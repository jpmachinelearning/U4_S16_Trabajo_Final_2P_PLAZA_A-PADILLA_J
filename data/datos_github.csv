tipo,numero,comentarios
Issue,4793,Siendo tratado en #4784 
Issue,4760,"Adem√°s, hemos podido comprobar que el mismo problema se reproduce en Odoo 17.0, utilizando el m√≥dulo l10n_es_aeat_mod190 en la rama 17.0.

Al generar el fichero del modelo 190 desde Odoo 17.0 para el ejercicio 2025, la sede electr√≥nica de la AEAT devuelve errores similares, relacionados con la falta de los campos obligatorios correspondientes a prestaciones de jubilaci√≥n, viudedad, pensiones por incapacidad y percepciones asimiladas, que son requeridos por la AEAT para dicho ejercicio.

Actualmente, dichos campos no parecen estar contemplados tampoco en la rama 17.0 del m√≥dulo, provocando que el fichero generado no sea v√°lido para su importaci√≥n.

Dado que estos campos ya han sido incorporados en la rama 18.0, consideramos que un backport de los cambios desde 18.0 hacia 17.0 (y 16.0) permitir√≠a mantener la compatibilidad del modelo 190 con los requisitos de la AEAT para el ejercicio 2025.

Gracias por vuestro trabajo y soporte. [SEP] S√≠, desde luego la soluci√≥n pasa por llevar esos cambios a ambas ramas. La cuesti√≥n es que quien est√© interesado en ello debe hacerlo, financiar para que lo hagan, o esperar a que otros lo hagan, ya que as√≠ es como funciona el software abierto: se contribuye voluntariamente y donde es posible hacerlo. Lo ideal ser√≠a que quien contribuye el parche, lo haga para todas las versiones posibles, pero no se le puede exigir que as√≠ lo haga. Cuando el parche se pone en una versi√≥n intermedia, s√≠ que solemos pedir que por lo menos lo lleven a todas las versiones superiores para mantener todo sincronizado. En este caso, es al rev√©s, habiendo sido puesto en la √∫ltima versi√≥n disponible, pero no estando en las versiones anteriores.

La mayor√≠a de trabajo est√° hecho, as√≠ que solo falta ese √∫ltimo empuj√≥n. ¬øOs anim√°is? [SEP] @pedrobaeza Gracias por la aclaraci√≥n.
De acuerdo, nos pondremos con el backport de los cambios desde 18.0 a las ramas 16.0 y 17.0 para cubrir los requisitos del ejercicio 2025, intentaremos hacerlo lo antes posible.
 
Gracias. üôÇ"
Issue,4743,
Issue,4681,"Hola.

Agradecer√≠a si alguien puede confirmar que tambi√©n tiene este problema en Verifactu en V17. He buscado razones para que funcionara correctamente en V16 y tras migrar a V17 apareciera este error, pero no he encontrado nada.

Gracias "
Issue,4677,
Issue,4666,"Ya he podido solucionarlo, en la v12 exist√≠a en el core de odoo la reconciliaci√≥n, a partir de la v14, ya no existe y se hace mediante los m√≥dulos de oca, y es por eso que ese m√≥dulo al llegar a la v18 y desplegar la bbdd actualizada, no mostraba lo mismo ya que no ten√≠a el m√≥dulo de reconciliaci√≥n.

Por si a alguien le sirve aqu√≠ estaba la soluci√≥n.

Gracias!"
Issue,4652,"@HaraldPanten  [SEP] @pedrobaeza tiene que ver con los cambios que llevasteis a cabo no hace mucho. Est√° causando ralentizaci√≥n y errores cuando se utilizan grupos de impuestos. En este caso el DUA, concretamente.

Ya nos das feedback. [SEP] @pedrobaeza Pudiste echarle un ojo a los comentarios en esta incidencia?

Gracias. [SEP] No, lo siento. [SEP] @pedrobaeza Pod√©is echarle un ojo? O proponemos parche directamente? [SEP] Si pod√©is vosotros proponer parche, os lo agradecer√≠a. Con el fin de a√±o estoy desbordado. [SEP] El PR propuesto https://github.com/OCA/l10n-spain/pull/4674 da una soluci√≥n a la incompatibilidad, pero no se aceptar√° debido a que el m√≥dulo necesita un refactoring, se tendr√° en cuenta m√°s adelante, quien quiere utilizarlo es totalmente viable.
Por mi parte dejar√≠a la Issue abierta para que haya una referencia.  [SEP] @pedrobaeza Dejamos esta issue abierta, para que el resto de usuarios tengan m√°s facilidad para encontrar la traza, etc. Cuando m√°s adelante se plantee refactoring, ya cerramos.

Gracias."
Issue,4650,"Faltar√≠a un m√≥dulo `l10n_es_sii_reav` que a√±ada los mapeos donde correspondan, y tal vez trate la clave adecuada en la posici√≥n fiscal."
Issue,4649,PR para 4T-12/2025: https://github.com/OCA/l10n-spain/pull/4691
Issue,4642,"¬øPero y cuando sea factura de rappel? ¬øO se rectifique una factura no introducida en Odoo (por ejemplo, por cambio de software)? ¬øQu√© pasa si no se env√≠a `""FacturasRectificadas"": [],`? ¬øNo deber√≠a ser √©se el parche? [SEP] Igual si, igual el parche es enviarlas sin ""FacturasRectificadas"": [], aunque lo marca en en dise√±o del registro como obligatorio, pero si no lo env√≠as lo acepta.
Asi NO se envia a verifactu
        ""TipoFactura"": ""R1"",
        ""TipoRectificativa"": ""I"",
        ""FacturasRectificadas"": [],
Asi SI se envia a verifactu
       ""TipoFactura"": ""R1"",
        ""TipoRectificativa"": false,
        ""DescripcionOperacion"": ""/"",

Pero que no se env√≠e creo que es propio del m√≥dulo de verifactu. No es que aeat lo rechace, realmente no se envia. Pero el cron tampoco da error visible. [SEP] Hola. Tenemos una instalaci√≥n de Odoo 17 con verifactu, en la cual un usuario, por mala costumbre desde antes de verifactu, realiz√≥ una factura rectificativa directamente sin crearla desde la factura de venta original.

El resultado es el mismo que se est√° comentando en este issue. ¬øAhora que ya la factura rectificativa est√° creada cu√°l es la mejor soluci√≥n? 

Entiendo que lo que est√° esperando verifactu y le falta es:
```
""FacturasRectificadas"": [
            {
                ""IDFacturaRectificada"": {
                    ""IDEmisorFactura"": ""BXXXXXXXX"",
                    ""NumSerieFactura"": ""SIXXXXX"",
                    ""FechaExpedicionFactura"": ""01-01-2026""
                }
            }
        ]
``` 

¬øPodr√≠a meterlo a trav√©s de BD, o hay alguna otra soluci√≥n mejor?

Gracias [SEP] Hola. √önicamente confirmar que introduciendo en BD el reversed_entry_id de la factura original que est√° relacionada con la rectificativa, soluciona el problema puntual.

Entiendo que la soluci√≥n definitiva es que si verifactu est√° instalado y habilitado, no se permita a los usuarios crear facturas rectificativas directamente, al igual que no se permite la cancelaci√≥n de las facturas.

Un saludo y muchas gracias"
Issue,4641,PR: https://github.com/OCA/l10n-spain/pull/4690 [SEP] Implementado.
Issue,4639,"El validador no parece funcionar correctamente, ya que el XSD s√≠ se cumple, y las facturas suben a FACe. ¬øHas probado a subir alguna? [SEP] Si, este es el error que me da al intentar subir.

<img width=""1600"" height=""860"" alt=""Image"" src=""https://github.com/user-attachments/assets/231c20f1-dbd5-4084-8c13-1cfc282ce151"" /> [SEP] Creo que puede ser por los experimentos con el nuevo sistema FACe que est√°n haciendo. @etobella t√∫ tienes problemas? [SEP] Con la integraci√≥n directa no he visto errores en mis clientes. Por lo que veo del error, se queja de que la etiqueta CnoCnae est√° definida pero deber√≠a estar vac√≠a, pero esto en teor√≠a no se rellena y se vac√≠a autom√°ticamente. [SEP] @etobella se queja de todas las etiquetas que estan vacias, yo he hecho un fix para que las que estan vacias no las ponga en el fichero y ya me deja subir bien, pero creo que se debe de corregir en el m√≥dulo. [SEP] @manuelcalerosolis La limpieza ya se hace autom√°ticamente aqu√≠ y est√° as√≠ desde hace tiempo. Los ficheros firmados desde el Odoo deber√≠an salir limpios.

https://github.com/OCA/l10n-spain/blob/18.0/l10n_es_facturae/reports/report_facturae.py#L45 [SEP] Mis clientes lo estan exportando sin firmar, tambien deben de salir limpios, ¬øno? [SEP] No lo s√©, nunca los he usado as√≠, ya que te complicas mucho la vida. Si lo ves necesario puedes proponer un PR üòâ "
Issue,4637,Deb√©is hacer backport de #4602 
Issue,4632,
Issue,4631,"Yo por mi parte no veo bug aqu√≠. S√≠ podr√≠a ser interesante que, cuando se crean nuevos diarios de venta, se genere alguna alerta del tipo ""Por favor, revise si debe activar la comunicaci√≥n Verifactu en este diario"".

Hay casos en los que se necesitan registrar / importar en Odoo facturas de venta que han sido generadas desde otro SIF y, por lo tanto, ya han sido comunicadas a Verifactu en ese otro sistema.
 [SEP] El SIF debe cumplir la normativa siempre.
Permitir crear facturas sin ese check activado no cumple el reglamento de facturacion

Ah√≠ esta mi preocupaci√≥n [SEP] La verdad es que aunque haya casu√≠sticas que puedan justificar no enviar a VERI\*FACTU, esto es la puerta abierta a tener un diario de ""caja B"". @almumu @anmarmo1 @SoniaViciana record√°is cu√°l fue la raz√≥n inicial de habilitar VERI\*FACTU por diarios? O fue solo por mimetizar con el SII?

Y lo mismo podr√≠a plantearse de las posiciones fiscales. [SEP] Disculpas si conven√≠s que esto aqu√≠ no procede

Pero si viene a colaci√≥n

Hay una casu√≠stica que igual puede ser tenida en cuenta

Cuando el destinatario de las operaciones es quien emite la factura en nombre del emisor

El destinatario env√≠a a la AEAT pues es √©l quien la ha generado con un SIF y esa AUTOfactura se la env√≠a al emisor

Vamos a necesitar introducir en odoo esa factura para contabilizarla, pero esa factura ya ha sido enviada, ya tiene una serie y un n√∫mero

Se podr√≠a limitar o modificar alg√∫n elemento de todos los registros account.move que pertenezcan a esos diarios concretos para que no generen facturas a trav√©s de la modificaci√≥n del reporte

 [SEP] Pongo un escenario real:

-Empresa del sector el√©ctrico que utiliza Odoo como ERP para su operativa general (contabilidad, compras, facturaci√≥n propia, etc.).
-Adem√°s, subcontrata un SIF externo para la emisi√≥n de determinadas facturas en su nombre.

Ese SIF externo:

-Genera su propia serie y numeraci√≥n,
-Remite esas facturas a Verifactu, cumpliendo con las obligaciones t√©cnicas de env√≠o establecidas en el reglamento.

Para poder llevar la contabilidad consolidada en Odoo, la empresa debe importar peri√≥dicamente esas facturas ya emitidas en el sistema externo. Deben existir como facturas en Odoo (por IVA, libros, modelos fiscales, conciliaciones‚Ä¶), pero no deber√≠an reenviarse a Verifactu, ya que ese env√≠o ya se realiz√≥ correctamente desde el primer SIF.

Por ese motivo, veo l√≥gico que el m√≥dulo de OCA permita configurar diarios en los que:

-Se registren e integren esas facturas externas,
-Pero con Verifactu desactivado para evitar duplicidades en la AEAT.

Desde mi punto de vista, la configuraci√≥n por diario no es un error, sino que permite cubrir escenarios en los que una empresa factura desde varios SIF y, aun as√≠, centraliza toda su contabilidad en Odoo.

En este contexto existir√≠an dos SIF diferenciados:

-El SIF externo, que emite y, por tanto, es responsable de enviar a Verifactu lo que √©l mismo genera.
-Odoo, que act√∫a como SIF √∫nicamente respecto a las facturas emitidas efectivamente en Odoo. Los diarios ‚Äúno Verifactu‚Äù no emiten; simplemente contabilizan facturas originadas en otros sistemas.

Coincido con Pedro en que esta flexibilidad podr√≠a malutilizarse para crear diarios ‚Äúopacos‚Äù, pero entiendo que ese riesgo existe en pr√°cticamente cualquier ERP y no deriva de la funcionalidad en s√≠, sino del control interno y los procesos de cada empresa.
 [SEP] Con ese planteamiento

Se permite emitir facturas al margen del reglamento

No es viable [SEP] FAQ para desarrolladores de la AEAT: https://www.agenciatributaria.es/static_files/AEAT_Desarrolladores/EEDD/IVA/VERI-FACTU/FAQs-Desarrolladores.pdf

El punto 10, importaci√≥n de facturas, creo que da la pista sobre el tema. Pongo este extracto:

[...]Por lo tanto, en los sistemas del empresario,
efectivamente, este tendr√° facturas de dos clases: las producidas con su SIF y las
producidas con el SIF del empresario al que delegue esa facturaci√≥n. Esas otras
facturas, naturalmente no se tienen ni que volver a imprimir con QR, ni mucho menos
volver a enviarlas a la Sede Electr√≥nica de la AEAT. Ambas funcionalidades las habr√°
realizado el SIF de la empresa que materialmente las haya emitido.[...]


 [SEP] El m√≥dulo de odoo SA para 18 por ejemplo , no permite desconectar verifactu en un diario de ventas si verifactu est√° activado [SEP] Sin embargo, el m√≥dulo de odoo SA no bloquea el diario de ventas con el hash de odoo (esto ser√≠a otra cuestion) [SEP] Propuesta de soluci√≥n

En aquellos deployments donde Verifactu est√© activado a nivel de compa√±√≠a ‚Äîcomo sucede actualmente‚Äî puede darse el caso de que existan diarios con la opci√≥n Verifactu activada y otros diarios donde dicha opci√≥n no est√© activada.

Para garantizar el cumplimiento normativo y evitar inconsistencias, se propone aplicar una restricci√≥n directa sobre los movimientos contables (account.move) que pertenezcan a diarios con Verifactu desactivado.

Restricci√≥n propuesta

Para los registros de account.move cuyo diario no tenga habilitada la opci√≥n Verifactu, se aplicar√°n los siguientes bloqueos:

1. No permitir imprimir

Los documentos contables asociados a estos diarios no podr√°n ser impresos bajo ninguna circunstancia.
Esto evita que se generen versiones impresas que puedan interpretarse como documentos oficiales cuando no cumplen con los requisitos Verifactu.

2. No permitir enviar

Del mismo modo, estos documentos no podr√°n enviarse a terceros (por email u otros medios) desde el sistema.
El objetivo es impedir que se distribuyan documentos que no est√©n validados conforme al est√°ndar Verifactu.

Resultado esperado

Con esta limitaci√≥n:

Los diarios con Verifactu activado seguir√°n funcionando con todas las caracter√≠sticas previstas (env√≠o, impresi√≥n, informes‚Ä¶).

Los diarios sin Verifactu activado quedar√°n claramente diferenciados, sin posibilidad de imprimir ni enviar sus movimientos.

Se evita cualquier uso indebido o interpretaci√≥n err√≥nea de documentos no validados seg√∫n Verifactu.

Se garantiza un funcionamiento coherente dentro del mismo deployment mixto. [SEP] > La verdad es que aunque haya casu√≠sticas que puedan justificar no enviar a VERI*FACTU, esto es la puerta abierta a tener un diario de ""caja B"". [@almumu](https://github.com/almumu) [@anmarmo1](https://github.com/anmarmo1) [@SoniaViciana](https://github.com/SoniaViciana) record√°is cu√°l fue la raz√≥n inicial de habilitar VERI*FACTU por diarios? O fue solo por mimetizar con el SII?
> 
> Y lo mismo podr√≠a plantearse de las posiciones fiscales.

Hola Pedro, lo dejamos abierto por que se planteo el tema de las auto-facturas y posibles casos en los que no se tuviesen que remitir a AEAT, Realmente, no se si realmente hay casos en los que no aplique el verifactu a parte de diarios que se utilicen para importar ventas y cosas asi, pero personalmente yo no lo contemplar√≠a en un diario de venta ya que si lo tratamos como factura nos obliga a tener un registro de facturacion aunque no se envie a AEAT y la implementacion de eso se complica, el registro de facturacion no es la propia factura en el documento de faq's en el punto 10 ""Cada factura tiene un Registro de Facturaci√≥n (RF). En la configuraci√≥n de dicho RF se incluye la identidad del SIF emisor. Por lo tanto, las facturas, mejor dicho los Registros
de Facturaci√≥n, que se encuentren soportados en un sistema de Gesti√≥n, pero que no
hayan sido producidos por el SIF del empresario, son f√°cilmente identificables como
RFs importados para dicha gesti√≥n"" Eso implica que guardemos la identificaci√≥n del SIF original [SEP] En ese sentido, quiz√°s ser√≠a interesante habilitar un campo de la cabecera de la factura, para diarios de venta No Verifactu, en el que se pueda informar la identificaci√≥n del SIF original.
 [SEP] Y, tambi√©n, lo que indica cesarsc79 tiene sentido: si se trata de facturas importadas desde otro SIF, hacia un diario de ventas de Odoo No Verifactu, quiz√°s se podr√≠a plantear la posibilidad de impedir que se pueda imprimir o enviar una factura, estas facturas solo deber√≠an existir en Odoo con prop√≥sitos de gesti√≥n contable, declaraci√≥n de impuestos... Pero no para reimpresi√≥n (al menos el Qr ya no sale) o para env√≠o.  [SEP] Cuantas m√°s vueltas le doy, m√°s se deber√≠a prohibir estos diarios que no env√≠en a VERI*FACTU. Si alguien importa, que en su proceso de importaci√≥n neutralice esas facturas para que no se env√≠en otra vez (por ejemplo, tocando el estado VERI*FACTU y poni√©ndolo a enviado). [SEP] Esos diarios ser√°n necesarios en varios escenarios

Autofacturas
Facturas emitidas con otro SIF

Debemos tener en cuenta que este reglamento est√° orientado m√°s al fabricante de software que al cliente final. Solo hay que ver las sanciones

Lo de la declaraci√≥n responsable firmada por el propio cliente, no es una soluci√≥n [SEP] Creo que aquellos que quieran bajo su riesgo tener esos diarios, deber√≠a ser mediante un m√≥dulo extra que lo habilite, pero no en el m√≥dulo base. ¬øEst√°is de acuerdo los que hab√©is intervenido en el desarrollo? [SEP] La soluci√≥n que comentas, Pedro, me parece la soluci√≥n ideal: m√≥dulo base restrictivo y plenamente orientado a la norma. M√≥dulo extra, permitir√° que quienes usen Odoo como SIF pero tambi√©n deban importar de SIF diferentes (imprescindible en determinadas operativas o sectores), tengan una soluci√≥n para ello. [SEP] > Creo que aquellos que quieran bajo su riesgo tener esos diarios, deber√≠a ser mediante un m√≥dulo extra que lo habilite, pero no en el m√≥dulo base. ¬øEst√°is de acuerdo los que hab√©is intervenido en el desarrollo?

A colaci√≥n de lo que dices, he estado pensando otra posible soluci√≥n que tiene en cuenta tus comentarios.......


### üìù PROPUESTA FUNCIONAL Y T√âCNICA PARA `l10n_es_verifactu_oca

A ra√≠z del debate sobre la posibilidad de crear diarios de ventas sin Verifactu aun teniendo Verifactu activo en la compa√±√≠a, y considerando adem√°s la necesidad de gestionar **facturas emitidas por otros SIF** (autofacturas, delegaci√≥n de facturaci√≥n, SIF sectoriales‚Ä¶), propongo la siguiente soluci√≥n dividida en dos niveles:

---

# 1Ô∏è‚É£ PROPUESTA FUNCIONAL

## 1.1. Comportamiento del m√≥dulo base `l10n_es_verifactu_oca` (estricto y seguro)

Cuando una compa√±√≠a tenga Verifactu activado:

1. **Todos los diarios de tipo ‚ÄúVentas‚Äù deben ser Verifactu por defecto**  
   - Al crear un diario con `type = sale`, el check Verifactu debe venir marcado autom√°ticamente.  
   - No deber√≠a ser posible desmarcarlo desde el m√≥dulo base.

2. **No se deben poder validar facturas de venta fuera del flujo Verifactu**  
   - Si la compa√±√≠a tiene Verifactu activo y se valida una factura de cliente (`out_invoice` / `out_refund`):
     - El diario debe tener Verifactu activado.  
     - Si no lo tiene ‚Üí error.
   - Mensaje propuesto:
     > ‚ÄúNo se pueden validar facturas de venta en un diario sin Verifactu cuando la compa√±√≠a tiene Verifactu activado.‚Äù

3. **Sin modalidad ‚ÄúNO Verifactu‚Äù en el m√≥dulo base**  
   - En Odoo 16 (OCA) solo contemplamos la modalidad ‚ÄúVerifactu‚Äù.  
   - Toda factura emitida desde un diario de venta normal debe pasar por Verifactu.

Este comportamiento evita:
- la emisi√≥n de facturas de ‚Äúcaja B‚Äù,
- inconsistencias en la traza Verifactu,
- errores involuntarios por parte del usuario.

---

## 1.2. M√≥dulo adicional OCA (nuevo): gesti√≥n de **facturas importadas desde otros SIF**

La AEAT, en la FAQ 10 (‚ÄúImportaci√≥n de facturas desde otros sistemas‚Äù), especifica que pueden coexistir:

- facturas emitidas por el SIF del empresario (Odoo), y  
- facturas emitidas por otro SIF (delegado, del destinatario, sectorial‚Ä¶).  

Estas facturas **no deben reenviarse a AEAT ni reimprimirse con QR**, pero s√≠ deben almacenarse indicando el **SIF emisor original**.

Para cubrir estos escenarios, se propone un m√≥dulo adicional (p. ej. `l10n_es_verifactu_oca_import`) con:

### a) Nuevo modo de diario:  
**‚ÄúDiario de importaci√≥n desde otro SIF‚Äù**

Campo nuevo en `account.journal` (solo tipo `sale`):

- `verifactu_import_journal = True` ‚Üí el diario se usa para **registrar facturas emitidas por otro SIF**, no por Odoo.

Al activarlo:
- La opci√≥n Verifactu del diario se desactiva (este diario no act√∫a como SIF).  
- Odoo no debe generar RF ni enviar nada a AEAT para estas facturas.

### b) Nuevos campos en la factura (`account.move`)

Para facturas en diarios de importaci√≥n:

- `external_sif_id` ‚Äì Identificador del SIF original.  
- `external_sif_installation` ‚Äì N¬∫ de instalaci√≥n del SIF original.  
- `external_rf_identifier` ‚Äì Identificador del RF original (si se tiene).  
- `is_external_invoice` (compute) ‚Äì Indica que es una factura importada.

Esto permite cumplir la trazabilidad prevista en la FAQ 10.

### c) Restricciones: sin impresi√≥n ni env√≠o

Para `is_external_invoice = True`:

- No se permite **imprimir** la factura desde Odoo.  
- No se permite **enviarla por email** desde Odoo.

La impresi√≥n y entrega al cliente ya la realiz√≥ el SIF original.

### d) Exclusi√≥n del flujo Verifactu

Las facturas importadas:

- No deben generar RF Verifactu.  
- No entran en el hash encadenado.  
- No se seleccionan para env√≠o a AEAT.  
- Pueden existir para contabilidad, libros de IVA y modelos fiscales.

---

# 2Ô∏è‚É£ PROPUESTA T√âCNICA

## 2.1. M√≥dulo base

### `account.journal`
- En `create` / `write`:
  - Si `type == 'sale'` y Verifactu est√° activo en la compa√±√≠a:
    - Forzar `verifactu = True` salvo que el m√≥dulo extra marque expl√≠citamente el diario como `verifactu_import_journal`.

### `account.move`
- En `action_post`:
  - Si es factura de cliente y:
    - diario es tipo `sale`,
    - Verifactu est√° activo a nivel de compa√±ia,
    - Verifactu no activado en el diario
    - y **NO** es diario de importaci√≥n ‚Üí error.

---

## 2.2. M√≥dulo adicional `l10n_es_verifactu_oca_import`

### Nuevos campos en `account.journal`
```python
verifactu_import_journal = fields.Boolean(
    string=""Diario de importaci√≥n desde otro SIF"",
    help=""Para registrar facturas ya emitidas por otro SIF y enviadas a AEAT.""
)
```

Al marcarlo:
```python
if self.type == 'sale' and self.verifactu_import_journal:
    self.verifactu_enabled = False
```

### Nuevos campos en `account.move`
```python
external_sif_id = fields.Char()
external_sif_installation = fields.Char()
external_rf_identifier = fields.Char()
is_external_invoice = fields.Boolean(compute=""_compute_is_external_invoice"", store=True)
```

### Bloqueo de impresi√≥n y env√≠o
```python
def action_print(self):
    if self.is_external_invoice:
        raise UserError(""No se puede imprimir una factura emitida por otro SIF desde Odoo."")
    return super().action_print()

def action_invoice_sent(self):
    if self.is_external_invoice:
        raise UserError(""No se puede enviar por email una factura emitida por otro SIF."")
    return super().action_invoice_sent()
```

### Exclusi√≥n del flujo Verifactu
En el m√©todo que prepara env√≠os:
```python
moves = moves.filtered(lambda m: not m.is_external_invoice)
```

---

# 3Ô∏è‚É£ BENEFICIOS

- Cumple estrictamente con Verifactu y evita riesgos de ‚Äúcaja B‚Äù.
- Respeta la normativa sobre RF importados descrita en la FAQ 10.
- Permite a las empresas que trabajan con varios SIF integrar facturas sin duplicidad en AEAT.
- Mantiene una arquitectura modular:  
  - el m√≥dulo base es seguro y normativo,  
  - el m√≥dulo extra a√±ade flexibilidad para quien realmente la necesita.


 [SEP] Vamos a empezar quitando la opci√≥n de desactivarlo, y luego se hace el m√≥dulo extra. Si quieres ir con ello, adelante. [SEP] Estoy de acuerdo con desactivar la opci√≥n creo que si alguien realmente lo necesita habria que hacer otro m√≥dulo como decis. [SEP] En todo caso... Creo que podremos pensar en todo esto de forma m√°s pausada, con el aplazamiento. Como se suele decir: ""para mear y no echar gota"". Estoy en shock. [SEP] Noticia del aplazamiento.

[https://www.eleconomista.es/legal/noticias/13672020/12/25/hacienda-da-un-respiro-a-empresas-y-autonomos-y-retrasa-verifactu-a-2027.html](url)

Cuando este publicado en el boe, seguimos [SEP] ¬øcomo qued√≥ esto?
Verifactu sigue siendo obligatorio desde el verano pasado para la gente que empiece a usar el SIF [SEP] S√≠, Odoo cuenta con VERI*FACTU. Otra cosa es que no se active hasta que no haga falta."
Issue,4626,
Issue,4623,
Issue,4620,Revisa por favor las discusiones que hay en este repositorio donde ya se ha preguntado y contestado. Cierro al no ser una issue del c√≥digo.
Issue,4618,"Hola @ivilata cuando realizas un restore con el neutralice todos los CRON deber√≠an quedar desactivados, por lo tanto revisa que el de VERI*FACTU se queda de esa manera, esto te garantiza que no se env√≠a nada. [SEP] Es lo que comenta Mario. Cierro. [SEP] ¬°Gracias @syci y @pedrobaeza! He vuelto a realizar la prueba reimportando la BDD como neutralizada (antes tambi√©n lo estaba), y esta vez las tareas de cron no se han ejecutado. Creo que durante mis pruebas, como reinstal√© el m√≥dulo de VERI*FACTU sobre la BDD neutralizada, tal vez se volvi√≥ a crear o actualizar la tarea, activa esta vez. Imagino que es el comportamiento esperado en este caso, as√≠ que nada.

Gracias de nuevo y disculpad por el ruido. üôÇ "
Issue,4615,"Si hay que hacer alg√∫n fix o improvement podr√≠a ponerme yo misma. @pedrobaeza @almumu  [SEP] Habr√≠a que marcar la casilla de simplificada en el contacto, s√≠. Creo que poner que haga eso autom√°tico podr√≠a ser algo arriesgado, ¬øno cre√©is? [SEP] S√≠, me parece bien que se haga de forma manual, as√≠ tenemos m√°s control. ¬°Mil gracias @pedrobaeza! Cierro la issue."
Issue,4613,"Las correcciones se pueden hacer en asientos manuales, por ejemplo:
Se hicieron 5 facturas de 1000 euros en la cuenta 705000 cuando deb√≠a haber sido 700000.

Se hace un asiento manual

5000‚Ç¨ 705000   a   700000 5000‚Ç¨


Y queda mas robusto el verifactu siendo inmodificable [SEP] Efectivamente, √©se ser√≠a el procedimiento. [SEP] Gracias"
Issue,4605,"probablemente este cambio tambi√©n afecte a verifactu, o a otros m√≥dulos que llamen a la funci√≥n _get_aeat_tax_info
https://github.com/OCA/l10n-spain/blob/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_verifactu_oca/models/account_move.py#L371



 [SEP] @pedrobaeza  [SEP] esto podr√≠a ser una posible soluci√≥n https://github.com/OCA/l10n-spain/pull/4606"
Issue,4604,
Issue,4603,
Issue,4596,"A mi me sali√≥ en la 16 el mismo error, tuve que actualizar el bank-statement-import y luego el account_statement_input_file eso es porque no existe como dices, pero no es solo al completo. [SEP] Efectivamente. Ten√©is que actualizar todo el c√≥digo fuente a la vez. No se pueden actualizar unos repositorios s√≠, y otro no.

Cierro porque no existe realmente el error. Es un problema de despliegue."
Issue,4591,
Issue,4589,"Hola, ¬øhas actualizado tambi√©n el m√≥dulo dentro del propio Odoo, o solo has actualizado el c√≥digo? [SEP] Buenos d√≠as Pedro, ¬øa que te refieres? he actualizado el modulo con todas sus dependencias :
-l10n_es_verifactu_oca
-l10n_es_aeat
-account_tax_balance
-date_range
-account_invoice_refund_link

estos son los m√≥dulos que actualice y posteriormente actualice por interfaz...  

si modifico el c√≥digo si que me va:

Original  (no va)

```python
 def reverse_moves(self):
        res = super().reverse_moves()
        self.move_ids.filtered(lambda mov: mov.move_type == ""out_invoice"").mapped(
            ""reversal_move_id""
        ).write({""verifactu_refund_type"": ""I""})
        return res
```
    
Modificaco (si va)

```python
    def refund_moves(self):

         return self.reverse_moves()
```

lo he dejado con el c√≥digo ORIGINAL.. 

Ya me dices algo cu√°ndo puedas y mil gracias Pedro.  [SEP] @alvrico esto √∫ltimo que env√≠as no s√© qu√© tiene que ver con lo primero que pusiste, porque este c√≥digo que pones es para cuando haces una rectificativa. [SEP] Buenas Pedro, me he liado con otro problema qeu tenia... 

lo que he actualizado ha sido esto:

Buenos d√≠as Pedro, ¬øa que te refieres? he actualizado el modulo con todas sus dependencias :
-l10n_es_verifactu_oca
-l10n_es_aeat
-account_tax_balance
-date_range
-account_invoice_refund_link

estos son los m√≥dulos que actualice y posteriormente actualice por interfaz...


no se si sabr√°s porque me pasa.. y perdona que me he liado con otro problema que me ha surgido [SEP] Ahora mismo la verdad es que no sabr√≠a decirte, porque no es un error ""normal"". Prueba a instalar el m√≥dulo en una instancia limpia a ver. [SEP] buenas Pedro, por arte de magia ya funciona.. va todo perfecto.. 

mil gracias de nuevo "
Issue,4586,Cierro porque ya se est√° tratando en el PR y esto a√±ade ruido.
Issue,4550,
Issue,4534,"Tu Odoo no debe estar totalmente actualizado. Desc√°rgate el √∫ltimo c√≥digo de todo, y actualiza los m√≥dulos en tu BD. Cierro por ser una cuesti√≥n de despliegue, no del m√≥dulo en si. [SEP] Eso es lo que me pregunto, est√° completamente actualizado. [SEP] Prueba en el [runboat de 16.0 de OCA/l10n-spain](https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=16.0) si eres capaz de reproducir el problema.
 [SEP] Tenias raz√≥n, fallo de despliegue, no recuerdo y no se porque motivo tenia dos carpetas de addons diferente path, mismo contenido, actualic√© el contenido del modulo de IGIC, pero no de la ubicaci√≥n correcta. Muchas gracias. Solucionado."
Issue,4507,El error que obtengo es: Codigo[20009].Error interno en el servidor [SEP] Tiene toda la pinta de ser un problema de la propia AEAT. [SEP] Cierro por falta de respuesta.
Issue,4497,
Issue,4489,"Has seleccionado la versi√≥n 3.2.2 en el formato de Facturae? [SEP] Buenas gracias por tu pronta respuesta.
He probado las 3 versiones posibles y sigue igual. [SEP] Yo hice una factura hace una semana con el m√≥dulo y lo sub√≠ a FACe sin tener ning√∫n problema. ¬øPor qu√© no la subes directamente a ver? [SEP] La he firmado con odoo y he probado a subirla.
He probado a√±adiendo y quitando el ES delante del dni de la compa√±ia.

6 - 447 - El DNI del emisor es incorrecto
"
Issue,4472,"El tema es tener que depender del m√≥dulo `hr`. Creo que el modelo 190 tendr√≠a que tener un grupo espec√≠fico de seguridad, pero no para toda la pesta√±a, si no para esos datos. [SEP] ¬øValdr√≠a el grupo que se us√≥ en https://github.com/OCA/l10n-spain/pull/3692? [SEP] S√≠, coincido en que crear un grupo de seguridad espec√≠fico para los campos sensibles del modelo 190 es una opci√≥n m√°s pr√°ctica. Evitar√° depender completamente del m√≥dulo hr.employee y tambi√©n permitir√° que esta pesta√±a sea accesible para los usuarios con este permiso.
¬øC√≥mo lo v√©is @rafaelbn y @EmilioPascual ? [SEP] M√°s que la pesta√±a, esos campos dentro de la pesta√±a. No se puede limitar la pesta√±a completa a la AEAT o a este nuevo grupo, porque ah√≠ hay campos que pueden necesitar cambiar otros perfiles (como la identificaci√≥n o si es simplificado). [SEP] Pod√©is revisar https://github.com/OCA/l10n-spain/pull/4512 con el fix."
Issue,4468,"No creo que sea de multi-empresa, si no de que tu diario no tiene marcado para utilizar el hash seguro. Revisa eso, y si no, lo m√°s sencillo es desmarcar y volver a marcar lo de habilitar VERI*FACTU. [SEP] Lo probar√©, gracias. [SEP] Buenas, es cierto que funciona as√≠. Hemos desactivado y activado en el diario de habilitar VERI*FACTU y si funciona. Como no lo pone en ning√∫n sitio y es poco intuitivo al ver un error hemos pensado en que era un bug.
Un saludo y gracias. [SEP] No, a ver, realmente se puede considerar un bug. La cuesti√≥n es dar con los pasos exactos que llevan al mismo, y por el momento, no lo hemos conseguido. Esto fue reportado tambi√©n en https://github.com/OCA/l10n-spain/pull/4399#issuecomment-3368924524, pero lo dicho, no consigo reproducirlo. [SEP] No se si es por la multicompa√±√≠a, pero me ha dado la pista para reproducirlo. Pasa cuando configuras verifactu desde otra compa√±√≠a como admin. Los pasos que he seguido en runboat, Con el usuario admin estando seleccionada la compa√±√≠a ""San Francisco"", accedo a la configuraci√≥n de la compa√±√≠a ES, activo y configuro verifactu. Luego voy a las facturas, cambio la compa√±√≠a y hago una factura. Al validarla da el error. Si configuro verifactu habiendo cambiado previamente a la compa√±√≠a ""ES"" no da ese error."
Issue,4467,
Issue,4463,"Nos ocurre lo mismo. 
La soluci√≥n ha sido modificar la definici√≥n de la funci√≥n quedando as√≠: def reverse_moves(self, is_modify=False)

Este m√≥dulo al heredar de account_invoice_refund_link que en su rama 16.0 esta definido como:
https://github.com/OCA/account-invoicing/blob/d0f39d06b2a703100feb3b5374652e802f802df4/account_invoice_refund_link/wizards/account_move_reversal.py#L10
Mientras que en la rama 17.0:
https://github.com/OCA/account-invoicing/blob/e34d6cfa741003d4668c4b8325782ea8798612b4/account_invoice_refund_link/wizards/account_move_reversal.py#L10
 [SEP] S√≠, disculpad. Esta tarde subo parche. [SEP] Tambi√©n, en cuanto a las facturas rectificativas, hemos detectado que al crear una directamente desde su men√∫ ""Facturas Rectificativas"", sin revertir desde la factura de cargo, esta no se env√≠a. Lo mismo es algo de configuraci√≥n que no hemos tenido en cuenta y no es el hilo adecuado, pero hago el comentario por si est√° relacionado.   [SEP] Arreglado en #4470 "
Issue,4462,Cubierto con #4565
Issue,4457,"Ya he podido solucionarlo, cierro."
Issue,4444,"¬øincluimos tambi√©n columna de periodo de deducci√≥n para que se incluya la fecha contable? 

<img width=""1461"" height=""562"" alt=""Image"" src=""https://github.com/user-attachments/assets/1bd6a948-e760-4cb6-9d19-c861ffc07cec"" /> [SEP] @AlbertCabedo va a financiar a @Tecnativa para realizar esta mejora. Estar√° disponible pr√≥ximamente. [SEP] Implementado en #4709, y backports en camino."
Issue,4435,Pon por favor dicho comentario en el PR abierto del m√≥dulo: #4378 
Issue,4430,
Issue,4428,Migrated at https://github.com/OCA/l10n-spain/tree/18.0/l10n_es_aeat_sii_oss
Issue,4425,"En 17 est√° implementado: https://github.com/OCA/l10n-spain/blob/05f2dd44c1602af0d6d0256bca064693d1afd015/l10n_es_aeat_sii_oca/models/res_company.py#L58 [SEP] https://github.com/OCA/l10n-spain/pull/4436 [SEP] Ya est√° disponible en 16, 17 y 18."
Issue,4424,"Edit: no s√© por qu√© he le√≠do SII. Efectivamente, habr√≠a que hacer el equivalente al del SII para OSS. [SEP] creado pr https://github.com/OCA/l10n-spain/pull/4500"
Issue,4423,creado pr https://github.com/OCA/l10n-spain/pull/4499 [SEP] Cierro como ya est√° el PR en marcha.
Issue,4421,"desarrollo en progreso https://github.com/OCA/l10n-spain/pull/4548 [SEP] Hola, 
en la configuracion del modulo verifactu en la compa√±ia debo poner  datos de desarrollador, esta informacion donde la puedo buscar [SEP] > Hola, en la configuracion del modulo verifactu en la compa√±ia debo poner datos de desarrollador, esta informacion donde la puedo buscar

https://github.com/OCA/l10n-spain/discussions/4451"
Issue,4420,"Me pongo con este issue
https://github.com/OCA/l10n-spain/pull/4429"
Issue,4419,"cierro issue puesto que las altas por rechazo son facturas que deben subsanarse al igual que las aceptadas con errores, es decir, una vez rechazada, no se enviar√≠a autom√°ticamente hasta que el usuario no la subsana y le da al bot√≥n de reenviar desde la factura. El problema es que el alta por rechazo no estaba funcionando correctamente, esto se soluciona en https://github.com/OCA/l10n-spain/pull/4429"
Issue,4416,
Issue,4402,"Migrando l10n_es_partner #4413  [SEP] Migrando l10n_es_aeat #4624  [SEP] Migrando l10n_es_aeat_mod111 #4675  [SEP] Migrando l10n_es_aeat_mod115 #4676 
 [SEP] Migrando delivery_gls_asm https://github.com/OCA/l10n-spain/pull/4685 [SEP] Migrando l10n_es_aeat_mod347 #4717  [SEP] 
> [ ]  payment_redsys - Incluido en core a partir de V19
> 

Dejo este comentario, ya que creo que payment_redsys no ser√° necesario
"
Issue,4397,"Buenas @vandekul, esa posici√≥n fue a√±adida hace 11 meses https://github.com/odoo/odoo/commit/a652896cb53717ad0a6a3abafb123bbe99110eb0 es posible que tu versi√≥n de odoo est√© desactualizada o bien el plan contable como tal. Una vez asegurado que tu versi√≥n contiene las posiciones correspondientes puedes utilizar el m√≥dulo https://github.com/OCA/account-financial-tools/blob/16.0/account_chart_update para crear las posiciones fiscales faltantes. Espero que te sirva de ayuda"
Issue,4391,Solucionado en #4404 
Issue,4390,"@moduon MT-11582

Vamos a agregar todas las retenciones e irpf que se deban excluir del total y que no est√°n hechas.

Corrigo la imagen de @ArantxaSudon que es una errata.

<img width=""2467"" height=""1096"" alt=""Image"" src=""https://github.com/user-attachments/assets/02d4b672-9897-4373-b117-bfe211698bb7"" />

¬øOs parece bien @OCA/local-spain-maintainers ?

Haremos PR semana que viene, para estar de acuerdo antes de hacerlo...

Gracias
Saludos [SEP] OK, adelante."
Issue,4389,"Se esta quejando del CIF del cliente. Por lo que veo no lo ten√©is establecido. [SEP] Eso pensava yo, pero realmente est√° establecido el CIF en la ficha del cliente:

<img width=""1188"" height=""625"" alt=""Image"" src=""https://github.com/user-attachments/assets/52b9f32c-a800-4321-9399-ccf7c2cdfd6c"" />
 [SEP] ES bug, acabo de probarlo en runboat y el campo ID no se rellena con en cif 
""IDOtro"": {
                    ""CodigoPais"": ""FR"",
                    ""IDType"": ""02"",
                    ""ID"": ""FR""}
Aunque este establecido. 

De hecho esta mal aqui https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_verifactu_oca/models/account_move.py#L447 [SEP] Ahora pongo el PR correspondiente. [SEP] > Ahora pongo el PR correspondiente.

Gracias @pedrobaeza  [SEP] Fix en #4398 "
Issue,4387,"Seg√∫n parece, tienes un c√≥digo de Odoo antiguo (que incluye el m√≥dulo l10n_es). Debes actualizar dicho c√≥digo y volver a probar."
Issue,4385,"Creo que @etobella podr√≠a opinar mejor al respecto [SEP] Para esto lo correcto es hacer un modulo que extienda la funcionalidad. Obviamente se puede hacer en la OCA y lo revisaremos cuando se publique [SEP] Perfecto, estoy a la espera de comprobar si la implementaci√≥n que he hecho funciona correctamente.

Lo que he planteado finalmente se basa en el modelo de unas facturas generadas con el programa de factura electr√≥nica que un cliente utiliza con factoring y que le est√°n funcionando correctamente.

La soluci√≥n consiste en:

* Agregar los campos Literales Legales, donde se podr√° incluir la informaci√≥n relativa al factoring.

* Incorporar los campos de Referencia Emisor y Referencia Receptor, para indicar expl√≠citamente que la factura se emite con factoring.

* Definir la cuenta bancaria asociada al factoring, que se usar√° siempre que el modo de pago sea de tipo Especial (13), sustituyendo la cuenta del cliente por la de la entidad cesionaria.

Gracias. [SEP] Buenos d√≠as @pedrobaeza @etobella,

Que os parece si agrego los literales legales, y las referencias en el l10n_es_facturae, ya que creo que esto es √∫til para toda persona que use el facturae, y luego haga un m√≥dulo de extensi√≥n que agregue la opci√≥n de la cuenta bancar√≠a de factoring?

¬°Quedo atento!

Saludos. [SEP] @BernatObrador los LegalLiterals ya existen, simplemente deber√°s a√±adir una referencia en el caso del factoring. Primero haz el m√≥dulo y desp√©s comprueba si lo necesitas. En la √∫ltima versi√≥n del facturae se pasa un proceso para limpiar los que est√°n vacios. [SEP] @etobella 
Por lo que vi en el report, y por eso los agregue, asegur√°ndome de que cada uno no haga m√°s de 250 char, es que en el reporte est√° as√≠:
`<LegalLiterals t-if=""False"" />`
Y en ning√∫n lado se computan estos.

Con el cliente ya hemos hecho la prueba y ha funcionado bien con la manera que os digo, agregando las referencias, literales legales y una cuenta da factoring, que ser√° la de la entidad que cesionaria, para que si el tipo de pago es especial (13), se sustituya la cuenta bancar√≠a en el pago, por esta, en lugar de la del cliente.

Hoy si me da tiempo subo las PR's, si no ya ser√° el lunes! Os voy comentando.

Muchas gracias por vuestro tiempo.

Saludos. [SEP] Implementado en #4417 "
Issue,4381,Solucionado en #4403
Issue,4376,Hola! Si tienen que ser dos d√≠gitos.   [SEP] Mil gracias! Funciona!
Issue,4375,"S√≠, aqu√≠ lo tienes: https://github.com/OCA/l10n-spain/pull/4357

y de hecho es una de las razones para tener la versi√≥n OCA."
Issue,4374,"El ID del SIF y el NIF informados deben haber sido dados de alta en Hacienda para poder hacer estas pruebas. [SEP] Hola, el NIF tiene que ser valido, el del desarrollador, AEAT lo comprueba, y el SIF id, se refiere a los dos digitos que indicas en la declaraci√≥n responsable y se tienen que dar de alta en la referencia del encadenamiento. 

<img width=""751"" height=""259"" alt=""Image"" src=""https://github.com/user-attachments/assets/37f1938f-a130-4a2a-98c5-e74c855196ba"" /> [SEP] Buenos d√≠as, Pedro:

Disculpa, pero si el software es Odoo, hay que poner lo que indica la declaraci√≥n responsable de Odoo, ¬øno habiendo sido ellos los que han desarrollador el m√≥dulo? Adjunto captura.

<img width=""1236"" height=""398"" alt=""Image"" src=""https://github.com/user-attachments/assets/65439e9c-0cbb-440c-a630-b989eb6616c6"" />

¬øSer√° que cada partner deber√° hacer una declaraci√≥n responsable y darse de alta en la AEAT?

Gracias de antemano por la ayuda.
 [SEP] Bueno, Odoo puede no cubrirte si no es un Odoo online. Cuando llegue la primera denuncia se sabra... Pon ah√≠ lo que estim√©is oportuno. [SEP] No hay que darse de alta en la AEAT, pero si que tendr√° que firmar alguien la declaraci√≥n responsable indicando que el software cumple con la legalidad. Puede ser el mismo cliente el que lo firme. Esto esta confirmado con AEAT, ya que al ser de c√≥digo abierto puede que tu como implantador no puedas asegurar que cumple. Odoo se ha puesto el pero me parece arriesgado ya que esta en la versi√≥n community y cualquiera puede modificar ese c√≥digo en una instalaci√≥n on-premise [SEP] Muchas gracias, Anmarmo1!"
Issue,4372,"Lo siento por mis disvistes !!

He visto se puede actualizar todo los posicines fiscales para registrar las nuevas claves de Verifactu por modulo ""account_chart_update"" segun pone en README.rst del ""l10n_es_verifactu_oca"":
- Establecer en las posiciones fiscales la clave de impuestos y la clave de registro VERI*FACTU.
- Para aplicar las claves ejecute el asistente de actualizaci√≥n del m√≥dulo accountchart_update.

En concreto:
            Install addons: account_chart_update
                # https://github.com/OCA/account-financial-tools.git

            Settings > Invoicing > Update Chart Template: Update char template
                Next:
                    Check Fiscal positions

                Create/update, then cloes

Creo que esta reuslto mis dudas.

Muchas gracias !!"
Issue,4368,"Hola @flachica me consta que @acysos ten√≠a pensado llevarlo a la V15, tambi√©n.

Seg√∫n lo que he hablado con @pedrobaeza , como los cambios de V16 hacia V14 y V15 son bastante similares, ser√≠a conveniente que pod√°is unir esfuerzos y coordinaros.

En caso de que necesit√©is revisiones, puedo aportar mi granito de arena.

Gracias. [SEP] @acysos, al enterarse finalmente dice que backportea a 13.0. A√∫n as√≠, no s√© si duplicamos esfuerzos. Bienvenidos tus aportes @HaraldPanten  [SEP] > [@acysos](https://github.com/acysos), al enterarse finalmente dice que backportea a 13.0. A√∫n as√≠, no s√© si duplicamos esfuerzos. Bienvenidos tus aportes [@HaraldPanten](https://github.com/HaraldPanten)

Y si lo llev√°is entonces vosotros a V14 y a V15? Nosotros a V13 no lo necesitamos.

Si fuera necesario miramos c√≥mo organizarnos para repartilo.

Ya nos dices @flachica  [SEP] Si. Mi idea es tener una PR en 14.0 antes de que finalice Octubre @HaraldPanten  [SEP] Por favor, portearlo a V13 tambien, no se si los cambios de V13 a V14 son muy profundos... [SEP] @flachica yo puedo ayudar tambien a nivel funcional en revisiones.
 [SEP] > Por favor, portearlo a V13 tambien, no se si los cambios de V13 a V14 son muy profundos...

Si no lo lleva a cabo @acysos de forma voluntaria, tambi√©n puedes abonar un importe a otros contribuidores para que lo hagan.

Un saludo. [SEP] He renombrado el hilo para ser m√°s amplio, puesto que no solo estamos hablando de la versi√≥n 14. [SEP] ¬°Hola! A no ser que @acysos indique que ya tiene algo iniciado de la adaptaci√≥n a Odoo 15, desde Batista10 (@B10Serveis) podr√≠amos encargarnos de ello (probablemente partiendo de la adaptaci√≥n a la 16). Por supuesto, toda ayuda en revisiones y sugerencias ser√≠a muy bienvenida. üôÇ  [SEP] Mejor partir de la 14 que de la 16, ya que en 16 se hizo una refactorizaci√≥n previa que habr√≠a que volver a extraerla para 15, lo que en la de la 14 ya se ha hecho. [SEP] Gracias @pedrobaeza, tomo nota. üôÇ  [SEP] Para facilitar el seguimiento del t√≠quet: el PR #4377 de @ljimenezsidoo para la migraci√≥n a 14 ya ha sido mezclado, he creado #4503 para la migraci√≥n a 15. [SEP] #4503 (Odoo 15) ha sido mezclado tambi√©n. üöÄ  [SEP] Voy a dar esta issue por cerrada, ya que se ha llevado Verifactu a 14.0, 15.0, 16.0 y 17.0.

En 18.0 acabar√° llegando por necesidad, seg√∫n procedimiento habitual de contribuciones, mientras que <14.0 deber√≠a tener un uso muy residual.

Cualquier cosa podemos reabrir hilo. [SEP] En 18 ya est√° tambi√©n... [SEP] sab√©is si se va a realizar backport a v13?
se sabe algo de que va a pasar con el tpv de odoo para verifactu?

gracias [SEP] De momento nadie ha expresado su inter√©s en pasarlo a 13. Es demasiado antiguo... Del TPV puedes mirar los diversos pull requests abiertos para ello."
Issue,4366,"tambi√©n he probado el addon y tengo tambi√©n error en el cron, he seguido el desarrollo y la versi√≥n tester de hace 1 mes funcionaba, ahora que sube las facturas solo con el cron, tambi√©n me da error,. [SEP] Probad por favor usando #4367 y dec√≠s si ya os sale correcto. [SEP] Buenos d√≠as, probado y funcionando. Muchas gracias. [SEP] correcto con los cambios indicados, gracias. seguiremos probando y si sale algo mas lo reportare.
gracias [SEP] Fusionando entonces. [SEP] Hola, he instalado el modulo verifactu en la version 16 y me pide como configuracion en las compa√±ias el codigo del desarrollador, como pudiera obtener ese codigo, Gracias"
Issue,4358,"Hola, no veo una aplicaci√≥n muy directa de eso en la gesti√≥n del ERP, pero si teneis algo espec√≠fico, comentadlo. [SEP] Hola @pedrobaeza le agregue m√°s detalles al Isuues, digame que le parece, gracias [SEP] De acuerdo, entonces entiendo que ser√° un nuevo plan contable ""IGIC (ZEC)"" o similar. [SEP] Si correcto @pedrobaeza es la idea "
Issue,4341,"Hola,
No veo mal que haya un m√≥dulo para gestiona las comunicaciones, ya que da mucha m√°s versatilidad a OCA. El problema que veo es que el framework EDI le ha pasado como al contract, ha evolucionado mucho y de tener una orientaci√≥n sencilla de utilizaci√≥n ha pasado a ser un monstruito jaja.
¬øCabe la posibilidad de separaci√≥n y adaptaci√≥n del framework EDI?

Seg√∫n estuve mirando en su d√≠a el punto 1 no lo veo viable. El punto 2, me gustar√≠a no realizarlo ya que realizar m√≥dulos bases de comunicaciones es muy √∫til, a lo mejor ... a√±adir un apartado a los videos donde se explicase el funcionamiento de framework EDI ¬øpodr√≠a estar bien @etobella ?

Creo que como has comentado enric, el camino natural ha ido a la extracci√≥n de ese apartado, no veo del todo bien volver hac√≠a atr√°s, si no, que se tendr√≠a que simplificar. ¬øCreaci√≥n de otro m√≥dulo de comunicaciones m√°s sencillito? (pero eso se podr√≠a conseguir con el refactor y separaci√≥n del framework edi ¬øcorrecto?)
 [SEP] ¬øNo podr√≠amos hacer como con SII, que solo se necesitan unos cuantos campos de control? Realmente el resto de informaci√≥n se ha demostrado no demasiado √∫til, y m√°s si hay una plataforma como FACe detr√°s, donde la misma ya registra la actividad. A efectos pr√°cticos, solo necesitamos saber si se ha enviado o no, y error en caso de que no. [SEP] Seria otra opci√≥n, si, por eso eran las ideas que se me ocurr√≠an por ahora. De todas formas, si simplificasemos el EDI Framework no lo ver√≠a mal yo
 [SEP] El tema es depender de la migraci√≥n de ese framework en cada versi√≥n para tener esto operativo, y m√°s si se da integraci√≥n por lo de la ley ""Crea y crece"". En ese sentido deber√≠amos ser m√°s aut√≥nomos. Por eso tambi√©n se quiso quitar de en medio `queue_job` en el SII. [SEP] Tambi√©n depende de otros m√≥dulos, aunque el edi-framework acostumbra a ser el m√°s complejo.

Adem√°s, la ley crea y crece no ir√° con facturae, as√≠ que si deber√° ser con un m√≥dulo diferente (y sus respectivos campos y tal) [SEP] Cuantos menos m√≥dulos haya en la pila, mejor, y algunas dependencias son l√≥gicas (como `l10n_es_facturae`), pero todo el framework EDI no. [SEP] En eso estoy de acuerdo @pedrobaeza De todas formas, el problema no es el edi-framework, es todo lo que lleva incorporado (queue job, connector....) que tiene una arquitectura demasiado compleja üò¢  [SEP] Pues entonces s√≠ que est√°s de acuerdo, porque el tema es que esa pila es demasiado compleja, y en 18 o cortamos por lo sano, o esa supuesta refactorizaci√≥n del EDI no va a llegar, porque ya hay una parte de la pila fusionada y otros no van a querer cambiarla, y mientras, seguiremos sin tener este m√≥dulo disponible. [SEP] A nivel de pilas de m√≥dulos obviamente ser√≠a mejor integrarlo en el propio y listo, pero veo mejor que exista uno base para que el m√°ximo de m√≥dulos se pueda beneficiar de ello, como actualmente est√° el framework-EDI. Estoy de acuerdo en que la dependencia tecnol√≥gica de ese m√≥dulo es muy grande y hay puntos de los cuales se quiere ""huir"" (job_queue) como pas√≥ con el SII (tambi√©n se podr√≠a mirar de adaptar el m√≥dulo para el queue o triggers de odoo, seg√∫n configuraci√≥n o extensiones).
Seg√∫n lo veo yo si integramos esta conexi√≥n directamente en el m√≥dulo, estamos ""cerrando"" y duplicando funcionalidades que actualmente est√°n gen√©ricas. Est√° bien que hayan m√≥dulos bases para circuitos de comunicaciones, ya que estamos viendo que cada vez es m√°s com√∫n. [SEP] Yo no veo que tenga tanta base compartida, pero si acaso, esa base podr√≠a ir en `l10n_es_aeat` como hicimos con SII/VeriFactu. [SEP] Pero entonces si otros m√≥dulos se quieren aprovechar de esas funcionalidades si no son del repo l10n-spain, no podr√°n.
Por otro lado, esta caracter√≠stica podr√≠a necesitarse o no ¬øes necesario ponerlo en el l10n_es_aeat? Ya que en general no gusta ampliar ese m√≥dulo. [SEP] ¬øPero qu√© funcionalidad se va a reaprovechar? A ver, dejemos de hablar en abstracto. Aqu√≠ no hay nada reaprovechable realmente. Lo dicho, al final tenemos unos campos de estado de env√≠o/error, y el c√≥digo que llama a la API de FACe. Por eso digo que no hay que complicarse. Teniendo librer√≠as Python para esas comunicaciones, y que se inicializan con dos l√≠neas y se env√≠an datos con otras 2, dejemos de montar capas abstractas que si `edi_webservice`, y sustituyendo c√≥digo por configuraciones raras que continuamente cualquier cambio hac√≠a que ya no saliera un bot√≥n o que no se enviara.

Lo dicho, tenemos el antecedente del SII donde no hay complicaci√≥n. Y lo de `l10n_es_aeat` era siguiendo vuestra l√≠nea de razonamiento, pero que efectivamente, aqu√≠ no hay c√≥digo compartido con nada. Lo otro de SII/VeriFactu era porque las estructuras de datos que se env√≠an son iguales en ambos, y s√≠ es m√°s cantidad de c√≥digo. [SEP] @pedrobaeza Se reaprovechan cosas. Yo en mi caso tengo clientes que env√≠an las facturas de m√∫ltiples formas dependendiendo de cliente y el funcionamiento de EDI ayuda un mont√≥n.

Personalmente estoy de acuerdo que el stack de edi-framework es demasiado complejo al depender de component y de queue_job y me ofrezco a eliminar esas dependencias para simplificar el stack. PEro de eso a cargarnos el concepto, pues veo muchos problemas. Sobretodo cuando venga la factura electr√≥nica obligatoria en UBL, en el que reinventaremos la rueda seg√∫n tu idea para generar los ficheros y el env√≠o, ya que el de FACe no nos servir√° (desconocemos a√∫n la forma de env√≠o, pero los ficheros seran distintos al 100%). Adem√°s que tendremos que notificar los pagos, con lo que tendremos un doble flujo de entrada (env√≠o de facturas de venta, recepci√≥n de compras, env√≠o de estado de compras....) Todo esto ya est√° contemplado en EDI y nos lo simplifica bastante si lo mejoramos un poco.

S√© que personalmente no es fruto de tu devoci√≥n el framework de EDI, pero creo que hacerlos completamente separados cada vez no aportan nada. Es mejor buscar una base com√∫n m√°s sencilla en mi opini√≥n [SEP] @pedrobaeza con algo as√≠ como lo ver√≠as? Se quitaria la mayor parte del stack extra dejando solo el edi_oca, que nos permite gestionar la generacio≈Ñ y env√≠o. Obviamente no pondr√≠amos m√°s dependencias que las explicadas
 [SEP] https://github.com/OCA/edi-framework/pull/192#issuecomment-3166786574 [SEP] El problema es que esto no va a estar en 18. [SEP] Se puede hablar con el equipo EDI y hacer comunicacion en el contributors de la OCA si es necesario y el concepto cuadra para todos [SEP] Bueno, primero habr√≠a que conseguir eso, y luego ver c√≥mo se queda finalmente. [SEP] PArece que ir√° a buen puerto, con lo que podemos plantear el cambio ya en v18. simplificandonos la vida a todos."
Issue,4338,"@AaronHForgeFlow no te has saltado esta sobreescritura en el m√≥dulo `l10n_es_dua_sii` de la 16?

https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_dua_sii/models/account_move.py#L47

Lo que se hace en la 17 es integrar y adaptar ese otro m√≥dulo, porque el DUA ya est√° en `l10n_es`. [SEP] @pedrobaeza claro, en la 16.0 estaba por separado ü§¶  

De todas formas dejo el issue abierto a ver si alguien da una raz√≥n funcional/legal de por qu√© es as√≠. No he encontrado nada. [SEP] La raz√≥n es porque la factura original del proveedor extranjero no hay que enviarla. La AEAT dice que no pasa nada por enviarla (claro, ellos quieren cuanta m√°s informaci√≥n de ti, mejor), pero como no es obligatoria, no se env√≠a. [SEP] @pedrobaeza  Vale! muchas gracias! "
Issue,4302,
Issue,4291,"Esto sucede porque no tiene el codigo postal el cliente definido. Esta definido como un campo obligatorio para el envi√≥ del ticketbai cuando no deberia ser asi no? [SEP] Buenas @Joaco1980 
No entiendo muy bien como reproducir el error que comentas.
Yo he realizado dos ventas en el POS sin seleccionar cliente y no me da ning√∫n error. Las ventas ""facturas simplificadas"" se env√≠an correctamente a TBAI. [SEP] > Buenas [@Joaco1980](https://github.com/Joaco1980) No entiendo muy bien como reproducir el error que comentas. Yo he realizado dos ventas en el POS sin seleccionar cliente y no me da ning√∫n error. Las ventas ""facturas simplificadas"" se env√≠an correctamente a TBAI.

Vale para replicarlo, crear un cliente nuevo ""PEPITO FLORES"" y d√©jale sin CP introducido, mete si quieres provincia, pa√≠s y todos los datos que consideres pero deja vac√≠o el CP. 

Es ahi donde da el error que comento, ademas si recargas la pagina y vuelves a crear el ticket se crea correctamente pero falla la transmisi√≥n y da error cuando haces un ticket despu√©s de este error:

ES): El XML del fichero TicketBAI no cumple el esquema.[Linea:2 Columna:1706] Error:cvc-pattern-valid: Value 'aN-aN-NaN' is not facet-valid with respect to pattern '\d{2,2}-\d{2,2}-\d{4,4}' for type 'FechaType'.(EU): TicketBAI fitxategiaren XMLak ez du eskema betetzen.[Linea:2 Columna:1706] Error:cvc-pattern-valid: Value 'aN-aN-NaN' is not facet-valid with respect to pattern '\d{2,2}-\d{2,2}-\d{4,4}' for type 'FechaType'.

Concretamente da un error de validaci√≥n con la fecha de la factura anterior que la deja asi en el xml:
<FechaExpedicionFacturaAnterior>aN-aN-NaN</FechaExpedicionFacturaAnterior>

Yo estoy subiendo los tickets con error en la subida manualmente en el LROE poniendo esa fecha bien no se si es la manera correcta de hacerlo pero al menos se validan, porque el bot√≥n de Cancelar y recrear no sirve en este caso concreto. [SEP] Efectivamente si el cliente no tiene CP salta el error.
`TypeError: Cannot read properties of undefined (reading 'number_prefix')`
 
Seguido de este error, el comportamiento al refrescar etc... pues ya puede ser cualquier cosa. Efectivamente es un BUG a corregir.

ping @rrebollo 
¬øComo lo ves para corregir este problema?


NOTA: Tambi√©n recuerdo que quedo pendiente mejorar el m√≥dulo para que funcionara con el cambio de  posici√≥n fiscal.
 [SEP] @Bilbonet puedo ocuparme del error pero definamos antes la conducta a seguir: ¬øDebemos hacer un mejor tratamiento de excepciones y loguear el error concreto: un log indicando que el CP es requerido o el CP no es realmente requerido y podemos continuar con el flujo normal? [SEP] Buenas @rrebollo , muchas gracias por el ofrecimiento.

El tema del TicketBAI funciona en las tres provincias vascas por separado. Lo digo porque aunque la normativa es com√∫n podr√≠a haber alguna peque√±a diferencia. Yo voy a comentar bas√°ndome en el TicketBAI de Bizkaia ""BFA"".

Adjunto documento con las especificaciones del env√≠o para el alta de facturas por si necesitas comprobar alguna otra cosa.

Respecto al error que nos ocupa. EL CP del  destinatario NO es un dato obligatorio. Bastar√≠a con evitar que de error cuando se encuentra con este campo vacio.

<img width=""1058"" height=""589"" alt=""Image"" src=""https://github.com/user-attachments/assets/7f5ae03c-0b01-4977-85df-6e828a8bdf3e"" />

‚ñ™ Letra roja: Bloque/Campo obligatorio. 
‚ñ™ Letra negra: Bloque/Campo opcional. 
‚ñ™ Fondo rosa: Bloque/Campo excluyente. 

Quedo a tu disposici√≥n para cualquier otra aclaraci√≥n üòä


[LROE_PJ_240_Alta_V1_0_0.pdf](https://github.com/user-attachments/files/22563391/LROE_PJ_240_Alta_V1_0_0.pdf) [SEP] @Bilbonet perfecto. Lo miro. Sucede que tenemos algunos issues tambi√©n en una instalaci√≥n de ticketbai pos en 16.0 y queremos ir descartando causas. As√≠ que puedo aprovechar y corregir este issue tambi√©n. Al cliente en cuesti√≥n le fallan algunos tickets en POS porque la secuencia que genera est√° repitiendo valores: el valor que sugiere ya est√° ocupado. Me atrevo a consultarte. ¬øQue crees que podr√≠amos revisar? Uno de los temas fundamentales es la imposibilidad de reproducir el bug porque ocurre espor√°dicamente y no est√°n claras las condiciones que lo desencadenan. [SEP] Genial @rrebollo , para todo lo que necesites no dudes en contactarme.

Respecto a lo que comentas de los duplicados mira esto #3984 
Cualquier cosa me comentas. [SEP] @Bilbonet @Joaco1980 he estado tratando de replicar el error originalmente reportado en este issue en el runboat pero estoy stuck en que el POS no carga el certificado.

<img width=""982"" height=""423"" alt=""Image"" src=""https://github.com/user-attachments/assets/e426a437-16c3-4bea-b38d-cea81e0678ce"" />

Estoy usando los datos de pruebas que se usan en los test automatizados. Alcanzo a ver que los certificados que vienen tanto en l10n_es_ticketbai como l10n_es_ticketbai_api parecen expirados.

<img width=""1679"" height=""336"" alt=""Image"" src=""https://github.com/user-attachments/assets/2c142cbf-be18-42ec-88eb-db6a76b56ee2"" />

¬øMe est√° faltanto alguna configuraci√≥n? ¬ødonde puedo obtener un juego de datos apropiado para las pruebas?

Solo de cargar el POS tengo üëá error en consola del browser

<img width=""560"" height=""189"" alt=""Image"" src=""https://github.com/user-attachments/assets/d15c00b3-7521-4ed2-b69c-7d2420d66252"" /> [SEP] aqui tienes certificados para pruebas

https://www.batuz.eus/fitxategiak/batuz/lroe/batuz_lroe_ziurtagiriak_kit_certificados_v1_0_3.7z





Get Outlook for Android<https://aka.ms/ghei36>
________________________________
From: Rolando P√©rez Rebollo ***@***.***>
Sent: Sunday, September 28, 2025 2:13:30 PM
To: OCA/l10n-spain ***@***.***>
Cc: Jesus (Bilbonet) ***@***.***>; Mention ***@***.***>
Subject: Re: [OCA/l10n-spain] [16] l10n_es_ticketbai_pos: Ticketbai no construida aun. (Issue #4291)

[https://avatars.githubusercontent.com/u/38138332?s=20&v=4]rrebollo left a comment (OCA/l10n-spain#4291)<https://github.com/OCA/l10n-spain/issues/4291#issuecomment-3343099649>

@Bilbonet<https://github.com/Bilbonet> @Joaco1980<https://github.com/Joaco1980> he estado tratando de replicar el error originalmente reportado en este issue en el runboar pero estoy stuck en que el pos carga el certificado

image.png (view on web)<https://github.com/user-attachments/assets/e426a437-16c3-4bea-b38d-cea81e0678ce>

Estoy usando los datos de pruebas que se usan en los test automatizados. Alcanzo a ver que los certificados que vienen tanto en l10n_es_ticketbai_pos como l10n_es_ticketbai_api parecen expirados.

image.png (view on web)<https://github.com/user-attachments/assets/2c142cbf-be18-42ec-88eb-db6a76b56ee2>

¬øMe est√° faltanto alguna configuraci√≥n, donde puedo obtener un juego de datos apropiado para las pruebas?

‚Äî
Reply to this email directly, view it on GitHub<https://github.com/OCA/l10n-spain/issues/4291#issuecomment-3343099649>, or unsubscribe<https://github.com/notifications/unsubscribe-auth/AB6MT4GNY2WXFNFMA7LJGJL3U7GGVAVCNFSM6AAAAACBXYIWOOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTGNBTGA4TSNRUHE>.
You are receiving this because you were mentioned.Message ID: ***@***.***>
 [SEP] > El tema del TicketBAI funciona en las tres provincias vascas por separado. Lo digo porque aunque la normativa es com√∫n podr√≠a haber alguna peque√±a diferencia. Yo voy a comentar bas√°ndome en el TicketBAI de Bizkaia ""BFA"".

@Bilbonet, si miramos:

https://github.com/OCA/l10n-spain/blob/0ba2de3db3f42dc16af7504e2329b4036582dce9/l10n_es_ticketbai_api/models/ticketbai_invoice.py#L939-L953

‚òùÔ∏è c√≥digo indica que Gipuzkoa es la excepci√≥n. 
(Aclaro que este fragmento **no** es el que se ejecuta en el m√≥dulo `l10n_es_ticketbai_pos`, pero lo encontr√© como un hallazgo interesante durante el an√°lisis del issue).

Pregunto porque tengo listo un fix para el error reportado aqu√≠, pero ahora tengo que refinarlo porque hay diferencias de comportamiento entre las agencias. [SEP] @rrebollo interesante.
Corrijo: Parece que 'Bizkaia/Vizcaya' es la excepci√≥n ""que infierno üò•"".

Pues parece que en facturaci√≥n ya se dio este problema y fue solventado. Imagino que lo mas sencillo ser√≠a aplicar el mismo procedimiento en el POS.
Pero lo que tu prefieras. Por mi como si se pone ZIP obligatorio para todas. En este caso tampoco me parece muy importante hilar fino üòä.
 [SEP] > @rrebollo interesante.
> Corrijo: Parece que 'Bizkaia/Vizcaya' es la excepci√≥n ""que infierno üò•"".
> 
> Pues parece que en facturaci√≥n ya se dio este problema y fue solventado. Imagino que lo mas sencillo ser√≠a aplicar el mismo procedimiento en el POS.
> Pero lo que tu prefieras. Por mi como si se pone ZIP obligatorio para todas. En este caso tampoco me parece muy importante hilar fino üòä.
> 

Yo creo que solo deberia de ser obligatorio si el destinatario lleva NIF y quiere deducirse por cualquier motivo el IVA, ah√≠ si se obliga a introducir el ""domicilio"" que supongo que incluya el ZIP.

Precisamente las facturas simplificadas es para simplificar la facturaci√≥n diaria, si exigimos completar todos esos campos que diferencia tenemos con hacer una factura de toda la vida? 

Una tienda que lo utiliza necesita agilidad en la venta, y si quiere asignar un cliente por tema estad√≠stico y de control de ventas no deber√≠a tener que pedir tantos datos, es mi opini√≥n.

En cualquier caso tom√©is la decisi√≥n que tom√©is el tema es que el error no permite arreglarlo introduciendo el ZIP y volver a crear el ticket, o sale sin QR a posteriori y no se crea en el backend, o borras la cache del navegador y vuelves a crearlo y esta vez si se realiza pero da el error de la fecha del ticket anterior en la trasmision, hay que modificarlo manualmente el xml y subirlo al LROE [SEP] > Yo creo que solo deberia de ser obligatorio si el destinatario lleva NIF y quiere deducirse por cualquier motivo el IVA, ah√≠ si se obliga a introducir el ""domicilio"" que supongo que incluya el ZIP.
> 
> Precisamente las facturas simplificadas es para simplificar la facturaci√≥n diaria, si exigimos completar todos esos campos que diferencia tenemos con hacer una factura de toda la vida?
> 
> Una tienda que lo utiliza necesita agilidad en la venta, y si quiere asignar un cliente por tema estad√≠stico y de control de ventas no deber√≠a tener que pedir tantos datos, es mi opini√≥n.

Si claro. El BUG es solo cuando identificas al cliente. Si es una venta an√≥nima no hay error.


 [SEP] @Bilbonet cuando finalmente he podido dilucidar una estrategia para adaptar el c√≥digo en l10n_es_ticketbai_pos y lograr hacer opcional el CP descubro que bizkaia est√° definida c√≥mo tbai.tax.agency en el addon l10n_es_ticketbai_batuz. Esto t√©cnicamente implica que para corregir ""bien"" el issue tendr√≠amos que hacer depender el primer addon mencionado del segundo y ya no puedo evaluar que otras repercusiones tendr√≠a esto. En este momento me inclino por dejarlo tal y como est√°. Ya que habr√≠a que ocuparse de temas de dise√±o m√°s serios antes de abordar este. @Joaco1980 lo siento. Si te sirve de algo eso solo est√° validando que el zip sean 5 d√≠gitos consecutivos so ... [SEP] Ya veo que se ha definido en los m√≥dulos de Batuz. Ciertamente esto lo complica üòî.
https://github.com/OCA/l10n-spain/blob/435ca7a53c5ee325f21d50d00306147b29ec55b7/l10n_es_ticketbai_api_batuz/data/tax_agency_data.xml#L5

A estas alturas y viendo que no creo que TBAI de OCA pase de la versi√≥n 16.0. Mejor seguir con la mismo estrategia y plantear un nuevo m√≥dulo que realice estas correcciones:

-  **l10n_es_ticketbai_pos_batuz**

 [SEP] A mi me parece bien que no toqu√©is nada pero que al menos ese error no implique no poder avanzar, es decir, si no hay zip en la validaci√≥n que salte un error de que falta el zip y al menos que te deje volver al cliente, introducir un zip y volver a intentar la transmisi√≥n del ticket con el zip.

Ahora el comportamiento es el siguiente: 
- Salta el error de construcci√≥n
-  Si luego intentas hacer el ticket le hace pero sin QR de TBAI, puede incluso saltar la secuencia o ni realizarse en el backend. 
- Hay que borrar cache del navegador y volver a realizar la venrta
-  Genera el ticket bien con el QR pero falla el xsig porque el campo de fecha de factura anterior le deja vac√≠o aN-aN-aNNN. 
 
Es como si en todo el proceso perder√≠a la referencia del ticket anterior. Esto implica un error en la transmisi√≥n a la hacienda vasca, hay que descargarse el xsig, ponerle la fecha correctamente y subirlo manualmente al LROE.  [SEP] > A estas alturas y viendo que no creo que TBAI de OCA pase de la versi√≥n 16.0. Mejor seguir con la mismo estrategia y plantear un nuevo m√≥dulo que realice estas correcciones

Vi algo de que ticketbai est√° disponible en Odoo ¬øEnterprise o Community a partir de que versi√≥n? Y powered by @ao-landoo y su team creo. [SEP] @Joaco1980 madurando esa √∫ltima idea

> A mi me parece bien que no toqu√©is nada pero que al menos ese error no implique no poder avanzar,

Tal vez algo se pueda hacer. Viendolo desde la perspectiva que planteas, el problema fundamental es que ese error ya salta durante la generaci√≥n del ticket, tal vez si colocamos una validaci√≥n al momento de escoger el cliente (el detalle es que realmente la validaci√≥n ignorar√° el comportamiento para Bizkaia: todos los clientes tienen que tener CP de 5 d√≠gitos) @Bilbonet ¬øQue crees?

 [SEP] > > A estas alturas y viendo que no creo que TBAI de OCA pase de la versi√≥n 16.0. Mejor seguir con la mismo estrategia y plantear un nuevo m√≥dulo que realice estas correcciones
> 
> Vi algo de que ticketbai est√° disponible en Odoo ¬øEnterprise o Community a partir de que versi√≥n? Y powered by [@ao-landoo](https://github.com/ao-landoo) y su team creo.

TicketBAI esta diponible en el core de Odoo desde la 16.0. Pero no en el POS.
TicketBAI en el POS se que est√° en la 18.0 no lo s√© seguro si esta en la 17.0    [SEP] > [@Joaco1980](https://github.com/Joaco1980) madurando esa √∫ltima idea
> 
> > A mi me parece bien que no toqu√©is nada pero que al menos ese error no implique no poder avanzar,
> 
> Tal vez algo se pueda hacer. Viendolo desde la perspectiva que planteas, el problema fundamental es que ese error ya salta durante la generaci√≥n del ticket, tal vez si colocamos una validaci√≥n al momento de escoger el cliente (el detalle es que realmente la validaci√≥n ignorar√° el comportamiento para Bizkaia: todos los clientes tienen que tener CP de 5 d√≠gitos) [@Bilbonet](https://github.com/Bilbonet) ¬øQue crees?

Pues si, me parece mejor poner una restricci√≥n general. 
**Que se obligue a poner CP si identificas al cliente, sea cual sea la hacienda,**
Es peor dejar el error actual. Que seg√∫n comenta @Joaco1980 hace un estropicio importante cortar la ejecuci√≥n con el error actual.

 [SEP] @Joaco1980 ¬øpodremos cerrar este issue entonces?"
Issue,4289,
Issue,4286,"Hola, ¬øpod√©is identificaros adecuadamente en lugar de un nick gen√©rico? As√≠ se sabe con qui√©n se est√° hablando. [SEP] lo detecte esta ma√±ana y le dije de cambiarlo para que funcionar√°, se llama Patrick. En ocasiones algunos impuestos usan para grecia GR y otros EL (el nuevo es EL desde hace muchos a√±os)  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Hola, estoy teniendo un problema similar.

Actualmente, el VAT del partner est√° configurado con el prefijo EL, que es el formato correcto seg√∫n VIES para Grecia. Sin embargo, al notificar la factura al SII, el env√≠o es rechazado indicando un error en la clave codigoPais, ya que el SII espera el c√≥digo ISO GR y se est√° enviando EL.

Si se modifica el VAT del partner y se establece el prefijo GR, el env√≠o al SII vuelve a fallar, en este caso indicando que el ID es incorrecto, ya que el VAT deja de ser v√°lido.

El comportamiento esperado por parte del SII es que se env√≠e:

codigoPais: GR

ID: ELXXXXXXXXX

Por lo que hemos podido analizar, el env√≠o actual utiliza el mismo prefijo tanto para el c√≥digo de pa√≠s como para el identificador, lo que dificulta cumplir simult√°neamente con los requisitos de VIES y del SII en este caso concreto. [SEP] Analizando el comportamiento con m√°s detalle, creo que el origen del problema puede estar en la siguiente l√≠nea de c√≥digo:
[
        country_code_map = {""EL"": ""GR""}](https://github.com/OCA/l10n-spain/blob/878690ccf0bdf1cd83b008824fe9bd0992630391/l10n_es_aeat/models/res_partner.py#L60)

En concreto, si esta clave no estuviese definida, el flujo posterior parece que podr√≠a ajustarse mejor al comportamiento esperado por el SII en este caso, permitiendo enviar codigoPais = GR mientras se mantiene el ID con el prefijo EL, que es el formato v√°lido seg√∫n VIES. [SEP] Esto se solucion√≥ en #4753 y #4754"
Issue,4272,"Odoo est√° incluyendo en el core de 17 un m√≥dulo para la gesti√≥n de Verifactu, y aqu√≠ en OCA, cuando se complete el desarrollo en 16, se migrar√° a 17. Busca por favor las referencias correspondientes."
Issue,4271,"Hola, Nacho, por no abras incidencias para este tipo de cosas que se recopilan y tratan en el [hilo dedicado a la propia migraci√≥n](https://github.com/OCA/l10n-spain/issues/3754). En cualquier caso, si tan fundamental es para vuestro proyecto, lo que pod√©is hacer es:

- Realizar la migraci√≥n vosotros y contribuirla a OCA.
- Financiar a un contribuidor para que la haga por vosotros.

Si no, no est√° garantizado ning√∫n plazo de realizaci√≥n. Cuando uno de los contribuidores que suelen migrar lo necesite, lo llevar√° a cabo y probablemente lo contribuya de vuelta en OCA, pero sin garant√≠as expresas ni obligaciones.

Cierro por lo dicho que no debe haber hilos en incidencias sobre cosas que no lo son."
Issue,4262,"Ser√≠a incluir el tipo de operaci√≥n, pero hay que asegurar que funcionan minorando la misma casilla, o si van de otra forma. [SEP] El modelo 123 no tiene casillas espec√≠ficas para facturas rectificativas por lo que tiene que ir minorando los importes

![Image](https://github.com/user-attachments/assets/fb452898-e318-455d-9f0d-9ee961779de0) [SEP] Ser√≠a entonces si no estoy equivocado, cambiar esta l√≠nea y la siguiente a ""both"" en lugar de ""credit"":

https://github.com/OCA/l10n-spain/blob/18.0/l10n_es_aeat_mod123/data/2024/l10n.es.aeat.map.tax.line.csv#L4 [SEP] Pero parece ser que hay que hacer m√°s cosas seg√∫n https://github.com/OCA/l10n-spain/pull/4220#issuecomment-3024074700 [SEP] He respondido en este PR que hizo @omar7r : https://github.com/OCA/l10n-spain/pull/4220

La cuesti√≥n es que la norma solo aplica si debes ingresar m√°s pero no es de menos.


1. Si la factura rectificativa aumenta la retenci√≥n:

- Debes presentar un modelo 123 complementario del trimestre original.

- Fundamento: art√≠culo 4.3 de la Orden HAP/1608/2014.


2. Si la factura rectificativa reduce la retenci√≥n:

- No se modifica el modelo 123 ya presentado.

- Si se ingres√≥ de m√°s, debes solicitar una devoluci√≥n de ingresos indebidos.

- Fundamento: art√≠culo 221.1 de la Ley General Tributaria.

---
Referencias:

Modelo 123 AEAT: https://sede.agenciatributaria.gob.es/Sede/procedimientoini/GC27.shtml

Orden HAP/1608/2014: https://www.boe.es/diario_boe/txt.php?id=BOE-A-2014-8121

Ley General Tributaria: https://www.boe.es/buscar/act.php?id=BOE-A-2003-23186


@moduon @omar7r  [SEP] https://github.com/OCA/l10n-spain/pull/4220#issuecomment-3024303414 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4237,"La rama 12.0 es una rama obsoleta y ya no se mantiene ""oficialmente"". Tambi√©n se junta que el soporte de las herramientas de CI para esa rama est√° obsoleto (por el propio GitHub), con lo que aqu√≠ debes buscar la forma de traer esos cambios, aunque mi recomendaci√≥n es que migres de versi√≥n. [SEP] Gracias Pedro, intentar√© actualizarme con openupgrade."
Issue,4223,"@pedrobaeza Podr√≠as echar un vistazo? Gracias! [SEP] He comentado esto en el foro, hay algunos bancos que ni el VAT te ponen. He tenido que hacer algo para poner el partner_id con una importaci√≥n de extractos por xlsx. Modificando fichero. [SEP] Esto qued√≥ solucionado eligiendo a nivel de diario lo que se quiere hacer, as√≠ que cierro."
Issue,4213,"Me temo que la informaci√≥n proporcionada no es suficiente. Revisa la fecha y hora a la que tiene programado el env√≠o, y si tu instancia puede ejecutar acciones planificadas. Por lo dem√°s, deber√≠a funcionar correctamente.

Cierro mientras no tengamos m√°s informaci√≥n que pueda llevarnos a deducir que es un problema del m√≥dulo."
Issue,4211,"@Bilbonet ¬øpodr√≠as tal vez indicarme donde encontrar el formato correcto? [SEP] Buenas @rrebollo 
Como se puede ver en el XML que he puesto de ejemplo. Si te fijas en el detalle del IVA.
La parte del recargo de equivalencia la indica mal con el valor ""N"".
Dever√≠a ser asi:
`<OperacionEnRecargoDeEquivalenciaORegimenSimplificado>S</OperacionEnRecargoDeEquivalenciaORegimenSimplificado>`

Si realizas una factura Ticketbai con recargo de equivalencia funciona bien. Son las ventas del POS las que sale este valor mal. 
 [SEP] Estimado @Bilbonet
**Problema**: 
- Las implementaciones no gestionan la posici√≥n fiscal, ejemplo: v14 https://github.com/OCA/l10n-spain/blob/edfd729da0de8614aad56379c68eb5e8fcd86cac/l10n_es_ticketbai_pos/static/src/js/tbai_models.js#L194-L209

En v16 no mezclado a√∫n:

https://github.com/BinhexTeam/l10n-spain/blob/544ca459119d1d607e8d8ca75fb534f5ff7cac2e/l10n_es_ticketbai_pos/static/src/js/tbai_models.js#L241

- Parece un enfoque t√©cnico simplificado

**Consulta**:
A la luz de estos elementos te parece que sea intencional (por dise√±o) o es una limitaci√≥n a corregir? Pregungo por confirmar el enfoque antes de proponer cambios t√©cnicos. [SEP] Buenas @rrebollo

No he analizado a fondo el c√≥digo que muestras y al mirarlo por encima tengo una duda.
¬øEsa parte que muestras del c√≥digo no se refiere a la posici√≥n fiscal de la compa√±√≠a?
Para el caso que tratamos es la posici√≥n fiscal del cliente la que interviene para el desglose de los impuestos. [SEP] > Buenas [@rrebollo](https://github.com/rrebollo)
> 
> No he analizado a fondo el c√≥digo que muestras y al mirarlo por encima tengo una duda. ¬øEsa parte que muestras del c√≥digo no se refiere a la posici√≥n fiscal de la compa√±√≠a? Para el caso que tratamos es la posici√≥n fiscal del cliente la que interviene para el desglose de los impuestos.

Exacto. Solo se tiene en cuenta la company. Creo que desde el punto de vista t√©cnico hay un tratamiento ""ingenuo"" del feature por eso me parece que es una limitaci√≥n desde el dise√±o. En el caso del addon ticketbai pos es √∫nicamente desde este c√≥digo que indico que se le asigna valor al elemento ""OperacionEnRecargoDeEquivalenciaORegimenSimplificado"" del xml. [SEP] Ok entiendo.
Entonces mas que un bug ya estamos hablando de una mejora que habr√≠a que implementar.
  [SEP] @Bilbonet entiendo que hay un referente porque desde la app de contabilidad el proceso funciona correctamente as√≠ que podr√≠a mirarse el c√≥digo all√≠ (asumo que mayormente python) y trasladar la idea hacia donde corresponda en ticketbai pos (python y js) muy probablemente. Aclarar desde el punto de vista del negocio el panorama para t√©cnicos como yo podr√≠a ser la clave: ¬øsi el cliente tiene una posici√≥n fiscal de Recargo de Equivalencia el IVA se comportar√° igual que en el r√©gimen simplificado? es que no creo que este cambio lo √∫nico que afecte sea el valor del tag OperacionEnRecargoDeEquivalenciaORegimenSimplificado al generar el xml. [SEP] No entiendo porque han hecho esta simplificaci√≥n la verdad.
Puede ser que el desarrollo viene de versiones anteriores del POS donde igual no se pod√≠an utilizar diferentes posiciones fiscales de cliente. Y en ese caso pues no correspond√≠a a√±adir dicha l√≥gica.

Peor por lo que yo conozco desde v14.0 el POS permite diferentes posiciones fiscales as√≠ que entiendo que tiene que funcionar igual que en financiero.

De hecho, el POS hace bien el calculo del IVA (parte del core de Odoo). 
Es la parte de TBAI la que no mira el detalle del impuesto si es <OperacionEnRecargoDeEquivalenciaORegimenSimplificado> (desarrollo TBAI).

Respecto a la pregunta que planteas, no se si hay otros caso en los que no este haciendo correctamente el env√≠o TBAI. Pero es muy probable que tambi√©n ocurra con otras posiciones fiscales como intracavitarias etc...

De momento las facturas simplificadas con recargo de equivalencia la hacienda de Bizkaia las est√° rechazando:
```
C√≥digo:   	B4_2000031
Descripci√≥n	(ES): Valor del Tipo impositivo no admitido.
``` [SEP] @Bilbonet gracias por el inside. Creo que como dices probablemente est√© relacionado con el hecho de que orgininalmente el POS no permit√≠a usar m√∫ltiples posiciones fiscales. Tengo esto en mis issues pendientes. Mirando lo hecho para contabilidad tal vez se pueda trasladar el comportamiento a pos o encontrar alguna soluci√≥n para incorporar el feature. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4207,"Est√° fusionado en el repositorio:

https://github.com/OCA/l10n-spain/tree/15.0/l10n_es_aeat_mod592"
Issue,4206,"@pedrobaeza Si puedes revisar esto y decirme si es por culpa de configuraci√≥n o si esta obsoleto lo del `_tipo` [SEP] No te puedo decir ahora mismo, porque ahora mismo no tenemos ninguno en activo con este transportista. Hasta hace poco, la antigua URL de ASM funcionaba. Tal vez la han cambiado. [SEP] @pedrobaeza Solo hay que cambiar la url a una mas actual, ya que he tenido que llamar a los de gls y me han dado la url que se tiene que utilizar y voy a hacer los fix de las version 14.0, 16.0 y 17.0, ya que en la version 18 hay un pr de una compa√±era mia que lo a√±adira ella.

La nueva url:

![Image](https://github.com/user-attachments/assets/eac7191e-5a32-45b9-ac94-870680a1460a)

El pr de la migraci√≥n:
https://github.com/OCA/l10n-spain/pull/4090 [SEP] Cierro al estar ya los PRs."
Issue,4198,"Hola, no existe ning√∫n m√≥dulo con ese nombre. Dirige por favor tus consultas al foro de AEOdoo, al no tratarse de problemas de los m√≥dulos en si, si no de uso."
Issue,4197,"Los m√≥dulos de prorrata no est√°n a√∫n migrados a dicha versi√≥n, por lo que es normal que los de una versi√≥n anterior no funcionen adecuadamente en la siguiente."
Issue,4196,"Exel oficial de equivalencias

https://www.ine.es/daco/daco42/clasificaciones/cnae25/Correspondencia_CNAE25_CNAE09.xlsx"
Issue,4185,"Da igual, porque esas casillas no se rellenan con nada, y est√°n ah√≠ solo ""de adorno"". Har√≠a falta migrar el m√≥dulo de criterio de caja, que las alimenta, y adem√°s creo recordar que se hace manualmente sin seguir esa configuraci√≥n.

Cierro por no ser un problema real."
Issue,4178,"Si es as√≠, creo que tambi√©n se deber√≠a modificar la casilla 84 y pasar ese impuestos a la casilla 94. [SEP] Y aunque no se si este comentario vendr√≠a aqu√≠ o se deber√≠a abrir un nuevo issue en caso de aprobar el cambio que propone @pedroortega-punt en el mod. 303, creo que en el mod. 390 se deber√≠a cambiar el impuesto de la casilla 110 a la 104. [SEP] @TesseraTech4 He realizado la consulta telef√≥nica al departamento de IVA y me han informado que los bienes a la casilla 60 y la prestaci√≥n de servicios a la casilla 120, por lo que habr√≠a que cambiar el mapeo del impuesto de bienes a la casilla 60. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4173,"Es mucho m√°s sencillo hacer el check de ""No incluir en el 347"" del contacto como dependiente de la compa√±√≠a. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4169,¬øEn la posici√≥n fiscal del r√©gimen extracomunitario hab√©is puesto que el tipo de identificaci√≥n SII sea de exportaci√≥n? [SEP] Buenos d√≠as @pedrobaeza he probado en el mismo runboat y ahora estamos haciendo pruebas en el cliente. Tiene pinta que es eso. Much√≠simas gracias. 
Issue,4165,"Este commit y otros similares en diversos m√≥dulos ya ten√≠an en cuenta que estuvieran archivados:

https://github.com/OCA/l10n-spain/commit/e4457af95b1c027a71eb74b1a6e066e6c828b9e8

Tendr√°s que concretar algo m√°s para saber si falta algo por aplicar. [SEP] Era para versi√≥n 14 que no estaba hecho el backport. Acabo de hacerlo en https://github.com/OCA/l10n-spain/pull/4170

@pedrobaeza gracias por el apunte."
Issue,4155,"Me temo que la informaci√≥n proporcionada no es suficiente para poder ayudar. [SEP] Buenas tardes,
He detectado que el error se produce porque al pulsar en la acci√≥n de servidor Enviar al SII en las facturas, en la funci√≥n de default_get, no actualiza el campo account_move_ids, con las IDS seleccionadas, por lo que al intentar enviar al SII, aparece sin facturas a enviar.
l10n_es_aeat_sii_oca/wizards/account_move_send_sii.py. 
```
        res.update(
            {
                ""sending_number"": len(account_moves),
                ""not_send_without_errors_number"": len(not_send_without_errors),
                ""with_errors_number"": len(with_errors),
                ""modified_number"": len(modified),
            }
        )
        return res
```

Saludos
 [SEP] Fuera de que ah√≠ pueda haber un error, ¬øpor qu√© se est√°n usando ese asistente, si con una configuraci√≥n normal se encola para enviar en cuanto se confirma la factura? [SEP] En mi caso tengo habilitado el que no se env√≠e las facturas autom√°ticamente, si no que se haga manualmente con el bot√≥n de Enviar al SII [SEP] Como tal, considero un error hacerlo de esa forma, porque es muy f√°cil ""olvidarse"" de alguna factura a enviar y hacerlo en plazo, pero bueno, cada uno que elija la forma que quiera. Entiendo de todas formas que no tienes nada que ver con Eva y la tuya ha sido una averiguaci√≥n parelela, ¬øverdad? [SEP] @Evaguadaltech es posible que alguna de las facturas est√© dando error en el env√≠o y por eso parezca que no haga nada. 
Intenta ejecutar la acci√≥n planificada manualmente y mira si te sale alg√∫n mensaje de error. 

Hola @pedrobaeza iba a abrir un issue, pero me cuelgo de este hilo, en caso de ser necesario lo abro formalmente. 
¬øSabes si es normal que no se puedan enviar al SII facturas de cliente de pa√≠ses extracomunitarios  sin NIF establecido? En versi√≥n 15 s√≠ se pod√≠a y no veo que en v17 haya que hacer una configuraci√≥n adicional. ¬øEs obligatorio? Gracias 
 [SEP] @mof-landoo en principio sobre eso no ha habido ning√∫n cambio, as√≠ que alguna diferencia deber√≠a haber entre lo hecho en la 15 y en la 17. Analiza eso, y si no, especifica todos los pasos con datos para reproducir el error en una issue diferente. [SEP] Muy buenas, nosotros estamos teniendo el mismo problema. Tenemos la versi√≥n 17 de Odoo y enviamos las facturas de forma manual pulsando el bot√≥n (tambi√©n lo hemos probado de forma autom√°tica). Desde el lado de Odoo parece que se ha enviado la factura de forma correcta, cambia a estado Enviado, obtiene el SII CSV, incluso muestra el Retorno SII, pero luego consultamos en la agenciatributaria y la factura no ha llegado.
Tambi√©n he probado a ejecutar la acci√≥n planificada de forma manual pero tampoco funciona.
En nuestro log de odoo (odoo-server.log), cuando pulsamos Enviar al SII solo se muestra lo siguiente:
odoo.addons.base.models.ir_cron: Starting job: 'Send Invoices to SII'
odoo.addons.base.models.ir_cron: Job done: 'Send Invoices to SII' (0.794s)

No aparece ning√∫n error.  
¬øSe os ocurre por qu√© puede ser para que lo revise? [SEP] @AlbertoCanto si os devuelve CSV, s√≠ que se est√° enviando. A ver si ten√©is puesto el portal de pruebas en lugar del real... [SEP] El modo pruebas no estaba activado, adem√°s, lo curioso, es que el CSV que devuelve no coincide con el real, ya que el que aparece en el campo de Odoo SII CSV es un valor alfanum√©rico y el que aparece en la factura dentro del portal de la agenciatributaria es num√©rico solamente. [SEP] Ser√°n n√∫meros diferentes, porque el CSV siempre ha tenido formato alfanum√©rico. [SEP] Cierro como ya se fusion√≥ el PR que correg√≠a el asistente de env√≠o."
Issue,4140,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4138,"Me pasa exactamente lo mismo, si alguien puede dar una solucion me salva, gracias.  [SEP] El m√≥dulo debe actualizarse a la √∫ltima versi√≥n (en c√≥digo y en base de datos), y utilizar la √∫ltima configuraci√≥n de exportaci√≥n disponible. Cierro al estar ya cubierto en el m√≥dulo."
Issue,4115,"Hola, Eva, ese tipo de preguntas puedes hacerla en https://www.aeodoo.org/forum, que es un lugar m√°s adecuado para ello."
Issue,4110,"@HaraldPanten @pedrobaeza @etobella @JordiBForgeFlow  [SEP] Bueno, yo lo veo m√°s sencillo en esos casos: tienes instalados los dos m√≥dulos, pero activas SII o Verifactu y ya est√°. Es que otro tipo de compatibilidad no es posible, porque hay campos muy espec√≠ficos de cada tipo. Por ejemplo, el QR o el encadenamiento de Verifactu, no tienen sentido en la capa superior de abstracci√≥n, al igual que el CSV del SII. [SEP] > Bueno, yo lo veo m√°s sencillo en esos casos: tienes instalados los dos m√≥dulos, pero activas SII o Verifactu y ya est√°. Es que otro tipo de compatibilidad no es posible, porque hay campos muy espec√≠ficos de cada tipo. Por ejemplo, el QR o el encadenamiento de Verifactu, no tienen sentido en la capa superior de abstracci√≥n, al igual que el CSV del SII.

Ser√≠a la idea, pero hay campos que son compartidos y eso es posible que cree ""inconsistencias"". Por otro lado, podr√≠a pasar que una compa√±√≠a utilice un sistema y otra compa√±ia (sistema multicompa√±√≠a) utilice el otro.... no se si ser√≠a ideal realizar una mayor separaci√≥n. Abro este punto, ya que como se acercan las jornadas podr√≠a ser un punto a realizar (en caso de tener que realizarse algo). [SEP] Hasta donde s√©, la activaci√≥n es por compa√±√≠a, por lo que no es problema. Si ves incompatibilidad de campos, ser√≠a listarlos y empezar a resolverlos (que b√°sicamente ser√≠a poner nombres distintos), pero no creo que haya tantos. [SEP] > Hasta donde s√©, la activaci√≥n es por compa√±√≠a, por lo que no es problema. Si ves incompatibilidad de campos, ser√≠a listarlos y empezar a resolverlos (que b√°sicamente ser√≠a poner nombres distintos), pero no creo que haya tantos.

Por nuestra parte sin problemas, entonces nos lo apuntaremos para el codesprint üòÑ . [SEP] Hola @ValentinVinagre a priori son compatibles, y se configuran por compa√±√≠a, si pasa de un sistema a otro habr√≠a que marcar/desmarcar los checks de la compa√±√≠a pero no necesariamente desinstalar los m√≥dulos con lo que no habr√≠a inconsistencias de datos, eso ya se planteo en el anterior codesprint. Digo a priori por que puede que haya algun m√©todo que se llame igual y habr√≠a que revisarlo.  [SEP] > Hola [@ValentinVinagre](https://github.com/ValentinVinagre) a priori son compatibles, y se configuran por compa√±√≠a, si pasa de un sistema a otro habr√≠a que marcar/desmarcar los checks de la compa√±√≠a pero no necesariamente desinstalar los m√≥dulos con lo que no habr√≠a inconsistencias de datos, eso ya se planteo en el anterior codesprint. Digo a priori por que puede que haya algun m√©todo que se llame igual y habr√≠a que revisarlo.

No estoy del todo de acuerdo, seg√∫n la migraci√≥n de 16-17 del SII ya vimos cosas compartidas, etc. [SEP] Igual no me he expresado correctamente, Quer√≠a decir que la idea era hacerlo as√≠, puede que haya algo compartido üòÑ [SEP] Valent√≠n, ¬øtienes un listado de esos campos conflictivos que comentas? [SEP] > Valent√≠n, ¬øtienes un listado de esos campos conflictivos que comentas?

Actualmente no tengo una lista, la idea es poner el tema encima de la mesa y plantear la situaci√≥n. No busco realizar una acci√≥n correctiva actualmente, nuestra idea si nos ponemos es en los spanish oca days. [SEP] Vale, pues en los Spanish OCA days alguien puede dedicarse a detectar esos posibles conflictos y atajarlos antes de que fusionemos para que no haya luego que renombrar campos y dem√°s. [SEP] Perd√≥n por mi ignorancia, pero se sabe cu√°ndo y por donde estar√° listo el m√≥dulo de VeriFactu ? [SEP] > Perd√≥n por mi ignorancia, pero se sabe cu√°ndo y por donde estar√° listo el m√≥dulo de VeriFactu ?

Se est√° realizando desde el siguiente PR, mejor preg√∫ntalo por ah√≠:
https://github.com/OCA/l10n-spain/pull/3579 [SEP] Respuesta de AEAT:

`Buenos d√≠as:

Primero, debe recordarse que un SIF adaptado al RD 1007/2023 (tanto actuando en la modalidad VERI*FACTU como en la NO VERI*FACTU) SOLO puede usarse cumpliendo con todos los requisitos de dicho RD 1007/2023 que le aplican a √©l (para lo que, entre otras cosas, es necesario tener instalado un certificado electr√≥nico cualificado v√°lido). Cuando un productor o fabricante ‚Äìmientras se den las circunstancias que permitan esto‚Äì ofrece al cliente un sistema de facturaci√≥n para que pueda ser usado de forma adaptada al RRSIF o sin adaptar a dicha normativa, o bien para que cumpla con diferentes normativas, tales como TicketBAI, RD 1007/2023 y la normativa que regula el Suministro Inmediato de Informaci√≥n ‚ÄúSII‚Äù, realmente est√° ofreciendo ‚Äúun paquete o familia‚Äù de varios productos SIF diferentes (aunque puede que compartan gran parte de su programaci√≥n), a fin de que el cliente pueda elegir espec√≠ficamente uno para instalar y usar, bajo la responsabilidad del usuario.
En cualquier caso, este ofrecimiento debe implementarse de tal forma que el usuario no pueda cambiar din√°micamente de un ‚Äúproducto‚Äù a otro con cada factura ni con cada sesi√≥n o arranque del producto, sino que el usuario deber√° elegir previamente qu√© tipo de SIF quiere utilizar y lo instalar√° ‚Äìo actualizar√°‚Äì para que cumpla con esas caracter√≠sticas, que ya permanecer√°n as√≠ en adelante (a menos que se desinstale).
En todo caso, ser√° el usuario √∫ltimo del SIF, quien ser√° responsable de seleccionar la modalidad de su software que corresponda con la normativa que se le aplica.

Si el caso es que el usuario ha decidido, por ejemplo, darse de alta voluntaria en el SII, a partir de ese momento, a todos los efectos relativos a su facturaci√≥n propia, no quedan afectados por el R. D. 1007/2023 y el programa que utilicen deber√°n cumplir gen√©ricamente con las obligaciones que se se√±alan en el art√≠culo 29.2.j) de la Ley 58/2003, de 17 de diciembre, General Tributaria (LGT).

Respecto a  la conservaci√≥n de los registros de facturaci√≥n (RFs) si se trata de un SIF que act√∫e en la modalidad VERI*FACTU, no es obligatoria la conservaci√≥n de los registros de facturaci√≥n (RFs), dado que estos habr√°n sido remitidos en el momento de la expedici√≥n de las facturas, a la sede electr√≥nica. En los dem√°s casos, rigen las normas de conservaci√≥n documental habituales en materia fiscal, es decir, con car√°cter general, la prescripci√≥n fiscal (cuatro a√±os posteriores a la fecha de devengo), pero, en determinados supuestos, plazos m√°s largos. 

Si fuese a la inversa, igualmente, deben cumplir con la normativa que corresponda. Lo que queremos dejar claro con esto, es que se trata de normativas diferentes con obligaciones diferenciadas. El SII consiste en la llevanza de los libros registro de IVA (facturas emitidas, facturas recibidas, bienes de inversi√≥n‚Ä¶) a trav√©s de la sede electr√≥nica de la Agencia Tributaria, lo que implica obligaciones de comunicaci√≥n electr√≥nica a la Agencia Tributaria de una amplia informaci√≥n relacionada con el IVA de las facturas emitidas y recibidas en un determinado plazo de tiempo. Por su parte, el reglamento que establece los requisitos de los sistemas inform√°ticos de facturaci√≥n obliga a que los SIF registren, con determinadas medidas de seguridad y control, cierta informaci√≥n solo de las facturas expedidas, pudiendo remitirse opcionalmente a la Agencia Tributaria.
El √°mbito subjetivo de ambos proyectos es excluyente, es decir, quienes cumplan con el SII no han de cumplir con el reglamento que establece los requisitos de los sistemas inform√°ticos de facturaci√≥n y viceversa.
Respecto a la consulta del encadenamiento, el SIF utilizado ser√≠a una nueva instalaci√≥n por lo que deber√≠a comenzar un nuevo encadenamiento.

Atentamente,
Atenci√≥n al Usuario
Departamento de Inform√°tica Tributaria
Email: verifactu@correo.aeat.es
`

Con saber que ha sido enviado para no volver a enviarlo valdr√≠a y ya est√° en el m√≥dulo l10n_es_aeat

Saludos,
Ignacio [SEP] > Con saber que ha sido enviado para no volver a enviarlo valdr√≠a y ya est√° en el m√≥dulo l10n_es_aeat

Genial, gracias @acysos . "
Issue,4103,"https://github.com/OCA/l10n-spain/issues/4024
Perdon no vi que ya estaba reportado este bug. [SEP] Revisa que utilizas el formato de exportaci√≥n √∫ltimo y que tienes todo el c√≥digo actualizado y tu BD actualizados los m√≥dulos. [SEP] ok gracias sin problemas , hare antes una copia de esta maquina en el proxmox."
Issue,4102,"Esto se ha discutido anteriormente por issues o en los PRs de `l10n_es_pos`. Haz una b√∫squeda para echar un vistazo. B√°sicamente, es utilizar `pos_default_partner` o desarrollar una extensi√≥n `l10n_es_vat_book_pos`. [SEP] Gracias Pedro. No ten√≠a constancia. 

De acuerdo, optaremos entonces por la extensi√≥n del vatbook para que no requiera el partner en los asientos de caja.  [SEP] Aqui esta:
- [l10n_es_vat_book_pos] https://github.com/OCA/l10n-spain/pull/4104 "
Issue,4100,"ping @AaronHForgeFlow @JordiBForgeFlow @etobella @ValentinVinagre @acysos @rubencr7 @fuentes73  [SEP] A ver, esto es complicado. La verdad es que lo primero seria pensar si necesitamos seguir usando los certificados como ficheros y que ventaja nos da eso. Si alguien accede al servidor, al final lo tiene todo, con lo que tenerlo en como fichero no nos da m√°s seguridad a no ser que tengamos la BBDD desacoplada del servidor de Odoo. Por lo tanto, yo creo que podemos usar el sistema de Odoo directamente ya que no hay una ventaja directa.

De todas formas, estar√≠a bien ver otras opiniones, por que tal vez se me escapa algo de por que se hizo as√≠ en su d√≠a. [SEP] Haciendo una revisi√≥n en diagonal, veo luces y sombras:
Luces:

- Nos ha pasado que ciertos clientes tienen ""intranquilidad"" en traspasar certificados electr√≥nicos y contrase√±as... as√≠ que ser√≠a una opci√≥n para que el propio usuario lo pueda gestionar y no necesite al implantador(hasta cierto punto).
- Si Odoo proporciona un sistema parecido o compatible, lo ideal es utilizarlo, menos que mantener.

Sombras:

- ¬øQue direcci√≥n tomar√° Odoo con esto?
- ¬øLa exportaci√≥n propia de Odoo puede dar informaci√≥n del certificado? ¬øest√° protegido?
- Elimina la opci√≥n de poder tener el certificado externamente ¬øser√≠a posible realizar la ampliaci√≥n? Si se hace... ¬øvale la pena?

En conclusi√≥n no me parece mal ir por el camino de Odoo, pero har√≠a una ampliaci√≥n para poder optar tambi√©n a la utilizaci√≥n del certificado como hasta ahora.
¬øComo lo veis? [SEP] Odoo usa los certificados para el mismo prop√≥sito que se usa en la localizaci√≥n, por ejemplo en su m√≥dulo de facturae lo usa, as√≠ que s√≠ creo que es un ""feature"" que est√° solapado con el m√≥dulo del l10n_es_aeat.
Sin embargo el m√≥dulo certificate es bastante nuevo y creo que le van a hacer cambios puesto que a mi modo de ver presenta algunas vulnerabilidades:

* La contrase√±a para desencriptar el fichero .pfx o p12 se guarda directamente en la tabla certificate_certificate:

![Image](https://github.com/user-attachments/assets/39589d2b-330c-440c-882e-367830b4aef6)

* El contenido del fichero .pem extra√≠do se guarda directamente en la tabla del ir_attachment:

![Image](https://github.com/user-attachments/assets/e7a1e311-94f7-42d6-a0db-0e6cdfde14f6)

Creo que aunque son funcionalidades que se solapan esperar√≠a a que Odoo las hiciera m√°s estable. Podr√≠amos hacer el esfuerzo de mejorar la seguridad ahora para que luego Odoo lo arregle en la siguiente versi√≥n.

Yo en el PR de migraci√≥n ya he quitado el commit que hac√≠a la migraci√≥n al nuevo modelo. [SEP] > Odoo usa los certificados para el mismo prop√≥sito que se usa en la localizaci√≥n, por ejemplo en su m√≥dulo de facturae lo usa, as√≠ que s√≠ creo que es un ""feature"" que est√° solapado con el m√≥dulo del l10n_es_aeat. Sin embargo el m√≥dulo certificate es bastante nuevo y creo que le van a hacer cambios puesto que a mi modo de ver presenta algunas vulnerabilidades:
> 
> * La contrase√±a para desencriptar el fichero .pfx o p12 se guarda directamente en la tabla certificate_certificate:
> 
> ![Image](https://github.com/user-attachments/assets/39589d2b-330c-440c-882e-367830b4aef6)
> 
> * El contenido del fichero .pem extra√≠do se guarda directamente en la tabla del ir_attachment:
> 
> ![Image](https://github.com/user-attachments/assets/e7a1e311-94f7-42d6-a0db-0e6cdfde14f6)
> 
> Creo que aunque son funcionalidades que se solapan esperar√≠a a que Odoo las hiciera m√°s estable. Podr√≠amos hacer el esfuerzo de mejorar la seguridad ahora para que luego Odoo lo arregle en la siguiente versi√≥n.
> 
> Yo en el PR de migraci√≥n ya he quitado el commit que hac√≠a la migraci√≥n al nuevo modelo.

¬øy si se valora para v19 a ver que cambios realizan? yo por el momento mantendr√≠a el de OCA como est√°. [SEP] Para m√≠ lo ideal seria:
1) Guardar el contenido fichero .p12 en una variable de entorno en el servidor
2) Guardar el password asociado en un lugar seguro, que puede ser uno de los siguientes:
    a) Variable de entorno, tambi√©n en el servidor
    b) En un servicio externo como Google KMS, AWS Secrets Manager, Hashicorp Vault... que limitan qui√©n puede acceder a estas claves (por ejemplo, aplicando restricci√≥n por IP)

Por lo que entiendo ahora la arquitectura del modulo l10n_es_aeat guarda la clave privada en la base de datos, de modo que esa clave acaba estando en todos los backups de la base de datos y acaban replicandose en entornos de staging con facilidad.




 [SEP] Creo que estas dos ventajas que se√±alaba @ValentinVinagre son importantes:

> * Nos ha pasado que ciertos clientes tienen ""intranquilidad"" en traspasar certificados electr√≥nicos y contrase√±as... as√≠ que ser√≠a una opci√≥n para que el propio usuario lo pueda gestionar y no necesite al implantador(hasta cierto punto).
> * Si Odoo proporciona un sistema parecido o compatible, lo ideal es utilizarlo, menos que mantener.

Sobre el primer punto, pensad que para que un usuario mande la contrase√±a del certificado a su implantador, tiene que usar un canal adicional, que perfectamente puede ser un vector de ataque adicional.

Pero sin contar con ese, b√°sicamente existen 3 vectores de ataque. Comparemos:


¬† | Sistema antiguo de OCA | Sistema nuevo de Odoo
-- | -- | --
**Acceso elevado a Odoo** | Vulnerable. | Vulnerable.
**Acceso elevado a Postgres** | Seguro, ya que no hay datos. | Seguro, salvo que tambi√©n consigas acceso al filestore.
**Acceso elevado al filestore** | Vulnerable. | Seguro, salvo que tambi√©n consigas acceso a Posgres.

As√≠ pues, antes est√°bamos poniendo toda la seguridad en el filestore. Ahora, una parte se almacena en Postgres y otra en el filestore. **A mi modo de ver, estamos incrementando la seguridad** puesto que un atacante necesitar√° vulnerar 2 accesos diferentes para desbloquear el certificado.

Por supuesto, un acceso elevado a Odoo es vulnerable en todos los sentidos y siempre lo ser√°, por dise√±o, porque:
- Odoo necesita desbloquear la clave. Por tanto, de un modo u otro, necesita tener la contrase√±a.
- Un usuario con privilegios puede escribir una acci√≥n de servidor y hacer lo que quiera.

M√°s contexto a considerar:
- El almacenamiento en texto plano de contrase√±as en Odoo ya se hace en otros sitios, como los servidores de correo entrante/saliente.
- OCA puede crear m√≥dulos que mejoren la seguridad de `certificate` mediante almacenar la contrase√±a en otro backend, ya sea el filestore, vault, bitwarden, etc. Esa mejora ser√≠a transparente a lo que haga `l10n_es` o similares, ya que actuar√≠a a otro nivel.

Por lo tanto, para m√≠ **lo mejor que podemos hacer es adoptar `certificate`**.

@moduon MT-9954 [SEP] Los que trabajaron en la migraci√≥n de la localizaci√≥n los Spanish OCA Days no estaban convencidos del cambio, as√≠ que por el momento se ha dejado como estaba. Se puede evaluar en la siguiente versi√≥n, o en medio de √©sta con scripts de migraci√≥n, aunque implicar√≠a un cambio de dependencias."
Issue,4094,"No es necesario abrir issue si se va a abrir PR, ya que es duplicar la informaci√≥n. Se contin√∫a en #4095 "
Issue,4092,"Can you provide more information about the error? like the line/file/module or even the full traceback? [SEP] Esto tiene pinta de un Odoo.sh con algo incorrecto con la librer√≠a openupgradelib. En cualquier caso, no es un problema de este repo. [SEP] Tengo este mismo issue en la V17 Odoo.sh, solo veo en el log OpenUpgrade: 'migrate' decorator: failed to inspect the frame above: 'pkg', no tengo m√°s detalles del origen. openupgradelib lo tengo actualizado. Alguna idea de como solventar este issue? [SEP] Creo que Odoo ha hecho algo en su Odoo.sh que provoca ese problema, pero claro, ya queda fuera de nuestro alcance. Pon un ticket de soporte a ellos a ver qu√© dicen. Sois varios con el mismo problema en cuanto us√°is la librer√≠a en ese hosting. A ver si saben deciros algo. He revisado los √∫ltimos commits de la librer√≠a, y no hay ninguna raz√≥n para que provoquen este error. [SEP] > Creo que Odoo ha hecho algo en su Odoo.sh que provoca ese problema, pero claro, ya queda fuera de nuestro alcance. Pon un ticket de soporte a ellos a ver qu√© dicen. Sois varios con el mismo problema en cuanto us√°is la librer√≠a en ese hosting. A ver si saben deciros algo. He revisado los √∫ltimos commits de la librer√≠a, y no hay ninguna raz√≥n para que provoquen este error.

Hi @pedrobaeza, i've opened the PR https://github.com/OCA/openupgradelib/pull/410  after investigating the probelm; that seem originated by 
 - 16.0 https://github.com/odoo/odoo/pull/202014
 - 17.0 https://github.com/odoo/odoo/pull/202583

both PRs move the migration logic away from its original position in a dedicated method, that has not the pkg in `locals` scope, because the caller pass to that method directly the name of module [SEP] Disculpad que parece que finalmente s√≠ es de la librer√≠a. Gracias a @patrickt-oforce 

Viendo la fecha del parche, no me cuadraba porque yo hice una migraci√≥n sin problemas hace unos d√≠as, pero ya s√© la raz√≥n: OCB no se est√° sincronizando desde hace una semana. [SEP] @pedrobaeza So, do you recommend reopening the issue? 

@patrickt-oforce you are crack!! [SEP] No, because it's already fixed."
Issue,4085,"No, esto es as√≠ a prop√≥sito, porque casi muchos no necesitan esa separaci√≥n (solo los B2C), as√≠ que obligar a ello no es de recibo, y m√°s con un m√≥dulo tan intrusivo como `partner_firstname`. Hay que leer los README: https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_facturae#installation"
Issue,4077,
Issue,4060,"Bueno, realmente es correcto que se muestre as√≠, porque Hacienda hasta donde s√© es lo que pide en sus inspecciones, ya que es lo que se puede deducir. Mostrar otro dato que haga que las verificaciones cruzadas con el 303 no cuadren es lo que provocar√≠a confusi√≥n y preguntas. El enlace proporcionado no veo que est√© relacionado, porque no es de prorrata y adem√°s habla del SII. [SEP] Entiendo que est√° mencionado lo del SII, porque SII y Libro de IVA deber√≠an coincidir. De todas formas, a nosotros no nos ha aparecido la casu√≠stica. Justamente tenemos los clientes que utilizan prorrata, tambi√©n est√°n dados de alta en el SII, en nuestro caso; por lo que el libro de IVA, a nivel pr√°ctico, no lo utilizan. [SEP] Seg√∫n el dise√±o de registro del Libro de IVA que se puede encontrar [aqu√≠](https://sede.agenciatributaria.gob.es/Sede/iva/libros-registro.html) y descargar desde este enlace [Dise√±os de registro normalizados para los Libros Registro del IVA de personas jur√≠dicas no incluidas en SII en los formatos XLS y CSV (actualizado 18-12-2024)](https://sede.agenciatributaria.gob.es/static_files/AEAT/LSIJ.xlsx):

> - En ""Cuota Deducible"" se consignar√° el importe de la Cuota del IVA Soportado que sea deducible para cada tipo de IVA. Cuando toda la cuota soportada sea deducible, en la columna ""Cuota Deducible"" se consignar√° el mismo contenido que figure en la columna ""Cuota IVA Soportado"". 

Es decir, que seg√∫n el ejemplo de @rafaelbn con una prorrata del 80% configurada en la compa√±√≠a entonces el valor mostrado en ""Cuota IVA Siportado"" deber√≠a ser diferente al valor mostrado en ""Cuota deducible"", concretamente un 80% en este caso. S√≥lo deber√≠an coincidir cuando toda la cuota soportada sea deducible.

Actualmente con los dos m√≥dulos instalados `l10n_es_vat_book` y `l10n_es_vat_prorate` el valor mostrado es id√©ntico en ""Cuota IVA Soportado"" y ""Cuota deducible"" dando a entender que toda la cuota soportada es deducible independientemente del valor que te hayas deducido. Tambi√©n se est√° viendo afectado ""Total de factura"" pues el valor reflejado es la Base Imponible + Cuota Deducible, pareciendo que el IVA est√° m√°l aplicado.

Ejemplo pr√°ctico de una factura de una compa√±ia con la Prorrata del IVA al 80% para este per√≠odo y con dos l√≠neas de factura, una l√≠nea con un importe de 100 ‚Ç¨ y un impuesto del 21% y otra l√≠nea de 200‚Ç¨ con el mismo impuesto.

![Image](https://github.com/user-attachments/assets/097d527b-11ad-48d2-b0a6-792d316bccbc)

- El total de la factura son 363‚Ç¨.
- La cuota de IVA Soportado es 63‚Ç¨, el 21% de 100‚Ç¨ m√°s el 21% de 200‚Ç¨.
- La cuota deducible es 50,40‚Ç¨, el 80% de la cuota de IVA soportado.


Sin enmbargo el libro de IVA est√° haciendo un c√°lculo incorrecto, con este ejemplo sale:

![Image](https://github.com/user-attachments/assets/bc39ab8f-904d-4010-a7e2-197267f3dc69)

A todas luces se ve que el c√°lculo es incorrecto.

¬øCu√°l cree√≠s que es la soluci√≥n correcta @pedrobaeza @HaraldPanten @etobella? ¬øCrear un m√≥dulo glue, por ejemplo, `l10n_es_vat_book_prorate` o solventarlo directamente en `l10n_es_vat_book`?
 [SEP] Gracias por los detalles extra, Emilio. Ahora queda claro que tenemos dos columnas para la cuota y que la prorrata har√≠a diferente cada una. @etobella utiliz√≥ un ""truco"" para no necesitar un m√≥dulo extra para el SII que complet√© yo en https://github.com/OCA/l10n-spain/pull/2598

Tal vez se podr√≠a aplicar algo similar. Si no, un glue module. [SEP] Con este PR https://github.com/OCA/l10n-spain/pull/4093 deber√≠a solventarse. [SEP] Solucionado en https://github.com/OCA/l10n-spain/pull/4093"
Issue,4051,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4042,"Buenas @JMTato, esos impuestos corresponden a los de impuesto minorista, pese a que se llamen Impuesto 3% en realidad no se aplica el 3%. Te adjunto un documento con m√°s informaci√≥n: https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://revistas.cef.udima.es/index.php/RCyT/article/download/18473/18201/27775&ved=2ahUKEwijmKzC1MKJAxXEVqQEHXihBlkQFnoECDYQAQ&usg=AOvVaw1b3TMfGz9pYSg7Dfdeo_3U  [SEP] Much√≠simas gracias!! Entendido y disculpa."
Issue,4039,"Rolando, no es necesario abrir un issue cuando vais a abrir el PR. Simplemente abre el PR directamente con el texto del issue. Cierro y se sigue por #4040 "
Issue,4024,"Revisa los pull request en 15.0 y 16.0, que ya est√° corregido, y en camino la 17.0. Para versiones anteriores, pod√©is hacer cherry-pick."
Issue,4020,"Bueno, con las de ATC creamos un nuevo men√∫ de segundo nivel ""Declaraciones ATC"": https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_atc/views/atc_menuitem.xml#L4, pero podemos reformularlo a tener un √∫nico men√∫ superior y poner tres niveles:

- Declaraciones

  -  AEAT

     - Modelo 303

  -  ATC

     - Modelo 415

 [SEP] @pedrobaeza me parece tambi√©n bien, la idea es no llenar de men√∫s el principal que puede ser al final muy  poco visual.

Pero tambi√©n hay que tener en cuenta que el por ejemplo el 347 se llama igual en varios sitios, pero hay alguna diferencia por ejemplo en Guipuzcoa se exporta diferente. No ser√≠a AEAT, aunque realmente el c√°lculo es el mismo, especificamente, pero si tiene una diferencia. Tal vez un as√≠, aunque aqu√≠ no lo tengo tan claro, porque veo que muchos van a ser generales:

- Declaraciones

  - Generales
     - Modelo 347
  - AEAT
     - Modelo 303
  -  ATC
     - Modelo 415


Saludos,
Ignacio

 [SEP] Uf, eso no me termina de convencer, porque en Canarias creo que no existe 347, por lo que tenerlo en el apartado ""Generales"" se puede entender que tambi√©n les afecta, siguiendo esa misma l√≥gica. [SEP] Ok, pues lo dejamos como AEAT los comunes, aunque tengan formato diferente de exportaci√≥n, como es el caso de Guipuzcoa.

- Declaraciones

  -  AEAT

     - Modelo 303
     - Modelo 347

  -  ATC

     - Modelo 415

  -  Bizkaia/Vizcaya

     - Modelo 140

.... [SEP] > Ok, pues lo dejamos como AEAT los comunes, aunque tengan formato diferente de exportaci√≥n, como es el caso de Guipuzcoa.
> 
> * Declaraciones
>   
>   * AEAT
>     
>     * Modelo 303
>     * Modelo 347
>   * ATC
>     
>     * Modelo 415
>   * Bizkaia/Vizcaya
>     
>     * Modelo 140
> 
> ....

Me parece una buena idea üëçüèª [SEP] OK, pues podemos hacer el cambio de 17 en adelante, ¬øo quer√©is ir m√°s atr√°s? [SEP] Yo har√≠a 16.0, 17.0 y 18.0 (cuando se migre).

Saludos,
Ignacio [SEP] OK, pues adelante quien se anime a hacerlo. [SEP] Lo veo bien tambi√©n, as√≠ sobrecargamos menos el men√∫. Lo √∫nico que no estoy seguro si deber√≠amos sacar el menu item fuera de l10n_es_aeat, en el caso de la ATC no nos afecta porque heredamos directamente de l10n_es_aeat pero el motivo principal es heredar de las plantillas de mapeo y los test helpers. Toda esa funcionalidad podr√≠a ir en un m√≥dulo com√∫n a parte. [SEP] Yo creo que debe quedarse en `l10n_es_aeat` por el momento, ya que es una base adecuada para las declaraciones (sean de la Administraci√≥n que sean) y no creo que surja el que alg√∫n modelo no dependa de este m√≥dulo y ""vaya por libre"" sin heredar el modelo base de declaraci√≥n. [SEP] Asigno yo a un programador y que mande el PR [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Ya realizado."
Issue,4017,"Utiliza el impuesto no sujeto para ello. [SEP] Gracias @pedrobaeza . Hab√≠a probado esa posibilidad.
Pero si uso ese impuesto que est√° en el mapeo del Libro de IVA y la casu√≠stica para una organizaci√≥n sin √°nimo de lucro, como me indican, es que pueda aparecer en el mod347, pero que no aparezca en el libro de IVA.
 [SEP] De momento no est√° contemplado eso, pero siempre puedes eliminar a mano el impuesto no sujeto del mapeo del libro de IVA. [SEP] Pero entonces los movimientos que literalmente sean no sujetos y que tuvieran que aparecer en el Libro de IVA, no aparecer√°n. Al quitarlo del mapeo. [SEP] Si como asociaci√≥n dices que tienes l√≠neas sin impuestos, no creo que tengas IVA no sujeto. [SEP] Me dicen que la organizaci√≥n se comporta como un h√≠brido. Hay movimientos que si tienen su impuesto, pudiendo incluir no sujeto y a su vez movimientos que declaran por el mod347 que eran los que no entraban en el c√°lculo por ir el campo impuesto vac√≠o. [SEP] Tendr√©is que hacer entonces vosotros los modificaci√≥n para tener todos los casos cubiertos. [SEP] Eso me temo. Hab√≠a que intentarlo. 
Gracias."
Issue,4016,"This is not something of this repository, but Odoo itself. Please look in odoo/odoo about that, which we already discussed with them, and it was rejected with a reasoning, not remembering if in a dedicated issue or the pull request introducing the change."
Issue,4008,Se est√° analizando en #3996
Issue,3999,"Hola, esto es algo que debe arreglarse a nivel de Odoo, no aqu√≠. S√© que han hecho algunos fixes y creo que no volver√° a ocurrir, pero no tengo la certeza, y cuando pasa, hay que arreglarlo manualmente. 

Cierro al no ser algo de este repositorio."
Issue,3995,La versi√≥n de Factuae utilizada especificar√° eso en su formato. Cambia a otra versi√≥n que sea la de 3 decimales (si es que existe). Esto va normalizado. [SEP] Cierro por lo comentado.
Issue,3984,"Acabo de ver que este bug ya estaba registrado aqu√≠ #3448 
Pero parece que no se ha aportado ninguna soluci√≥n por el momento.

Alguna novedad @xabispacebiker @omar7r  
 [SEP] Buenas 
Encuentro nuevos errores en el POS con la numeraci√≥n de facturas simplificadas. Estos errores se producen cuando hay desconexi√≥n del POS. 
Pongo una imagen de ejemplo donde se observa que el mecanismo para asignar el numero de factura simplificada produce otros errores.
En la imagen el numero de pedido ha producido un desajuste en la correlaci√≥n de la numeraci√≥n.
Pero en la asignaci√≥n del numero de factura simplificada ha producido duplicaciones.

![Image](https://github.com/user-attachments/assets/6de1eaaf-dae0-4c4f-861d-4f385c3175cd)

Esto junto con el m√≥dulo Ticketbai provoca facturas rechazadas que no se registran en hacienda.

Otro asunto relacionado #3480  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3971,"A tener en cuenta: https://github.com/OCA/l10n-spain/pull/2371#issuecomment-1169837041 [SEP] Issues o PRs relacionados:

- https://github.com/OCA/l10n-spain/pull/2371
- https://github.com/OCA/l10n-spain/pull/3571 [SEP] Haciende Bizkaia ‚ÄúDFB‚Äù tiene una aplicaci√≥n llamada [BILA](https://www.bizkaia.eus/es/bila) como herramienta para cumplir con los modelos fiscales.
Esta aplicaci√≥n permite importa ciertos modelos desde ficheros tal como se ha comentado en otros issues y PRs aqu√≠ comentados.

Yo por mi parte no tengo ning√∫n desarrollo ni conozco ninguno a este respecto.

Puestos a debatir este tema, en mi opini√≥n se podr√≠a empezar con los modelos m√°s habituales  de IVA (303 y 390) y su casu√≠stica.

En Bizkaia, hacienda pide declarar el IVA deducible separando compras de gastos y bienes de inversi√≥n.

![Image](https://github.com/user-attachments/assets/f7967544-c65a-4aeb-b9f0-618ae2e22c96)

Esto actualmente se realiza separando en diarios los diferentes grupos. Aunque luego es un poco costoso obtener de Odoo la informaci√≥n separada en estos grupos y por tipos impositivos. El informe de OCA **""Tabla de impuestos""** no permite filtrar por Diario. Te tienes que ir ha los apuntes contables y all√≠ realizar filtros, agrupaciones y calculadora en mano para sacar lo datos.

Buscar una forma m√°s optima de agilizar este proceso e incluso a√±adir los modelos 303 y 390 para la BFA podr√≠a ser un comienzo.

Muchas gracias üôÇ
 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3970,"@giarve , es correcto el BUG. Te lo ratifico. El caso es que cada uno esta usando el mismo impuesto para cosas diferentes...

Si quieres lee por curiosidad https://github.com/OCA/l10n-spain/issues/2945

Nadie lo resuelve y mis intentos han sido bald√≠os üò¢  [SEP] Hola @giarve ,

Te comento para que le expliques a los asesores, pues lamentablemente hay un impuesto para gobernar todas las exenciones y claro... no vale. Entonces tiene que cambiar los XML-ID del ""impuesto comod√≠n"" para corregirlo.

Existen varias exenciones del IVA y lamentablemente no tenemos (en Odoo 16 y anteriores) varios impuestos diferentes, s√≥lo hay uno y otros m√°s incorrecto y confuso que otra cosa.

Lo primero que tienes que determinar es ¬øcu√°l es el art√≠culo de La Ley del IVA que necesitan?

Y la respuesta que te van a decir es el Art√≠culo 20 de la ley del IVA.

## Operaciones EXENTAS de IVA (sujetas pero exentas)

| Tipo de Exenci√≥n                                           | Art√≠culo LIVA      | Casilla Modelo 303                      |
|------------------------------------------------------------|--------------------|------------------------------------------|
| Exenciones interiores (sanidad, educaci√≥n, etc.)           | Art. 20            | Casilla 83 (*solo en 4T o mes 12*)       |
| Exportaciones de bienes                                    | Art. 21            | Casilla 60 / 94                          |
| Operaciones asimiladas a exportaciones                     | Art. 22            | Casilla 60 / 94                          |
| Servicios relacionados con exportaciones                   | Art. 23            | Casilla 60 / 94                          |
| Zonas francas, dep√≥sitos aduaneros, etc.                   | Art. 24            | Casilla 60 / 94                          |
| Entregas intracomunitarias de bienes                       | Art. 25            | Casilla 59 / 93                          |
| Agencias de viajes ‚Äì operaciones exentas                   | Art. 143           | Casilla 60 / 94                          |

---

## Operaciones NO SUJETAS al IVA (por localizaci√≥n u otros motivos)

| Tipo de No Sujeci√≥n                                         | Fundamento Legal   | Casilla Modelo 303 |
|-------------------------------------------------------------|---------------------|---------------------|
| Operaciones No sujetas por reglas de localizaci√≥n           | Arts. 69-70 LIVA    | Casilla 120         |
| Otras operaciones no sujetas por reglas de localizaci√≥n     | Arts. 68-72 LIVA    | Casilla 121         |
 [SEP] Lo ideal aqu√≠ no ser√≠a tener un impuesto distinto por cada art√≠culo del IVA entonces? Cu√°l ser√≠a el problema? Compatibilidad con versiones anteriores?

El impuesto comod√≠n este va a cubrir muchos casos, pero no siempre y no queda claro cuando **sin mirar las casillas de mapeo de impuestos**. 
Otra alternativa ser√≠a tener m√°s impuestos comodines, por ejemplo, agrupar todos los que van a la Casilla 60 / 94. O se le pone un nombre largo.

Lo m√°s f√°cil para el usuario: que el impuesto sea autodescriptivo, es decir, 1 impuesto por cada art√≠culo del IVA.
Lo m√°s f√°cil para mantener, entiendo: impuesto comod√≠n para las mismas casillas (problema: quiz√°s en un futuro hay que desglosar si cambia la casilla y dar√≠a pie a errores? no se las veces que ha podido pasar esto o si ha pasado)

De todas formas no le veo mucha diferencia pero no soy yo el que ha estado manteniendo los impuestos as√≠ que voy a dejar que gente con m√°s experiencia digan algo por este hilo. [SEP] En 17 ya hay un desglose de cada IVA exento seg√∫n art√≠culo, e hice un remapeo. Revisad https://github.com/OCA/l10n-spain/pull/4084/files#diff-8da58f33dfe1f2b3032205072ca8757fc48b8ca81d21fde4951d35fd5bc176eeR42

Parece que en la casilla 60 siguen faltando otros tipos de exento seg√∫n la tabla de Rafa, eso s√≠. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3961,"Hola, Nosotros llevamos ya unos meses trabajando con el m√≥dulo de TicketBAI  contra la hacienda de Bizkaia sin problemas, y el QR se genera en el momento de firmar la factura para enviarla al LROE. SIn embargo desde la actualizaci√≥n a Odoo18 falla y sabemos que est√° dando muchos problemas. Odoo por ahora no est√° dando respuestas. [SEP] A mi con la versi√≥n Odoo17, tenia problemas para generar el codigo QR, aunque si que sub√≠an bien las facturas (esto puedes chequear en la web de Hacienda de Gipuzkoa [https://egoitza.gipuzkoa.eus/WAS/CORP/WATTramiteakWEB/inicio.do])   y gracias a la comunidad de OCA aeodoo. El link de la consulta es el siguiente:
[https://www.aeodoo.org/en/forum/localizacion-espanola-3/tbai-error-al-generar-el-codigo-qr-1960])
Lo solucion√© instalando:
pip install reportlab
sudo apt-get install libcairo2 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3942,
Issue,3941,"Hola, efectivamente no est√° cubierto. He anotado la falta para que conste en https://github.com/OCA/l10n-spain/commit/5c46443507ba3da27ae3e1158894df1a651312e8, pero a no ser que contribuy√°is vosotros con esa mejora, no est√° previsto incluirlo, as√≠ que cierro."
Issue,3900,
Issue,3896,"¬øQu√© opci√≥n es √©sa de ""por lotes""? Yo lo subo desde el bot√≥n ""Importar"" y no he tenido problemas:

![Image](https://github.com/user-attachments/assets/bd9b5510-505a-4e62-9e3b-98357de3c301) [SEP] Sucede lo mismo para versi√≥n 16.0.

La presentaci√≥n de pagos por lotes es un servicio que permite enviar declaraciones correspondientes al mismo modelo, ejercicio y perodo de forma conjunta y autom√°tica: https://sede.agenciatributaria.gob.es/Sede/ayuda/manuales-videos-folletos/videos/presentacion-declaraciones-lotes.html

Lo curioso es que si subes los mismos archivos por separado AEAT se lo traga, pero por lotes da el error:

>CTROLEOF - No se deben presentar declaraciones con car√°cter de fin de l√≠nea o de carro

No hay ninguna especificaci√≥n t√©cnica, ni nada en el dise√±o de registro del modelo 111 que indique que se tiene que generar de manera diferente el archivo de exportaci√≥n.

De todas formas por el error que da, tiene pinta que el error est√° aqu√≠ https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_aeat_mod111/data/aeat_export_mod111_data.xml#L720 [SEP] Emilio, prueba a quitar eso a ver si funciona. Se que por ejemplo en Navarra es al rev√©s: que algunos modelos, sin LF+CR, no funcionan. [SEP] > Sucede lo mismo para versi√≥n 16.0.
> 
> La presentaci√≥n de pagos por lotes es un servicio que permite enviar declaraciones correspondientes al mismo modelo, ejercicio y perodo de forma conjunta y autom√°tica: https://sede.agenciatributaria.gob.es/Sede/ayuda/manuales-videos-folletos/videos/presentacion-declaraciones-lotes.html
> 
> Lo curioso es que si subes los mismos archivos por separado AEAT se lo traga, pero por lotes da el error:
> 
> > CTROLEOF - No se deben presentar declaraciones con car√°cter de fin de l√≠nea o de carro
> 
> No hay ninguna especificaci√≥n t√©cnica, ni nada en el dise√±o de registro del modelo 111 que indique que se tiene que generar de manera diferente el archivo de exportaci√≥n.
> 
> De todas formas por el error que da, tiene pinta que el error est√° aqu√≠ https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_aeat_mod111/data/aeat_export_mod111_data.xml#L720


------
Hola buenos d√≠as. 
Comentaros que cuando vas a validad el 303 al importar el archivo tambi√©n da error. Os lo pongo por si sirve de ayuda. 
Vosotros sab√©is m√°s ahora mismo de las especificaciones. 

![Image](https://github.com/user-attachments/assets/5cfebef9-c107-4d94-a133-982907dc2a61)

y este son los errores del archivo que se ha subido

![Image](https://github.com/user-attachments/assets/68ca0238-28a8-4916-bdc3-caafa309eeb2)

el archivo es la exportacion que realiza Odoo en el modelo 303 vuestro [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3886,"Hola, esa captura que ense√±as no corresponde al m√≥dulo de OCA. Debe ser de los informes enterprise, y por tanto, tendr√≠as que reportarlo a Odoo S. A., no aqu√≠, o empezar a utilizar el 349 de OCA. [SEP] Hola. Simplemente comentar que hemos cambiado de los m√≥dulos de enterprise a los de la OCA, gracias a tu respuesta.

Este error y otro comentado sobre la inclusi√≥n de operadores intracomunitarios en el modelo, que no lo eran, funcionan perfectamente aqu√≠.

Saludos."
Issue,3881,
Issue,3876,"Hola, comente sobre este problema directamente en el pr que hizo el cambio: https://github.com/OCA/l10n-spain/pull/3936#issuecomment-2624046335

un saludo. [SEP] Liberada versi√≥n en #3936 "
Issue,3872,"@pedrobaeza  [SEP] Duplicado de #3636 

Por favor no es necesario que me hagas ping. Recibo igual las notificaciones."
Issue,3868,"Hola de nuevo,
he vuelto a probar en una instalaci√≥n limpia de v14 y sucede lo mismo, el bot√≥n de Validar se pone en verde una vez que a√±ades el pago pero al clicar simplemente no hace nada.
He probado en Odoo18 que soporta nativamente TicketBai y el pos adaptado para ticketbai funciona seg√∫n lo esperado, al clicar el bot√≥in Validar sin especificar cliente alguno se genera la factura simplificada con el tbai y qrcode.
A ver si alguien nos puede aclarar qu√© estamos haciendo mal.
Gracias! [SEP] Una vez probado tambi√©n con v12 se obtiene el mismo comportamiento.

Con las herramientas de desarrollador activadas en el navegador se obtiene un error del tipo
TypeError: Cannot read properties of undefined (reading 'importKey') --> en v12
o del tipo
TypeError: na.subtle --> en v14

Buscando informaci√≥n por diferentes posts parece que las librerias utilizadas (Crypto, requests_pkcs12,.) requieren un entorno de acceso seguro, es decir, hay que acceder por https.

Una vez configurado un reverse proxy con https, los errores una desaparecido y el bot√≥n de Validar ya funciona correctamente generando una factura simplificada cuando no se selecciona cliente con el tbai y qrcode.

Quiz√°s a alguien m√°s le pase y este post le sea de utilidad.

Gracias!"
Issue,3864,"S√≠, confirmo que no es correcto como est√° ahora mismo. [SEP] @Christian-RB Necesitas ayuda con la parte de los scripts de migraci√≥n?

Al final habr√° dos currazos:
1- Simplificar el c√≥digo
2- Aplicar scripts para arreglar los datos de la gente que lo tienen mal por culpa de esto. [SEP] Buenas @etobella Ahora mismo estoy con el punto 1 casi terminando. 
Ser√≠a de gran ayuda si alguien crea los scripts para el remapeo de los xml_ids.
Si necesitan alguna referencia estoy reutilizando los mismos que en 16.0. [SEP] cuando est√© todo lo reviso y os doy una ayuda con eso [SEP] Cambios necesarios realizados"
Issue,3862,"Hola, la clave del 349 se calcula en base a los impuestos, no a la posici√≥n fiscal:

https://github.com/OCA/l10n-spain/blob/0e62d8ab8ceb93c4acf441b2b83fdf60a90cebfb/l10n_es_aeat_mod349/models/account_move.py#L47-L59

por lo que el comportamiento que describes no es lo que ocurre. Revisa que cada factura tiene los impuestos adecuados.

Cierro al no ser correcta la aseveraci√≥n y no existir ese error. [SEP] Hola. Entonces, al incluir o no seg√∫n el impuesto, ¬øtiene alguna l√≥gica que incluya el ""21% G"" en el 349?  En el caso de otros clientes que no son particulares en estados miembros, pero no figuran en el registro de operadores intracomunitarios, se debe incluir el IVA en la factura y ellos tienen que deducirlo/reclamarlo porque est√°n exentos. Sin embargo, no pueden figurar en el 349 porque no est√°n en el registro de operadores. 

No veo ning√∫n IVA 21% espec√≠fico para Ventas intracomunitarias que pudiera ser excluido del 349, junto con el cliente. 

¬øQu√© estoy haciendo mal? [SEP] Es que cualquier impuesto que no sean los intracomunitarios se excluyen por defecto del 349, sin hacer nada. Aqu√≠ est√°n los √∫nicos impuestos que se incluyen (los c√≥digos son los XML-IDs):

https://github.com/OCA/l10n-spain/blob/0e62d8ab8ceb93c4acf441b2b83fdf60a90cebfb/l10n_es_aeat_mod349/data/aeat.349.map.line.csv"
Issue,3861,"Hasta donde s√©, el asiento de regularizaci√≥n no tiene que ver con lo que compensas o no. Es el resultado de tu ejercicio. Luego, se tendr√° que hacer un asiento extra que mueva parte de los saldos entre la 470 y la 4751 seg√∫n esa operaci√≥n. Hacerlo todo en un mismo asiento, no s√© si ser√≠a lo correcto. La informaci√≥n podr√≠a estar seg√∫n las casillas, desde luego.

@AlbertCabedo es correcto hacerlo todo de un golpe? [SEP] Hola @pedrobaeza 

No s√© a que te refieres con lo del asiento de regularizaci√≥n exactamente

El problema que presenta aqu√≠ @EmilioPascual es que cuando te sale un trimestre a pagar IVA pero tenemos una cantidad a compensar que utilizamos para pagar menos a Hacienda, esa cantidad, contablemente, tiene que quitarla de la cuenta 470xxx porque si no es as√≠, esa cuenta quedar√° descuadrada

El modelo 303 lo hace bien trasladando esa cantidad a la casilla 110 pero no genera bien el asiento porque no la descuenta de la cuenta 470xxx

Si veis en el video, cuando solo compensamos lo resta de esa cuenta pero cuando compensamos una parte y pagamos otra, lleva el total a la cuenta 475xxx, cuando debe llevar cada parte a su cuenta correspondiente

Resumen contable del v√≠deo

![Captura desde 2024-12-19 12-38-27](https://github.com/user-attachments/assets/044bd1a1-5ce7-46e3-b0b6-3efd37561efb)

@rafaelbn @loida-vm @pedrobaeza @AlbertCabedo 

 [SEP] El asiento de regularizaci√≥n es el asiento que genera la declaraci√≥n, y como digo, ese asiento es el movimiento de la 472/477 a la cuenta que toque (4751 o 4700). El que adem√°s se compense es lo que digo que no tengo claro que tenga que ir en el mismo asiento o deba ser uno separado. [SEP] @pedrobaeza mi duda sobre el asiento de regularizaci√≥n del IVA era porque no se van a poder utilizar las cuentas **4750** y **4700** en el mismo asiento, de hecho, eso es lo que contablemente refleja la situaci√≥n real de lo que estamos declarando en el 303

Si nosotros en la declaraci√≥n del 303 ponemos en la casilla 78 alguna cantidad porque decidimos compensar y esta no queda reflejada en el asiento, entonces el asiento es incorrecto porque me est√° poniendo lo mismo que si no declarase nada en esa casilla

Lo que est√° ocurriendo ahora mismo es que hace el mismo asiento, rellenes o no la casilla 78 y no deber√≠a ser as√≠

Dejo un v√≠deo en el que se ve que hace lo mismo en los dos casos:

https://www.loom.com/share/2ec2f8d5962042269c8d183ed1903b73?sid=2c19b53c-14ec-4217-a85b-0aba9133bb5d

@rafaelbn @EmilioPascual @loida-vm 

@AlbertCabedo  [SEP] A ver si @AlbertCabedo o @acysos confirman al respecto. [SEP] He realizado el siguiente PR https://github.com/OCA/l10n-spain/pull/3874 para resolver esta casuistica [SEP] Cierro estando #3874 ya fusionado."
Issue,3858,"Hola @EnekoAira 

Nos ha pasado lo mismo con esto de los impuestos de alimentos y los errores del SII...
El problema de habilitar la ""Fecha de operaci√≥n"", es que la misma determina la deducibilidad de las cuotas de IVA. Y si esa fecha difiere respecto a la ""Fecha contable"" de la factura, habr√° una incongruencia respecto a los periodos en los que se liquidan esas facturas dentro de los modelos legales de Odoo:

- 303
- 349
- LIVA
- otros...

Es decir, tambi√©n implica hacer un desarrollo extra en todos modelos legales para que priorice incluir en las declaraciones las facturas conforme a ""fecha operaci√≥n"" (siempre que est√© establecida), por encima de ""fecha contable"".

Saludos,
 [SEP] Trat√°ndose de operaciones entre empresas la mayor√≠a de veces, en los que les da igual el IVA, ya que son meros intermediarios, la soluci√≥n m√°s eficaz es cambiar los impuestos a los que toque en la fecha de factura, sin m√°s complicaci√≥n. [SEP] @SoniaViciana Gracias por la respuesta.

No he tenido en cuenta todos esos modelos, supongo que deber√≠amos consultar la forma de afrontarlo a la propia AEAT. 
Tengo mi opini√≥n pero no est√° respaldada. 

No obstante, si as√≠ fuere, habr√≠a que cambiarlos tambi√©n. Que la pereza no nos lleve a no hacer bien las cosas :-)
 [SEP] @EnekoAira no es pereza, si no practicidad. Adem√°s, ¬øtienes pensado t√∫ hacer esas mejoras? [SEP] > Trat√°ndose de operaciones entre empresas la mayor√≠a de veces, en los que les da igual el IVA, ya que son meros intermediarios, la soluci√≥n m√°s eficaz es cambiar los impuestos a los que toque en la fecha de factura, sin m√°s complicaci√≥n.

No soy qui√©n para contestar a esto. Yo no lo har√≠a, otros ERPs no lo hacen [SEP] Eso de siempre aludir a que ""otros ERPs"" tal, bueno, pues vete con el otro ERP...

Una cosa est√° clara: un sistema en el que la fecha contable del asiento de la 472 o 477 no coincide con la fecha efectiva de impuestos es un NO muy grande por muchas razones que ahora mismo no voy a desglosar, ya que de todas formas es algo que no se va a hacer en Odoo nunca, primero porque el propio Odoo no lo permite ni lo va a permitir (ya quit√≥ hace muchos a√±os, a partir de la v9, eso de forzar periodo y fecha del asiento, que permit√≠a hacer m√°s o menos estas cosas), y segundo porque la localizaci√≥n se complicar√≠a de forma inimaginable para un caso tan marginal.

Cierro esta issue como algo que no se realizar√°. [SEP] @SoniaViciana, en realidad creo que la fecha por la que se deben generar los modelos es la fecha de devengo, no la fecha de operaci√≥n.

Es imposible que sea la fecha de operaci√≥n la marque el per√≠odo de devengo, dado que si as√≠ fuese ser√≠a imposible cumplir lo que indican en las preguntas frecuentes de la AEAT sobre como se debe de cubrir el tipo de operaci√≥n en el caso de rectificativas, por ejemplo. (https://sede.agenciatributaria.gob.es/Sede/impuestos-tasas/iva/iva-libros-registro-iva-traves-aeat/preguntas-frecuentes/2-registro-cuestiones-comunes.html?faqId=910f6c3d02bc9510VgnVCM100000dc381e0aRCRD)

En las √∫ltimas versiones del SII est√°n validando precisamente que el impuesto reportado est√© vigente a ""fecha de operaci√≥n"" de la factura informada; con lo cual queda claro que para la AEAT la fecha que debe tomarse a la hora de decidir el tributo a aplicar es la fecha de operaci√≥n (no la fecha de factura, ni la fecha contable, ni la fecha de devengo, ni cualquiera otra fecha que queramos aplicar).

Vuelvo sobre el ejemplo de las rectificativas. Si en un per√≠odo P (IVA al 4%) tengo que rectificar una factura del per√≠odo P-1 (con un IVA 2%), no puedo simplemente cambiar el IVA de la nueva factura rectificativa al 4%, porque entonces mis bases y cuotas no son correctas, ya que he pagado por 2 y rectifico por 4, causando un perjuicio a la hacienda p√∫blica; lo cual no les gusta nada y nos pone en el foco de una posible inspecci√≥n.


PS: Es mi primer aporte a la comunidad de Odoo y me he quedado muy ingratamente sorprendido por la reacci√≥n tajante , desmesurada y agresiva. @SoniaViciana si quieres que continuemos esta reflexi√≥n conjuntamente puedes escribirme directamente. [SEP] Una tirita se arranca mejor de un golpe que poco a poco.

Lo que comentas de las rectificativas es otra cuesti√≥n aparte. A m√≠ hasta ahora no me han rechazado en el SII una rectificativa hecha con fecha de estos meses (desde octubre) con impuesto del 4%, porque precisamente tienen en cuenta estas cuestiones, y poner fecha de operaci√≥n de antes de octubre lo considero incorrecto, porque el devengo de la rectificaci√≥n es ahora, no cuando se hizo la operaci√≥n rectificada. [SEP] Estar√© yo confundido, pero insisto en que ""fecha de operaci√≥n"" y ""per√≠odo de devengo"" no est√°n relacionados.

Sobre la rectificativa, la AEAT es clara (por raro que parezca :D): https://sede.agenciatributaria.gob.es/Sede/impuestos-tasas/iva/iva-libros-registro-iva-traves-aeat/preguntas-frecuentes/2-registro-cuestiones-comunes.html?faqId=d6ce6c3d02bc9510VgnVCM100000dc381e0aRCRD

PS: Con un poco de agua tibia tambi√©n salen muy bien las tiritas. [SEP] Gracias por el enlace, Ra√∫l. En el m√≥dulo SII, no estamos indicando fecha de operaci√≥n en ning√∫n caso, sea rectificativa o normal, y Hacienda no lo est√° rechazando, aunque no conoc√≠a que la AEAT indique que deba ser la fecha de operaci√≥n de la rectificada.

De todas formas:

- El SII no rechaza rectificativas con el 4% en las fechas actuales.
- El SII no obliga a poner fecha de operaci√≥n. Rellenando ""Fecha expedici√≥n"" y ""Periodo de liquidaci√≥n"" es suficiente.
- No tengo constancia de notificaciones o inspecciones que indiquen lo contrario.

Por el momento, no veo que haya que hacer nada al respecto para las rectificativas, y empezar a enviar esa fecha generar√≠a muchos flecos, como por ejemplo cuando se hace una rectificativa (como un rappel), sin una factura de origen exacta. Se podr√≠a barajar enviar la fecha de operaci√≥n de la rectificativa cuando el origen est√° claro. Eso a ver qu√© les parece a otra gente. Reabro para dar lugar a ese debate, aunque esto sea un tema lateral.

De cara a la fecha de operaci√≥n en general, el objetivo aqu√≠ es automatizar lo m√°ximo posible el env√≠o y evitar errores, por lo que tener un campo ""Fecha de operaci√≥n"" manipulable no est√° entre las caracter√≠sticas deseables por el momento, salvo que se encuentre alguna causa insalvable, pero si alguien quiere hacerlo, gracias a la capacidad modular de Odoo, se puede hacer como un m√≥dulo de extensi√≥n. [SEP] Ah, y otra cosa que veo seg√∫n la nueva informaci√≥n: la fecha de operaci√≥n no debe marcar el periodo de liquidaci√≥n de los impuestos, ya que si no, las rectificativas ir√≠an en declaraciones anteriores y no en la que toca. Parece que ese dato es totalmente caprichoso. [SEP] En nuestro caso, en alguna empresa del grupo, que no es la que usa Odoo si hemos tenido problemas de env√≠o al SII por enviar una factura rectificativa con fecha de noviembre, que rectificaba a una de septiembre, y llevaba entre los IVAs una parte de IVA al 5%.

Dado que ese IVA no es v√°lido en octubre, el SII la rechaz√≥, y tuvimos que modificarla indicando que la fecha de operaci√≥n era septiembre para que la aceptase.

En resumen, la fecha de operaci√≥n es la que marca los tributos a aplicar, y la fecha de devengo es la que marca el per√≠odo en el que se debe incluir en los modelos (al menos de IVA, si metemos el IRPF por el medio ya nos salen m√°s lios...).

PD: Soy Rub√©n ;D [SEP] La propuesta de a√±adir un nuevo campo de ""fecha de operaci√≥n"", sin valor por defecto, pero que si est√° cubierto se informe al SII va precisamente en la l√≠nea de que luego, cada empresa seg√∫n sus necesidades decida como dar valor a este campo:
- Manualmente por los usuarios
- En base a la fecha de los albaranes
- En base a la fecha de pedidos
- ...

Todo eso ser√≠a una cuesti√≥n a personalizar en los m√≥dulos de cada empresa, seg√∫n sus necesidades y decisiones.
As√≠ mismo, quien no necesite/quiera hacer nada al respecto simplemente con no alimentar ese campo el comportamiento de su sistema seguir√° igual que ahora.

Es por ello que, dado que el concepto de ""fecha de operaci√≥n"" es un concepto que define el SII debe de estar contemplado en este m√≥dulo el que se env√≠e. Y como es, cuando menos, controvertido; de ah√≠ que la propuesta sea crear un campo que cada empresa decida como alimentar (o no) seg√∫n su caso de uso. [SEP] Perdona, Rub√©n, como el login aparece rmosquera, se me ha ido el nombre. Es raro, acabo de comprobar ahora mismo justo ese caso, y tengo facturas aceptadas por el SII en octubre con IVA 4 %.

Si la fecha de operaci√≥n se considera solo a esos efectos, creo que puede a√±adirse que se env√≠e - sin intervenci√≥n del usuario - en las rectificativas cuando se tiene claro el origen.

Lo de poner ese campo de forma general, no, porque eso repercutir√≠a en la gente tocando sin saber, y teniendo tickets de asistencia por esos temas. Lo dicho, eso es f√°cil ponerlo en un m√≥dulo extra, e incluso se podr√≠a plantear tener ese m√≥dulo extra aqu√≠, pero desde luego de base, es muy peligroso. [SEP] Al 4% claro que lo van a aceptar, porque es un tipo v√°lido en cualquier mes.

El caso es con los IVA que la AEAT si puede validar porque solo han estado activos durante un tiempo, como el 5% o el 2%.

Entiendo, aunque no comparto, el temor de un mal uso de ese campo... Si est√° oculto, solo lo activar√° quien necesite usarlo y debemos confiar en que sepa como usarlo.

No podemos limitar el caso a las rectificativas, lo uso como ejemplo porque es el m√°s claro y el m√°s expl√≠cito; pero cualquier caso en el que facturemos operaciones de un mes en otro, y en ese salto de mes haya un cambio de IVA pueden provocar este problema.

La soluci√≥n que planteas para estos casos en https://github.com/OCA/l10n-spain/issues/3858#issuecomment-2551519653, de decirle al departamento de administraci√≥n, que haga mal las facturas, a sabiendas; no me parece apropiado.
Y adem√°s, no resuelve el caso de las compras, en las que el proveedor simplemente podr√≠a negarse a hacer esto.
Y seguramente tambi√©n nos dar√≠a problemas con los casos de aut√≥nomos en R√©gimen Especial Agrario, que no liquidan IVA y por tanto, los estar√≠amos perjudicando si les facturamos con un tipo de IVA m√°s alto. [SEP] Y otra cosa para @SoniaViciana entonces: con eso no habr√≠a que tocar nada de los otros m√≥dulos. Simplemente, habr√≠a IVA 4% en por ejemplo octubre, pero ya est√°.

Yo de todas formas, estoy dudando bastante que Hacienda permita hacer facturas de cliente del 4% por ejemplo a finales de octubre, por mucho que le digas que la fecha de operaci√≥n es de septiembre porque la mercanc√≠a se envi√≥ entonces... [SEP] > No podemos limitar el caso a las rectificativas, lo uso como ejemplo porque es el m√°s claro y el m√°s expl√≠cito; pero cualquier caso en el que facturemos operaciones de un mes en otro, y en ese salto de mes haya un cambio de IVA pueden provocar este problema

No lo limito, solo digo que en este caso es automatizable y sin efectos laterales: se env√≠a si se sabe la factura origen. Se sigue como hasta ahora si no se sabe (como el de una factura de rappel).

> La soluci√≥n que planteas para estos casos en https://github.com/OCA/l10n-spain/issues/3858#issuecomment-2551519653, de decirle al departamento de administraci√≥n, que haga mal las facturas, a sabiendas; no me parece apropiado.

No es hacerlo mal. Al contrario, es hacerlo bien, porque la tributaci√≥n siempre se aplica a las facturas. Los albaranes no llevan fiscalidad. Lo otro se admite por dar ""cuartelillo"". Pero f√≠jate que tendr√≠as el mismo problema (por lo menos en Odoo, pero tambi√©n en otros ERPs), si hiciste un presupuesto hace un a√±o, con los impuestos anteriores, y lo confirmas, env√≠as y facturas ahora. Tendr√°s que cambiar igualmente los impuestos a los que tocan ahora. No vale poner fecha de operaci√≥n de hace un a√±o porque era cuando emitiste el presupuesto.

> Y adem√°s, no resuelve el caso de las compras, en las que el proveedor simplemente podr√≠a negarse a hacer esto.
> Y seguramente tambi√©n nos dar√≠a problemas con los casos de aut√≥nomos en R√©gimen Especial Agrario, que no liquidan IVA y por tanto, los estar√≠amos perjudicando si les facturamos con un tipo de IVA m√°s alto.

Como digo, hasta ahora no tengo constancia de ning√∫n rechazo de este tipo. y el r√©gimen agrario no est√° contemplado en el desarrollo actual. Pero bueno, volvemos a lo mismo: que la fecha de operaci√≥n se puede implementar en un m√≥dulo aparte. Si es lo bueno que tiene la modularidad. [SEP] Efectivamente no deber√≠as facturarlo a finales de octubre; pero no porque no lo admita el SII, que creo que si lo aceptar√° (ser√≠a cuesti√≥n de testarlo en el entorno de pruebas).

El problema ah√≠ ser√≠a que incumplir√≠as los plazos de la ley: https://sede.agenciatributaria.gob.es/Sede/ayuda/manuales-videos-folletos/manuales-practicos/manual-iva-2021/capitulo-10-obligac-formales-suj-registro/obligaciones-materia-facturacion/plazos-expedicion-envio-facturas.html

Pero hasta el 16 si podr√≠as:
`Antes del d√≠a 16 del mes siguiente a aqu√©l en que se haya producido el devengo del impuesto correspondiente a la citada operaci√≥n` [SEP] El caso del presupuesto y del albar√°n no son comparables. Hacienda es clara con que la fecha que marca la fiscalidad es la de ""la entrega de la mercanc√≠a o de la prestaci√≥n del servicio""; ni presupuesto, ni pedido, ni factura.

De hecho, es esa fecha ""de entrega de la mercanc√≠a o prestaci√≥n del servicio"", la que te marca el plazo para poder emitir la factura, como indico en el comentario anterior.

Por nuestra parte veo necesario este desarrollo, y no s√© si lo plantearemos como un m√≥dulo espec√≠fico, o como un fork (con su PR) a la rama 12.0 de este repo (que es la versi√≥n en la que a√∫n trabajamos).
Seguramente optemos por lo que t√©cnicamente nos resulte m√°s sencillo. Si creamos un m√≥dulo nuevo no creo que podamos asumir el adaptarlo a las normas de OCA, que es algo en lo que no tenemos experiencia, y somos una empresa usuaria final de Odoo, no una implantadora. [SEP] Nos toc√≥ trabajar con esto hace poco para un caso muy puntual relacionado con las cuotas de alimentos:

![image](https://github.com/user-attachments/assets/a1d411f3-173f-4ed9-a431-79ba37992c76)

Y podemos asegurar que en el PRE-303 esa factura se deduce a 10/2024 y no en 11/2024. No he encontrado mucha info en la AEAT, pero s√≠ en los blocs de otros ERP:

https://soporte.sage.es/plus/2017/09/gestion-de-fechas-de-facturas-expedidas-para-el-sii-en-contaplus-flex/

https://a3responde.wolterskluwer.es/documentos/erp/fecha-contable-y-fecha-de-operacion-en-facturas-de-venta.html [SEP] Pues entonces volvemos al supuesto inicial que ten√≠amos tanto Sonia como yo, que es que s√≠ que marca la fecha de operaci√≥n lo que es la fecha a efectos fiscales, y eso supone esa triple fecha que es una l√≠nea roja.

Pero entonces es inconsistente con ese otro enlace que dice que en las rectificativas la fecha de operaci√≥n debe ser la de la factura origen.

¬øTal vez la fecha de operaci√≥n la utiliza Hacienda de forma diferente seg√∫n el tipo de factura? [SEP] En mi opini√≥n, y aqu√≠ entro en el terreno de lo que intuyo pero no puedo asegurar; lo que marca en que modelo debe ir no es ninguna de las fechas, si no el ""per√≠odo"" que se indique. Y apoyo mis suposiciones en que:
- Los modelos siempre hacen referencia a un per√≠odo, que puede ser mensual, trimestral o anual. En el caso de las empresas en SII, mensual y anual. Y esos son los campos que efectivamente tiene el registro de ""Periodo"" en el SII.
- En otra empresa del grupo que no usa Odoo estamos reportando las facturas de compra del mes pasado, que registramos antes del 16 del mes en curso, con per√≠odo de devengo del mes de la factura, para devengarlas lo antes posible. Llevamos haciendo esto sin problema durante a√±os. Las contabilizadas despu√©s del 16 van el el modelo correspondiente al periodo en el que se contabilizan.
- Existe tambi√©n en el SII una opci√≥n de indicar que el IVA de una factura se devengar√° en un per√≠odo posterior a aquel en el que se reporta (que se debe usar en casos de proveedores en ""criterio de caja"".

El caso que expone @SoniaViciana no concuerda con lo que yo entiendo, ya que si en esa factura indican:
![image](https://github.com/user-attachments/assets/fb32a033-fd84-480b-8ba5-8bdceb4415c0)

Deber√≠a ir en el modelo del 11-2024.

Entiendo que puede parecer un argumento peregrino pero... ¬øes posible que ese premodelo no sea correcto? En nuestro grupo de empresas no usamos esos premodelos generados por la AEAT, por lo que no puedo juzgarlo.

Sobre la documentaci√≥n de otros ERPs... pues es la informaci√≥n de los casos m√°s generales, y tiene la validez que le demos en base a la credibilidad de la empresa (y de su celo por mantener actualizada la documentaci√≥n p√∫blica). Y dicho esto, la veo correcta; pero para el caso general y m√°s com√∫n, y en el que la informaci√≥n se registra en plazo en el ERP.
 [SEP] Ya, pero sin esa confirmaci√≥n de qu√© supone la fecha de operaci√≥n en ese caso, la verdad es que es arriesgado aventurarse a poner un dato. [SEP] No s√© si desde la OCA ten√©is alg√∫n canal de comunicaci√≥n con la AEAT para poder plantear esa consulta a nivel t√©cnico, de la correlaci√≥n entre los datos enviados al SII y los modelos.

En el ERP de la empresa que no usa Odoo los tributos tienen el concepto de ""fecha de devengo"" y ese es el campo que se usa para los modelos y con el que calcula el ""PeriodoLiquidacion"" para el SII. Lo hacemos as√≠ desde hace tiempo sin problemas.

Entiendo que sin una respuesta que se pueda considerar de una autoridad no se incorporen cambios en esa l√≠nea al m√≥dulo de la OCA.

Nosotros trataremos de hacer nuestro aporte con lo que a nosotros nos sirva. [SEP] @acysos puedes lanzar consulta vinculante sobre este tema?

En cuanto a lo de la fecha de devengo separada de la fecha contable, es la l√≠nea roja que siempre os he comentado. No puede ser que se saque un sumas y saldos de una 472/477 y d√© un resultado, y en cambio en el 303 se declare otro distinto porque las fechas de devengo son algo diferente. [SEP] Legalmente si puede ocurrir esa diferencia, y que los datos sean correctos. Pero en cualquier caso concuerdo que es algo que si se puede evitar es mucho m√°s pr√°ctico, y solo lo pon√≠a como ejemplo y argumento de como creo que funciona el sistema por parte de la AEAT. No propongo que se incorpore un cambio de este tipo, que bastante tenemos con el debate sobre la ""fecha de operaci√≥n"" :D [SEP] ¬°Gracias @EnekoAira ! ¬°Bonito caso!

Esta es mi propuesta: https://github.com/OCA/account-invoicing/issues/1962

Me hice una chuletilla de un ejemplo de factura de proveedor, que hay hasta 4 a√±os para contabilizar y para la misma factura son 5 fechas diferentes.

![Image](https://github.com/user-attachments/assets/a2c508ce-5437-4fb5-8b12-ea37ffed6c44)

‚ù§ ‚ù§ 

@moduon [SEP] Desde mi punto de visto ser√≠a muy conveniente que apareciera un nuevo campo de ""fecha de operaci√≥n"", sin valor por defecto, pero que si est√° cubierto se informe al SII puesto que la fecha en la que quiero imputar mi gasto puede ser distinta a la fecha contable, ya que hay hasta el d√≠a 16 de cada mes para poder devengarme en el periodo anterior 

El SII recoge esta casuistica y diferencia entre la fecha de registro contable (fecha en la que se registra la factura) y la Fecha de operaci√≥n (fecha en la que imputo mi gasto), como vemos en la tabla de @rafaelbn 

Tenemos que tener mucho cuidado con la nomenclatura ya que lo que: 

- en la AEAT llaman **Fecha de operaci√≥n**, en Odoo es la **fecha contable**
- en la AEAT llaman **Fecha de registro contable**, es la fecha en la que registro la factura en el programa y la valido y esa fecha la tiene en cuenta la AEAT para los plazos del SII

Esto solo se da en la facturas de proveedor ya que en las de cliente esas dos fechas tienen que ser iguales

Estoy de acuerdo con todo lo que ha ido exponiendo @rmosquera-aira

A ver si @acysos hace la consulta vinculante para ver si se puede desarrollar porque nosotros lo vemos necesario

https://github.com/moduon [SEP] > en la AEAT llaman Fecha de operaci√≥n, en Odoo es la fecha contable

Esto no es del todo correcto, porque est√° el periodo de liquidaci√≥n tambi√©n en la informaci√≥n que se pasa a la AEAT, y el problema es que tengamos una desincronizaci√≥n entre la contabilidad de la 472/477 y la fiscalidad. Mientras eso no se aclare (y tengamos claro que la fecha de operaci√≥n es solo para ""ver los impuestos v√°lidos""), no se debe incorporar ese campo a nivel de usuario. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3856,"Todo esto est√° ya hecho en 15.0 en adelante. Revisad PRs ya fusionados. Para 14.0, alguien debe hacer los backports."
Issue,3851,"Hola.

Esta cuesti√≥n no tiene que ver con los m√≥dulos publicados en este repositorio. Publica por favor tu consulta en los foros de AEOdoo para que alguien te pueda orientar, que tiene pinta de configuraci√≥n. 

Cierro por lo expuesto."
Issue,3842,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3831,"Hola,

Esto no es cosa del m√≥dulo, si no de tu despliegue: o bien no tienes el c√≥digo de Odoo actualizado, que incluye esos cambios, o bien en tu BD no est√° actualizado dicho m√≥dulo.

En cualquier caso, cierro esta issue, al no tratarse de un error en el c√≥digo fuente en si. Puedes acudir al foro o a listas para solicitar m√°s ayuda."
Issue,3829,"Puedes proponer un PR arregl√°ndolo. [SEP] Seria lo suyo, pero antes habr√≠a que comentar el por que esta oculto el boton de cancelar asiento ""button_cancel"" en facturas de proveedor cuando tenemos confirmada la factura, aprovechamos y tratamos ambos asuntos en un mismo PR.


https://github.com/OCA/l10n-spain/blob/e1107ce2adfb333daa948cc441970284800555f3/l10n_es_ticketbai/views/account_move_views.xml#L248-L252
 [SEP] De acuerdo. Eso lo tendr√°s que ver con los creadores/mantenedores del m√≥dulo, ya que al ser algo espec√≠fico de vuestra parte, los mantenedores habituales de la localizaci√≥n no hemos intervenido. [SEP] Buenas @enriquemartin entiendo que la parte de l10n_es_ticketbai la hizo Aritz Olea en su d√≠a y ahora mismo no habr√≠a maintainer de ese modulo? [SEP] Buenas @AsierAcedo no hay maintainer oficial activo no, pero nosotros solemos ser bastante activos en cuanto a PRs en los m√≥dulos de tbai/batuz [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Hola @AsierAcedo 
Al final no hay PR de esto?  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3826,"El `with` justamente lo que hace es un `close` cuando termina su alcance, as√≠ que a priori es lo mismo. [SEP] @pedrobaeza Correcto, disculpa. Haciendo pruebas pensaba que no se bloqueaba por alguna raz√≥n, pero tambi√©n se bloquea (he editado el mensaje de la issue para quitar la alternativa). Estoy probando en el runbot y ocurre lo mismo: si hay un error durante el env√≠o, hay un bloqueo. [SEP] Pero yo no he experimentado nunca ese bloqueo que comentas. Mira si es por algo espec√≠fico de esa instancia. [SEP] @pedrobaeza El problema reside en lo de siempre. El m√©todo de env√≠o sin el queue, que ya sabemos que da muchos problemas/fallos.

Nosotros siempre lo configuramos con el conector en producci√≥n, pero hemos detectado este mal funcionamiento en una instancia de pruebas, por ejemplo cuando el SII da errores cuando no hay certificado, etc. Este tipo de errores (no errores en facturas).

Merece la pena invertir recursos en mejorar ese sistema? M√°s que nada es para dejarlo reportado.

Por otra parte, y ya que estamos... no s√© si merecer√≠a la pena hacer desaparecer el sistema ""instant√°neo"" en el refactoring de V17.

Ya nos dices. [SEP] S√≠, en v17 yo quitar√≠a el sistema instant√°neo, puesto que la principal raz√≥n era porque `queue_job` no es compatible con Odoo.sh, pero ya al no utilizarlo, ya da igual. Adem√°s, se puede hacer instant√°neo poni√©ndolo un retardo de 0. [SEP] > S√≠, en v17 yo quitar√≠a el sistema instant√°neo, puesto que la principal raz√≥n era porque `queue_job` no es compatible con Odoo.sh, pero ya al no utilizarlo, ya da igual. Adem√°s, se puede hacer instant√°neo poni√©ndolo un retardo de 0.

OK

@manuelregidor Teniendo en cuenta estos cambios y para no irnos muy ""offtopic"", puedes a√±adir este punto a la lista de faltantes para el refactoring de V17? Me refiero a lo de eliminar el m√©todo instant√°neo sin queue, que antes ya hemos barajado esa opci√≥n. [SEP] @HaraldPanten De acuerdo, lo a√±ado. Es necesario mantener esta issue abierta? Gracias. [SEP] > @HaraldPanten De acuerdo, lo a√±ado. Es necesario mantener esta issue abierta? Gracias.

Creo que no. Por m√≠ podemos cerrarla"
Issue,3823,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3812,"@fcvalgar es correcto. El libro de IVA no se ha actualizado conforme a los nuevos impuestos. [SEP] @HaraldPanten a ver si mi compa√±ero @edlopen nos puede lanzar un PR para a√±adir esos mapeos.  [SEP] @HaraldPanten @fcvalgar os dejo el PR para que lo prob√©is. ¬°Gracias!

https://github.com/OCA/l10n-spain/pull/3813 [SEP] Esta issue se puede cerrar porque se resolvi√≥ en https://github.com/OCA/l10n-spain/pull/3813 [SEP] Falta hacer backport/fw-port. [SEP] Ya est√° llevado a 15.0 y rehecho en 17.0. Los nuevos IVAs no deducibles estaban mapeados incorrectamente en 16.0 y ya est√° tambi√©n arreglado."
Issue,3806,"Hola, la opci√≥n de importar m√≥dulos solo sirve para m√≥dulos que no contengan c√≥digo (m√≥dulos de datos, como los de industria), por lo que no es v√°lida para casi ning√∫n m√≥dulo. Debes incluir el m√≥dulo en tu addons path de Odoo, y reiniciar la instancia una vez colocado.

Cierro, ya que no es un ning√∫n fallo del m√≥dulo, si no de c√≥mo se ha intentado desplegar. [SEP] Gracias por la respuesta Pedro. No ten√≠a ni idea."
Issue,3799,Efectivamente es incorrecto. Arreglado en https://github.com/OCA/l10n-spain/commit/2ec7e5299e66a6d17e385017e14df36edbd19edb
Issue,3790,"El comprobador es una herramienta de depuraci√≥n con sus limitaciones, y en el 303 tal como est√° no sirve. Se aceptan mejoras en el mismo, pero no es un error como tal, si no una limitaci√≥n. [SEP] Entiendo, muchas gracias por la respuesta. Saludos!"
Issue,3787,"Dir√≠a que has cambiado las cuentas est√°ndar 472/477. [SEP] Gracias por tu  rapida respuesta amigo Pedro. No he cambiado nada simplemente he instalado todo y estoy haciendo pruebas antes de utilizar este sistema el proximo a√±o. Podrias decirme como habria podido cambiar estas cuentas y como restaurar esto para que funcione correctamente ? muchisimas gracias Pedro
![impuesto](https://github.com/user-attachments/assets/090ad9ee-30bd-4ab1-9671-e5026fe44580)

Este es el tipo de impuesto que  he usado.
 [SEP] tengo diferentes backups en mi proxmox y he cargado la primera imgen que cree cuando estaba el sistema con las addons sin ningun tipo de cambio y he hecho una simulacion y obtengo el mismo resultado , no hay nada en casillas 11 y 37
![addons](https://github.com/user-attachments/assets/d6e8bda1-3c5d-47c4-9901-1409ad321331)
Crees que es algun tipo de bug ? has intentado replicar esto? o crees que en mi maquina hay alguna configurancion cambiada? gracias Pedro [SEP] El impuesto que debes utilizar es ""IVA 21% Adquisici√≥n de servicios intracomunitarios"", no ""IVA 0% Adquisici√≥n de servicios intracomunitarios"", o mejor a√∫n, establece el ""IVA 21% (servicios)"" en el producto, y la posici√≥n fiscal ""R√©gimen Intracomunitario"" en el proveedor, y te lo har√° solo el sistema. [SEP] Muchisimas gracias Pedro por tu ayuda asi como dices si ha funcionado correctamente pido disculpas por abrir este hilo con el tag de bug puesto que no lo es . Gracias de nuevo por tu ayuda amigo.
![ok](https://github.com/user-attachments/assets/2a7a422a-f9ca-4fa9-b057-3bba3e7995f9)
"
Issue,3786,"Alguien le puede intentar echar un ojo a esto? Lo necesitamos para fin de a√±o... no nos importa pagar por el tiempo. Gracias. [SEP] > Alguien le puede intentar echar un ojo a esto? Lo necesitamos para fin de a√±o... no nos importa pagar por el tiempo. Gracias.

@buildamoc lo hemos corregido en este [PR](https://github.com/OCA/l10n-spain/pull/4121) üòÑ "
Issue,3754,"Nota para cuando comencemos con la migraci√≥n de AEAT, SII, etc: revisar el m√≥dulo core `certificate` para ver si provee ya de base las herramientas para la gesti√≥n de certificados. [SEP] I'm migrating l10n_es_partner [SEP] Trabajando en l10n_es_igic [SEP] working on `l10n_es_toponyms` [SEP] Working on payment_redsys [SEP] Are there plans to migrate the modules not yet migrated in version 17? Specifically, I'm referring to:
-  l10n_es_ticketbai
- l10n_es_ticketbai_api
- l10n_es_ticketbai_api_batuz
- l10n_es_ticketbai_batuz [SEP] @Gasteizko a partir de la v17.0 esta incluido en el core de Odoo

https://github.com/OCA/OCB/tree/17.0/addons/l10n_es_edi_tbai
 [SEP] > [@Gasteizko](https://github.com/Gasteizko) a partir de la v17.0 esta incluido en el core de Odoo
> 
> https://github.com/OCA/OCB/tree/17.0/addons/l10n_es_edi_tbai

Si, pero paso lo mismo con el SII, que esta en el core, pero le faltan cosas y no funciona bien con los IRPF. Ah√≠ ya es decisi√≥n m√°s de los que est√°n en el pa√≠s vasco que quieren hacer. [SEP] Working on l10n_es_account_asset #4217  [SEP] Working on l10n_es_account_banking_sepa_fsdd #4219  [SEP] Working on l10n_es_cnae  #4236  [SEP] Hay planes de migrar el modelo 190? [SEP] Hay plan sobre el modulo de verifactu?
 [SEP] Working on l10n_es_aeat_patner_check #4283 "
Issue,3751,"@sergio-teruel tienes informaci√≥n sobre este punto? [SEP] Hola @ValentinVinagre No recuerdo bien, seguramente ser√° por herencia del pasado.
Tendr√≠a que analizar en profundidad [SEP] Gracias por contestar, efectivamente se puede quitar esa dependencia sin problemas, es dinamica y esta relativamente bien protegida aqui https://github.com/OCA/l10n-spain/blob/2ffc60e53c05330b3fada7c4f927b37abe3eab42/payment_redsys/models/payment_provider.py#L103

Nosotros  ya estamos usando el modulo sin la dependencia, y teniendo correctamente configurado web.base.url funciona muy bien [SEP] Perfecto, pues si alguien pod√©is hacer el pull request, as√≠ queda bien establecido. Indicad por favor en el README la cuesti√≥n de `web.base.url` o del dominio cuanto se tiene website. [SEP] ¬°Qu√© bien visto!

¬ø@IJOL os encarg√°is del PR? Podemos hacerlo nosotros desde Sygel sin problema sino. Avisadnos y nos organizamos.

¬°Gracias!

Un saludo, [SEP] @IJOL ¬øPuedes hacerme ping en el PR?"
Issue,3730,"Hello ‚úãüèº !

Please @etobella @pedrobaeza @HaraldPanten could review this proposal please?

Thank you very much! üòÑ ‚ù§Ô∏è 

For me is üëçüèº , really nice video @ArantxaSudon üíò ü§ó  [SEP] https://github.com/OCA/l10n-spain/pull/3715 [SEP] Cierro al estar el PR propuesto. [SEP] @etobella gracias por remitirme a este PR pero he vuelto a probarlo y  no hace lo que comento en el v√≠deo

@pedrobaeza podr√≠as, por favor, volver a abrir este Issue

![Captura desde 2024-09-26 13-14-59](https://github.com/user-attachments/assets/fcae54c2-e87e-4e96-a7ec-36ea2e08aa6e)


Como ver√©is en esta captura, yo hago las pruebas y grabo el v√≠deo con el PR https://github.com/OCA/l10n-spain/pull/3715 ya aprobado y lo que comento aqu√≠ sigue reproduci√©ndose

He vuelto a repetirlo, comprobando que el m√≥dulo estaba instalado y, es cierto que:

-  si se utiliza **distinto impuesto**, las l√≠neas de la prorrata si se desdoblan
-  pero si utilizo el **mismo impuesto** (que es lo que suele ocurrir), entonces la l√≠neas no se desdoblan y va todo a la misma l√≠nea de gasto.

 
 Creo que, si os fijais en el v√≠deo que os dej√©, se ve perfectamente como me lo deja en una solo l√≠nea

Muchas gracias

@rafaelbn @EmilioPascual 
MT-1809 @moduon
 [SEP] Esto no es un PR, si no un issue. Los comentarios correspondientes deber√≠an hacerse en el PR de Enric. [SEP] @pedrobaeza Entonces vuelvo a poner todo esto en https://github.com/OCA/l10n-spain/pull/3715 ?

Yo no soy t√©cnico, soy funcional y aporto todo lo que puedo para mejorar y si t√∫ me dices que lo cambie, que eres el que sabe como funciona, no hay ning√∫n problema, lo cambio en un segundo [SEP] A ver, el PR est√° cerrado y mergeado y yo no podr√© dedicarle tiempo a resolverlo, si quer√©is, pod√©is abrir un PR y, si puedo, ya lo revisar√©, es lo m√°ximo que os puedo ofrecer. [SEP] Gracias @etobella  [SEP] OK, si #3715 no es lo que se comenta en esta issue, entonces reabro para seguir reflej√°ndolo hasta que haya un PR que lo haga. Disculpad la confusi√≥n. [SEP] Muchas gracias @pedrobaeza  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3721,"Se soluciono solo
Parece que era cosa de ellos"
Issue,3720,"¬øA alguien m√°s le pasa? [SEP] @keiverobles efectivamente as√≠ es.
La soluci√≥n pasa por refactorizar la forma en la que se recogen los datos para conformar el XML. Se tiene que hacer agrupando por tipo impositivo.
En su momento se trat√≥ el tema pero de momento nadie a tomado la iniciativa de plantear una soluci√≥n.

Gracias por el issue porque aqu√≠ queda perfectamente explicado el problema üëç [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3718,"Por si alguien tiene las mismas dudas que yo, he resuelto los problemas de la siguiente forma:
- En el fichero /l10n-spain/l10n_es_facturae/views/report_facturae.xml sustituir el c√≥digo existente por el siguiente ( he dejado la primera y √∫ltima l√≠nea afectada del xml para mayor claridad) :

```
        ................
        <PartyIdentification t-if=""False"" />

        <t t-set=""has_admin_centres"" t-value=""
            administrative_partner.oficina_contable or 
            partner.oficina_contable or 
            administrative_partner.organo_gestor or 
            partner.organo_gestor or 
            administrative_partner.unidad_tramitadora or 
            partner.unidad_tramitadora or 
            administrative_partner.organo_proponente or 
            partner.organo_proponente
        "" />

        <t t-if=""partner.facturae and has_admin_centres"">
            <AdministrativeCentres>
                <t t-call=""l10n_es_facturae.administrative_center"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.oficina_contable or partner.oficina_contable"" />
                    <t t-set=""role_type_code"" t-value=""'01'"" />
                </t>
                <t t-call=""l10n_es_facturae.administrative_center"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.organo_gestor or partner.organo_gestor"" />
                    <t t-set=""role_type_code"" t-value=""'02'"" />
                </t>
                <t t-call=""l10n_es_facturae.administrative_center"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.unidad_tramitadora or partner.unidad_tramitadora"" />
                    <t t-set=""role_type_code"" t-value=""'03'"" />
                </t>
                <t t-call=""l10n_es_facturae.administrative_center"" t-if=""administrative_partner.organo_proponente or partner.organo_proponente"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.organo_proponente or partner.organo_proponente"" />
                    <t t-set=""role_type_code"" t-value=""'04'"" />
                </t>
            </AdministrativeCentres>
        </t>

        <LegalEntity t-if=""buyer_type == 'J'"">
        ....................
```

Adem√°s, en el fichero /l10-nspain/l10n_es_facturae/models/account_move.py no obligar a comprobar la unidad tramitadora y oficina contable, comentando estas l√≠neas:

```
	#if not self.partner_id.unidad_tramitadora:
        #    raise ValidationError(_(""Unidad Tramitadora not provided""))
        #if not self.partner_id.oficina_contable:
        #    raise ValidationError(_(""Oficina Contable not provided""))
```

Por √∫ltimo, si se quiere poder firmar con el certificado digital, hay que ir a Facturaci√≥n/Contabilidad->Configuraci√≥n->AEAT|Certificados AEAT:
   	- Poner un nombre al certificado
   	- Incluir el archivo .pfx
   	- Poner un nombre a la _carpeta_ donde se ubicar√°n las claves p√∫blicas y privadas que ser√° en la ruta de  Odoo16/sessions/_carpeta_
   	- Incluir la fecha de inicio de uso del certificado y la fecha de finalizaci√≥n
   	- Darle a OBTENER CLAVES. 
   	- Una vez obtenidas, darle a PARA ACTIVAR y verificar que est√© activado.
   Ahora si se quiere firmar la factura electr√≥nicia, al generarla, dejar marcado el bot√≥n de firmar.


"
Issue,3703,"Odoo SA ya lo tiene desarrollado para Odoo Enterprise hace 3 semanas: https://github.com/odoo/enterprise/pull/69736 [SEP] Empezamos a trabajar en el PR para hacerlo en OCA. @moduon MT-7092 [SEP] Hola a todos, Emilio lo empez√≥ a hacer en el OCA Sprint pero no lo termin√≥. Ahora lo est√° retomando @Shide . Si alguno tiene m√°s experiencia y quiere ayudar nos dec√≠s. Estamos con esto ahora mismo. [SEP] Estoy yo haci√©ndolo ahora. En unas horas lo tendr√©. [SEP] Gracias @pedrobaeza  [SEP] - [x] Hecho PR para Odoo 15 en https://github.com/OCA/l10n-spain/pull/3755
- [x] https://github.com/OCA/l10n-spain/pull/3757 [SEP] REABRO porque tenemos errores. Creo que no est√°n implementsdos todos los cambios. Estoy viendo que se puso en Known issues 

@Shide  [SEP] Las casillas no implementados son casos muy espec√≠ficos de las nuevas auto-declaraciones rectificativas. Si ten√©is un caso y ten√©is claro c√≥mo funcionan, adelante con los cambios. [SEP] El error actual es:

![image001](https://github.com/user-attachments/assets/5765bd5c-87aa-4b45-96a9-259dd6216d14)
 [SEP] @rafaelbn ese error es porque no se est√° utilizando el nuevo formato BOE. Si generaron la declaraci√≥n antes del parche, tendr√°n puesta esa configuraci√≥n antigua. Cambiad la configuraci√≥n y volved a exportar. [SEP] - [x] PR en https://github.com/OCA/l10n-spain/pull/3770 [SEP] Correcto @pedrobaeza . Adicionalmente se necesita en ciertos casos rellenar estas casillas.

https://github.com/OCA/l10n-spain/pull/3770"
Issue,3700,"Es probable que no est√©s utilizando los impuestos correspondientes del OSS, o que tengas mal gestionado el mapeo en el m√≥dulo del SII. No es una incidencia del m√≥dulo como tal. [SEP] Hola entonces tengo que mepear los impuestos del OSS en Contabilidad>Configuracion>SII - Mapeo de impuestos. Como se hace con los nuevos impuestos que se crean.¬øes correcto lo que indico?


Gracias.
Un saludo."
Issue,3699,"Hola, esto no tiene que ver con `l10n_es_igic`, si no con el actualizar (`account_chart_update`). En cualquier caso, simplemente quita la actualizaci√≥n de esa posici√≥n fiscal en el listado en el que aparece, en lugar de darle a ""Siguiente"", ""Siguiente"". [SEP] Hola Pedro,

Gracias por la informaci√≥n. No obstante, hemos actualizado el m√≥dulo account_chart_update a la √∫ltima versi√≥n pero sigue apareciendo el mismo error al actualizar el plan contable:

""La posici√≥n fiscal 'EU privado' tiene intrastat establecido en B2B, por lo que la opci√≥n 'IVA Requerido' debe estar activada.

(La opci√≥n de ""Requiere IVA"" est√° activada en ""EU privado"")

¬øSabes cu√°l podr√≠a ser el motivo?

No puedo quitar la actualizaci√≥n de esa posici√≥n porque entonces no se actualizar√≠a.

Muchas gracias. [SEP] Desactiva esa casilla manualmente, o en el `account_chart_update` (que hay que ejecutarlo), pongas de no actualizar ese dato."
Issue,3698,"Prueba a subirlo en formato p12. [SEP] Gracias, Pedro.
No se como obtener un P15.
He conseguido transformarlo a pem, pero tampoco sirve (Could not deserialize PKCS12 data). [SEP] Perd√≥n, era p12. Prueba a utilizar un navegador como Firefox para importar el certificado, y ver si funciona correctamente. Entonces, desde ah√≠ podr√°s exportar a formato .p12. B√°sicamente es similar al .pfx, pero para aumentar las posibilidades de compatibilidad. [SEP] Mismo error.
Al cargar, sigo viendo como nombre de archivo, lo que ""ocupa"":
![image](https://github.com/user-attachments/assets/63cc42c9-94fa-42f3-98eb-f1613e67f66b)
Y si intento obtener claves:
![image](https://github.com/user-attachments/assets/80c5e5f2-f8e8-4888-9ba4-02e564ee3204)
Probado con p12 y Firefox.
 [SEP] Bueno, lo de que se vea el tama√±o es normal, porque as√≠ funciona el widget. Si la importaci√≥n en Firefox funciona, entonces el problema podr√≠a ser de las librer√≠as crypto instaladas. Lista qu√© versiones tienes de cada librer√≠a y f√≠jate lo que hay en el requirements.txt del repositorio https://github.com/OCA/l10n-spain/blob/16.0/requirements.txt.

En cualquier caso, me temo que esto no es un fallo del m√≥dulo, por lo que no se debe continuar aqu√≠ en el issue tracker. Si con estas indicaciones no lo consigues, acude por favor al foro https://www.aeodoo.org/forum para solicitar m√°s ayuda."
Issue,3690,"Hola Matias, nos encontramos con el mismo problema. Pudiste encontrar soluci√≥n? [SEP] Hola, en mi caso el problema estaba con otro modulo de pagos (Klarna) que capturaba todos los token de pago y no devolvia el estado de la transaccion al modulo de Redsys, corrgiendo esto se solucion√≥ el problema."
Issue,3689,"Hola @fcvalgar , yo creo que es un BUG del m√≥dulo, dado que esa pesta√±a se deber√≠a comportar de manera an√°loga a la pesta√±a de Contabilidad. Es decir:

Igual que si tengo acceso a la pesta√±a de Contabilidad veo la pesta√±a Contabilidad y si no no

Pues

Si tengo acceso como responsable de AEAT veo la pesta√±a y si no No

Para todos, es un problema de seguridad importante en la parte de protecci√≥n de datos puesto que si os fij√°is si usas el 190 y rellenas datos, como hacemos, ah√≠ salen datos privados de salud como si tienes discapacidad y cosas as√≠... y lo puede ver cualquiera.

¬°Gracias! ¬°Saludos!

Creo que es un cambio f√°cil @OCA/local-spain-maintainers que nosotros haremos un PR para que esa pesta√±a no se muestre si no tienes en el usuario el permiso de AEAT. ¬øOs parece OK? Gracias. üòÑ ‚ù§Ô∏è  [SEP] Fix en https://github.com/OCA/l10n-spain/pull/3692.

Si hay campos cuya privacidad es m√°s cr√≠tica, decidme cu√°les por favor porque hay que a√±adir una capa extra de seguridad a nivel ORM. [SEP] Se cierra y la discusci√≥n contin√∫a en #3692 "
Issue,3688,"La forma adecuada de resolverlo ser√≠a crear un m√≥dulo `l10n_es_vat_book_pos`, que detecta qu√© apuntes provienen del PoS, y que no los marque como incorrectos por no tener NIF, y adem√°s tenga en cuenta las posibles casu√≠sticas de constar como simplificadas, o tambi√©n resumirlos como agrupados. [SEP] > adem√°s tenga en cuenta las posibles casu√≠sticas de constar como simplificadas,

Que casu√≠sticas se pueden producir?

>  o tambi√©n resumirlos como agrupados.

esto a simple vista parece mucho mas complicado, no iria por esta ruta si no es obligatorio

 [SEP] En cuanto a lo de no dar errores por no tener nif, seg√∫n deduzco de anteriores conversaciones una manera de solucionar este asunto ser√≠a por la ruta de pos_default_partner, y marcar este partner como no Aeat, esto sigue siendo  v√°lido como soluci√≥n? [SEP] https://github.com/OCA/l10n-spain/blob/d1aaa8aa24889b16df2de25298385e366b5decba/l10n_es_vat_book/models/l10n_es_vat_book_line.py#L39-L41

He visto esto en la revision del asunto, no es da√±ino, pero tampoco bonito [SEP] > Que casu√≠sticas se pueden producir?

Creo que b√°sicamente que venga indicado que es simplificada, pero no he entrado en detalles.


> esto a simple vista parece mucho mas complicado, no iria por esta ruta si no es obligatorio

S√≠, pero ser√≠a lo m√°s √∫til en cuanto a volumen.

> He visto esto en la revision del asunto, no es da√±ino, pero tampoco bonito

S√≠, estar√≠a bien limpiarlo.

> En cuanto a lo de no dar errores por no tener nif, seg√∫n deduzco de anteriores conversaciones una manera de solucionar este asunto ser√≠a por la ruta de pos_default_partner, y marcar este partner como no Aeat, esto sigue siendo v√°lido como soluci√≥n?

Esto es un workaround, pero lo suyo es tratarlo adecuadamente. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3682,"Duplicado con el foro: https://www.aeodoo.org/forum/localizacion-espanola-3/sii-con-oss-1462

Cuando est√© claro que es un error real del m√≥dulo, se puede reabrir esto.

Ana, no hagas cross-posting. Punto 16 de la FAQ de los foros, que aplica aqu√≠ tambi√©n: https://www.aeodoo.org/forum/localizacion-espanola-3/faq [SEP] Buenos d√≠as, nuestro problema se solucion√≥ con la desinstalaci√≥n de uno de los m√≥dulos del est√°ndar para OSS. Despu√©s de hacerlo, en ajustes ten√≠amos disponible el wizard que nos permite crear los impuestos necesarios.
![OCA](https://github.com/user-attachments/assets/5ced878c-5035-4856-bc91-9e0541d3da67)
La pista surgi√≥ con el comentario de Harald Panten en el foro de Aeodoo, al cuestionar el formato de los impuestos disponibles.
Muchas gracias a todos

"
Issue,3680,"He encontrado el problema, se debia a una cuenta obsoleta que se intentaba usar y Odoo en consecuencia devolv√≠a un error 400.
Al cambiar la configuraci√≥n de la cuenta el pago se procesa con √©xito y el carrito se vac√≠a."
Issue,3676,"Alguna ayuda o pista por donde tirar sobre esto?  [SEP] Nadie se ha encontrado con el problema?
 [SEP] Revisa la tabla de mapeo de impuestos del SII, se est√° enviando un impuesto con una base de -73.1. Es probable que alguno de los impuestos no los tengas mapeados correctamente. [SEP] Te faltar√° mapear el impuesto ""IVA Soportado exento (operaciones corrientes)"" en el apartado SFRS del SII. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3670,Utiliza por favor los foros (https://www.aeodoo.org/forum) para este tipo de preguntas.
Issue,3669,La traza que aparece en tu reporte no tiene nada que ver con que tenga el `ES` o no lo tenga. El problema es que no tienes configurado el certificado.
Issue,3668,"Puesto que est√° el PR #3667, no es necesario tener tambi√©n una issue, as√≠ que cierro."
Issue,3660,"Efectivamente, no est√° afectado, porque nosotros redirigimos a la p√°gina de la propia Redsys, as√≠ que cierro. Gracias por comentarlo en cualquier caso."
Issue,3650,"Y por que necesitais que sea LGPL?

No deberiais necesitar un glue module [SEP] A ver, por mi parte, no veo la necesidad de cambiar la licencia. Si no se necesita un glue module, se pueden usar ambos m√≥dulos. En caso contrario, est√° el account_asset_management de OCA :wink: 

Sobre portar la funcionalidad a Odoo, pues lo que vosotros quer√°is (teniendo en cuenta que estamos hablando de contabilidad, supongo que Odoo dir√° que a EE... adem√°s, no tengo claro como ligar√° con su sistema de presentaci√≥n de impuestos o con el propio SII...), pero recordad que los mismos mecanismos no deberian usarse, ya que seria incumplimiento de licencia. [SEP] Hola @etobella ,

Por que es el m√≥dulo base de la prorrata de IVA y si no usas los activos de OCA y usas los de Odoo no puedes adaptar los activos de Odoo a la prorrata para que te cree el activo por el valor adecuado si la factura de proveedor tiene prorrata.

Como te digo tenemos estas 2 opciones para darle salida porque para nosotros no es una opci√≥n usar los activos de OCA üòÑ , que est√°n genial, pero siempre que podemos usamos lo que tiene Odoo y ampliamos lo que no tiene.

Ya me dec√≠s para si esta v√≠a no sirve hablar con Odoo para solucionarlo en CORE.

¬°Mil gracias!

Abrazos,
Rafa [SEP] Hablalo con core, a mi la licencia me parece correcta tal y como est√°, adem√°s siempre pod√©is optar por los assets de OCA."
Issue,3647,Cierro ya despu√©s de un tiempo publicado.
Issue,3641,"Debes actualizar todo el c√≥digo, no solo el de OCA/l10n-spain. En este caso, tienes c√≥digo obsoleto de odoo/odoo. Y claro, actualizar los m√≥dulos en la BD correspondiente. [SEP] Glups, gracias, tienes toda la razon era el odoo,  disculpas por el ruido"
Issue,3636,Same issue here [SEP] Resuelto en #3872 
Issue,3627,"@ramiadavid es esto lo que t√∫ te encontraste en la migraci√≥n a 17.0? [SEP] @pedrobaeza si, creo que si [SEP] @emedina-mts echa un vistazo a estos cambios:

https://github.com/OCA/l10n-spain/pull/3529/commits/62b30b88c233e1f783c4d8cb7e90e9f74be57dbe#diff-dddf5901fd999ae3d0c986925b1d6d86981f36753f3f607c6ec6c6299d44e312R197

y si los llevas a 16 y funciona, estar√≠a bien que hicieras un PR para resolverlo en esta versi√≥n. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] @emedina-mts hola, cuando hice la migraci√≥n a la v17 (creo que era esa) ya lo coment√© y lo modifiqu√© para esa versi√≥n, porque habia un problema en los tests y no se estaban ejecutando y por tanto no se detecta a el fallo, yo suger√≠ que hab√≠a que revisarlo en versiones anteriores. Porque no tenia claro si los signo tenian que ser todos en negativo o todos en positivo, simplemente modifique el xml para que los tests no dieran error, porque asum√≠ que los tests estaban correctos y en la pagina de hacienda aparentemente de las dos formas las validaba correctamente

Aunque ahora no recuerdo donde lo coment√© porque no encuentro los comentarios, pero si buscas el pr de la migraci√≥n y miras los cambios hechos en el xml, ver√°s que se han hecho cambios justamente para eso [SEP] #4012 incluye el parche para los signos."
Issue,3624,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3622,"Esto no ha cambiado, ya que nunca ha exportado el IBAN completo. Se est√° revisando si incluirlo si es compatible con todos aqu√≠: https://github.com/OCA/l10n-spain/pull/3332"
Issue,3610,"Fixed with PR #3609  [SEP] Closing the issue as there's a PR. Next time, you only need to put the PR explaining the issue there."
Issue,3607,"No uso todo el tema del pip y los artificios del setup que hace el pre-commit, pero borrando la carpeta del setup y lanzado pre-commit de nuevo, ha salido esto que debe solucionarlo:

https://github.com/OCA/l10n-spain/commit/8f6f52b14c12c98700cd25d4c0b007303991d036"
Issue,3605,"Creo que el flag a nivel de account.move.line es la opci√≥n m√°s factible. Pero el actual `with_vat_prorate` se utiliza para otro fin, que es para marcar el apunte generado por el sistema que es la parte de la cuota del impuesto que no se deduce.

Ese flag podr√≠a ser un computed writable y llamarse `apply_vat_prorate`, y que se cambie solo seg√∫n los impuestos puestos o el producto. Desplazar√≠amos la l√≥gica que se mira ahora mismo de qu√© impuestos y cuentas aplican la prorrata o no a este nuevo campo, y simplificar√≠amos el `_compute_all_tax` a solo mirar si tiene dicho campo marcado o no.

@etobella tambi√©n debe opinar aqu√≠, que √©l toc√≥ bastante este m√≥dulo en 14.0 [SEP] Gracias Pedro,

Perfecto, a ver si Enric puede corroborar la idoneidad del cambio. [SEP] A ver, mi conocimiento de la prorrata es el siguiente:

Existen 3 tipos de empresas

- Empresas normales
- Empresas con prorata general (se aplica la prorrata en todas las facturas de compra)
- Empresas con prorata especial (es el caso que explicas)

Todo lo que comentas afecta a la prorata especial. En la especial, al recibir una factura pueden darse 3 casos (de hecho deber√≠a hacerse l√≠nea a l√≠nea):

1- La factura no aplica prorrata - Actividad 2
2- Aplico la prorrata (o sea, que un porcentaje va a gastos directamente) - no queda claro que actividad es
3- Toda la factura va a gastos - Actividad 1

Por lo tanto, lo que deber√≠a hacerse a nivel de apunte es poner un campo de selecci√≥n (en blanco seria aplica prorata general) Este campo solo deberia aparecer si la compa√±√≠a tiene el flag de ""Prorata especial"" (as√≠ no cambia nada para la general)

WDYT? [SEP] Bueno, realmente puede ser prorrata general, pero hablar de l√≠neas de negocio. @AlbertCabedo es el caso de AEOdoo, ¬øno? ¬øO eso se considera prorrata especial? [SEP] > A ver, mi conocimiento de la prorrata es el siguiente:
> 
> Existen 3 tipos de empresas
> 
> * Empresas normales
> * Empresas con prorata general (se aplica la prorrata en todas las facturas de compra)
> * Empresas con prorata especial (es el caso que explicas)
> 
> Todo lo que comentas afecta a la prorata especial. En la especial, al recibir una factura pueden darse 3 casos (de hecho deber√≠a hacerse l√≠nea a l√≠nea):
> 
> 1- La factura no aplica prorrata - Actividad 2 2- Aplico la prorrata (o sea, que un porcentaje va a gastos directamente) - no queda claro que actividad es 3- Toda la factura va a gastos - Actividad 1
> 
> Por lo tanto, lo que deber√≠a hacerse a nivel de apunte es poner un campo de selecci√≥n (en blanco seria aplica prorata general) Este campo solo deberia aparecer si la compa√±√≠a tiene el flag de ""Prorata especial"" (as√≠ no cambia nada para la general)
> 
> WDYT?

Correcto, Enric. Entonces la propuesta (sin entrar en detalles t√©cnicos ya que no es este mi foco) podr√≠a ser:

1- Check en compa√±√≠a para establecer si se rige por prorrata especial (solo si tiene prorrata marcado).

2- En caso de que la compa√±√≠a tenga prorrata especial, en los apuntes contables habr√° el check para decidir si se aplica prorrata especial. Si el check de los apuntes no est√° marcado y la compa√±√≠a se rige por prorrata especial, los IVA soportados funcionar√°n SIN prorrata (es decir, un impuesto soportado ""normal"") .

- Ese es nuestro caso, en una misma factura hay impuestos soportados que se comportan SIN prorrata, pero hay apuntes con IVA soportado a los que S√ç se debe aplicar prorrata.

2.1- Si la compa√±√≠a no tiene marcado prorrata especial (pero s√≠ prorrata) se comportar√° como hasta ahora con prorrata general.

2.2- Obviamente, si la compa√±√≠a no tiene prorrata, se comportar√° normalmente. No se ver√° sujeta a esta casu√≠stica.

3- He aqu√≠ otra pregunta... lo har√≠ais en el mismo m√≥dulo? O en una extensi√≥n del tipo `l10n_es_vat_prorate_special` o similar? Personalmente creo que un nuevo m√≥dulo ser√≠a lo m√°s adecuado, para simplificar el c√≥digo del `l10n_es_vat_prorate` est√°ndar.

WDYT?
 [SEP] No puede ser un check en la l√≠nea, pk hay 3 casos distintos:

- Aplica prorata
- Todo va a gastos
- todo normal

Te lo pongo con un ejemplo:

Supongamos que tenemos una compa√±√≠a 2 actividades: Consultoria y Formaci√≥n y que tiene una prorata del 30%. Y tengo un √∫nico centro de trabajo.

Supongamos que recibo la factura de luz. Como no se a que actividad va, tengo que aplicar mi prorata. O sea, del IVA podremos desgravar el 30% y el otro 70% ir√° directamente a gastos

Ahora recibo una factura de mesas. Si las mesas son para la parte de consultoria, no aplica la prorata y todo lo podremos desgravar.

Si la factura de mesas fuera para usar en las aulas, al ir a la actividad de educaci√≥n, no puedo desgravarme los gastos. [SEP] > No puede ser un check en la l√≠nea, pk hay 3 casos distintos:
> 
> * Aplica prorata
> * Todo va a gastos
> * todo normal
> 
> Te lo pongo con un ejemplo:
> 
> Supongamos que tenemos una compa√±√≠a 2 actividades: Consultoria y Formaci√≥n y que tiene una prorata del 30%. Y tengo un √∫nico centro de trabajo.
> 
> Supongamos que recibo la factura de luz. Como no se a que actividad va, tengo que aplicar mi prorata. O sea, del IVA podremos desgravar el 30% y el otro 70% ir√° directamente a gastos
> 
> Ahora recibo una factura de mesas. Si las mesas son para la parte de consultoria, no aplica la prorata y todo lo podremos desgravar.
> 
> Si la factura de mesas fuera para usar en las aulas, al ir a la actividad de educaci√≥n, no puedo desgravarme los gastos.

Hola Enric, lo que comentas sobre la opci√≥n de ""Todo va a gastos"".

Seg√∫n lo que tengo entendido y nuestro caso:

- Aplica prorrata --> Ese apunte (esa l√≠nea de factura) si es para actividad que prorratee, se le desglosar√° el impuesto en 2 apuntes. Uno como IVA soportado ""normal"", y otro como m√°s valor de la base, para entendernos (un apunte en la cuenta de gastos).
- Todo normal --> Se comporta como un IVA soportado sin prorrateo.
- Todo va a gastos --> Este punto no lo entiendo. ¬øQu√© quieres decir que va todo a gastos?

En una misma factura, yo tengo los casos 1 y 2. ""Aplica Prorrata"" y ""Todo normal"" respectivamente.

Me falta por entender el caso de una l√≠nea de factura en la que ""Todo vaya a gastos"". ¬øA qu√© te refieres?

Gracias. [SEP] Me refiero a que ese IVA no ser√† desgravable y debe ir todo a gasto (como si tuvieras una prorata del 0%) [SEP] > Me refiero a que ese IVA no ser√† desgravable y debe ir todo a gasto (como si tuvieras una prorata del 0%)

Pero para eso ya tendr√≠amos el IVA no deducible. Por lo que no veo necesario que haya 3 opciones:

- IVA Soportado habitual.
- IVA Soportado que s√≠ se deba prorratear.
- Todo gasto --> Se puede resolver con los IVA soportados no deducibles, que ya existen.

¬øMe equivoco? ¬øO estamos mezclando conceptos? [SEP] y que haremos con los casos raros como el IVA de Bienes de inversi√≥n? [SEP] Pongamos un ejemplo.

**Contexto:**

- Soy la Compa√±√≠a 1.
- Llevo a cabo varias actividades. Unas afectadas por prorrata y otras no, por lo que me veo sujeto a la prorrata especial.
- Actividad 1 = Afectada por prorrata.
- Actividad 2 = NO afectada por prorrata.

Caso de uso:

- Me llega la factura mensual de mi proveedor 1, quien me agrupa muchos conceptos en una misma factura.
- En su factura tengo productos con IVA soportado.
- Pongamos que hay 2 conceptos/productos en esa factura.
- El IVA de estos productos, debo interpretarlos seg√∫n mi actividad, resumidamente:

1. Este producto es para mi sector de actividad NO afectado por la prorrata.
2. Este producto es para mi sector de actividad S√ç afectado por la prorrata.

Resoluci√≥n. C√≥mo entrar√≠a la factura en el sistema:

- En la l√≠nea del producto 1, no marcar√≠a el check de prorrata especial, por lo que no se ver√≠a afectado por la prorrata. Ser√≠a un IVA soportado habitual.
- En la l√≠nea del producto 2, marcar√≠a el check de aplicar prorrata especial, ya que en esta l√≠nea s√≠ querr√≠a aplicar la prorrata del IVA. Esto me har√≠a 2 apuntes contables: uno que se llevar√≠a la prorrata a la cuenta de impuesto y otro que coger√≠a la misma cuenta que la base (lo que te hage la funcionalidad de la prorrata, para entendernos).

Este ser√≠a un caso de factura con IVAs con prorrateo y sin prorrateo en la misma factura. El caso que me comentas t√∫, entiendo que se diferenciar√≠a de los productos 1 y 2, ¬øcorrecto? [SEP] correcto @pedrobaeza . 
Seg√∫n mi punto de vista, hablais todos de lo mismo y est√°is todos alineados. Respecto a un posible desarrollo entiendo lo siguiente:
1) si el gasto no es deducible, ya tenemos el Impuesto creado para ello, no hay que hacer nada
2) Si el gasto es deducible 100%, ya tenemos el impuesto creado para ello, no hay que hacer nada.
3) Aqui est√° el tema, si el gasto es ""com√∫n"" en ambas actividades, por ejemplo, el asesor, el abogado, o la luz, entonces se aplica prorrata en estos gastos. Se puede crear un impuesto para ellos o bien desarrollar alguna casilla u opci√≥n que permita aplicar prorrata a dichos gastos.

Como digo, todos dec√≠s lo mismo y est√°is en lo cierto, cualquier cosa o aclaraci√≥n un meet de 5 minutos y lo resolvemos seguro. gracias y buen finde! [SEP] Gracias @AlbertCabedo creo que ya tenemos un punto en com√∫n y pueden empezar a desarrollarlo.

@eantones puede que esto te interese  [SEP] > correcto @pedrobaeza . Seg√∫n mi punto de vista, hablais todos de lo mismo y est√°is todos alineados. Respecto a un posible desarrollo entiendo lo siguiente:
> 
> 1. si el gasto no es deducible, ya tenemos el Impuesto creado para ello, no hay que hacer nada
> 2. Si el gasto es deducible 100%, ya tenemos el impuesto creado para ello, no hay que hacer nada.
> 3. Aqui est√° el tema, si el gasto es ""com√∫n"" en ambas actividades, por ejemplo, el asesor, el abogado, o la luz, entonces se aplica prorrata en estos gastos. Se puede crear un impuesto para ellos o bien desarrollar alguna casilla u opci√≥n que permita aplicar prorrata a dichos gastos.
> 
> Como digo, todos dec√≠s lo mismo y est√°is en lo cierto, cualquier cosa o aclaraci√≥n un meet de 5 minutos y lo resolvemos seguro. gracias y buen finde!

Gracias Albert. Nos has despejado las dudas.

@pedrobaeza @etobella Entonces propongo lo que ya he comentado antes (sin entrar en detalles, sino a nivel conceptual):

1- Check en compa√±√≠a para establecer si se rige por prorrata especial (solo visible/seleccionable si la compa√±√≠a tiene prorrata marcado).

2- En caso de que la compa√±√≠a tenga prorrata especial, en las l√≠neas de factura (y en los apuntes) habr√° la posibilidad de marcar un check (`ya pensaremos si default=True o si default=False`). Yo optar√≠a porque pueda ser seleccionable `default=True/False` seg√∫n la compa√±√≠a, pero eso ya es m√°s un detalle de UI.

- Este check solo ser√° visible/seleccionable si la compa√±√≠a tiene marcada la opci√≥n de prorrata especial.
- Este check servir√° para decidir si el IVA aplicado a esta l√≠nea de factura (y en los apuntes) se prorratea o no se prorratea.
- En caso de estar marcado, el IVA se prorratea (S√ç se aplica prorrata).
- En caso de estar desmarcado, el IVA soportado se aplicar√° normalmente (NO se aplica prorrata).

3- Para terminar... ¬øHacemos m√≥dulo aparte? ¬øO en el mismo m√≥dulo? Yo creo que lo m√°s limpio seria hace un `l10n_es_vat_prorate_special` o similar, puesto que es un caso muy poco com√∫n.

WDYT?

 [SEP] Creo que no merece la pena separar en 2 m√≥dulos. No se gana tanto en este caso. [SEP] OK. Empezamos a planificar la apertura de nuevo PR. A priori, a falta de estudio en detalle:

- A√±adir el check en compa√±√≠a, para determinar si se est√° afectado por prorrata especial.
- A√±adir los cambios necesarios en facturas y apuntes.
- A√±adir los cambios necesarios a nivel de UI.
- Ampliar README.
- A√±adir tests.

Todo como IMP del m√≥dulo ya existente `l10n_es_vat_prorate` [SEP] Ahora que tenemos hecho esto, vamos a hacer comprobaciones en el m√≥dulo l10n_es_aeat_mod303_vat_prorate, para validar que todo d√© como tiene que dar. [SEP] Implementado."
Issue,3589,"Por si le arroga luz a alguien: un par de clientes nos lo han reportado pero no pasa desde todas las m√°quinas. Este comando es equivalente a la llamada que recibe timeout en los tests que mencionas:
```
wget https://egoitza.gipuzkoa.eus/ogasuna/sii/ficheros/v1.1/SuministroFactRecibidas.wsdl -O-
```
En mi PC (por poner un ejemplo) funciona correctamente pero un par de clientes no. No s√© si hacienda est√° baneando determinadas IPs o es un problema de enrutado m√°s general. [SEP] Gracias por la informaci√≥n. Desde mi PC tambi√©n funciona. A lo mejor como dices han puesto una lista de denegados. Estoy reintentando en estos momentos un CI, y si sigue fallando, voy a excluir la agencia de los tests porque nos est√° bloqueando todos los PRs, a falta de saber los motivos. [SEP] Nos acaba de llegar esto desde hacienda:

> Buenos d√≠as,
>
> Desde la ma√±ana del pasado viernes d√≠a 17 estamos teniendo algunos problemas de conectividad. Estamos trabajando para solventarlos en la mayor brevedad posible.
>
> Esta incidencia se tendr√° en cuenta, en su caso,  a todos los efectos del cumplimiento de las obligaciones tributarias.
>
> Disculpen las molestias ocasionadas. [SEP] Hacienda Gipuzkoa notifica que los problemas de conectividad ya est√°n resueltos. @pedrobaeza, si lo puedes confirma se podr√≠a cerrar este ticket sin problemas. [SEP] Veamos a ver si ya vuelven a funcionar los tests correctamente: https://github.com/OCA/l10n-spain/pull/3602 [SEP] Pues s√≠, efectivamente ya funciona de nuevo. Lo he dejado restablecido en 16.0, pero para las versiones anteriores creo que lo voy a dejar desactivado como ya tenemos el chivato en caso de que vuelva a fallar, y as√≠ no paralizamos tantas ramas en caso de que vuelva a pasar."
Issue,3565,"Hola, eso ocurre si actualizas c√≥digo y reinicias servicio, pero no actualizas m√≥dulo dentro de la instancia para que se reflejen los cambios de estructura de la base de datos. Es algo est√°ndar de todo Odoo.

Cierro, al no tratarse de un error del m√≥dulo."
Issue,3560,"Hola, OCA no se hace garante de nada.

Tendr√° que ser el propio integrador, o en su defecto, el usuario (el cliente) el que se hace garante del software."
Issue,3552,"Hola, realiza por favor la pregunta en el foro de AEOdoo (https://www.aeodoo.org/forum), ya que este espacio es para bugs/problemas con el c√≥digo."
Issue,3551,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3539,"Hola Gelo, gracias por el reporte.

¬øSolo falla en V16? ¬øO te has encontrado lo mismo en V15, por ejemplo?

Saludos. [SEP] Fusionado el FIX --> https://github.com/OCA/l10n-spain/pull/3540"
Issue,3538,"Lo tienes en #3534  [SEP] Perd√≥n, #3359, que tengo foll√≥n por lo de la separaci√≥n de PRs."
Issue,3533,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3527,"De hecho, mirando el listado de todas las retenciones que existen para la localizaci√≥n espa√±ola, existen un mont√≥n que a dia de hoy no deber√≠an existir. Este es el listado de las retenciones existentes en 2024 segun l'AEAT:

https://sede.agenciatributaria.gob.es/static_files/Sede/Programas_ayuda/Retenciones/2024/Cuadro_tipos_retenciones_IRPF2024.pdf [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Relacionado con IRPFs, me he encontrado con un caso donde el r√©gimen del contacto es de canarias pero tambi√©n hay que aplicarle IRPF X% y por lo tanto no lleva IVA. La soluci√≥n que me viene inmediatamente a la cabeza es una posici√≥n fiscal que mapee a impuestos de canarias (**sin IVA**) y adem√°s aplique el IRPF. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3522,"@HaraldPanten @pedrobaeza  [SEP] > account_demo

https://github.com/odoo/odoo/blob/17.0/addons/account/demo/account_demo.py [SEP] @manuelregidor respecto a esa factura ¬øque es diferente o porque realiza que fallen los test? Es algo raro que antes no fallara y ahora si ¬øpodr√≠a haber otra causa? [SEP] @ValentinVinagre Porque aplica en las l√≠neas impuestos que se tienen en cuenta en el 303, por lo que no solamente se genera el informe con los datos creados en los tests del m√≥dulo del 303 sino tambi√©n con los de la info de demo. [SEP] Una soluci√≥n directa es cambiar la fecha de los datos de los tests para que sea del a√±o pasado, y as√≠ no hay solape. [SEP] > Una soluci√≥n directa es cambiar la fecha de los datos de los tests para que sea del a√±o pasado, y as√≠ no hay solape.

Si realizamos eso ¬øNo podr√≠a pasar que no podamos testear correctamente nuevos mapeos de impuestos? 
Es decir: si por ej. tenemos mapeos de esta manera:
mapeo1: 1/1/2010 - 31/12/2020
mapeo2: 1/2/2021 - actual

Aqu√≠ se podr√≠a poner las facturas de test en fecha 1/1/2021 sin problema. Pero, si entrase un mapeo nuevo por ej:
mapeo1: 1/1/2010 - 31/12/2020
mapeo2: 1/2/2021 - 31/12/2023
mapeo3: 1/1/2024 - actual

Si ponemos las fechas de facturas en a√±os pasados... no podremos testear correctamente esos mapeos actuales. Si no es que para los tests hacemos la jugada de ... dejar siempre el √∫ltimo mapeo y forzar unas fechas espec√≠ficas correspondiente a los tests.

¬øcomo lo ves?
 [SEP] Ya, claro, ese problema estaba presente en anteriores versiones y de hecho por eso puse la fecha actual y tuve que cambiar el resultado de los tests cuando migr√©, porque hab√≠a definiciones de mapeos de impuestos m√°s modernos, pero lo dec√≠a como soluci√≥n inmediata.

Otra opci√≥n ser√≠a por SQL hacer un borrado de impuestos en las facturas existentes para sin mucha complicaci√≥n, que no interfieran. [SEP] Veo mejor pensar una soluci√≥n un poco m√°s a largo plazo, total ahora estamos a tiempo, ya que se est√° realizando toda la migraci√≥n y no tenemos clientes con una alta urgencia de estas necesidades.
Por lo que hemos comentado veo las siguientes opciones:

1.- En los test's de los modelos siempre testear el √∫ltimo mapeo, borrar los anteriores y indicar siempre una fecha espec√≠fica para que no interfiera lo de Odoo. (esta es la que veo que menos problemas nos podr√≠a dar y que es la ""las estable"").
2.- Realizar un borrado por sql (o similar) de todos los impuestos aplicados en las facturas creadas por Odoo. Esto ... no me acaba de gustar del todo, ya que se podr√≠a interferir en los posibles testeos futuros de otros m√≥dulos o si Odoo en un futuro cambia esto... ¬øpodr√≠a ser problem√°tico?
3.- Cambiar fechas en las facturas de los tests actuales.
4.- Cambiar los test's para que de alguna manera se identifiquen las facturas que no tendr√≠an que entrar para los test's de los modelos de OCA. Por ej. ¬øen el aeat se podr√≠a indicar una funci√≥n de filtrado de todo esto?

Por el momento veo esto ...  No se si veis alguna opci√≥n m√°s. 
 [SEP] 2 no es problem√°tico, porque se deshace todo en cuanto termina el test espec√≠fico. [SEP] > 2 no es problem√°tico, porque se deshace todo en cuanto termina el test espec√≠fico.

La idea ser√≠a ponerlo en el l10n_es_aeat para que lo recojan el resto de m√≥dulos de la l10n-spain de oca o en cada m√≥dulo que tenga problemas? [SEP] Se puede poner en el test aeat base. Igualmente lo deshar√° en cada test hijo que lo herede."
Issue,3521,"*** Editado punto 4 y a√±adido punto 5. [SEP] Hola @SoniaViciana 

Entiendo los problemas que indicas, sobre todo los que tienen que ver con las sesiones que cierran al dia siguiente. Donde los apuntes se van a quedar en una fecha distinta a la del envio del SII de algunas facturas simplificadas.
Lo que no tengo muy claro es la propuesta de soluci√≥n usando el **l10n_es_aeat_sii_invoice_summary** por que hacer un apunte con el resumen de lo que hay que enviar al SII, ¬øsupone duplicar la informaci√≥n contable? 
Como dices verifactu ha excluido a las empresas adscritas al SII pero no se hasta cuando van a permitir seguir enviando un asiento resumen a los del SII cuando a los dem√°s les van a exigir enviar todas las facturas...

En cualquier caso, es cierto que hay algunos problemas con esta implementaci√≥n que habr√≠a que revisar, tal vez podr√≠amos esperar a ver la implementaci√≥n del verifactu en el pos por que habr√° que tocar tambi√©n cosas para enviar cada una de las facturas simplificadas por separado.

Un saludo
 [SEP] Hola @anmarmo1 

En la propuesta de soluci√≥n, la idea ser√≠a no duplicar, si no dotar al asiento agrupado de facturas simplificadas que ya genera el TPV, de la informaci√≥n / l√≥gica faltante para que sea una factura de venta a todos los efectos. Completando a su vez los campos de `l10n_es_aeat_sii_invoice_summary` (primer y √∫ltimo n√∫mero de factura simplificada).
Sin embargo... esto se tiene que sopesar, porque har√≠a el SII del TPV incompatible con `l10n_es_pos_by_device` (m√∫ltiples dispositivos por sesi√≥n en el punto de venta). 

Entonces, lo cierto es que hay que pensarse bien qu√© conviene m√°s, sabiendo los pros y los contras de cada opci√≥n (esto es lo que pretendo en este issue). En todo caso, iremos informando. La opci√≥n 2 no es algo que tengamos pensado abordar a corto plazo.

Saludos, [SEP] Lo suyo ser√≠a que se discutiera esto en los Spanish OCA Days. Sonia, convence a tu jefe para que vay√°is para all√°... [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3520,"Detalla de los cambios comentados sobre el 123 en https://github.com/OCA/l10n-spain/issues/3227 [SEP] Gracias @ArantxaSudon @rafaelbn . Abr√≠s PR? [SEP] @HaraldPanten , podemos empezar a trabajar en esto el lunes a primera hora. Esta semana no podemos empezar. [SEP] > @HaraldPanten , podemos empezar a trabajar en esto el lunes a primera hora. Esta semana no podemos empezar.

Sin problema, cuando os vaya bien. Nosotros estamos con la migraci√≥n a V17. Si os encarg√°is del nuevo formato en V16, por ejemplo, ya lo a√±adimos en el PR de migraci√≥n para la nueva.

Gracias! [SEP] @HaraldPanten PR en https://github.com/OCA/l10n-spain/pull/3528 [SEP] @rafaelbn @HaraldPanten  dejo captura del excell utilizado en V16 para incorporar los cambios por si sirve de ayuda

![Captura desde 2024-04-15 12-20-06](https://github.com/OCA/l10n-spain/assets/104626993/81c42c25-6876-494e-b015-bdf8a8528e73)
 [SEP] Realizado en #3528"
Issue,3518,"Buenas tardes @greciosd, por lo que he podido comprobar es correcto que ambas cuentas tengan el mismo c√≥digo, pero claramente no es correcto que ambas se carguen en el paquete ""sin √°nimo de lucro"". En el plan general la cuenta 4707 corresponde a ""Hacienda P√∫blica, deudora por IGIC"" y en el plan ""sin √°nimo de lucro"" la cuenta 4707 corresponde a ""Hacienda P√∫blica, deudora por colaboraci√≥n en la entrega y distribuci√≥n de subvenciones (art.12 Ley de Subvenciones)"". Voy a proponer un PR para sacar las cuentas 4707 y la cuenta 4757 del common, para poder asignarlas a nivel del hijo. [SEP] El PR en concreto: https://github.com/OCA/l10n-spain/pull/3523"
Issue,3514,"Hola, Loia, creo recordar que se quit√≥ porque la AEAT no quer√≠a tener el campo rellenado en ese caso. Entonces el parche ser√≠a que no fuera visible para el tipo `I`. Probadlo si es correcta mi hip√≥tesis y nos dec√≠s. [SEP] Por ahora el tipo ""I"" no es visible. Pero s√≠ deber√≠a serlo. Seg√∫n la AEAT, esta es la nueva normativa: 
![imagen](https://github.com/OCA/l10n-spain/assets/104626797/3d886030-fa3c-44d2-b78b-5455cfbdadf7)
https://sede.agenciatributaria.gob.es/Sede/todas-gestiones/impuestos-tasas/iva/modelo-303-iva-autoliquidacion_/instrucciones.html

Si la opci√≥n es a domiciliar, debe estar indicada la cuenta bancaria. 
Ahora el c√≥digo est√° as√≠: https://github.com/OCA/l10n-spain/blob/fc2a79ffe96832030fffed3c3d41b251ba63d12c/l10n_es_aeat_mod303/data/2023/aeat.model.export.config.line.csv#L123 (_l√≠nea 123; columna: expression_) 
Solo es visible con el `result_type` X y D

Gracias [SEP] OK, pues adelante con el PR si lo ten√©is claro."
Issue,3507,"@etobella si no recuerdo mal, lo incluiste t√∫ para evitar una incompatibilidad. [SEP] No entiendo el problema :thinking: que tiene que ver el manifest de la 15 si estas instalando 16. 

De hecho, usamos la misma versi√≥n que define Odoo en sus requirements. https://github.com/odoo/odoo/blob/16.0/requirements.txt#L5

As√≠ que para mi no hay ning√∫n bug.

Debemos recordar que por eso hay cambio de versiones... Las dependencias pueden cambiar entre versiones mayores (lo intentamos evitar en menores...) [SEP] @etobella la indicaci√≥n a la rama 15 es por indicar las diferencias entre una rama que no da ning√∫n problema (la cual en su manifest no solicita ninguna version de cryptography en concreto) realizando la instalaci√≥n con una que si las esta dando.

La √∫nica diferencia apreciable entre versiones es la obligaci√≥n de versi√≥n de la dependencia que aunque estando la misma versi√≥n que requiere odoo y en el sistema la misma, esa indicaci√≥n de version es la que genera el fallo que salta el error de que no esta instalada (aunque si lo esta)

Como se ha indicado, los pasos han sido los siguientes:

Instalaci√≥n de odoo 16 CE con sus requirements, su funcionamiento es correcto
Descarga del repositorio l10n_spain e instalaci√≥n de sus requirements, cuando se va a los modulos mencionados salta el mensaje de que esa versi√≥n no esta instalada.

Si eliminamos del manifest la versi√≥n, dejando solo indicado la dependencia cryptography funciona correctamente la instalaci√≥n

Queremos dejar claro que este problema no es a nivel del fichero requirements.txt sino en los archivos __manifest__.py [SEP] El problema esta en tu instalacion. Odoo requiere esa version, por eso esta congelado. [SEP] @iTecan efectivamente si se instala con las versiones indicadas tanto en el requirements.txt de Odoo como en el manifest, todo funciona correctamente, as√≠ que cierro. Revisa por favor tu procedimiento de despliegue para ver si est√°s instalando por otro lado una versi√≥n sin congelar de `cryptography`, y tendr√°s que indicar dicha versi√≥n. Me suena que utilizas Doodba, as√≠ que ser√≠a en el archivo pip.txt indicar `cryptography==3.4.8` en lugar de solo `cryptography`.

Cierro entonces la issue."
Issue,3500,
Issue,3483,"Hola, esto no es ninguna issue del m√≥dulo, por lo que √©ste no es el lugar adecuado para hacer este tipo de solicitudes. Prueba a ponerlo en los foros de AEOdoo: https://www.aeodoo.org/forum. De todas formas, creo que este tipo de cosas son las que debe aportar cada uno como empresa implantadora de Odoo, y no tengo claro que alguien os conteste al respecto. Estamos muchos que ni trabajamos en esa zona, y los dem√°s ya han aportado el software como gesto solidario."
Issue,3482,"Envase no debe ser la traducci√≥n para `product.packaging`: https://dle.rae.es/envase. Empaquetado era correcto IMO. [SEP] Precisamente consultamos la RAE a la hora de hacer esa elecci√≥n. [La traducci√≥n para empaquetado](https://dle.rae.es/empaquetado) indica √∫nicamente:

> Acci√≥n y efecto de empaquetar.

Normalmente, en los contextos mencionados, el que conlleva una ""acci√≥n y efecto"" es m√°s bien el contexto de inventario. Pongamos el caso de un supermercado:
- Los operarios de almac√©n har√°n la ""acci√≥n y efecto de [des]empaquetar"" al abrir los pallets, que quiz√°s vengan envueltos en pl√°stico, y colocar las cajas en estanter√≠as, o ""acciones"" similares.
- En cambio, las fresas ya las compran ""envasadas"" en cajitas de 500g, no es una ""acci√≥n"" que ellos hagan.

En cualquier caso, obviamente son t√©rminos casi equivalentes, y el problema de escoger ""empaquetado"" es que deja la inc√≥gnita de qu√© escoger para la otra parte: la de stock. [SEP] En stock (`stock.quant.package`), est√° puesto ""paquete"". Para `product.packaging`, se habla de ""empaquetado"", por lo que est√°n diferenciados. Creo que ""envase"", aunque su tercedra acepci√≥n lo puede permitir, queda poco natural. Ejemplo: tenemos un cliente que vende guantes de protecci√≥n, y los vende empaquetados de 5 en 5. Hablar de envase de 5 pares de guantes quedar√≠a muy raro. Tambi√©n envase se relaciona muchas veces con l√≠quidos. [SEP] > Envase no debe ser la traducci√≥n para `product.packaging`: https://dle.rae.es/envase. Empaquetado era correcto IMO.

Yo aqu√≠ discrepo üòÖ. Me explico:

- En funci√≥n de la definici√≥n que das de la RAE creo que encaja en la segunda acepci√≥n. Por ejemplo, caja de 6 unidades en la venta de manzanas que es un producto que se vende por Kg.
![image](https://github.com/OCA/l10n-spain/assets/147538094/8e333f74-d23b-4e1c-ad80-91a96465fad7)

- Respesto a ""Empaquetado"" la RAE dice:
![image](https://github.com/OCA/l10n-spain/assets/147538094/4cf19bdd-7a8f-4743-9660-4447e23acf3b)

- Si miramos empaquetar, creo que tambi√©n la segunda acepci√≥n encaja con lo que @yajo dice en el ejemplo: Nos han llegado al almac√©n 100 envases de 200g de jam√≥n, empaquetados en 4 cajas.
![image](https://github.com/OCA/l10n-spain/assets/147538094/fbb7158a-a917-478e-abda-b50e8ac7cbe3)

Saludos,
 [SEP] Lo dicho, Gelo, t√∫ nunca hablar√≠as de envase de 5 pares de guantes, ¬øa que no? [SEP] > En stock (`stock.quant.package`), est√° puesto ""paquete"". Para `product.packaging`, se habla de ""empaquetado"", por lo que est√°n diferenciados.

Sobre el papel, son t√©rminos diferentes; pero en realidad, paquete y empaquetado no est√°n bien diferenciados. Si lo estuvieran, nunca hubi√©ramos necesitado preocuparnos de este asunto...

""Paquete"" es el sustantivo y ""empaquetar"" es el verbo, pero ambas se refieren a la misma cosa. De hecho, [la primera definici√≥n de empaquetar](https://dle.rae.es/empaquetar) es ""hacer paquetes"".

> Creo que ""envase"", aunque su tercedra acepci√≥n lo puede permitir, queda poco natural.

Del mismo modo, cuando hablamos de ""empaquetados"", hay contextos en que no queda natural. Ejemplo: Vendo aceite empaquetado en botellas de 1, 5 y 10 L. Obviamente, en este contexto queda mejor ""envasado"".

Tambi√©n hay contextos en que queda exactamente igual de bien tanto el uno como el otro:
- Vendo jam√≥n empaquetado en bl√≠sters de 200g.
- Vendo jam√≥n envasado en bl√≠sters de 200g.

Y hay otros en los que queda igual de mal uno que el otro:
- Vendo jam√≥n empaquetado en pata de 7kg.
- Vendo jam√≥n envasado en pata de 7kg.

Por eso dec√≠a al principio:

> Obviamente no encajar√° siempre con cada caso de uso, pero m√°s o menos se puede llegar a entender.
> 
> Creemos que lo m√°s importante es tener un est√°ndar, que la traducci√≥n sea homog√©nea, y que se distinga f√°cilmente entre modelos y usos, sin confundir.

Creo que el espa√±ol es un idioma suficientemente rico como para poder usar 2 terminolog√≠as totalmente diferentes y as√≠ ayudar a nuestros usuarios a entender la diferencia.

En fin, todo esto que estamos comentando no es en contra de lo que dices, @pedrobaeza, sino simplemente estamos expresando p√∫blicamente el mismo an√°lisis que ya hicimos internamente y que luego nos llev√≥ a la conclusi√≥n de que la usabilidad de Odoo mejorar√≠a llamando ""envase"" a `product.packaging` que llam√°ndolo ""empaquetado"". [SEP] Pero curiosamente los casos en los que queda peor envase afectan a mis clientes, y supongo que envasado quedar√° mejor en los vuestros. A ver qu√© opina m√°s gente al respecto. [SEP] Bueno, tampoco es tan as√≠. Quiero decir que no a todos nuestros clientes les encaja perfecto ""envase"". Incluso, para ciertos clientes les encaja bien en unos productos y mal en otros.

La cuesti√≥n aqu√≠ no es si le va mejor o peor a nuestros clientes. La cuesti√≥n es mejorar la usabilidad general de Odoo permitiendo al usuario diferenciar apropiadamente entre 2 funcionalidades independientes, que tienen nombres demasiado parecidos. [SEP] Ya, yo es lo que intento tambi√©n, con unos t√©rminos lo m√°s adecuados posibles, teniendo en cuenta que no siempre va a casar al 100%. En muchos sitios te est√°s refieriendo como ""envasado"" en lugar de ""envase"", que es el cambio que plante√°is, con lo que ah√≠ ya tambi√©n se desfigura la idoneidad de esa palabra, porque as√≠ queda mejor en las frase formuladas. La cuesti√≥n es que en Odoo solo tenemos una palabra en la columna, y entre ver ""Envase"" o ver ""Empaquetado"" en dicha columna, yo sigo decant√°ndome por la √∫ltima, pero lo dicho, a ver qu√© opina otra gente. [SEP] > Lo dicho, Gelo, t√∫ nunca hablar√≠as de envase de 5 pares de guantes, ¬øa que no?

Hola Pedro, no te discuto que en alguna ocasi√≥n puede ser confuso, pero tambi√©n puede ser porque no usamos la palabra adecuada. 

Seg√∫n chat GPT:
Los t√©rminos ""paquete"" y ""envase"" son com√∫nmente utilizados en el contexto del embalaje de productos, pero tienen significados ligeramente diferentes:

**- Envase:**
  - Un envase se refiere espec√≠ficamente al contenedor f√≠sico utilizado para contener y proteger un producto. Puede ser cualquier tipo de recipiente, como una botella, una lata, una caja, una bolsa, etc.

  - El envase cumple funciones importantes, como proteger el producto de da√±os f√≠sicos, contaminaci√≥n, p√©rdida de frescura y deterioro durante el transporte y el almacenamiento.
  - Adem√°s de proteger el producto, el envase puede tener un papel en la promoci√≥n y la comercializaci√≥n del producto, ya que a menudo lleva informaci√≥n sobre el producto, instrucciones de uso, etiquetas de advertencia, dise√±os gr√°ficos para atraer a los consumidores, etc.

**-Paquete:**
  - El t√©rmino ""paquete"" se utiliza m√°s ampliamente para referirse al conjunto completo de materiales de embalaje que rodean y contienen un producto. Esto incluye no solo el envase primario que contiene directamente el producto, sino tambi√©n cualquier envoltura secundaria o material de relleno utilizado para proteger y presentar el producto.
  - Un paquete puede incluir varios niveles de embalaje, como el envase primario (la botella, la lata, etc.), el envase secundario (la caja que contiene varias unidades del producto), y el embalaje de transporte (cartones, relleno protector, etc.).
  - El paquete se dise√±a teniendo en cuenta tanto la protecci√≥n del producto como la eficiencia en t√©rminos de almacenamiento, transporte y manipulaci√≥n.

En resumen, **mientras que el ""envase"" se refiere espec√≠ficamente al contenedor f√≠sico que contiene el producto, el ""paquete"" se refiere al conjunto completo de materiales de embalaje que rodean y contienen el producto, incluyendo el envase primario, cualquier envoltura secundaria y el embalaje de transporte.**

As√≠ que yo creo que la RAE y Chat GPT van m√°s a favor de la propuesta de @yajo  [SEP] > En muchos sitios te est√°s refieriendo como ""envasado"" en lugar de ""envase""

Gracias, he actualizado algunas traducciones para que digan ""envase"". Creo que puse ""envasado"" por inercia al ver ""empaquetado"". üòÖ 

En cualquier caso, no era un gran problema. Precisamente, al usar 2 familias completamente diferentes de palabras, ya no se vuelve tan relevante diferenciar si uno usa el sustantivo o el verbo. [SEP] Ante la falta de opiniones de m√°s empresas, y puesto que Jairo volvi√≥ a cambiar todos los t√©rminos en Transifex a la siguiente semana, lo dejaremos as√≠ por el momento. [SEP] OK Gracias ‚ù§Ô∏è üòä "
Issue,3480,"Este caso parece complejo. 
Entiendo lo que comentas, y siendo as√≠, seria conveniente hacer la mejora en el POS.
Si haces alguna propuesta de mejora y necesitas ayuda para hacer pruebas y review estoy disponible üôÇ
 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3475,"Indicada la incompatibilidad en el ROADMAP: https://github.com/OCA/l10n-spain/commit/fc2f5838f308ce36cd9f597d464e23bda5e8be9d

Cierro y el que quiera solucionar dicho caso, puede poner un PR al respecto."
Issue,3474,"Por favor no abras issues nuevos teniendo una issue (y adem√°s fijada) para controlar dicho progreso. Se seguir√° progresando en el tema, pero no hay fechas cerradas."
Issue,3459,"Aunque no est√°s indicando el m√≥dulo, por el trozo de error, est√°s creando la base de datos con c√≥digo de Odoo core obsoleto. Actualiza dicho c√≥digo. [SEP] Me refer√≠a a l10n_es_facturae. Correcto, al actualizar l10n_es s√≠ es posible instalar l10n_es_facturae. Gracias!"
Issue,3456,#3472 - correcci√≥n v14.0 [SEP] Cerrado por mergeo
Issue,3455,"Seg√∫n veo en la definici√≥n de la exportaci√≥n, tiene para aplicar el signo:

https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_aeat_mod347/data/aeat_export_mod347_partner_data.xml#L178-L180

![image](https://github.com/OCA/l10n-spain/assets/7165771/39400832-dc2d-41f8-817b-72175d0a4f20)

¬øLo tienes as√≠ definido en la BD en la que est√°s exportando? [SEP] @pedrobaeza  si lo tengo as√≠
![image](https://github.com/OCA/l10n-spain/assets/84158523/b732e7fa-f2ba-4eee-9189-eaf59ad923f0)
 [SEP] Pues entonces deber√≠a exportar con la N delante... ¬øLo que muestras arriba es ese campo de importe de las operaciones o es alg√∫n otro? [SEP] Solo me han pasado esa captura. Tranquilo ya lo reviso yo, era solo confirmar que tiene que salir en negativo en el documento. [SEP] Pero si por la posici√≥n (despu√©s de la ""B"") tiene que ser ese campo [SEP] @pedrobaeza He estado revisando el tema y creo que el problema est√° aqui:
https://github.com/OCA/l10n-spain/blob/035a1f9d5525f2e043d5991e8d89a36f8754261f/l10n_es_aeat_mod347/data/aeat_export_mod347_partner_data.xml#L176

La funci√≥n abs hace que el valor siempre sea positivo, ¬øsabes si hay alg√∫n motivo para esto o se puede modificar? [SEP] Veo que ese cambio lo hice aqu√≠:

https://github.com/OCA/l10n-spain/commit/2102ab1207fb8ed546c4ac9b468c25b02c14f733

y es que antes hab√≠a `abs` en el c√≥digo, pero no veo la raz√≥n que me llevo a poner el `abs` en la exportaci√≥n del BOE. No tiene demasiado sentido visto ahora, y puede que fuera un ""por si acaso"". Creo que no ha impactado hasta ahora porque no es lo habitual que salgan registros con negativo. Arreglado en #3467 (y posteriores fw-port)."
Issue,3452,"Creo que la soluci√≥n es actualizar la libreria **xmlsig**, nos encontremos un problema similar y actualmente tenemos la version 1.0.1 y dejo de dar ese error. [SEP] La librer√≠a xmlsig esta actualizada, como comente antes [SEP] El mismo problema en Odoo 16.  Comparando el fichero firmado con autofirma y el fichero firmado con Odoo veo que autofirma usa el sha-256 mientras que el que me sale de odoo usa sha1. No s√© donde se cambia eso en Odoo. [SEP] Tras varias confirmaciones, el m√≥dulo no tiene problemas en si. La problem√°tica puede venir de las versiones criptogr√°ficas, o del certificado subido (como le ha ocurrido a https://www.aeodoo.org/forum/localizacion-espanola-3/error-gestion-certificado-en-odoo-16-docker-1501).

Entonces cierro esta issue, al no tratarse de algo de c√≥digo de este repositorio."
Issue,3451,"Caso bastante especial sin duda... Creo que no habr√≠a que hacer una factura, si no un asiento, pero efectivamente har√≠a falta un impuesto nuevo con cuota 0 y mapearlo en el 347 si no hay ninguno de los existentes que pueda valer. [SEP] S√≠, un caso especial, y con el Kit Digital creo que ser√° un problema para mucha gente, pues hay que informarlo en el 347 cuando supere los 3.000‚Ç¨...

Con meter el impuesto en el apunte de la 4708 tambi√©n he probado y no funciona bien, no s√© si hice algo mal, al poner el impuesto directamente en el apunte contable, a parte que hay que poner igualmente la empresa que otorga la subvenci√≥n y por tanto y crear el cliente igualmente, con su CIF y su direcci√≥n correcta (en el caso del Kit Digital ser√≠a ENTIDAD P√öBLICA EMPRESARIAL RED.ES), en el 347 el importe global lo pone correcto, pero en el desglose trimestral lo pone en negativo y considera el apunte como el de una rectificativa. 

Por otro lado en mi caso la factura ayuda mucho para saber cu√°nto falta por cobrar de la subvenci√≥n y poner claridad en el asunto, es una factura que hay que cobrar, tienes un sitio donde sabes todas las subvenciones que has recibido, tienes el control en cuentas de clientes, etc...

---

El asiento del Kit precisamente es un poco complejo, lo pongo aqu√≠ por si da alguna pista (disclaimer!! esto es seg√∫n lo que me ha recomendado a mi la gestor√≠a, como dice gpt, mejor consultar con un experto en contabilidad antes de tocar nada :)

Asiento de la factura del proveedor:

|Cuenta | Empresa | Etiqueta | Impuesto (cuota) | Impuestos | Cuenta anal√≠tica | Monto moneda | Moneda | Debe | Haber | Fecha vencimiento
|-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
|¬† | ¬† | ¬† | ¬† | ¬† | ¬† | ¬† | ¬† | 2.416,37 | 2.416,37 | ¬†
|4100156 Agente Digitalizador SL | Agente Digitalizador SL | / | ¬† | ¬† | ¬† | 0,00 | ¬† | 0,00¬†‚Ç¨ | 2.416,37¬†‚Ç¨ | 01/07/2023
|472000 Hacienda P√∫blica. IVA soportado | Agente Digitalizador SL | 21% IVA soportado (servicios corrientes) | 21% IVA soportado (servicios corrientes) | ¬† | ¬† | 0,00 | ¬† | 419,37¬†‚Ç¨ | 0,00¬†‚Ç¨ | 01/07/2023
|206000 Aplicaciones inform√°ticas | Agente Digitalizador SL | Kit digital | ¬† | 21% IVA soportado (servicios corrientes) | ¬† | 0,00 | ¬† | 1.997,00¬†‚Ç¨ | 0,00¬†‚Ç¨ | 01/07/2023

Asiento de factura de la subvenci√≥n, te√≥ricamente se podr√≠a hacer a mano, pero entonces al menos en mi caso, el 347 lo considera una factura rectificativa:

|Cuenta | Empresa | Etiqueta | Impuesto (cuota) | Impuestos | Cuenta anal√≠tica | Monto moneda | Moneda | Debe | Haber | Fecha vencimiento
|-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
|¬† | ¬† | ¬† | ¬† | ¬† | ¬† | ¬† | ¬† | 1.997,00 | 1.997,00 | ¬†
|430041 ENTIDAD P√öBLICA EMPRESARIAL RED.ES | ENTIDAD P√öBLICA EMPRESARIAL RED.ES | / | ¬† | ¬† | ¬† | 0,00 | ¬† | 1.997,00¬†‚Ç¨ | 0,00¬†‚Ç¨ | 05/07/2023
|470804 HP Deudora Subvenciones Kit Digital 2023/.../... | ENTIDAD P√öBLICA EMPRESARIAL RED.ES | Subvencion 2023/.../... 141-KD000... | ¬† | Subvenciones | ¬† | 0,00 | ¬† | 0,00¬†‚Ç¨ | 1.997,00¬†‚Ç¨ | 05/07/2023

Asiento manual para poder cuadrar el pago de las facturas (el iva se paga directamente al agente digitalizador):


|Cuenta | Empresa | Etiqueta | Impuesto (cuota) | Impuestos | Cuenta anal√≠tica | Monto moneda | Moneda | Debe | Haber | Fecha vencimiento
|-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
|¬† | ¬† | ¬† | ¬† | ¬† | ¬† | ¬† | ¬† | 1.997,00 | 1.997,00 | ¬†
|4100156 Agente Digitalizador SL | Agente Digitalizador SL | Traspaso saldo proveedor subvenci√≥n Kit Digital 2023/.../... para conciliar el pago de facturas | ¬† | ¬† | ¬† | 0,00 | ¬† | 1.997,00¬†‚Ç¨ | 0,00¬†‚Ç¨ | 05/07/2023
|430041 ENTIDAD P√öBLICA EMPRESARIAL RED.ES | ENTIDAD P√öBLICA EMPRESARIAL RED.ES | Traspaso saldo proveedor subvenci√≥n Kit Digital 2023/.../... para conciliar el pago de facturas | ¬† | ¬† | ¬† | 0,00 | ¬† | 0,00¬†‚Ç¨ | 1.997,00¬†‚Ç¨ | 05/07/2023

 [SEP] Hola, Miquel, lo que pones es de cara a la empresa receptora del KD, ¬øverdad? El que vaya a la cuenta 4300 no me cuadra. @AlbertCabedo te has encontrado con este caso? [SEP] @pedrobaeza si, esto es para la empresa receptora del KD.

Por lo que nos ha explicado nuestra gestor√≠a, hay que tener en cuenta que existen dos movimientos:
- La empresa que solicita el KID obtiene una subvenci√≥n de 2.000‚Ç¨ de la ENTIDAD P√öBLICA EMPRESARIAL RED.ES. Por tanto, a efectos pr√°cticos, RED.ES es un deudor (de ah√≠ la 4300, que en este caso sirve de cuenta puente) que le debe 2.000‚Ç¨ de una subvenci√≥n a la empresa. Por eso yo hago una factura en el diario de subvenciones y le pongo impuesto S_SUB
- El agente digitalizador, el proveedor de servicios, que hace una factura a la empresa por 2.000‚Ç¨ + IVA, como es un activo digital hay que imputarlo a la 206

El IVA no es subvencionable y hay que pagarlo al proveedor, en cambio los 2.000‚Ç¨ que cuesta el KD los cobra el agente directamente de red.es al presentar la justificaci√≥n. Por tanto, la factura del cliente RED.ES hay que cuadrarla contra la base de la factura de proveedor del agente y de aqu√≠ el asiento de la 4100 contra 4300, para conciliar ambas facturas y marcarlas como pagadas.

Esto pasar√° en las subvenciones en que el proveedor cobra directamente la subvenci√≥n concedida a la empresa, sin que la empresa vea el dinero en su cuenta bancaria. [SEP] Yo creo que no debe ir contra la 4300, si no que con una cuenta de subvenciones, y tambi√©n el que tiene que declarar el KD en el 347 en todo caso es el agente digitalizador, no el cliente final, pero a ver si alg√∫n otro fiscalista/contable nos puede decir. [SEP] Hola,

Nosotros tras varias consultas a Hacienda no han explicado que el agente declara normal y el beneficiario declara normal pero a m√°s a m√°s debe de poner las bases de los kits digitales en la casilla 120 contra el Ministerio de Asuntos Econ√≥micos y Transformaci√≥n Digital

> El 4 mar 2024, a las 20:13, Pedro M. Baeza ***@***.***> escribi√≥:
> 
> 
> Yo creo que no debe ir contra la 4300, si no que con una cuenta de subvenciones, y tambi√©n el que tiene que declarar el KD en el 347 en todo caso es el agente digitalizador, no el cliente final, pero a ver si alg√∫n otro fiscalista/contable nos puede decir.
> 
> ‚Äî
> Reply to this email directly, view it on GitHub <https://github.com/OCA/l10n-spain/issues/3451#issuecomment-1977282116>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/ABPMFVRMIVEZ2PNIH3QIYQTYWTBWVAVCNFSM6AAAAABDY4B52WVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTSNZXGI4DEMJRGY>.
> You are receiving this because you are subscribed to this thread.
> 

 [SEP] Hola, Josep, ¬øla casilla 120 de qu√©? [SEP] Del modelo 347

> El 5 mar 2024, a las 9:21, Pedro M. Baeza ***@***.***> escribi√≥:
> 
> 
> Hola, Josep, ¬øla casilla 120 de qu√©?
> 
> ‚Äî
> Reply to this email directly, view it on GitHub <https://github.com/OCA/l10n-spain/issues/3451#issuecomment-1978195316>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/ABPMFVXO7RWUSY5T5M6SUETYWV6BZAVCNFSM6AAAAABDY4B52WVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTSNZYGE4TKMZRGY>.
> You are receiving this because you commented.
> 

 [SEP] Pues me temo que no s√© de lo que hablas, ya que en el modelo 347, hasta donde s√©, no hay casillas numeradas (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos/347.pdf) [SEP] Disculpa, me liado de 120.
Se debe de a√±adir un registro de la siguiente forma seg√∫n lo nos explicaron en Hacienda.

El Agente lo declara normal
El Beneficiario declara normal la facturas del agente y a√±ade un registro contra el Ministerio por la base total de las ayudas.

Ôøº

> El 5 mar 2024, a las 9:49, Pedro M. Baeza ***@***.***> escribi√≥:
> 
> 
> Pues me temo que no s√© de lo que hablas, ya que en el modelo 347, hasta donde s√©, no hay casillas numeradas (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos/347.pdf)
> 
> ‚Äî
> Reply to this email directly, view it on GitHub <https://github.com/OCA/l10n-spain/issues/3451#issuecomment-1978241013>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/ABPMFVTO5ZWWZM3HRWL44E3YWWBJZAVCNFSM6AAAAABDY4B52WVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTSNZYGI2DCMBRGM>.
> You are receiving this because you commented.
> 

 [SEP] @pedrobaeza respecto a qui√©n debe declarar la subvenci√≥n en el 347, en todas las subvenciones es el beneficiario de la subvenci√≥n. En el caso el KD, cuando entras en el portal, ah√≠ pone que el beneficiario es la empresa que recibe los servicios del agente digitalizador.


![image](https://github.com/OCA/l10n-spain/assets/1849488/45efe6c7-ae50-44fd-ad31-464e3c597b69)


Las condiciones que estipula red.es para recibir el KD es que los servicios a contratar deben ser realizados por un agente digitalizador. Pasa lo mismo con los cupones de industria 4.0 u otras subvenciones en las que la empresa beneficiaria est√° obligada a gastarse el dinero en unos proveedores certificados en las competencias para las que se ha solicitado la subvenci√≥n.

Por tanto qui√©n debe declarar la subvenci√≥n en el 347 es la empresa que recibe el dinero, y adem√°s debe activarla en sus cuentas y declarar el ingreso en las 740 o 746. El KD es un poco complejo porqu√© el ingreso que se debe declarar es la parte amortizada. En otras subvenciones es m√°s sencillo, por ejemplo los Next Generation que no son amortizables, deben declararse todo el importe recibido en el a√±o en curso (criterio de caja) como un ingreso, aunque debe activarse el total recibido. Por ejemplo si se reciben 100k para un proyecto de 2 a√±os, el primer a√±o se activan los 100k, pero se declaran 50k de ingreso.


Respecto la 4300, eso mejor un fiscalista, porque aunque el nuestro nos ha dicho que no est√° mal hecho, no es muy ""elegante"", a lo mejor hay quien tiene una mejor f√≥rmula para hacerlo. Hablando con otras empresas que se dedican mucho a subvenciones, nos han comentado que ellos tambi√©n tienen un diario de subvenciones, aunque no crean facturas como tales, pero s√≠ imputan ah√≠ los movimientos.

En cualquier caso, coincido en que es necesario un tipo de impuesto S_SUB que recoja los importes de las subvenciones en el 347. [SEP] OK, creo que queda bastante claro y documentado en este hilo. A ver si alguien recoge el testigo y se pone hacerlo. Si no, esto podr√≠a ser una tarea para los Spanish OCA days de Tenerife en mayo. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3450,"El contacto hay que definirlo correctamente:

![image](https://github.com/OCA/l10n-spain/assets/7165771/bcbf71bb-94ae-4f5b-9e54-8174e7d5f4f8)
 [SEP] Hola, disculpa @pedrobaeza como se dec√≠a al abrir el hilo facturae solicitan nombre y APELLIDO a√∫n habi√©ndolo marcado como ""individual"" (previamente ya hab√≠amos probado esto que comentas). Cuando seleccionas ""Individual"", tal y como se muestra en tu captura, sigue sin aparecer un campo donde a√±adir el apellido. 
Hemos probado a a√±adir ambos datos en el mismo campo pero el odoo no es capaz de separarlo. ¬øExiste alguna soluci√≥n?
 [SEP] Instalar `partner_firstname`."
Issue,3449,
Issue,3448,"@xabispacebiker Nos acabamos de encontrar con este error y esa librer√≠a de js que genera el fichero en el TPV es una muerte, ¬øhas dado con la solucion? gracias [SEP] Buenas @omar7r , Finalmente pudimos identificar el problema en el proceso de generaci√≥n de facturas TicketBAI que ocurr√≠a bajo ciertas condiciones, como la p√©rdida de conexi√≥n a internet o una alta carga del sistema. Este problema se deb√≠a a una ""race condition"", donde m√∫ltiples procesos intentaban generar un n√∫mero de factura al mismo tiempo. Como resultado, el mismo n√∫mero de factura pod√≠a ser asignado a diferentes facturas, causando errores al enviar los datos a la agencia tributaria.

Para resolver este problema, hemos implementado un mecanismo para evitar la generaci√≥n concurrente del mismo n√∫mero de factura. Esto es lo que hicimos:

1. Introducci√≥n de un flag: A√±adimos un flag (isGeneratingInvoice) para rastrear si un proceso de generaci√≥n de factura ya est√° en curso.
2. Control de acceso: Antes de iniciar el proceso de generaci√≥n de la factura, el sistema verifica este flag. Si ya se est√° generando una factura, el nuevo proceso esperar√° hasta que el actual termine.
3. Reinicio del flag: Una vez que la generaci√≥n de la factura se completa, el flag se reinicia, permitiendo que el siguiente proceso contin√∫e.
4. Control de errores: Mejoramos el control de errores para asegurar que el flag se reinicie incluso si ocurre un error durante el proceso de generaci√≥n de la factura.

Por el momento parece que el error se ha corregido. [SEP] Muchas gracias por la respuesta ¬øno ten√©is ese parche p√∫blico o? habr√° que mirar de hacer algo as√≠, prob√© con el m√≥dulo de multidispositivos y de inicio parec√≠a que no pod√≠a replicar el problema forzando la ca√≠da y recuperaci√≥n de la conexi√≥n como antes y pens√© que ya no suced√≠a, pero nada, sigue sucediendo y no logro encontrar el nuevo patr√≥n para replicarlo... [SEP] @xabispacebiker saludos. ¬øComo ha ido finalmente el fix? ¬øAlguna posibilidad de compartirlo con la comunidad?"
Pull Request,4799,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out!"
Pull Request,4798,"Parche directo

/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4798-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4798-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4798-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/a91c57db7e96f1872d6b9510035c50dd2bcc5272).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red."
Pull Request,4797,
Pull Request,4796,"Gracias por la correcci√≥n @carlosdauden 
Parece que ahora que se env√≠an las rectificativas como tal el test no pasa porque el test no estaba bien planteado.

<img width=""3769"" height=""1714"" alt=""image"" src=""https://github.com/user-attachments/assets/0ee2c39d-04e7-4f82-b508-d28c5b8504bf"" />

¬øPuedes corregir el test y aprobamos.?"
Pull Request,4795,"This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4795-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4795-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at cc83ac9a2c90e99484f2f4a34d740a769ba2d5e7. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4794,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/48b6018d3c0a48eba89506a3ee81d431e05b8f74).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/860ac56e39bde542cc39caa5e1f5921754f4a0c8).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 391a4f5fb86090dd94aed568c95023db035cde68. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4792,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4792-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4792-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 835942345db56aefbb77af1f1c43e6e5d94b3990. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4791,"Hi @EmilioPascual, @Andrii9090, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/5c3cff50b276156a971fa0f627136c4303e833fb).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 906962409a0b86583388ebf9b3eee7253cf4052e. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4790,"On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/2ece3f2750f19de0803110dfffce85f8c1127db3).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/577885ceea1282e10c33c1f8b4722f3701e6d4ac).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red."
Pull Request,4789,"What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4789-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4789-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b385ffae3cbdc3d19e5bf1762c9ca0f747d0bce6. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4788,"Listo, lo he a√±adido a la constrain para que salte tambi√©n si lo a√±adieran en la compa√±√≠a directamente [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/0e09b28007c5334c3d9316551b4ecedacbf7553d).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 4819579f190a945a6c78cb7d9468832edc996f71. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4787,
Pull Request,4786,"Hi @nicolasramos,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4786-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4786-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 8c3a8703afbdf736eabd820cb4ccbe22f27125c9. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4785,"Hi @nicolasramos,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4785-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4785-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9fe183b73261cc10acb65dd253a0de0abbacf898. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4784,"En este caso, como son pocos cambios, creo que se podr√≠an codificar en la misma configuraci√≥n de exportaci√≥n BOE con una f√≥rmula similar a `object.convocation_bdsn if year > 2023 else """"` [SEP] > En este caso, como son pocos cambios, creo que se podr√≠an codificar en la misma configuraci√≥n de exportaci√≥n BOE con una f√≥rmula similar a `object.convocation_bdsn if year > 2023 else """"`

Lo intent√© as√≠, pero el nuevo campo es n√∫merico y si es antes de 2023 tendr√≠a que poner espacios en blanco pero un campo n√∫merico te pondr√° 0. Si le fuerzas a que ponga los espacios en blanco saltar√° un error que un campo num√©rico no puede poner un string. [SEP] Pero aunque sea num√©rico, puedes poner que en el formato BOE sea texto, y te convierte el n√∫mero y ya est√°. De hecho, no s√© si deber√≠as poner `fields.Integer` o `fields.Char` en el campo, porque muchas veces acostumbran a poner un 0 delante, y eso lo quitar√≠a siendo integer. [SEP] > Pero aunque sea num√©rico, puedes poner que en el formato BOE sea texto, y te convierte el n√∫mero y ya est√°. De hecho, no s√© si deber√≠as poner `fields.Integer` o `fields.Char` en el campo, porque muchas veces acostumbran a poner un 0 delante, y eso lo quitar√≠a siendo integer.

Ten√≠as raz√≥n, pasandolo a `char` se ha reducido bastante. Gracias por el aporte. ¬øPuedes volver a echarle un ojo? [SEP] Error en los tests de facturae [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4784-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4784-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at bef87df366d00c757008e85feb707859f084a39d. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4783,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hola @desagia ,

Por favor, tienes que hacer un PR para cada m√≥dulo.

Y verifica que pasan todos los test.

¬°Muchas gracias!

Saludos"
Pull Request,4782,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out!"
Pull Request,4781,
Pull Request,4780,"@mbaena ya me avisas cuando est√© para revisar [SEP] @pedrobaeza listo para revisar
Ya lo estamos utilizando en producci√≥n para el modelo 190 (ejercicio 2025), sin incidencias hasta ahora. [SEP] Hola, @mbaena, disculpa si no me he expresado bien. No quer√≠a que el formato de 2025 lo convirtieras a XML, si no que no cambiaras el de 2017. El de 2025 por supuesto que puede quedarse en CSV y que ya vaya de la ""forma nueva"" m√°s eficiente. Es no tener que convertir el anterior formato a CSV, ya que el mismo est√° en XML. [SEP] hola, @pedrobaeza creo que esto era lo que indicabas, mantener XML anterior e incorporar nuevo en CSV. Probado en real.  [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4780-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4780-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at b14f68f26743cc47e70e4413aea587b0556583f8. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4779,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4779-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4779-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6dd2d21f10fdd6871202be5503bb088d29f278b3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4778,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4778-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4778-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ade22074857513c175aea049022f0d5b8365b85e. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4777,
Pull Request,4776,"Hi @EmilioPascual, @Andrii9090, @rafaelbn,
some modules you are maintaining are being modified, check this out!"
Pull Request,4775,"Hi @Andrii9090, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] Buenas tardes @EmilioPascual como nos hab√≠an dicho que no ten√≠an pensado incorporarlo ya est√°bamos realizado la implementaci√≥n de la P√°gina 12 en https://github.com/OCA/l10n-spain/pull/4776. Est√°bamos pendientes de que el cliente subiera el fichero a la AEAT para proponerlo y ha pasado sin problema con m√∫ltiples actividades"
Pull Request,4774,"@HaraldPanten @pedrobaeza  [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch), awaiting test results. [SEP] It looks like something changed on `18.0` in the meantime.
Let me try again (no action is required from you).
Prepared branch [18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a67f120b425499f87df1dcdcb4da193417c157c0. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4773,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] > Esos impuestos ya est√°n presentes en otras casillas, como por ejemplo el `p_iva4_sp_ex` en la 190 y 191, as√≠ que dudo que vayan ah√≠. Adem√°s, por el nombre, parecen ser de exportaci√≥n, no de ISP.

La casilla 523 es una casilla de caracter puramente informativo o estad√≠stico. Est√° englobada en la secci√≥n 11. Operaciones espec√≠ficas el cual tiene el siguiente apunte:

<img width=""629"" height=""98"" alt=""image"" src=""https://github.com/user-attachments/assets/4d09c35f-738f-4922-970f-071af0ec5f77"" />

Seg√∫n entiendo la casilla 523 es igual que la casilla 27 pero incluyendo s√≥lo los servicios. [SEP] A ver si @AlbertCabedo o @acysos nos puede confirmar, pero lo dicho, el impuesto `p_iva4_sp_ex` no tiene pinta de ir ah√≠. [SEP] Ahora veo #4771 de nuevo y efectivamente ah√≠ est√° metido ese impuesto bajo el ep√≠grafe `IVA devengado en otros supuestos de inversi√≥n del sujeto pasivo`, con lo que s√≠ es ISP, pero la cuesti√≥n es si aqu√≠ va tambi√©n lo mismo, o lo del art√≠culo 84 son otros supuestos. [SEP] La casila 27 y 28 tambi√©n tambi√©n vienen bajo el supuesto del articulo 84.
<img width=""962"" height=""130"" alt=""image"" src=""https://github.com/user-attachments/assets/ddc622db-6ac9-427d-9791-f1ed8527d31b"" />
Lo √∫nico que aqu√≠ especifica tambi√©n el 4¬∫ que tiene que ver con la entrega de gas, electricidad, ... seg√∫n https://www.boe.es/buscar/pdf/1992/BOE-A-1992-28740-consolidado.pdf
<img width=""907"" height=""219"" alt=""image"" src=""https://github.com/user-attachments/assets/b87bf8ef-f094-4a39-bc94-2918421f8a57"" />
Creo que esto √∫ltimo no influye para el mapeo de los impuestos de la casilla."
Pull Request,4772,"@HaraldPanten could u review? thanks üò∏  [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch), awaiting test results. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5a70778400a2712ca097c6344c0e71b1a7783ea7. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4771,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] ¬øQu√© caso de impuesto tiene valores en otra cuenta contable? [SEP] Todos los impuestos en la casilla 28 tienen la cuenta 472 y la 477 menos p_iva0_ic_sc. Si lee la 472, est√°r√≠a cogiendolo del IVA deducible, algo incorrecto. Adem√°s si tienes prorrata la cantidad ser√° incorrecta. En cuanto al p_iva0_ic_sc no tiene ninguna cuenta, pero como el porcentaje es 0, no est√° generando cuota. [SEP] Vale, el t√≠tulo me despist√≥ que pusiera 347. Es el 390... C√°mbialo, por favor. [SEP] > Vale, el t√≠tulo me despist√≥ que pusiera 347. Es el 390... C√°mbialo, por favor.

Si, perd√≥n, estoy trabajando tambi√©n en el nuevo modelo de registro del 347 y se me fue la cabeza. Gracias por el apunte. [SEP] Ahora has puesto 349, pero es el 390 :wink:  [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4771-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4771-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9983791d08b480de1482eaf3f04de2f414fcffc6. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4770,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hola,

Las casillas 60 y 61 es solo para las compensaciones, la rectificativas o deducciones por rectificaci√≥n van a la siempre a las casillas 639 y 62, aunque sean del r√©gimen especial de agricultura, ganader√≠a y pesca. 

https://sede.agenciatributaria.gob.es/static_files/Sede/Procedimiento_ayuda/G412/Instrucciones_modelo_390-2025.pdf

Necesitamos una consulta vinculante con AEAT que indiquen ellos que se puede poner con s√≠mbolo negativo en las casillas 60 y 61, ya que estas casillas solo aceptan s√≠mbolo positivo.

Saludos [SEP] Hola,
Tiene todo el sentido lo que indica @acysos, gracias por la aclaraci√≥n. La mejora propuesta del Modelo 390 est√° basada en c√≥mo se gestionan las compensaciones del REAGP en el Modelo 303, donde todas las compensaciones se agregan en la casilla 42, seg√∫n el mapeo actual:

https://github.com/OCA/l10n-spain/blob/163c6de6b6329c766d37aaebd590afa051bb4658/l10n_es_aeat_mod303/data/2024-10/l10n.es.aeat.map.tax.line.csv#L38

El problema que hab√≠amos detectado es un descuadre entre los totales del Modelo 390 y lo declarado en los modelos 303, ya que la implementaci√≥n actual del 390 no estaba teniendo en cuenta las rectificaciones.
"
Pull Request,4769,"This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4769-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4769-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b1c99e6fa3f6599f03f2643884399d5e45c46d9d. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4768,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out!"
Pull Request,4767,"@christian-ramos-tecnativa puedes por favor mirar el error de `l10n_es_pos_sii`. [SEP] Arreglado en https://github.com/OCA/l10n-spain/pull/4769 [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4767-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4767-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 163c6de6b6329c766d37aaebd590afa051bb4658. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4766,"What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4766-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4766-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at d10f01df85b9a9610eb7286cfd41b23dd26ee50b. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4765,"Hi @EmilioPascual, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] Estoy a favor de la comprobaci√≥n, pero no me gusta nada hacer cosas que modifiquen la factura durante la validaci√≥n. Ya que est√°s validando una factura que consideras correcta pero luego puede presentar datos distintos y esto puede confundir al usuario. ¬øNo podr√≠amos transformarlo en un raise directamente? Indicando en el error que pasando la factura a cancelado y a borrador de nuevo deber√≠a generar el vat correctamente [SEP] He cambiado el c√≥digo, ahora 
 - si la empresa tiene prorrata configurada,
 - si las l√≠neas de factura est√°n sujetas a prorrata,
 - si los impuestos de la factura tienen `with_vat_prorate=True`
 - si no existe ninguna l√≠nea de apunte contable correspondiente a la prorrata.
En caso de cumplirse estas condiciones, salta un raise

Adem√°s, he establecido el campo `with_vat_prorate` de account.move.line como readonly en el caso de prorrata general, para evitar que el ORM lo establezca a False por defecto durante el c√°lculo de las l√≠neas de prorrata.

@EmilioPascual puedes revisar de nuevo?"
Pull Request,4764,"Great! [SEP] exacto, al ser `report.${nombre del report}`, Odoo lo coge autom√°ticamente. [SEP] Anda, esas ""black magic""...

Pon porfa un comentario al lado de la l√≠nea `_name` para recordar eso. [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/757e772df85ebb73470600c9a38952d2135229f7).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/9ad35743e515b1e909db67100bb21c6ae9d66043).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at f4fa261ef499c55a9b4de78e119da7c996b0a0a9. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4763,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] ping @Bilbonet @luciaavanzosc @oihane @mariancuadranetkia [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4763-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4763-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ff164db495c98271469173900f3fab8049da0b2f. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4762,"@Shide puedes revisar este fix, ya que seg√∫n parece, lo introdujiste t√∫? [SEP] @EmilioPascual @ArantxaSudon porfa, echadle un ojo [SEP] @moduon MT-13491 [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4762-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4762-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 26f707d16e71b36049f4383ecbaf7a1c4d2678f6. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4761,"> ¬øNo habr√≠a que cambiar el `freeze_time` de los tests para poner 2026?
> 
> https://github.com/OCA/l10n-spain/blob/163c6de6b6329c766d37aaebd590afa051bb4658/l10n_es_atc_mod417/tests/test_l10n_es_atc_mod417.py#L572

Esta actualizaci√≥n es por trimestre, no es por cambio de a√±o a√∫n, a diferencia de la actualizaci√≥n en el PR https://github.com/OCA/l10n-spain/pull/4757 donde s√≠ tengo que cambiar la fecha de los test, porque ah√≠ el JAR valida el a√±o. Imagino que en una pr√≥xima actualizaci√≥n, donde s√≠ cambie el a√±o, ah√≠ s√≠ se debe cambiar en los test, pero ahora no es necesario. [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4761-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4761-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3aac26c68dfae7b98b9e9d9b1a07ee37f83aa884. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4759,"On my way to merge this fine PR!
Prepared branch [15.0-ocabot-merge-pr-4759-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4759-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 4c3b798da72d7ba3c88466afd69721cab129dc27. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4758,"@eantones, can you please review it?

 [SEP] @deeniiz also the CI is red, please check it out."
Pull Request,4757,"Hi @nicolasramos,
some modules you are maintaining are being modified, check this out!"
Pull Request,4756,"El modelo se calcula para una sola compa√±√≠a, no para varias, por lo que no entiendo el parche."
Pull Request,4755,"@pedrobaeza Puedes revisar el pr y si esta correcto le puedes dar el aprobado para que se fusione lo antes posible [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4755-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4755-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 1ab4e2fa97731392287419e900d86c27c31fe9e9. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4754,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Habr√≠a que comprobar si esto tiene alg√∫n efecto lateral fuera del SII. Creo recordar que el 349 tambi√©n utiliza esto. [SEP] Por lo que he comprobado del 349 se fuerza el `country_code` (que actualmente devuelve EL) y se pasa por la funci√≥n `_map_aeat_country_code` nuevamente, con este cambio no ser√≠a necesario, ya que ser√≠a `GR` desde la primera llamada. Adem√°s en los tests del 349 tiene partner con pa√≠s Grecia, por lo que habr√≠a saltado el CI en caso de que este cambio le afectara.
https://github.com/OCA/l10n-spain/blob/36eda0438efb096ed8c040418fd10893a0e3fe1c/l10n_es_aeat_mod349/models/mod349.py#L432-L440
https://github.com/OCA/l10n-spain/blob/36eda0438efb096ed8c040418fd10893a0e3fe1c/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py#L365-L367 [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4754-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4754-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ce7d74ffb8bbaff47df4c546c264726aeff554e8. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4753,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] Fusiono en base a las reviews existentes.

/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4753-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4753-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 2294e946f91bb5df26b363517db55bd49f28fa0b. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] Ll√©valo por favor a 18"
Pull Request,4752,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch), awaiting test results. [SEP] It looks like something changed on `18.0` in the meantime.
Let me try again (no action is required from you).
Prepared branch [18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at fc53612c021bc816bedecdf6d3a6b76db0afb0d2. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4751,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] <img width=""1327"" height=""671"" alt=""image"" src=""https://github.com/user-attachments/assets/4d4551c7-e2e5-4def-b7bc-9d2b023af8e8"" />
 [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] @pedrobaeza se podr√≠a mergear este? o faltar√≠a revisar algo? [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4751-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4751-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 1802baf4b9001442537a69d23e0b3532ea257c5d. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4750,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] <img width=""1327"" height=""671"" alt=""image"" src=""https://github.com/user-attachments/assets/33baccee-6dff-4dde-944e-3e839631c190"" />
 [SEP] @luciaavanzosc @oihane pueden dar un poco m√°s de contexto @Bilbonet. [SEP] Lo han empezado a validar en √Ålava y falla sino se cambia. LGTM [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [14.0-ocabot-merge-pr-4750-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/14.0-ocabot-merge-pr-4750-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at fd23732dee3a31ea7772a96ec338789f5a4b60df. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] @omar7r habr√° que revisar si s√≥lo es Araba"
Pull Request,4749,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] LGTM!"
Pull Request,4748,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4748-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4748-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at bac2dc70f1955137d9948f68d27f3d7341fd9f9c. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4747,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4747-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4747-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at df3a1d3bcc22fec63757ca9ec8b7808affc1a48e. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4746,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/1c888ca4dd9e0c7833ad4738054e1a047b3ab303).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 36eda0438efb096ed8c040418fd10893a0e3fe1c. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4745,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4745-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4745-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @EmilioPascual para la pr√≥xima, recuerda a√±adir la nueva configuraci√≥n al test para as√≠ evitar sorpresas y regresiones. [SEP] Congratulations, your PR was merged at 7e013beb6fdbd6e13da0d148d77b65a6f35185bf. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4744,"/ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [15.0-ocabot-merge-pr-4744-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4744-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at d0c1b0c0a53259c576191e91e5d8fc52b4aa34a3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4742,"@eduezerouali-tecnativa revisa bien el backport, que en el Excel salen mezclados los datos en columnas que no corresponden.

<img width=""2347"" height=""210"" alt=""image"" src=""https://github.com/user-attachments/assets/021bba9f-964b-4acc-9a2d-8731fe549d72"" />
 [SEP] @pedrobaeza 
<img width=""1756"" height=""194"" alt=""Selecci√≥n_054"" src=""https://github.com/user-attachments/assets/9b9c0c10-e077-4224-bb96-0e9c41e1a173"" />
He hecho una prueba en local y se ejecuta bien, cosa que en runboat no. El commit esta con los ultimos cambios. [SEP] /ocabot merge minor [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4742-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4742-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at c0f1aad097c803f2e808c007629328a97cb1d6b3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4741,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4741-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4741-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 3af0494a8327b8903808c4ca24b9c8587a4f6697. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4740,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor), awaiting test results. [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 73dec24922ef39c6f9b3d4b40b7dc1e81dcf5319. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4739,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4739-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4739-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3dcd8a1e2c0454ef1641fdf9b1d6260056267108. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4738,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/ecaacf055c3a0b9c71e474fc9db9e653b10e95d4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/e3b9a06d5917ac9c41155c4be84491c429bbae84).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b85bd887eea3f65f39d58892b1e8f3a52ac8830b. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4737,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR looks fantastic, let's merge it!
Prepared branch [19.0-ocabot-merge-pr-4737-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/19.0-ocabot-merge-pr-4737-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9bf2a1d793c262765735f5c68b3a6549cf3bd39d. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4736,"This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4736-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4736-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at e936d3af1229c954d2450bed3d4fc49755b40915. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4735,
Pull Request,4734,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/a506c1c4022a9aa9fb138bebb7da1abb4a5c277e).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 889ffbd41b2a65471674d8901223740a8b0f3689. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4733,"What a great day to merge this nice PR. Let's do it!
Prepared branch [15.0-ocabot-merge-pr-4733-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4733-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 51b348ea328d20bb6d903d76c7dad24016d3fd55. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4732,"Hi @pedrobaeza, @victoralmau,
some modules you are maintaining are being modified, check this out! [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4732-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4732-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9f474d3896f86b697a368da4e1bd1699cb7e12b9. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] @christian-ramos-tecnativa ¬øPuedes hacer backport a 17.0?"
Pull Request,4731,"This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4731-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4731-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6aedd2a4047a29fb9b247fef4a245df469dacf25. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4730,"What a great day to merge this nice PR. Let's do it!
Prepared branch [15.0-ocabot-merge-pr-4730-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4730-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a296b02aa14c9a5d1039449e3fab1d2f77eb334c. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] ¬øHace falta en 16.0? [SEP] S√≠, en el PR 4736 he mirado de corregir los tests KO en este m√≥dulo..."
Pull Request,4729,"This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4729-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4729-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at dbe00155799ffd353dad1a29a007c600da4aedb8. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4728,"On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4728-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4728-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 0ba76c2742d8add304d1abad7d939af770a1c3ff. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4727,/ocabot migration l10n_es_aeat_mod390
Pull Request,4726,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4726-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4726-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a24b63c6f5e85cdf3aea31dd4062561a0fe28f8e. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4725,
Pull Request,4724,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4724-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4724-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cd45131687afe7a1176cb11215196ecd0cc2b3a3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4723,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4723-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4723-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4723-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/5825061e9d4cbc740e3cba7736274c3ae51c164e).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4723-by-HaraldPanten-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4723-by-HaraldPanten-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5f8058ce57c2ecae5d263e35ae6477d8d574c437. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4722,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4722-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4722-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 8c4438c6968603fe10bdd6c845f107a4db2da844. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4721,"/ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4721-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4721-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b6d43e3ed757a88f07121c32edb1244440dd4530. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4720,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4720-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4720-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 2dc85b4542fb019d0004520ffd4a7e310b81e203. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4719,"√çdem que el de 16. Las columnas del Excel no coinciden. [SEP] ping @pedrobaeza  [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4719-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4719-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at b560ee1fb9878cf7b3fd0aa674f5026a66652e23. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4718,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4718-by-etobella-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4718-by-etobella-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 04f115220f183bf968e3937620a3a44b8e0c0374. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4717,/ocabot migration l10n_es_aeat_mod347
Pull Request,4716,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @pedrobaeza 
Same https://github.com/OCA/l10n-spain/pull/4475
 [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4716-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4716-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5c39867f69b29795e62fe6f8e1f248f1332583d5. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4715,"/ocabot merge patch [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4715-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4715-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 182d65d390dedde920534a47770d757ffd385aab. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4714,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4714-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4714-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 00aa4a69f0c05465ffbdb3391c8e37b7aed3bc95. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4713,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4713-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4713-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 0024eb109f9b42c8d63b837b7ab030b9d9fe2bcc. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4712,
Pull Request,4711,"Los errores vienen de la migraci√≥n a 18, cuando se paso del archivo `xml` a `csv`, los espacios en blancos no los reconoce sin las comillas, esto hace que en vez de a√±adir un espacio en blanco como indica el dise√±o de registro, se a√±ada `False` dando error al subir el archivo a AEAT. [SEP] Cierro en favor de https://github.com/OCA/l10n-spain/pull/4718 que recoge los cambios para 2025"
Pull Request,4710,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @christian-ramos-tecnativa Changes done! [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4710-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4710-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 524dec78351172e3c4c06235f16ff5568a26aabc. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4709,"@eduezerouali-tecnativa ¬øPuedes hacer backport a 17? [SEP] > @eduezerouali-tecnativa ¬øPuedes hacer backport a 17?

Si est√° previsto hacer backport a 16 y 17 [SEP] > Un detalle m√°s: el periodo de deducci√≥n s√≠ que se puede escribir, y se obtiene de la fecha contable de la factura, aunque habr√≠a que a√±adir un dato extra a nivel de libro de IVA: si la liquidaci√≥n es trimestral o mensual.

Entonces habr√≠a que a√±adir `vat_settlement_period` a nivel de `l10n.es.vat.book`. Y el c√°lculo ser√≠a, en el caso de liquidaci√≥n mensual, a√±adir los 30 d√≠as naturales, y en el caso de liquidaci√≥n trimestral, comprobar a qu√© trimestre corresponde y poner la fecha del √∫ltimo d√≠a del trimestre. [SEP] S√≠, se a√±ade ese campo, y ser√≠a poner dentro de qu√© toca: el a√±o en el ejercicio, y si es mensual, pues el mes en periodo (01, 02...), y si es trimestral, pues 1T, 2T, 3T, 4T. [SEP] Hay ejemplos en `l10n_es_aeat*` que lo calcula de manera elegante. [SEP] Lo reviso y lo a√±ado. [SEP] ping @pedrobaeza  [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor), awaiting test results. [SEP] muchas gracias!!! pues testeado y ok a merge [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/1a0929b73bfa232b7e250fc7c924766591847a1b).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 3ddc7f91efa7e578fe6249cfb497d3d24a1ec08d. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4708,
Pull Request,4707,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Ya est√°n todos los puntos comentados, en cuanto al PR que realizaste para `l10n_es_pos_sii` me ha parecido que los campos en este est√°n bastante preparados con los `invisible` y `readonly` donde toca. D√©jame saber si echas alguno en falta [SEP] A que te refieres con 

> las nuevas etiquetas acortadas.

@pedrobaeza? [SEP] Mira en el otro PR c√≥mo en la vista se ponen string acortadas sin el t√©rmino SII."
Pull Request,4706,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Gracias por el PR! üëç

Siguiendo el feedback de @pedrobaeza, aqu√≠ va una propuesta de refactorizaci√≥n que acumula los paths y los valida una sola vez:

```python
@api.model
def get_certificates(self, company=None):
    if not company:
        company = self.env.user.company_id

    aeat_certificates = self.search([
        (""company_id"", ""="", company.id),
        (""public_key"", ""!="", False),
        (""private_key"", ""!="", False),
        ""|"",
        (""date_start"", ""="", False),
        (""date_start"", ""<="", fields.Date.today()),
        ""|"",
        (""date_end"", ""="", False),
        (""date_end"", "">="", fields.Date.today()),
        (""state"", ""="", ""active""),
    ])

    if aeat_certificates:
        # Acumular archivos faltantes
        missing_files = []
        for aeat_certificate in aeat_certificates:
            public_crt = aeat_certificate.public_key
            private_key = aeat_certificate.private_key
            if not os.path.isfile(public_crt):
                missing_files.append(_(""Public certificate: %s"") % public_crt)
            if not os.path.isfile(private_key):
                missing_files.append(_(""Private key: %s"") % private_key)

        # Validar una sola vez
        if missing_files:
            raise exceptions.UserError(
                _(""Error! The following certificate files were not found:\n%s"")
                % ""\n"".join(missing_files)
            )

        return (
            aeat_certificates[0].public_key,
            aeat_certificates[0].private_key,
        )
    else:
        # Fallback a par√°metros de configuraci√≥n
        ICP = self.env[""ir.config_parameter""].sudo()
        public_crt = ICP.get_param(""l10n_es_aeat.public_key"", False)
        private_key = ICP.get_param(""l10n_es_aeat.private_key"", False)

        if not public_crt or not private_key:
            raise exceptions.UserError(_(""Error! There aren't certificates.""))

        # Paths por defecto (instalaciones nuevas)
        default_paths = (
            ""/opt/certificates/publicCert.crt"",
            ""/opt/certificates/privateKey.pem"",
        )

        missing_files = []
        if public_crt not in default_paths and not os.path.isfile(public_crt):
            missing_files.append(_(""Public certificate: %s"") % public_crt)
        if private_key not in default_paths and not os.path.isfile(private_key):
            missing_files.append(_(""Private key: %s"") % private_key)

        if missing_files:
            raise exceptions.UserError(
                _(""Error! The following certificate files were not found:\n%s\n\n""
                  ""Please configure a valid certificate through ""
                  ""Settings > AEAT > Certificates"")
                % ""\n"".join(missing_files)
            )

        return public_crt, private_key
```

**Ventajas de este enfoque:**
- ‚úÖ El usuario ve **todos** los archivos faltantes de una vez (mejor UX)
- ‚úÖ Evita m√∫ltiples `raise` dispersos
- ‚úÖ C√≥digo m√°s mantenible y DRY
"
Pull Request,4705,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4705-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4705-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a4ff6c54d1f80c3284fdc94228710a5f196db037. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4704,"Hi @pedrobaeza, @victoralmau,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/ad0fd5a3581e1b26937dfb0fcbd93a06d1074b36).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/9d2f4cb0b643e83136f6c430d0ba02b2412863f6).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] Hice rebase para reiniciar los tests. @pedrobaeza puedes intentar fusionar de nuevo?  [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/ad803b8cfc4f88662195aab5518215738ecf37fe).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5e90b6f39949e32d5089f2ce5436767f6ea5ebb4. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4703,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out! [SEP] @hildickethan 
can you merge this pr?
It's the same than #4210 , #4209 and #4208  [SEP] ideally wouldnt merge with failed tests but it looks unrelated so should be ok

/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [15.0-ocabot-merge-pr-4703-by-hildickethan-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4703-by-hildickethan-bump-patch), awaiting test results. [SEP] El bot no lo va a fusionar si est√° en rojo. Dar√° error. [SEP] tenia esperanzas de que era algo puntual de conexi√≥n, pero si falla entiendo que habr√≠a que hacer backport de estos cambios que refactorizan los tests y asumo que arreglan el problema https://github.com/OCA/l10n-spain/pull/4548 [SEP] @hildickethan your merge command was aborted due to failed check(s), which you can inspect on [this commit of 15.0-ocabot-merge-pr-4703-by-hildickethan-bump-patch](https://github.com/OCA/l10n-spain/commits/c1ea7ce283918d6a61edb96fa5150e5eb5f103df).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] @mariancuadranetkia fallan los tests por algo del m√≥dulo de verifactu
<img width=""1253"" height=""168"" alt=""imagen"" src=""https://github.com/user-attachments/assets/0fe71869-043a-4786-8c59-70aa5ffab96d"" />
no pasa en las otras versiones por lo tanto seguramente ser√° algo que habr√° que hacer backport [SEP] @hildickethan he estado revisando, pero de momento no he tenido mucho √©xito. He probado incluso comparando con versiones m√°s nuevas, pero a√∫n no he dado con 'la tecla'. 
Hasta el jueves no podr√© volver a mirarlo, pero lo volver√© a revisar por si tuviera m√°s suerte.

Gracias a ambos! [SEP] Generado PR #4730 [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [15.0-ocabot-merge-pr-4703-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4703-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6cd80df98bb766d4c7d92b0938ee899c43afe8b4. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] @mariancuadranetkia no hac√≠a falta rebase en este caso, porque el bot ya lo hace, y como has hecho push despu√©s de lanzar el comando, ahora esto consta como closed en lugar de merged. En cualquier caso, est√° fusionado. [SEP] @pedrobaeza pens√© que ser√≠a necesario y por eso lo hice, pero a la siguiente vez me asegurar√© antes revisando o incluso preguntando si tal. Muchas gracias!"
Pull Request,4702,Waiting to merge this pull request: https://github.com/OCA/l10n-spain/pull/4526
Pull Request,4701,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out!"
Pull Request,4700,"Fusiono directamente para proceder a realizar las traducciones:

/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4700-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4700-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 1ff183d041f2ed09e937e5b71819a83635f529da. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4699,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4699-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4699-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 7a7a552b66a7c5d1bb428b7094049f3b2e432450. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4698,"Hi @Christian-RB,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4698-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4698-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6bfe0a426fc873ec61a9d984076344c81c3a6bfe. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4697,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4697-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4697-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 0f58f3c77ef2541921b91e11eb241b8cb6e8e50d. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4696,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4696-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4696-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 268afce573c36a58d9393e905fd4b6d65c15dbdb. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4695,"Hi @Christian-RB,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4695-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4695-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at c8d89ad439e6793fa8618dd76710b08e80b6b962. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4694,"Hi @Christian-RB,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4694-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4694-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5f07ac229231c2d309f7071dad13e1dd21392792. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4693,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4693-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4693-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ac3d26175131d56d9e2436a571016dbb6a102227. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4692,"@HaraldPanten @etobella y los dem√°s usuarios del SII, qu√© os parece esta mejora? [SEP] Gracias Pedro,

Te decimos algo en breve, para revisarlo con un poco m√°s de detalle üëç"
Pull Request,4691,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] Me comentan que han podido presentar 4T con el formato antiguo. ¬øPuede ser que la actualizaci√≥n solo sea para 2026? [SEP] En Diciembre sacan 2 dise√±os de registro uno para el √∫ltimo per√≠odo de 2025 y otro para 2026
<img width=""424"" height=""83"" alt=""image"" src=""https://github.com/user-attachments/assets/6d19f1b7-efcc-4182-aeb4-554217807fa9"" />
<img width=""689"" height=""171"" alt=""image"" src=""https://github.com/user-attachments/assets/09edcfeb-8f34-4ddc-8970-6b0c7da8d933"" />

Dentro especifica que el de 2026 (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos_26/DR303e26.xlsx) es a partir de 2026
<img width=""1029"" height=""42"" alt=""image"" src=""https://github.com/user-attachments/assets/b42f8546-b295-4b54-a481-63f9ff0b8b72"" />

Mientras que el del 2025 (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos_25/DR303e25.xlsx) espec√≠fica para el 2025 
<img width=""560"" height=""57"" alt=""image"" src=""https://github.com/user-attachments/assets/ccc91e3a-7555-4db9-87e0-0bcafbd6c3c4"" />

Nosotros hemos presentado los 303 con el formato nuevo del 2025 y en principio no est√° dando errores. He estado mirando si eran compatibles porque a lo mejor alguna variables si no llevan nada, rellena con ceros que es uno de los cambios, pero me parece insalvable el cambio en las longitudes de la p√°gina 2
<img width=""1059"" height=""553"" alt=""image"" src=""https://github.com/user-attachments/assets/59a5560c-15d7-4430-b7a6-b6258c95b8fa"" />

Puede que formato anterior del 2025 no haya quedado obsoleto. Es lo que tiene AEAT que no es muy claro.

Desde luego que este no es para 2026
 [SEP] Acabo de probar a exportar con los dos formatos y subirlos al pre-portal de AEAT con una declaraci√≥n bastante completita, se ha tragado los 2 sin errores. [SEP] Acabo de ver por que ha sido, la p√°gina 2 y 5 est√°n omitidas y en la p√°gina 1 que es donde est√°n los cambios de este PR si el a√±o es mayor a 2024 siempre se pone ""00000"".

Parece entonces que no hace falta crear una configuraci√≥n para 2025 y se puede hacer con la que hay actualmente 2024-10. Cierro PR.

Todav√≠a quedar√≠a pendiente hacer las adaptaciones para el 2026"
Pull Request,4690,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4690-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4690-by-pedrobaeza-bump-minor), awaiting test results. [SEP] > T√©cnicamente tiene buena pinta. Ya es probarlo en casos reales a ver si sale alg√∫n problema, pero eso se puede hacer en PRs posteriores.

Hemos probado todo lo que hemos podido en el pre-portal de AEAT y ya hemos subido bastantes a producci√≥n sin error.
 [SEP] Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Congratulations, your PR was merged at e58fd456002db3847e57ba475c9bc0728b8ce6b6. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4689,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4689-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4689-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 31e1f31340496abc952a071f94949a79d4b8873e. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4688,/ocabot migration l10n_es_aeat_sii_match
Pull Request,4687,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/9f2e1a82959ab3a44abdf467b4258b229caf1dc8).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 516c0d00c7141e38648441f27faf8b5b9ebd3da3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4686,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out! [SEP] > Entiendo que ocurrir√≠a lo mismo si usas la funci√≥n de `gls_asm_send_pickup` sin que sea de tipo pickup pero como ese proceso es manual y el bot√≥n no sale si no es del tipo correcto, ese caso no deber√≠a ser un problema

S√≠, estoy de acuerdo, crees que deber√≠amos poner el `UserError` en lugar del `continue`, para ser coherentes? [SEP] > S√≠, estoy de acuerdo, crees que deber√≠amos poner el `UserError` en lugar del `continue`, para ser coherentes?

Si tienes tiempo estar√≠a bien, por coherencia m√°s que otra cosa y vendr√≠a bien si algun dia se ejecuta por c√≥digo en lugar del bot√≥n [SEP] > > S√≠, estoy de acuerdo, crees que deber√≠amos poner el `UserError` en lugar del `continue`, para ser coherentes?
> 
> Si tienes tiempo estar√≠a bien, por coherencia m√°s que otra cosa y vendr√≠a bien si algun dia se ejecuta por c√≥digo en lugar del bot√≥n

Okay! Ahora he a√±adido esta parte [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4686-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4686-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6309db228e2244365fec56824471fd8fc4102758. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4685,"/ocabot migration delivery_gls_asm

A revisar CI."
Pull Request,4684,"@Jaimermaccione Fixed, could you please check again?
Thanks [SEP] @HaraldPanten this PR has passed functional and technical review. Could you please review and merge it?
Thanks [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4684-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4684-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at dfb5e3fb2a006eb6a7cd9f36e530ba77a21fcb45. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4683,"Hi @carlos-lopez-tecnativa,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4683-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4683-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Ciertamente, para mi tampoco tiene sentido... [SEP] Congratulations, your PR was merged at 446cd1a464862e154424ae21a9acea9d145ee062. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4682,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] @luciaavanzosc estoy trabajando en algunos issues en un cliente y veo que hemos enfrentado problemas comunes. En este caso en particular me pregunto desde el punto de vista del dise√±o ¬øes valido que l10n_es_unique_id no tenga ning√∫n valor? @Bilbonet 
"
Pull Request,4680,"/ocabot migration l10n_es_aeat_mod303 [SEP] @sbiosca-s73 ¬øpuedes a√±adir el siguiente fix?

*  #4748 [SEP] @dalonsod hecho!"
Pull Request,4679,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] @Bilbonet ¬øpodr√≠as echarle un ojo a esto? ¬øreproducirlo en runboat tal vez? [SEP] El segundo commit de este PR tiene como objetivo corregir este error:

```
tbai_datas
Traceback (most recent call last):
File ""/opt/odoo-server/odoo/http.py"", line 1823, in _serve_db
return service_model.retrying(self._serve_ir_http, self.env)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/service/model.py"", line 152, in retrying
result = func()
^^^^^^
File ""/opt/odoo-server/odoo/http.py"", line 1851, in _serve_ir_http
response = self.dispatcher.dispatch(rule.endpoint, args)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/http.py"", line 2055, in dispatch
result = self.request.registry['ir.http']._dispatch(endpoint)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/addons/base/models/ir_http.py"", line 154, in _dispatch
result = endpoint(**request.params)
^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/http.py"", line 763, in route_wrapper
result = endpoint(self, *args, **params_ok)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/addons/web/controllers/dataset.py"", line 43, in call_kw
return self._call_kw(model, method, args, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/addons/web/controllers/dataset.py"", line 34, in _call_kw
return call_kw(Model, method, args, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/api.py"", line 480, in call_kw
result = _call_kw_model(method, model, args, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/api.py"", line 451, in _call_kw_model
result = method(recs, *args, **kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/addons/point_of_sale/models/pos_order.py"", line 939, in create_from_ui
order_ids.append(self._process_order(order, draft, False))
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/extra_addons/oca/l10n-spain/l10n_es_ticketbai_pos/models/pos_order.py"", line 201, in _process_order
vals = order.tbai_prepare_invoice_values(pos_order)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/extra_addons/oca/l10n-spain/l10n_es_ticketbai_pos/models/pos_order.py"", line 107, in tbai_prepare_invoice_values
datas = base64.b64encode(order_data[""tbai_datas""].encode(""utf-8""))
~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'tbai_datas'
```

**Posible causa principal:**  
Probablemente se deb√≠a a una condici√≥n de carrera en el c√≥digo JavaScript y/o a una interrupci√≥n en la cadena de Promesas y/o a excepciones ocultas durante el proceso de generaci√≥n de facturas simplificadas.  

Este problema fue particularmente dif√≠cil de abordar debido a su naturaleza intermitente, ya que ocurre de forma aleatoria y parece estar relacionado con latencias de red u otros factores de sincronizaci√≥n. [SEP] Buenas @rrebollo 

A que te refieres con activar ""R√©gimen simplificado"" en el POS?
En la configuraci√≥n de la compa√±√≠a si veo el check en el apartado TicketBai, pero en el POS no lo veo.

 [SEP] > A que te refieres con activar ""R√©gimen simplificado"" en el POS? En la configuraci√≥n de la compa√±√≠a si veo el check en el apartado TicketBai, pero en el POS no lo veo.

A esto:

<img width=""1354"" height=""819"" alt=""image"" src=""https://github.com/user-attachments/assets/b72b5282-49fa-4ca9-acf8-a6321768f7b5"" />

 [SEP] Sobre la discrepancia entre el valor de `to_invoice` como option y el que figura en el json de pos order, entiendo que puede tratarse de una variaci√≥n en el c√≥digo que no se manej√≥ previamente. Todas las pruebas de la funci√≥n `create_from_ui` de `pos.order` ‚Äîque simulan la llamada desde el servicio RPC de JavaScript‚Äî pasan el mismo valor tanto en el option como en el JSON de pos order; normalmente asignan el mismo par√°metro.

Adicionalmente, al realizar pruebas en un entorno Runbot ([runbot.com](https://runbot.com/)) con una versi√≥n vanilla de Odoo 16 CE, observ√© que, aunque en la interfaz del POS se seleccione la opci√≥n ‚ÄúFacturar‚Äù, el valor de `to_invoice` en options permanece en `false`.

Dada esta situaci√≥n, el enfoque adoptado en este PR para resolver el problema resulta leg√≠timo y adecuado. [SEP] Estoy trabajando en un set de pruebas js [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch), awaiting test results. [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at c2bca315ce4639d63faa0c2b788fcf8215cf93ab. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4676,/ocabot migration l10n_es_aeat_mod115
Pull Request,4675,/ocabot migration l10n_es_aeat_mod111
Pull Request,4674,"@HaraldPanten could u review please? [SEP] Probado en local y funciona correctamente. Se resuelve el error y no hay discrepancias con los resultados (tampoco con prorrata, etc.).

Tambi√©n probado en runboat y se resuelve el error con los grupos de impuestos.

@pedrobaeza Al margen de ajustes que queremos hacer y a√±adir tests, te cuadra el enfoque planteado? Sin este parche (o uno equivalente) actualmente no es posible generar el libro de IVA en instancias que utilicen DUA y tengan facturas del transitario con el grupo de impuestos aplicado.

Gracias. [SEP] En general, utilizar un enfoque con `try` + `except` no suele ser la mejor de las soluciones, ya que ese error puede ser causado por varias razones (aunque se limite la excepci√≥n a capturar), y luego, el c√≥digo del `except` no asegura tampoco que vaya a salir bien. ¬øNo se puede detectar de otra forma la estructura? ¬øPuedes resumir por aqu√≠ c√≥mo sale de una y otra forma para ver si tenemos una mejor forma? [SEP] > En general, utilizar un enfoque con `try` + `except` no suele ser la mejor de las soluciones, ya que ese error puede ser causado por varias razones (aunque se limite la excepci√≥n a capturar), y luego, el c√≥digo del `except` no asegura tampoco que vaya a salir bien. ¬øNo se puede detectar de otra forma la estructura? ¬øPuedes resumir por aqu√≠ c√≥mo sale de una y otra forma para ver si tenemos una mejor forma?

Cambiado con detecci√≥n de longitud. Si ""res"" con la devoluci√≥n de la llamada ""_process_aeat_tax_base_info"" tiene m√°s de longitud 1 es que se est√° haciendo un grupo de impuestos.  [SEP] > Uhm, sigue sin convencerme demasiado... ¬øNo habr√≠a que mirar `si tax es de tipo grupo`, y si es el caso, entonces buscar `res[tax.child_ids]` (en seudoc√≥digo)?

Pongo un ejemplo:
Impuesto: DUA --> account.tax(157,) 
Impuestos hijos: account.tax(9, 154)
res despu√©s de la llamada a ""_process_aeat_tax_base_info"" -> {account.tax(9,): {'tax': account.tax(9,), 'base': 5691.03, 'amount': 0, 'deductible_amount': 0}, account.tax(154,): {'tax': account.tax(154,), 'base': 5691.03, 'amount': 0, 'deductible_amount': 0}} 

1) Se puede comprobar si el ""account.tax(157,) / Tax"" de esa iteraci√≥n es grupo de impuesto y entonces que haga esa ""excepci√≥n"" (sin problema).

2) B√∫squeda  res[tax.child_ids], se podr√≠a realizar, pero solamente con que cojamos la base de uno de ellos ya es suficiente, el resto se pueden ignorar.

¬øTe va bien con ese enfoque?  [SEP] Vale, entonces podr√≠a ser `if is_group(tax): list(res.values())[0][""base""]` [SEP] @pedrobaeza @HaraldPanten sab√©is si hay alg√∫n problema con los runboats?
`Error: Docker login for 'ghcr.io' failed with exit code 1`

Ya he subido el cambio el cambio seg√∫n lo que se habl√≥ ayer üò∏ a ver que os parece. [SEP] > @pedrobaeza @HaraldPanten sab√©is si hay alg√∫n problema con los runboats? `Error: Docker login for 'ghcr.io' failed with exit code 1`
> 
> Ya he subido el cambio el cambio seg√∫n lo que se habl√≥ ayer üò∏ a ver que os parece.

A nivel funcional, el runboat no me ha dado problemas. A priori funciona con normalidad.

Pedro, ya nos das feedback sobre el planteamiento t√©cnico. A nivel funcional querr√© hacer algunas pruebas m√°s; eso s√≠.

Gracias. [SEP] Vale @pedrobaeza  te comento...

Lo que hemos hecho ha sido compatibilizar el grupo de impuestos para sacar el libro de IVA. El desglose en dos l√≠neas no es correcto, como bien dices. A mi entender, deber√≠a comportarse como en las versiones antiguas. Una l√≠nea con la base y la cuota seg√∫n la revalorizaci√≥n. Al final es coger la base y la cutoa donde se aplica el impuesto de importaciones.

De todas formas, eso no lo hemos cambiado. Nosotros lo que hemos hecho ha sido compatibilizar el libro de IVA, tal y como estaba, con los grupos de impuestos. Habr√≠a que hacer un FIX para que apareciera la base y la cuota en una sola l√≠nea, como hab√≠a funcionado hasta la V16. Adjunto captura.

<img width=""1502"" height=""272"" alt=""Captura de pantalla 2025-12-22 a las 14 38 57"" src=""https://github.com/user-attachments/assets/e193d61d-9f17-4cbd-9148-6a1061c3a0a6"" />

Hacemos FIX en este mismo PR en commit por separado? [SEP] Pod√©is ponerlo en este PR. [SEP] ¬øAlguna novedad? [SEP] > ¬øAlguna novedad?

Mi idea es continuarlo el viernes/lunes a m√°s tardar, que entre fiestas y cierres.... üòÖ . [SEP] @pedrobaeza @HaraldPanten indicado en la cabecera del PR y puesto en estado draft como comentamos ayer :) . [SEP] Este PR no debe ser fusionado. Es un parche circunstancial que dejamos abierto (en Draft) por si el resto de usuarios se encuentran con el mismo problema. Esto permite extraerlo, pero no es una soluci√≥n definitiva. Hasta el refactoring del m√≥dulo puede utilizarse como parche temporal."
Pull Request,4673,"Hola, veo que est√°is haciendo esto en varios sitios, pero no tengo claro que mejore velocidad en general, ya que si no se hace prefetch, luego tendr√° que obtener los datos ""por trozos"", y realmente Odoo ya lleva una gesti√≥n para hacer un prefetch inteligente. [SEP] @pedrobaeza con las pruebas realizadas hemos comprobado que con el prefetch, el consumo de la ram era exponencial al calcular el libro de iva de una empresa con muchas facturas, despu√©s de a√±adir dicho cambio el proceso acabo sin problema. [SEP] Ya, ¬øpero y tiempos? ¬øEsa instancia tiene modificaciones severas sobre `account.move` y `account.move.line`? Algo intermedio es hacer prefetch solo de los campos necesarios para el proceso. [SEP] > Algo intermedio es hacer prefetch solo de los campos necesarios para el proceso.

Esta es la soluci√≥n ideal, el problema ser√° que el prefetch estar√° calculando computes complejos que luego no se usan aqu√≠ [SEP] Bueno, en el ORM se difieren la obtenci√≥n de los campos calculados hasta que se usen por primera vez, por lo que eso no deber√≠a ser."
Pull Request,4672,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4672-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4672-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 393a220daebf4090131f7b4464a393111a51eded. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4671,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @pedrobaeza ya que fusionas para 16 y 17, que no se te pase 18. Gracias. üòä [SEP] > Aplica los comentarios de la 16 aqu√≠.

Es verdad, se me olvidar√≥n. Ya est√°, gracias por recordarlo. [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/f6fef01498a0bc8fe52c7b4db26bb3635b48fe62).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 334c6d4c58baafa36e72af2bf861a36338e321df. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4670,"@bjkumal @eantones please review it
 [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4670-by-etobella-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4670-by-etobella-bump-nobump), awaiting test results. [SEP] /ocabot migration l10n_es_facturae_sale_stock [SEP] Congratulations, your PR was merged at 9734cce395dbe79ab0b8ce4dc42955c1ee0320a3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4669,"Los tests fallan por el m√≥dulo `l10n_es_atc_mod420`. Error de fechas https://github.com/OCA/l10n-spain/actions/runs/20652855269/job/59300462804#step:8:1311, me parece que los tests no son correctos si al cambiar de a√±o dan error. [SEP] > A√±ade por favor en los tests dicho impuesto para verificar las casillas - que cambiar√°n -, y as√≠ detectar si en el futuro cambian los XML-IDs, que salte el error.

Hecho. Gracias. [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4669-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4669-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a1afcd8d78181a09b94868b0e103a46936d468f7. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4668,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4668-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4668-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at fdf41b11a53eec1565f7f2694a68aeb8df938e6a. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4667,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4667-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4667-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 465965a147f26dc23bc164f14ac11e0e45b5679e. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4665,
Pull Request,4664,"On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4664-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4664-by-pedrobaeza-bump-patch), awaiting test results. [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] Congratulations, your PR was merged at 174522360a73a6f8b1007ea5e2703401626f0456. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4663,"@pedrobaeza @almumu [SEP] > En este m√≥dulo no se puede depender de `stock`. Mira si existe otra forma de arreglarlo sin requerir esa dependencia. Por otro lado, mira de que no se cambie README/index.html

Vale! Ahora lo intento [SEP] > En este m√≥dulo no se puede depender de `stock`. Mira si existe otra forma de arreglarlo sin requerir esa dependencia. Por otro lado, mira de que no se cambie README/index.html

En teor√≠a, deber√≠a ser suficiente a√±adiendo el t-if=""address"" de la vista original de Odoo

        <div t-if=""address"" t-attf-class=""address row mb-4"" title=""This block is not always present depending on the printed document."">

https://github.com/odoo/odoo/blob/376c36336b4a2bd01c9cb9b2594abee0713bcf51/addons/web/views/report_templates.xml#L280

Con esto ya no aparece el bloque ""Address block"" [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4663-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4663-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 046cdd85ee6296f5e4002c7e9e3261923f6b1f45. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] @RicardCForgeFlow Creo que esto no se llev√≥ a la V17. Podr√≠ais llevarlo/revisarlo?

@pedrobaeza @AaronHForgeFlow @LoisRForgeFlow 

Gracias por la aportaci√≥n. [SEP] > @RicardCForgeFlow Creo que esto no se llev√≥ a la V17. Podr√≠ais llevarlo/revisarlo?
> 
> @pedrobaeza @AaronHForgeFlow @LoisRForgeFlow
> 
> Gracias por la aportaci√≥n.

Hola @HaraldPanten ahora he hecho el cambio para la v17: https://github.com/OCA/l10n-spain/pull/4687

Para la v16 no es necesario, ya que no existe el bloque ""Address block"" [SEP] > #4687

Perfecto! Muchas gracias por la aportaci√≥n."
Pull Request,4662,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] > Si se tiene desactivado el SII, no debe haber facturas con `aeat_state` distinto de `not_sent`, as√≠ que es algo espec√≠fico de esa instancia donde ten√©is el problema, pero este cambio no tiene demasiado sentido para m√≠ ahora mismo.
> 
> ¬øCu√°l es el caso de uso?

Hola @pedrobaeza 
El problema es que para las facturas que se crearon **antes** de activar el m√≥dulo `l10n_es_aeat_sii_oca`, el campo `aeat_state` aparece vac√≠o en lugar de `not_sent` y no deja eliminarlas.

¬øEs correcto este comportamiento?

Igual lo mejor es modificar el campo `aeat_state` de las facturas que se crearon **antes** de activar el m√≥dulo `l10n_es_aeat_sii_oca` con una acci√≥n de servidor en nuestro caso. [SEP] Entendido el problema. Entonces cambia el filtered a que sea `rec.aeat_state not in [""not_sent"", False]`. [SEP] > Entendido el problema. Entonces cambia el filtered a que sea `rec.aeat_state not in [""not_sent"", False]`.

@pedrobaeza buena idea. Acabo de subir los cambios. [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4662-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4662-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cb464963d188c069c266c54ba6a85309e54870c2. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] > /ocabot merge patch
> 
> ¬øPuedes llevarlo a versiones superiores?

Si."
Pull Request,4661,
Pull Request,4660,"¬øPuedes por favor llevarlo a la 17 tambi√©n? [SEP] @pedrobaeza , lo vamos a llevar a todas las versiones ;-)

> Cuando est√© fusionado hago cherry-pick a la 17 [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4660-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4660-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 84ac9d1e30b8c561bc549c324195743a278d1f29. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4659,"@pedrobaeza 
cuando se mergee este ya se podr√≠a eliminar el commit https://github.com/OCA/l10n-spain/pull/4378/commits/625d706d74df3dda6147a8f9982beb95bf803964  del PR  https://github.com/OCA/l10n-spain/pull/4378 de l10n_es_verifactu_pos_oca
"
Pull Request,4658,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] https://github.com/odoo/odoo/blob/2dc9529af127ed4b2d451059b6ab9c83778c7814/odoo/addons/base/models/res_partner.py#L395 [SEP] Comprueba CI. @carlosdauden como t√∫ estuviste cacharreando con esto, tal vez puedes dar pistas [SEP] > Comprueba CI. @carlosdauden como t√∫ estuviste cacharreando con esto, tal vez puedes dar pistas

Te lo cuento, si he revisado y seguro que el error del orden tambi√©n est√° en 17.0. El tema es que en 16.0 el order era por display_name y a partir de 17.0 el order es por complete_name. Esa es la diferencia fundamental.

https://github.com/odoo/odoo/blob/bb60d831a7cdb0606c1baae9a8985b2fdb7dc15b/odoo/addons/base/models/res_partner.py#L179

Por que no ordena bien? por que lo que vemos en pantalla es el display_name con el comercial calculado pero realmente el complete_name no se estaba calculando con el comercial (de ah√≠ el error de los test que espera que siga sin calcularse).

Es correcto que el complete_name siga sin calcularse? No, por que entonces el orden en las vistas no ser√° el correcto visualmente.

El test que hay ahora mismo como digo espera que se calcule el display_name con el comercial pero que el complete_name no se calcule. Por lo tanto hay que modificar el test.

Al a√±adir el contexto al compute que se alimenta del m√©todo _get_complete_name SI a√±ade el comercial y el orden se corresponde con lo visual (display_name) pero claro, el test ya no es correcto. [SEP] Vale, pero recuerdo que @carlosdauden toc√≥ eso. A ver si nos puede dar pistas o nos descarta que tenga que ver. [SEP] /ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4658-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4658-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at 3dcc7dd0d35d4e65db46332557db0354dd17f104. Thanks a lot for contributing to OCA. ‚ù§Ô∏è [SEP] Only 19 fw-port pending."
Pull Request,4656,"/ocabot migration l10n_es_pos_sii [SEP] Listo para revisi√≥n [SEP] Parece que el CI est√° ca√≠do por la imagen de postgres, en un rato lo vuelvo a lanzar [SEP] /ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4656-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4656-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at 68807f45a87a317e10d271b0e1b783ed470f4b65. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4655,"/ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/ffdf47d200bee8f9170bfad477705a941b926829).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 10d2830d6dd464a33cc3fbf445d51eca1261b2e0. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4654,"Hi @etobella,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/0b22bbebc4767e904b260f873457127389013124).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6dec1c2e1db952c6ee513c099d1dea5a213bca08. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4653,
Pull Request,4651,/ocabot migration l10n_es_account_banking_sepa_fsdd
Pull Request,4648,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] Es un caso demasiado espec√≠fico como bien dec√≠s... pero no deber√≠a crearse un m√©todo espec√≠fico para ello, si no ver por qu√© fallan los mecanismos de limpieza est√°ndar y mejorarlos."
Pull Request,4647,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Este desarrollo es incorrecto. Cierra el PR y revisa la tarea por favor"
Pull Request,4646,
Pull Request,4645,
Pull Request,4644,/ocabot migration l10n_es_account_statement_import_n43
Pull Request,4640,"Hola @almumu cuando tengas un rato libre, ¬øpodr√≠as por favor echarle un vistazo r√°pido a este borrador de PR? Me gustar√≠a especialmente tu opini√≥n sobre la parte de la subsanaci√≥n, para ver si consideras que este enfoque es el m√°s adecuado. Cualquier aporte / sugerencia ser√° bienvenida."
Pull Request,4638,
Pull Request,4636,"/ocabot merge minor [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/aefd36e6c26d272f85a3f3ed5a76f9b7a32c2e8f).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at a7fb941179328d37cc002e247425a82a64433ade. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4635,
Pull Request,4634,"@pedrobaeza @almumu [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/07e89917d3bd8a6e9744a50ba89795b0d76a24f5).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3abdabbfc1243bde64b8cd0abce8abceaf4d25cc. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4633,
Pull Request,4630,Pendiente de #4499 
Pull Request,4629,/ocabot migration l10n_es_aeat_partner_check
Pull Request,4627,"Subido con la aproximaci√≥n inicial @pedrobaeza   [SEP] Pero si lo metemos en el `res.config.settings`, ¬øEl usuario va a necesitar permiso de `Ajustes` no? 
Si planteamos esta opci√≥n creo que mi primera aproximaci√≥n con el `wizard` es m√°s apropiada aunque quedara un poco raro el manejo del One2many, el cu√°l, podr√≠amos sustituirlo con un bot√≥n que llame al modelo de `res.company.vat.prorrate` en lugar de manejarlo en el propio wizard [SEP] Con permiso de administrador de facturaci√≥n no se tiene acceso a esa configuraci√≥n? Si es as√≠, entonces no nos valdr√≠a. M√≠ralo y lo que t√∫ veas. [SEP] @christian-ramos-tecnativa c√≥mo qued√≥ esto? El runboat no funciona ahora mismo. [SEP] @pedrobaeza Lo hab√≠a devuelto a la primera aproximaci√≥n utilizando un wizard, he hecho rebase a ver si el runboat colabora. No he encontrado otra forma que quedara mas ""limpia"" a nivel de c√≥digo. La experiencia de usuario considero que si est√° correctamente cubierta. Si puedes pru√©balo de nuevo con mas ""cari√±o"" y me dices que te parece üòÑ  [SEP] Tras volverlo a analizar, lo del m2m lo sigo sin ver. Es mejor hacer una ""copia"" de las l√≠neas en el wizard, y luego volcarlo a lo definitivo. Se podr√≠a hacer f√°cilmente con una herencia con cambio de nombre, y que a√±ada el campo inverse del wizard, y el `company_id` lo rellenas t√∫ en el `default_get` y por contexto para las nuevas l√≠neas, y luego ser√≠a volcarlo haciendo un read y sacando el valor del campo m2o del inverse. [SEP] Listo, he preferido hacerlo al momento de pulsar el bot√≥n `Actualizar` ya que el `inverse` estar√≠a modificando los datos reales con cada modificaci√≥n y considero que hacer eso es un wizard es muy poco intuitivo. Ya que, por lo general, el usuario cree que los cambios se aplican al cerrar el wizard. [SEP] Listo! üëçüèª  [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4627-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4627-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 7b5aa79adfa7b2b84bf80559b20fa24a6b772ac5. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4625,"@adasatorres ping me when all tests are green [SEP] No hay un modelo espec√≠fico para Canarias equivalente al 347? Cu√°l es la finalidad de esto? [SEP] Buenas tardes, @pedrobaeza.
Efectivamente, en Canarias existe un modelo equivalente (el 415). Supongo que debe haber alg√∫n caso espec√≠fico que el 415 no cubre, ya que he visto que este addon existe en la versi√≥n 16.0 conviviendo con el del 415, y adem√°s hay un PR abierto para la 18.0 sobre el mismo tema.

Quiz√° @christian-ramos-tecnativa, que fue quien subi√≥ el addon en la 16.0, pueda aportar m√°s informaci√≥n sobre si realmente es necesario, teniendo en cuenta que ya existe el addon del modelo 415. [SEP] La verdad que cuando hered√© el desarrollo de este m√≥dulo no le d√≠ muchas vueltas, pero ahora por m√°s que lo piense no se me ocurre un ejemplo en el que tengas que presentar un 347 con igic. 
Tienen alg√∫n caso real que utilice esta funcionalidad? [SEP] @pedrobaeza @christian-ramos-tecnativa, Cierro el PR, ya que despu√©s de investigar, he comprobado que para operaciones sujetas a IGIC en Canarias, la obligaci√≥n informativa anual se cumple mediante el Modelo 415. Ademas no  he encontrado ning√∫n excepci√≥n."
Pull Request,4624,/ocabot migration l10n_es_aeat
Pull Request,4622,
Pull Request,4619,"/ocabot migration delivery_mrw [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/90f45c3b812daf9b117af505b4e1fd49ef0453eb).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge nobump [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/69630f6756bdb07ea9d4cc2960f5fbabd0597e73).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge nobump [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at bbfe643b70dbea7c0678cdd530eedf0bc97e355f. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4617,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] ¬ø@pedrobaeza, @LauraCForgeFlow pod√©is revisar los cambios por favor? [SEP] ¬ø@pedrobaeza puedes volver a revisarlo, por favor? Muchas gracias üòä [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch), awaiting test results. [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/76176889882a5f83b88a26517873418b2feb92e4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Al fusionar ha dado error en el m√≥dulo del verifactu [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/6ec673c46be6640c49c60fd937eac8750b92387a).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] Uhm, ese error es extra√±o, pero habr√≠a que solucionarlo para limpiar la rama. [SEP] ¬ø@pedrobaeza puedes volver a lanzar el merge? Ya qued√≥ resuelto el error del verifactu que salt√≥ al fusionar. Gracias [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 7a6618f9e7915b2d71bb92ac59a5818e31718d27. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4616,"Hasta donde s√©, el resultado es autom√°tico y calculado. ¬øEn qu√© casos se necesitar√≠a cambiar ese resultado? [SEP] > Hasta donde s√©, el resultado es autom√°tico y calculado. ¬øEn qu√© casos se necesitar√≠a cambiar ese resultado?

Creo que no, el campo no es compute y no se hace nada en el `calculate` [SEP] Ya, pues entonces creo que es lo que habr√≠a que hacer en lugar de cambiar el readonly, ¬øno os parece? [SEP] @EmilioPascual @ArantxaSudon @pedrobaeza He modificado el PR para hacer la mejora del c√≥mputo del campo tipo declaraci√≥n. [SEP] @pedrobaeza ¬øPodr√≠as revisarlo? ¬°Gracias! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). ü§ñ [SEP] Hola, @pedrobaeza, ¬øpodr√≠as revisar la respuesta de Emilio? ¬°Gracias! [SEP] Efectivamente, como dice @pedrobaeza ""Negativa"" se refiere a 0

<img width=""674"" height=""192"" alt=""image"" src=""https://github.com/user-attachments/assets/41a107e0-bd8e-4af2-80be-16c95b1cff19"" />

Adem√°s, he a√±adido una restricci√≥n al confirmar de que la casilla 30 no sea negativa.

<img width=""658"" height=""106"" alt=""image"" src=""https://github.com/user-attachments/assets/a10a934f-9d06-40dd-83d4-7d6d97e69c6d"" />

Adem√°s, ¬øpod√©is cambiar el nombre del PR para que indique la rama 16.0? Este PR est√° apuntando a 16.0 [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/f85535a28e80a027258ed70673ba4e5dd9119b9c).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 752dc7f82ff323af1eac411cf3e3a57877999201. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4614,
Pull Request,4612,"En lugar de esto, simplemente pon en la clave `excludes` el otro m√≥dulo y deja que Odoo ya haga esta comprobaci√≥n. [SEP] > En lugar de esto, simplemente pon en la clave `excludes` el otro m√≥dulo y deja que Odoo ya haga esta comprobaci√≥n.

Okay! Es verdad, mucho mas simple :sweat_smile:  [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/29ca7de9657b53bb0b4a5c9e892a07b9a9ff3c57).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] @pedrobaeza He parado el workflow ya que ha habido un push despu√©s de tu comando de merge y no s√© c√≥mo puede afectar. ¬øPuedes revisar que se pueda fusionar y relanzar el comando si lo ves bien?

Gracias de antemano. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 016933d9ba88fb920cd08f30bbb82231054eb150. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4611,
Pull Request,4610,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] @Bilbonet uno de nuestros clientes estaba experimentando random issues como [este](https://github.com/OCA/l10n-spain/pull/3909#issuecomment-2666406741). He realizado este patch en aras de corregirlo. En mis pruebas locales funciona correctamente. Tal vez puedas ayudarme con un review funcional. [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4610-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4610-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9587712879dbcb63e709f541cb515964709fea74. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4609,
Pull Request,4608,"Este PR est√° pendiente de solucionar https://github.com/OCA/l10n-spain/pull/4499#issuecomment-3571519427 [SEP] Buenas @syci. 

Desde el desconocimiento (no conozco el r√©gimen tributario canario), ¬øporque has asignado el impuesto ""Exento por Comercio Minorista"" a la clave S1 (Operaci√≥n Sujeto No exenta)?

Por otro lado, el ""IGIC Exento Repercutido"" ¬øporque su causa de exenci√≥n es E6?

El ""IGIC 0% (Exportaciones)"" lo veo bien en E2 por tratarse de una exportaci√≥n.

Como bien dices est√° pendiente del PR del m√≥dulo original."
Pull Request,4607,
Pull Request,4606,"No termino de ver la relaci√≥n de esto con el SII. [SEP] > No termino de ver la relaci√≥n de esto con el SII.

buenos d√≠as @pedrobaeza , la relaci√≥n es que despu√©s de ese cambio en https://github.com/OCA/l10n-spain/commit/fa02f05b86cf2b16c42491bcb49143d6d6be5bb8#diff-d74b92c5e46eac6d96f3fd4c432611a9c7c51c3f691dddba3342721ff660fe3fR16-R17

en el m√≥dulo **l10n_es_vat_book_oss** se establece a 0 el importe de todos los impuestos OSS
https://github.com/OCA/l10n-spain/blob/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_vat_book_oss/models/account_move.py#L16

<img width=""892"" height=""234"" alt=""image"" src=""https://github.com/user-attachments/assets/9c819e14-afa0-403f-a209-21b2e5e71d6f"" />


 y en el m√≥dulo **l10n_es_aeat_sii_oss** se buscan esos mismos impuestos oss para restarlos del importe total en el sii
[l10n_es_vat_book](https://github.com/OCA/l10n-spain/blame/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_aeat_sii_oss/models/account_move.py#L14)
<img width=""709"" height=""307"" alt=""image"" src=""https://github.com/user-attachments/assets/36ad32bb-c6f9-4b0f-9d63-7e5eba6ddba5"" />



por lo que ya no se est√°n restando los impuestos oss del importe total porque ""amount"" siempre es 0 porque el m√≥dulo l10n_es_vat_book_oss lo establece a 0 en la funci√≥n _process_aeat_tax_fee_info que es la que se utiliza dentro de _get_aeat_tax_info (la misma que se utiliza en el sii, y tambi√©n en verifactu para obtener el desglose de impuestos)
https://github.com/OCA/l10n-spain/blob/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_aeat/models/account_move.py#L38
<img width=""1017"" height=""548"" alt=""image"" src=""https://github.com/user-attachments/assets/31c945d0-08a0-43f9-a5c9-2fa7790cb35e"" />


<img width=""1203"" height=""497"" alt=""image"" src=""https://github.com/user-attachments/assets/b7d5572b-5683-4c6e-ace3-656f4fddf369"" />


 [SEP] Ya, ah√≠ est√° el tema, que la idea es que libro de IVA deber√≠a ser igual a SII/VERI*FACTU, y por eso busco que haya una fuente de verdad. Creo que lo que podemos hacer si no es tener como con la cuota: el importe y luego lo deducible, pues aqu√≠ la base y la base ""aplicable a impuestos"", y entonces quitar de uno u otro, y as√≠ seguir conteniendo todo en el mismo diccionario y llamada, pero utilizar una u otra seg√∫n interese. [SEP] @pedrobaeza el problema es que ahora todas las facturas con OSS salen con incidencias en el SII. Exactamente que se deber√≠a hacer para poder cerrarlo? [SEP] ¬øQu√© te parece la sugerencia de tener esos cuatro valores devueltos, y leer en cada m√≥dulo (SII/vat book) lo que interese? Si no lo ves factible, vamos a solucionarlo de la manera que sea."
Pull Request,4602,"This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4602-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4602-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 8af041d43cd184373e75b8546b94222896a614e0. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4601,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] No es un error real seg√∫n lo comentado en https://github.com/OCA/l10n-spain/issues/4596#issuecomment-3569886665, as√≠ que cierro."
Pull Request,4600,Pendiente de #4622 
Pull Request,4599,
Pull Request,4598,"This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4598-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4598-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 431acdf74780f8abe623486749c76d4f9b599f79. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4595,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4595-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4595-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4595-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/e9beaf90a5587fb40d173948f599d69e1543e8b6).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] @ramzeta por favor no quites los par√°metros anteriores. El error en el CI que hay ahora mismo se debe a que FACe lleva m√°s de 24 horas ca√≠do. A ver si lo solucionan, y si no, veremos de desactivar temporalmente los tests, aunque precisamente el m√≥dulo tampoco funciona debido a eso. [SEP] Vale subo una mejora que detecte ! Gracias [SEP] S√≠, y por favor haz squash de los commits y revisa el CI de pre-commit."
Pull Request,4594,
Pull Request,4593,"/ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4593-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4593-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3553e282cd4cad0d5a5f452ee61c695e4f3b5b48. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4592,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/c677e71f371d07f2d21bd06b816d8f9f8a241fc4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch), awaiting test results. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cd13b882929971aa0f9f784ce50fb3954dc25fec. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4590,ping @juancarlosonate-tecnativa he a√±adido el cuando se cambie el partner recalcule los impuestos en `sale.order`. En el caso de `purchase.order` y `account.move` ya se hace.
Pull Request,4588,"/ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4588-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4588-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at c887d9e624468fa97da94034359635e607eefa83. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4587,"/ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4587-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4587-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at 468bd2f477811f83440f988ec0f7e72f3d007066. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4585,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @carlos-lopez-tecnativa Done!! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4585-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4585-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 531a2525a14caf27de84040f1da629515a303f0f. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4584,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4584-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4584-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 491f186a858791d88dee5294e74389b2d58d4766. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4583,"He probado el m√≥dulo pero primero me da error que no esta instalado ""pos_hr"", creo que hay que incluir esa dependecia, el QR sale en la impresi√≥n pero cuando va a la URL no aparece el n√∫mero de factura, aparece como ""false"", y logicamente da ""factura no encontrada"" [SEP] Este m√≥dulo no debe depender de `pos_hr`. [SEP] > He probado el m√≥dulo pero primero me da error que no esta instalado ""pos_hr"", creo que hay que incluir esa dependecia, el QR sale en la impresi√≥n pero cuando va a la URL no aparece el n√∫mero de factura, aparece como ""false"", y logicamente da ""factura no encontrada""

A falta de revisar el error que comentas, comentar que el m√≥dulo no tiene dependencia directa con pos_hr.
Sus dependecias son: l10n_es_pos_oca y l10n_es_verifactu_oca [SEP] S√≠, parece l√≥gico mirar el flag de simplificado. [SEP] @cesarportas 
Functional review: tras a√±adir este m√≥dulo y hacer una venta en POS me salta el siguiente error cuando voy a validar el m√©todo de pago. Me da tanto con tarjeta como en efectivo as√≠ que el m√©todo de pago no influye en el error. 

Tengo VERIFACTU configurado correctamente y este error s√≥lo me da dentro del POS ya que dentro de las facturas, puedo validar y confirmar una factura sin problema ninguno.


<img width=""1920"" height=""1171"" alt=""image"" src=""https://github.com/user-attachments/assets/2f30fee1-aac9-4a63-85f9-7db293dea221"" />
"
Pull Request,4582,"Tiene sentido mantener esto en lugar de ir al de Odoo core? [SEP] @pedrobaeza gracias por avisarme, no me hab√≠a dado cuenta que en v19. 0 estaba en el core, lo cancelo. "
Pull Request,4581,"@pedrobaeza Aprovechando que estoy haciendo esto, veo que ahora lo que nos piden es enviar el .pem del certificado, no copiarlo manualmente. Teniendo en cuenta que no tiene passwords, podr√≠amos intentar que fuera una funcionalidad parecida al show key que hay a dia de hoy, aunque en las pruebas que he hecho me implicaba hacer un campo calculado que cada vez que entrabas sacaba la parte p√∫blica. El problema es que no puedo descargar el fichero con ese onchange. Si cambiamos esa funcionalidad por un wizard te parece bien? En el wizard aparecer√≠a la clave p√∫blica escrita por si la queremos copiar y tendr√≠amos la opci√≥n de descargar el fichero pem.

Opci√≥n con el onchange se ver√≠a as√≠:

<img width=""584"" height=""133"" alt=""image"" src=""https://github.com/user-attachments/assets/782aa2f1-09a6-4b0b-891c-55c68ee233b2"" />

Con el bot√≥n seria m√°s sencillo creo yo. [SEP] Con el onchange no se ve mal tampoco, ¬øno? [SEP] el tema es que con el onchange no va, se debe hacer un campo compute que no depende del valor del campo no almacenado (el show public certificate), por lo tanto, el campo se recalcula cada vez que entramos en el registro, no cuando lo pedimos. Esto se hace as√≠ por que en el momento de hacer la descarga, el fichero vuelve a calcularse, y al ser el show un no stored, lo vuelve a poner a False y, por lo tanto, no hay elemento. [SEP] Bueno, si ves problemas t√©cnicas, no creo que sea mucho problema tener un bot√≥n + popup"
Pull Request,4580,"@ajfebres Recuerda que es un commit por m√≥dulo, quita el del pre-commit [SEP] @syci Estoy conservando el hist√≥rico de la versi√≥n de la cual estoy migrando, seg√∫n:

https://github.com/OCA/maintainer-tools/wiki/Migration-to-version-15.0 [SEP] > @syci Estoy conservando el hist√≥rico de la versi√≥n de la cual estoy migrando, seg√∫n:
> 
> https://github.com/OCA/maintainer-tools/wiki/Migration-to-version-15.0

S√≠, pero este no corresponde tenerlo en el hist√≥rico. 
<img width=""1136"" height=""84"" alt=""image"" src=""https://github.com/user-attachments/assets/926bac47-53f6-40b9-bad2-aae9c238bb46"" />
 [SEP] Pendiente de #4499 "
Pull Request,4579,"`
    if(!result.verifactu_qr){
                    result.verifactu_qr = this._get_verifactu_qr_code_data();
                }
                return result;
`

A la hora de reimprimir no sale el qr 

En el models js me aparece correctamente con esto en el export_for_printing() al volver a reimprimir el ticket

As√≠ ya lo ven en la 14"
Pull Request,4577,"/ocabot merge major [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4577-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4577-by-pedrobaeza-bump-major), awaiting test results. [SEP] Congratulations, your PR was merged at d72dfe8658ba37e3422aa225265070a7736ee9f0. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4576,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/b4a39e1696e2d3ceeb5fd39ed8a3abdaa58b9559).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9f6c6d16ceddfdd49fa0889ffb62dc54d672cc91. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4575,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4575-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4575-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 704c5b184812e910a538ead8fa921c8f1fc4d974. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4574,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4574-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4574-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cb531729904d61860afb53c8d466e5e6aa3ffeaf. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4573,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/b23a2176266c21fdf0e7224fc010ff8dfcafaac4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 95dbcd78d0cf3fdeb224f2b762414b8348dc3d2f. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4572,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4572-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4572-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 4f2881fc04f98bcd6614a6fb25aacf7ca91331f0. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4571,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [15.0-ocabot-merge-pr-4571-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4571-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 06757f5a5eda1a37ffed89504a1b1ef98296d766. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4570,"@enriquemartin FYI [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [14.0-ocabot-merge-pr-4570-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/14.0-ocabot-merge-pr-4570-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9b36a6849d6e56d1b30eb0bb8b2816fa8ede7cf6. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4569,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4569-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4569-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ce22d44d4ac2ee627d4ae544e9de09fe57c40163. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4568,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4568-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4568-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 8d5e2967d0a7c40ea93f74b23a5c9adfaa9150a3. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4566,"Hi @EmilioPascual, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] @etobella recuerdas la funci√≥n de eso? [SEP] @Andrii9090 actualiza el commit, el m√≥dulo se llama `l10n_es_vat_prorate`, no l10n_vat_prorate [SEP] Parece que ese cambio viene de este PR cancelado de migraci√≥n https://github.com/OCA/l10n-spain/pull/4251/files#diff-e382c2f33435675e086d7fac9d04032b592ec563e685ec3b2fb75bea7e3f1c05

Cuando @Andrii9090 retomo la migraci√≥n a 18.0 lo hizo a partir de ese PR. ¬ø@BetoRaja, @Anxo82, @HaraldPanten os acord√°is porque a√±adiais la parte que se quita en este PR?

A falta de un argumento v√°lido yo lo qutar√≠a, no entiendo el motivo de hacerlo y adem√°s est√° causando problemas. [SEP] Cierto, en este commit lo a√±aden https://github.com/OCA/l10n-spain/pull/4251/commits/8dcd1b62b652042b5713afeecb8530847af32985#diff-e382c2f33435675e086d7fac9d04032b592ec563e685ec3b2fb75bea7e3f1c05 [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4566-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4566-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 79f14ccd015c49ee823420931e288d2d29260bb6. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4565,"/ocabot merge major [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/c348bdd33d95ed0aab919dcda216d64ee915abb8).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge major [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major), awaiting test results. [SEP] Congratulations, your PR was merged at dc4ac92efef35495876d8f4a7382fb9be6541476. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
Pull Request,4564,"/ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4564-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4564-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 596197dd3787a58b1c1a66de548ef88b37a72df7. Thanks a lot for contributing to OCA. ‚ù§Ô∏è"
