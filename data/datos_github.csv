tipo,numero,comentarios
Issue,4793,Siendo tratado en #4784 
Issue,4760,"Además, hemos podido comprobar que el mismo problema se reproduce en Odoo 17.0, utilizando el módulo l10n_es_aeat_mod190 en la rama 17.0.

Al generar el fichero del modelo 190 desde Odoo 17.0 para el ejercicio 2025, la sede electrónica de la AEAT devuelve errores similares, relacionados con la falta de los campos obligatorios correspondientes a prestaciones de jubilación, viudedad, pensiones por incapacidad y percepciones asimiladas, que son requeridos por la AEAT para dicho ejercicio.

Actualmente, dichos campos no parecen estar contemplados tampoco en la rama 17.0 del módulo, provocando que el fichero generado no sea válido para su importación.

Dado que estos campos ya han sido incorporados en la rama 18.0, consideramos que un backport de los cambios desde 18.0 hacia 17.0 (y 16.0) permitiría mantener la compatibilidad del modelo 190 con los requisitos de la AEAT para el ejercicio 2025.

Gracias por vuestro trabajo y soporte. [SEP] Sí, desde luego la solución pasa por llevar esos cambios a ambas ramas. La cuestión es que quien esté interesado en ello debe hacerlo, financiar para que lo hagan, o esperar a que otros lo hagan, ya que así es como funciona el software abierto: se contribuye voluntariamente y donde es posible hacerlo. Lo ideal sería que quien contribuye el parche, lo haga para todas las versiones posibles, pero no se le puede exigir que así lo haga. Cuando el parche se pone en una versión intermedia, sí que solemos pedir que por lo menos lo lleven a todas las versiones superiores para mantener todo sincronizado. En este caso, es al revés, habiendo sido puesto en la última versión disponible, pero no estando en las versiones anteriores.

La mayoría de trabajo está hecho, así que solo falta ese último empujón. ¿Os animáis? [SEP] @pedrobaeza Gracias por la aclaración.
De acuerdo, nos pondremos con el backport de los cambios desde 18.0 a las ramas 16.0 y 17.0 para cubrir los requisitos del ejercicio 2025, intentaremos hacerlo lo antes posible.
 
Gracias. 🙂"
Issue,4743,
Issue,4681,"Hola.

Agradecería si alguien puede confirmar que también tiene este problema en Verifactu en V17. He buscado razones para que funcionara correctamente en V16 y tras migrar a V17 apareciera este error, pero no he encontrado nada.

Gracias "
Issue,4677,
Issue,4666,"Ya he podido solucionarlo, en la v12 existía en el core de odoo la reconciliación, a partir de la v14, ya no existe y se hace mediante los módulos de oca, y es por eso que ese módulo al llegar a la v18 y desplegar la bbdd actualizada, no mostraba lo mismo ya que no tenía el módulo de reconciliación.

Por si a alguien le sirve aquí estaba la solución.

Gracias!"
Issue,4652,"@HaraldPanten  [SEP] @pedrobaeza tiene que ver con los cambios que llevasteis a cabo no hace mucho. Está causando ralentización y errores cuando se utilizan grupos de impuestos. En este caso el DUA, concretamente.

Ya nos das feedback. [SEP] @pedrobaeza Pudiste echarle un ojo a los comentarios en esta incidencia?

Gracias. [SEP] No, lo siento. [SEP] @pedrobaeza Podéis echarle un ojo? O proponemos parche directamente? [SEP] Si podéis vosotros proponer parche, os lo agradecería. Con el fin de año estoy desbordado. [SEP] El PR propuesto https://github.com/OCA/l10n-spain/pull/4674 da una solución a la incompatibilidad, pero no se aceptará debido a que el módulo necesita un refactoring, se tendrá en cuenta más adelante, quien quiere utilizarlo es totalmente viable.
Por mi parte dejaría la Issue abierta para que haya una referencia.  [SEP] @pedrobaeza Dejamos esta issue abierta, para que el resto de usuarios tengan más facilidad para encontrar la traza, etc. Cuando más adelante se plantee refactoring, ya cerramos.

Gracias."
Issue,4650,"Faltaría un módulo `l10n_es_sii_reav` que añada los mapeos donde correspondan, y tal vez trate la clave adecuada en la posición fiscal."
Issue,4649,PR para 4T-12/2025: https://github.com/OCA/l10n-spain/pull/4691
Issue,4642,"¿Pero y cuando sea factura de rappel? ¿O se rectifique una factura no introducida en Odoo (por ejemplo, por cambio de software)? ¿Qué pasa si no se envía `""FacturasRectificadas"": [],`? ¿No debería ser ése el parche? [SEP] Igual si, igual el parche es enviarlas sin ""FacturasRectificadas"": [], aunque lo marca en en diseño del registro como obligatorio, pero si no lo envías lo acepta.
Asi NO se envia a verifactu
        ""TipoFactura"": ""R1"",
        ""TipoRectificativa"": ""I"",
        ""FacturasRectificadas"": [],
Asi SI se envia a verifactu
       ""TipoFactura"": ""R1"",
        ""TipoRectificativa"": false,
        ""DescripcionOperacion"": ""/"",

Pero que no se envíe creo que es propio del módulo de verifactu. No es que aeat lo rechace, realmente no se envia. Pero el cron tampoco da error visible. [SEP] Hola. Tenemos una instalación de Odoo 17 con verifactu, en la cual un usuario, por mala costumbre desde antes de verifactu, realizó una factura rectificativa directamente sin crearla desde la factura de venta original.

El resultado es el mismo que se está comentando en este issue. ¿Ahora que ya la factura rectificativa está creada cuál es la mejor solución? 

Entiendo que lo que está esperando verifactu y le falta es:
```
""FacturasRectificadas"": [
            {
                ""IDFacturaRectificada"": {
                    ""IDEmisorFactura"": ""BXXXXXXXX"",
                    ""NumSerieFactura"": ""SIXXXXX"",
                    ""FechaExpedicionFactura"": ""01-01-2026""
                }
            }
        ]
``` 

¿Podría meterlo a través de BD, o hay alguna otra solución mejor?

Gracias [SEP] Hola. Únicamente confirmar que introduciendo en BD el reversed_entry_id de la factura original que está relacionada con la rectificativa, soluciona el problema puntual.

Entiendo que la solución definitiva es que si verifactu está instalado y habilitado, no se permita a los usuarios crear facturas rectificativas directamente, al igual que no se permite la cancelación de las facturas.

Un saludo y muchas gracias"
Issue,4641,PR: https://github.com/OCA/l10n-spain/pull/4690 [SEP] Implementado.
Issue,4639,"El validador no parece funcionar correctamente, ya que el XSD sí se cumple, y las facturas suben a FACe. ¿Has probado a subir alguna? [SEP] Si, este es el error que me da al intentar subir.

<img width=""1600"" height=""860"" alt=""Image"" src=""https://github.com/user-attachments/assets/231c20f1-dbd5-4084-8c13-1cfc282ce151"" /> [SEP] Creo que puede ser por los experimentos con el nuevo sistema FACe que están haciendo. @etobella tú tienes problemas? [SEP] Con la integración directa no he visto errores en mis clientes. Por lo que veo del error, se queja de que la etiqueta CnoCnae está definida pero debería estar vacía, pero esto en teoría no se rellena y se vacía automáticamente. [SEP] @etobella se queja de todas las etiquetas que estan vacias, yo he hecho un fix para que las que estan vacias no las ponga en el fichero y ya me deja subir bien, pero creo que se debe de corregir en el módulo. [SEP] @manuelcalerosolis La limpieza ya se hace automáticamente aquí y está así desde hace tiempo. Los ficheros firmados desde el Odoo deberían salir limpios.

https://github.com/OCA/l10n-spain/blob/18.0/l10n_es_facturae/reports/report_facturae.py#L45 [SEP] Mis clientes lo estan exportando sin firmar, tambien deben de salir limpios, ¿no? [SEP] No lo sé, nunca los he usado así, ya que te complicas mucho la vida. Si lo ves necesario puedes proponer un PR 😉 "
Issue,4637,Debéis hacer backport de #4602 
Issue,4632,
Issue,4631,"Yo por mi parte no veo bug aquí. Sí podría ser interesante que, cuando se crean nuevos diarios de venta, se genere alguna alerta del tipo ""Por favor, revise si debe activar la comunicación Verifactu en este diario"".

Hay casos en los que se necesitan registrar / importar en Odoo facturas de venta que han sido generadas desde otro SIF y, por lo tanto, ya han sido comunicadas a Verifactu en ese otro sistema.
 [SEP] El SIF debe cumplir la normativa siempre.
Permitir crear facturas sin ese check activado no cumple el reglamento de facturacion

Ahí esta mi preocupación [SEP] La verdad es que aunque haya casuísticas que puedan justificar no enviar a VERI\*FACTU, esto es la puerta abierta a tener un diario de ""caja B"". @almumu @anmarmo1 @SoniaViciana recordáis cuál fue la razón inicial de habilitar VERI\*FACTU por diarios? O fue solo por mimetizar con el SII?

Y lo mismo podría plantearse de las posiciones fiscales. [SEP] Disculpas si convenís que esto aquí no procede

Pero si viene a colación

Hay una casuística que igual puede ser tenida en cuenta

Cuando el destinatario de las operaciones es quien emite la factura en nombre del emisor

El destinatario envía a la AEAT pues es él quien la ha generado con un SIF y esa AUTOfactura se la envía al emisor

Vamos a necesitar introducir en odoo esa factura para contabilizarla, pero esa factura ya ha sido enviada, ya tiene una serie y un número

Se podría limitar o modificar algún elemento de todos los registros account.move que pertenezcan a esos diarios concretos para que no generen facturas a través de la modificación del reporte

 [SEP] Pongo un escenario real:

-Empresa del sector eléctrico que utiliza Odoo como ERP para su operativa general (contabilidad, compras, facturación propia, etc.).
-Además, subcontrata un SIF externo para la emisión de determinadas facturas en su nombre.

Ese SIF externo:

-Genera su propia serie y numeración,
-Remite esas facturas a Verifactu, cumpliendo con las obligaciones técnicas de envío establecidas en el reglamento.

Para poder llevar la contabilidad consolidada en Odoo, la empresa debe importar periódicamente esas facturas ya emitidas en el sistema externo. Deben existir como facturas en Odoo (por IVA, libros, modelos fiscales, conciliaciones…), pero no deberían reenviarse a Verifactu, ya que ese envío ya se realizó correctamente desde el primer SIF.

Por ese motivo, veo lógico que el módulo de OCA permita configurar diarios en los que:

-Se registren e integren esas facturas externas,
-Pero con Verifactu desactivado para evitar duplicidades en la AEAT.

Desde mi punto de vista, la configuración por diario no es un error, sino que permite cubrir escenarios en los que una empresa factura desde varios SIF y, aun así, centraliza toda su contabilidad en Odoo.

En este contexto existirían dos SIF diferenciados:

-El SIF externo, que emite y, por tanto, es responsable de enviar a Verifactu lo que él mismo genera.
-Odoo, que actúa como SIF únicamente respecto a las facturas emitidas efectivamente en Odoo. Los diarios “no Verifactu” no emiten; simplemente contabilizan facturas originadas en otros sistemas.

Coincido con Pedro en que esta flexibilidad podría malutilizarse para crear diarios “opacos”, pero entiendo que ese riesgo existe en prácticamente cualquier ERP y no deriva de la funcionalidad en sí, sino del control interno y los procesos de cada empresa.
 [SEP] Con ese planteamiento

Se permite emitir facturas al margen del reglamento

No es viable [SEP] FAQ para desarrolladores de la AEAT: https://www.agenciatributaria.es/static_files/AEAT_Desarrolladores/EEDD/IVA/VERI-FACTU/FAQs-Desarrolladores.pdf

El punto 10, importación de facturas, creo que da la pista sobre el tema. Pongo este extracto:

[...]Por lo tanto, en los sistemas del empresario,
efectivamente, este tendrá facturas de dos clases: las producidas con su SIF y las
producidas con el SIF del empresario al que delegue esa facturación. Esas otras
facturas, naturalmente no se tienen ni que volver a imprimir con QR, ni mucho menos
volver a enviarlas a la Sede Electrónica de la AEAT. Ambas funcionalidades las habrá
realizado el SIF de la empresa que materialmente las haya emitido.[...]


 [SEP] El módulo de odoo SA para 18 por ejemplo , no permite desconectar verifactu en un diario de ventas si verifactu está activado [SEP] Sin embargo, el módulo de odoo SA no bloquea el diario de ventas con el hash de odoo (esto sería otra cuestion) [SEP] Propuesta de solución

En aquellos deployments donde Verifactu esté activado a nivel de compañía —como sucede actualmente— puede darse el caso de que existan diarios con la opción Verifactu activada y otros diarios donde dicha opción no esté activada.

Para garantizar el cumplimiento normativo y evitar inconsistencias, se propone aplicar una restricción directa sobre los movimientos contables (account.move) que pertenezcan a diarios con Verifactu desactivado.

Restricción propuesta

Para los registros de account.move cuyo diario no tenga habilitada la opción Verifactu, se aplicarán los siguientes bloqueos:

1. No permitir imprimir

Los documentos contables asociados a estos diarios no podrán ser impresos bajo ninguna circunstancia.
Esto evita que se generen versiones impresas que puedan interpretarse como documentos oficiales cuando no cumplen con los requisitos Verifactu.

2. No permitir enviar

Del mismo modo, estos documentos no podrán enviarse a terceros (por email u otros medios) desde el sistema.
El objetivo es impedir que se distribuyan documentos que no estén validados conforme al estándar Verifactu.

Resultado esperado

Con esta limitación:

Los diarios con Verifactu activado seguirán funcionando con todas las características previstas (envío, impresión, informes…).

Los diarios sin Verifactu activado quedarán claramente diferenciados, sin posibilidad de imprimir ni enviar sus movimientos.

Se evita cualquier uso indebido o interpretación errónea de documentos no validados según Verifactu.

Se garantiza un funcionamiento coherente dentro del mismo deployment mixto. [SEP] > La verdad es que aunque haya casuísticas que puedan justificar no enviar a VERI*FACTU, esto es la puerta abierta a tener un diario de ""caja B"". [@almumu](https://github.com/almumu) [@anmarmo1](https://github.com/anmarmo1) [@SoniaViciana](https://github.com/SoniaViciana) recordáis cuál fue la razón inicial de habilitar VERI*FACTU por diarios? O fue solo por mimetizar con el SII?
> 
> Y lo mismo podría plantearse de las posiciones fiscales.

Hola Pedro, lo dejamos abierto por que se planteo el tema de las auto-facturas y posibles casos en los que no se tuviesen que remitir a AEAT, Realmente, no se si realmente hay casos en los que no aplique el verifactu a parte de diarios que se utilicen para importar ventas y cosas asi, pero personalmente yo no lo contemplaría en un diario de venta ya que si lo tratamos como factura nos obliga a tener un registro de facturacion aunque no se envie a AEAT y la implementacion de eso se complica, el registro de facturacion no es la propia factura en el documento de faq's en el punto 10 ""Cada factura tiene un Registro de Facturación (RF). En la configuración de dicho RF se incluye la identidad del SIF emisor. Por lo tanto, las facturas, mejor dicho los Registros
de Facturación, que se encuentren soportados en un sistema de Gestión, pero que no
hayan sido producidos por el SIF del empresario, son fácilmente identificables como
RFs importados para dicha gestión"" Eso implica que guardemos la identificación del SIF original [SEP] En ese sentido, quizás sería interesante habilitar un campo de la cabecera de la factura, para diarios de venta No Verifactu, en el que se pueda informar la identificación del SIF original.
 [SEP] Y, también, lo que indica cesarsc79 tiene sentido: si se trata de facturas importadas desde otro SIF, hacia un diario de ventas de Odoo No Verifactu, quizás se podría plantear la posibilidad de impedir que se pueda imprimir o enviar una factura, estas facturas solo deberían existir en Odoo con propósitos de gestión contable, declaración de impuestos... Pero no para reimpresión (al menos el Qr ya no sale) o para envío.  [SEP] Cuantas más vueltas le doy, más se debería prohibir estos diarios que no envíen a VERI*FACTU. Si alguien importa, que en su proceso de importación neutralice esas facturas para que no se envíen otra vez (por ejemplo, tocando el estado VERI*FACTU y poniéndolo a enviado). [SEP] Esos diarios serán necesarios en varios escenarios

Autofacturas
Facturas emitidas con otro SIF

Debemos tener en cuenta que este reglamento está orientado más al fabricante de software que al cliente final. Solo hay que ver las sanciones

Lo de la declaración responsable firmada por el propio cliente, no es una solución [SEP] Creo que aquellos que quieran bajo su riesgo tener esos diarios, debería ser mediante un módulo extra que lo habilite, pero no en el módulo base. ¿Estáis de acuerdo los que habéis intervenido en el desarrollo? [SEP] La solución que comentas, Pedro, me parece la solución ideal: módulo base restrictivo y plenamente orientado a la norma. Módulo extra, permitirá que quienes usen Odoo como SIF pero también deban importar de SIF diferentes (imprescindible en determinadas operativas o sectores), tengan una solución para ello. [SEP] > Creo que aquellos que quieran bajo su riesgo tener esos diarios, debería ser mediante un módulo extra que lo habilite, pero no en el módulo base. ¿Estáis de acuerdo los que habéis intervenido en el desarrollo?

A colación de lo que dices, he estado pensando otra posible solución que tiene en cuenta tus comentarios.......


### 📝 PROPUESTA FUNCIONAL Y TÉCNICA PARA `l10n_es_verifactu_oca

A raíz del debate sobre la posibilidad de crear diarios de ventas sin Verifactu aun teniendo Verifactu activo en la compañía, y considerando además la necesidad de gestionar **facturas emitidas por otros SIF** (autofacturas, delegación de facturación, SIF sectoriales…), propongo la siguiente solución dividida en dos niveles:

---

# 1️⃣ PROPUESTA FUNCIONAL

## 1.1. Comportamiento del módulo base `l10n_es_verifactu_oca` (estricto y seguro)

Cuando una compañía tenga Verifactu activado:

1. **Todos los diarios de tipo “Ventas” deben ser Verifactu por defecto**  
   - Al crear un diario con `type = sale`, el check Verifactu debe venir marcado automáticamente.  
   - No debería ser posible desmarcarlo desde el módulo base.

2. **No se deben poder validar facturas de venta fuera del flujo Verifactu**  
   - Si la compañía tiene Verifactu activo y se valida una factura de cliente (`out_invoice` / `out_refund`):
     - El diario debe tener Verifactu activado.  
     - Si no lo tiene → error.
   - Mensaje propuesto:
     > “No se pueden validar facturas de venta en un diario sin Verifactu cuando la compañía tiene Verifactu activado.”

3. **Sin modalidad “NO Verifactu” en el módulo base**  
   - En Odoo 16 (OCA) solo contemplamos la modalidad “Verifactu”.  
   - Toda factura emitida desde un diario de venta normal debe pasar por Verifactu.

Este comportamiento evita:
- la emisión de facturas de “caja B”,
- inconsistencias en la traza Verifactu,
- errores involuntarios por parte del usuario.

---

## 1.2. Módulo adicional OCA (nuevo): gestión de **facturas importadas desde otros SIF**

La AEAT, en la FAQ 10 (“Importación de facturas desde otros sistemas”), especifica que pueden coexistir:

- facturas emitidas por el SIF del empresario (Odoo), y  
- facturas emitidas por otro SIF (delegado, del destinatario, sectorial…).  

Estas facturas **no deben reenviarse a AEAT ni reimprimirse con QR**, pero sí deben almacenarse indicando el **SIF emisor original**.

Para cubrir estos escenarios, se propone un módulo adicional (p. ej. `l10n_es_verifactu_oca_import`) con:

### a) Nuevo modo de diario:  
**“Diario de importación desde otro SIF”**

Campo nuevo en `account.journal` (solo tipo `sale`):

- `verifactu_import_journal = True` → el diario se usa para **registrar facturas emitidas por otro SIF**, no por Odoo.

Al activarlo:
- La opción Verifactu del diario se desactiva (este diario no actúa como SIF).  
- Odoo no debe generar RF ni enviar nada a AEAT para estas facturas.

### b) Nuevos campos en la factura (`account.move`)

Para facturas en diarios de importación:

- `external_sif_id` – Identificador del SIF original.  
- `external_sif_installation` – Nº de instalación del SIF original.  
- `external_rf_identifier` – Identificador del RF original (si se tiene).  
- `is_external_invoice` (compute) – Indica que es una factura importada.

Esto permite cumplir la trazabilidad prevista en la FAQ 10.

### c) Restricciones: sin impresión ni envío

Para `is_external_invoice = True`:

- No se permite **imprimir** la factura desde Odoo.  
- No se permite **enviarla por email** desde Odoo.

La impresión y entrega al cliente ya la realizó el SIF original.

### d) Exclusión del flujo Verifactu

Las facturas importadas:

- No deben generar RF Verifactu.  
- No entran en el hash encadenado.  
- No se seleccionan para envío a AEAT.  
- Pueden existir para contabilidad, libros de IVA y modelos fiscales.

---

# 2️⃣ PROPUESTA TÉCNICA

## 2.1. Módulo base

### `account.journal`
- En `create` / `write`:
  - Si `type == 'sale'` y Verifactu está activo en la compañía:
    - Forzar `verifactu = True` salvo que el módulo extra marque explícitamente el diario como `verifactu_import_journal`.

### `account.move`
- En `action_post`:
  - Si es factura de cliente y:
    - diario es tipo `sale`,
    - Verifactu está activo a nivel de compañia,
    - Verifactu no activado en el diario
    - y **NO** es diario de importación → error.

---

## 2.2. Módulo adicional `l10n_es_verifactu_oca_import`

### Nuevos campos en `account.journal`
```python
verifactu_import_journal = fields.Boolean(
    string=""Diario de importación desde otro SIF"",
    help=""Para registrar facturas ya emitidas por otro SIF y enviadas a AEAT.""
)
```

Al marcarlo:
```python
if self.type == 'sale' and self.verifactu_import_journal:
    self.verifactu_enabled = False
```

### Nuevos campos en `account.move`
```python
external_sif_id = fields.Char()
external_sif_installation = fields.Char()
external_rf_identifier = fields.Char()
is_external_invoice = fields.Boolean(compute=""_compute_is_external_invoice"", store=True)
```

### Bloqueo de impresión y envío
```python
def action_print(self):
    if self.is_external_invoice:
        raise UserError(""No se puede imprimir una factura emitida por otro SIF desde Odoo."")
    return super().action_print()

def action_invoice_sent(self):
    if self.is_external_invoice:
        raise UserError(""No se puede enviar por email una factura emitida por otro SIF."")
    return super().action_invoice_sent()
```

### Exclusión del flujo Verifactu
En el método que prepara envíos:
```python
moves = moves.filtered(lambda m: not m.is_external_invoice)
```

---

# 3️⃣ BENEFICIOS

- Cumple estrictamente con Verifactu y evita riesgos de “caja B”.
- Respeta la normativa sobre RF importados descrita en la FAQ 10.
- Permite a las empresas que trabajan con varios SIF integrar facturas sin duplicidad en AEAT.
- Mantiene una arquitectura modular:  
  - el módulo base es seguro y normativo,  
  - el módulo extra añade flexibilidad para quien realmente la necesita.


 [SEP] Vamos a empezar quitando la opción de desactivarlo, y luego se hace el módulo extra. Si quieres ir con ello, adelante. [SEP] Estoy de acuerdo con desactivar la opción creo que si alguien realmente lo necesita habria que hacer otro módulo como decis. [SEP] En todo caso... Creo que podremos pensar en todo esto de forma más pausada, con el aplazamiento. Como se suele decir: ""para mear y no echar gota"". Estoy en shock. [SEP] Noticia del aplazamiento.

[https://www.eleconomista.es/legal/noticias/13672020/12/25/hacienda-da-un-respiro-a-empresas-y-autonomos-y-retrasa-verifactu-a-2027.html](url)

Cuando este publicado en el boe, seguimos [SEP] ¿como quedó esto?
Verifactu sigue siendo obligatorio desde el verano pasado para la gente que empiece a usar el SIF [SEP] Sí, Odoo cuenta con VERI*FACTU. Otra cosa es que no se active hasta que no haga falta."
Issue,4626,
Issue,4623,
Issue,4620,Revisa por favor las discusiones que hay en este repositorio donde ya se ha preguntado y contestado. Cierro al no ser una issue del código.
Issue,4618,"Hola @ivilata cuando realizas un restore con el neutralice todos los CRON deberían quedar desactivados, por lo tanto revisa que el de VERI*FACTU se queda de esa manera, esto te garantiza que no se envía nada. [SEP] Es lo que comenta Mario. Cierro. [SEP] ¡Gracias @syci y @pedrobaeza! He vuelto a realizar la prueba reimportando la BDD como neutralizada (antes también lo estaba), y esta vez las tareas de cron no se han ejecutado. Creo que durante mis pruebas, como reinstalé el módulo de VERI*FACTU sobre la BDD neutralizada, tal vez se volvió a crear o actualizar la tarea, activa esta vez. Imagino que es el comportamiento esperado en este caso, así que nada.

Gracias de nuevo y disculpad por el ruido. 🙂 "
Issue,4615,"Si hay que hacer algún fix o improvement podría ponerme yo misma. @pedrobaeza @almumu  [SEP] Habría que marcar la casilla de simplificada en el contacto, sí. Creo que poner que haga eso automático podría ser algo arriesgado, ¿no creéis? [SEP] Sí, me parece bien que se haga de forma manual, así tenemos más control. ¡Mil gracias @pedrobaeza! Cierro la issue."
Issue,4613,"Las correcciones se pueden hacer en asientos manuales, por ejemplo:
Se hicieron 5 facturas de 1000 euros en la cuenta 705000 cuando debía haber sido 700000.

Se hace un asiento manual

5000€ 705000   a   700000 5000€


Y queda mas robusto el verifactu siendo inmodificable [SEP] Efectivamente, ése sería el procedimiento. [SEP] Gracias"
Issue,4605,"probablemente este cambio también afecte a verifactu, o a otros módulos que llamen a la función _get_aeat_tax_info
https://github.com/OCA/l10n-spain/blob/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_verifactu_oca/models/account_move.py#L371



 [SEP] @pedrobaeza  [SEP] esto podría ser una posible solución https://github.com/OCA/l10n-spain/pull/4606"
Issue,4604,
Issue,4603,
Issue,4596,"A mi me salió en la 16 el mismo error, tuve que actualizar el bank-statement-import y luego el account_statement_input_file eso es porque no existe como dices, pero no es solo al completo. [SEP] Efectivamente. Tenéis que actualizar todo el código fuente a la vez. No se pueden actualizar unos repositorios sí, y otro no.

Cierro porque no existe realmente el error. Es un problema de despliegue."
Issue,4591,
Issue,4589,"Hola, ¿has actualizado también el módulo dentro del propio Odoo, o solo has actualizado el código? [SEP] Buenos días Pedro, ¿a que te refieres? he actualizado el modulo con todas sus dependencias :
-l10n_es_verifactu_oca
-l10n_es_aeat
-account_tax_balance
-date_range
-account_invoice_refund_link

estos son los módulos que actualice y posteriormente actualice por interfaz...  

si modifico el código si que me va:

Original  (no va)

```python
 def reverse_moves(self):
        res = super().reverse_moves()
        self.move_ids.filtered(lambda mov: mov.move_type == ""out_invoice"").mapped(
            ""reversal_move_id""
        ).write({""verifactu_refund_type"": ""I""})
        return res
```
    
Modificaco (si va)

```python
    def refund_moves(self):

         return self.reverse_moves()
```

lo he dejado con el código ORIGINAL.. 

Ya me dices algo cuándo puedas y mil gracias Pedro.  [SEP] @alvrico esto último que envías no sé qué tiene que ver con lo primero que pusiste, porque este código que pones es para cuando haces una rectificativa. [SEP] Buenas Pedro, me he liado con otro problema qeu tenia... 

lo que he actualizado ha sido esto:

Buenos días Pedro, ¿a que te refieres? he actualizado el modulo con todas sus dependencias :
-l10n_es_verifactu_oca
-l10n_es_aeat
-account_tax_balance
-date_range
-account_invoice_refund_link

estos son los módulos que actualice y posteriormente actualice por interfaz...


no se si sabrás porque me pasa.. y perdona que me he liado con otro problema que me ha surgido [SEP] Ahora mismo la verdad es que no sabría decirte, porque no es un error ""normal"". Prueba a instalar el módulo en una instancia limpia a ver. [SEP] buenas Pedro, por arte de magia ya funciona.. va todo perfecto.. 

mil gracias de nuevo "
Issue,4586,Cierro porque ya se está tratando en el PR y esto añade ruido.
Issue,4550,
Issue,4534,"Tu Odoo no debe estar totalmente actualizado. Descárgate el último código de todo, y actualiza los módulos en tu BD. Cierro por ser una cuestión de despliegue, no del módulo en si. [SEP] Eso es lo que me pregunto, está completamente actualizado. [SEP] Prueba en el [runboat de 16.0 de OCA/l10n-spain](https://runboat.odoo-community.org/builds?repo=OCA/l10n-spain&target_branch=16.0) si eres capaz de reproducir el problema.
 [SEP] Tenias razón, fallo de despliegue, no recuerdo y no se porque motivo tenia dos carpetas de addons diferente path, mismo contenido, actualicé el contenido del modulo de IGIC, pero no de la ubicación correcta. Muchas gracias. Solucionado."
Issue,4507,El error que obtengo es: Codigo[20009].Error interno en el servidor [SEP] Tiene toda la pinta de ser un problema de la propia AEAT. [SEP] Cierro por falta de respuesta.
Issue,4497,
Issue,4489,"Has seleccionado la versión 3.2.2 en el formato de Facturae? [SEP] Buenas gracias por tu pronta respuesta.
He probado las 3 versiones posibles y sigue igual. [SEP] Yo hice una factura hace una semana con el módulo y lo subí a FACe sin tener ningún problema. ¿Por qué no la subes directamente a ver? [SEP] La he firmado con odoo y he probado a subirla.
He probado añadiendo y quitando el ES delante del dni de la compañia.

6 - 447 - El DNI del emisor es incorrecto
"
Issue,4472,"El tema es tener que depender del módulo `hr`. Creo que el modelo 190 tendría que tener un grupo específico de seguridad, pero no para toda la pestaña, si no para esos datos. [SEP] ¿Valdría el grupo que se usó en https://github.com/OCA/l10n-spain/pull/3692? [SEP] Sí, coincido en que crear un grupo de seguridad específico para los campos sensibles del modelo 190 es una opción más práctica. Evitará depender completamente del módulo hr.employee y también permitirá que esta pestaña sea accesible para los usuarios con este permiso.
¿Cómo lo véis @rafaelbn y @EmilioPascual ? [SEP] Más que la pestaña, esos campos dentro de la pestaña. No se puede limitar la pestaña completa a la AEAT o a este nuevo grupo, porque ahí hay campos que pueden necesitar cambiar otros perfiles (como la identificación o si es simplificado). [SEP] Podéis revisar https://github.com/OCA/l10n-spain/pull/4512 con el fix."
Issue,4468,"No creo que sea de multi-empresa, si no de que tu diario no tiene marcado para utilizar el hash seguro. Revisa eso, y si no, lo más sencillo es desmarcar y volver a marcar lo de habilitar VERI*FACTU. [SEP] Lo probaré, gracias. [SEP] Buenas, es cierto que funciona así. Hemos desactivado y activado en el diario de habilitar VERI*FACTU y si funciona. Como no lo pone en ningún sitio y es poco intuitivo al ver un error hemos pensado en que era un bug.
Un saludo y gracias. [SEP] No, a ver, realmente se puede considerar un bug. La cuestión es dar con los pasos exactos que llevan al mismo, y por el momento, no lo hemos conseguido. Esto fue reportado también en https://github.com/OCA/l10n-spain/pull/4399#issuecomment-3368924524, pero lo dicho, no consigo reproducirlo. [SEP] No se si es por la multicompañía, pero me ha dado la pista para reproducirlo. Pasa cuando configuras verifactu desde otra compañía como admin. Los pasos que he seguido en runboat, Con el usuario admin estando seleccionada la compañía ""San Francisco"", accedo a la configuración de la compañía ES, activo y configuro verifactu. Luego voy a las facturas, cambio la compañía y hago una factura. Al validarla da el error. Si configuro verifactu habiendo cambiado previamente a la compañía ""ES"" no da ese error."
Issue,4467,
Issue,4463,"Nos ocurre lo mismo. 
La solución ha sido modificar la definición de la función quedando así: def reverse_moves(self, is_modify=False)

Este módulo al heredar de account_invoice_refund_link que en su rama 16.0 esta definido como:
https://github.com/OCA/account-invoicing/blob/d0f39d06b2a703100feb3b5374652e802f802df4/account_invoice_refund_link/wizards/account_move_reversal.py#L10
Mientras que en la rama 17.0:
https://github.com/OCA/account-invoicing/blob/e34d6cfa741003d4668c4b8325782ea8798612b4/account_invoice_refund_link/wizards/account_move_reversal.py#L10
 [SEP] Sí, disculpad. Esta tarde subo parche. [SEP] También, en cuanto a las facturas rectificativas, hemos detectado que al crear una directamente desde su menú ""Facturas Rectificativas"", sin revertir desde la factura de cargo, esta no se envía. Lo mismo es algo de configuración que no hemos tenido en cuenta y no es el hilo adecuado, pero hago el comentario por si está relacionado.   [SEP] Arreglado en #4470 "
Issue,4462,Cubierto con #4565
Issue,4457,"Ya he podido solucionarlo, cierro."
Issue,4444,"¿incluimos también columna de periodo de deducción para que se incluya la fecha contable? 

<img width=""1461"" height=""562"" alt=""Image"" src=""https://github.com/user-attachments/assets/1bd6a948-e760-4cb6-9d19-c861ffc07cec"" /> [SEP] @AlbertCabedo va a financiar a @Tecnativa para realizar esta mejora. Estará disponible próximamente. [SEP] Implementado en #4709, y backports en camino."
Issue,4435,Pon por favor dicho comentario en el PR abierto del módulo: #4378 
Issue,4430,
Issue,4428,Migrated at https://github.com/OCA/l10n-spain/tree/18.0/l10n_es_aeat_sii_oss
Issue,4425,"En 17 está implementado: https://github.com/OCA/l10n-spain/blob/05f2dd44c1602af0d6d0256bca064693d1afd015/l10n_es_aeat_sii_oca/models/res_company.py#L58 [SEP] https://github.com/OCA/l10n-spain/pull/4436 [SEP] Ya está disponible en 16, 17 y 18."
Issue,4424,"Edit: no sé por qué he leído SII. Efectivamente, habría que hacer el equivalente al del SII para OSS. [SEP] creado pr https://github.com/OCA/l10n-spain/pull/4500"
Issue,4423,creado pr https://github.com/OCA/l10n-spain/pull/4499 [SEP] Cierro como ya está el PR en marcha.
Issue,4421,"desarrollo en progreso https://github.com/OCA/l10n-spain/pull/4548 [SEP] Hola, 
en la configuracion del modulo verifactu en la compañia debo poner  datos de desarrollador, esta informacion donde la puedo buscar [SEP] > Hola, en la configuracion del modulo verifactu en la compañia debo poner datos de desarrollador, esta informacion donde la puedo buscar

https://github.com/OCA/l10n-spain/discussions/4451"
Issue,4420,"Me pongo con este issue
https://github.com/OCA/l10n-spain/pull/4429"
Issue,4419,"cierro issue puesto que las altas por rechazo son facturas que deben subsanarse al igual que las aceptadas con errores, es decir, una vez rechazada, no se enviaría automáticamente hasta que el usuario no la subsana y le da al botón de reenviar desde la factura. El problema es que el alta por rechazo no estaba funcionando correctamente, esto se soluciona en https://github.com/OCA/l10n-spain/pull/4429"
Issue,4416,
Issue,4402,"Migrando l10n_es_partner #4413  [SEP] Migrando l10n_es_aeat #4624  [SEP] Migrando l10n_es_aeat_mod111 #4675  [SEP] Migrando l10n_es_aeat_mod115 #4676 
 [SEP] Migrando delivery_gls_asm https://github.com/OCA/l10n-spain/pull/4685 [SEP] Migrando l10n_es_aeat_mod347 #4717  [SEP] 
> [ ]  payment_redsys - Incluido en core a partir de V19
> 

Dejo este comentario, ya que creo que payment_redsys no será necesario
"
Issue,4397,"Buenas @vandekul, esa posición fue añadida hace 11 meses https://github.com/odoo/odoo/commit/a652896cb53717ad0a6a3abafb123bbe99110eb0 es posible que tu versión de odoo esté desactualizada o bien el plan contable como tal. Una vez asegurado que tu versión contiene las posiciones correspondientes puedes utilizar el módulo https://github.com/OCA/account-financial-tools/blob/16.0/account_chart_update para crear las posiciones fiscales faltantes. Espero que te sirva de ayuda"
Issue,4391,Solucionado en #4404 
Issue,4390,"@moduon MT-11582

Vamos a agregar todas las retenciones e irpf que se deban excluir del total y que no están hechas.

Corrigo la imagen de @ArantxaSudon que es una errata.

<img width=""2467"" height=""1096"" alt=""Image"" src=""https://github.com/user-attachments/assets/02d4b672-9897-4373-b117-bfe211698bb7"" />

¿Os parece bien @OCA/local-spain-maintainers ?

Haremos PR semana que viene, para estar de acuerdo antes de hacerlo...

Gracias
Saludos [SEP] OK, adelante."
Issue,4389,"Se esta quejando del CIF del cliente. Por lo que veo no lo tenéis establecido. [SEP] Eso pensava yo, pero realmente está establecido el CIF en la ficha del cliente:

<img width=""1188"" height=""625"" alt=""Image"" src=""https://github.com/user-attachments/assets/52b9f32c-a800-4321-9399-ccf7c2cdfd6c"" />
 [SEP] ES bug, acabo de probarlo en runboat y el campo ID no se rellena con en cif 
""IDOtro"": {
                    ""CodigoPais"": ""FR"",
                    ""IDType"": ""02"",
                    ""ID"": ""FR""}
Aunque este establecido. 

De hecho esta mal aqui https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_verifactu_oca/models/account_move.py#L447 [SEP] Ahora pongo el PR correspondiente. [SEP] > Ahora pongo el PR correspondiente.

Gracias @pedrobaeza  [SEP] Fix en #4398 "
Issue,4387,"Según parece, tienes un código de Odoo antiguo (que incluye el módulo l10n_es). Debes actualizar dicho código y volver a probar."
Issue,4385,"Creo que @etobella podría opinar mejor al respecto [SEP] Para esto lo correcto es hacer un modulo que extienda la funcionalidad. Obviamente se puede hacer en la OCA y lo revisaremos cuando se publique [SEP] Perfecto, estoy a la espera de comprobar si la implementación que he hecho funciona correctamente.

Lo que he planteado finalmente se basa en el modelo de unas facturas generadas con el programa de factura electrónica que un cliente utiliza con factoring y que le están funcionando correctamente.

La solución consiste en:

* Agregar los campos Literales Legales, donde se podrá incluir la información relativa al factoring.

* Incorporar los campos de Referencia Emisor y Referencia Receptor, para indicar explícitamente que la factura se emite con factoring.

* Definir la cuenta bancaria asociada al factoring, que se usará siempre que el modo de pago sea de tipo Especial (13), sustituyendo la cuenta del cliente por la de la entidad cesionaria.

Gracias. [SEP] Buenos días @pedrobaeza @etobella,

Que os parece si agrego los literales legales, y las referencias en el l10n_es_facturae, ya que creo que esto es útil para toda persona que use el facturae, y luego haga un módulo de extensión que agregue la opción de la cuenta bancaría de factoring?

¡Quedo atento!

Saludos. [SEP] @BernatObrador los LegalLiterals ya existen, simplemente deberás añadir una referencia en el caso del factoring. Primero haz el módulo y despés comprueba si lo necesitas. En la última versión del facturae se pasa un proceso para limpiar los que están vacios. [SEP] @etobella 
Por lo que vi en el report, y por eso los agregue, asegurándome de que cada uno no haga más de 250 char, es que en el reporte está así:
`<LegalLiterals t-if=""False"" />`
Y en ningún lado se computan estos.

Con el cliente ya hemos hecho la prueba y ha funcionado bien con la manera que os digo, agregando las referencias, literales legales y una cuenta da factoring, que será la de la entidad que cesionaria, para que si el tipo de pago es especial (13), se sustituya la cuenta bancaría en el pago, por esta, en lugar de la del cliente.

Hoy si me da tiempo subo las PR's, si no ya será el lunes! Os voy comentando.

Muchas gracias por vuestro tiempo.

Saludos. [SEP] Implementado en #4417 "
Issue,4381,Solucionado en #4403
Issue,4376,Hola! Si tienen que ser dos dígitos.   [SEP] Mil gracias! Funciona!
Issue,4375,"Sí, aquí lo tienes: https://github.com/OCA/l10n-spain/pull/4357

y de hecho es una de las razones para tener la versión OCA."
Issue,4374,"El ID del SIF y el NIF informados deben haber sido dados de alta en Hacienda para poder hacer estas pruebas. [SEP] Hola, el NIF tiene que ser valido, el del desarrollador, AEAT lo comprueba, y el SIF id, se refiere a los dos digitos que indicas en la declaración responsable y se tienen que dar de alta en la referencia del encadenamiento. 

<img width=""751"" height=""259"" alt=""Image"" src=""https://github.com/user-attachments/assets/37f1938f-a130-4a2a-98c5-e74c855196ba"" /> [SEP] Buenos días, Pedro:

Disculpa, pero si el software es Odoo, hay que poner lo que indica la declaración responsable de Odoo, ¿no habiendo sido ellos los que han desarrollador el módulo? Adjunto captura.

<img width=""1236"" height=""398"" alt=""Image"" src=""https://github.com/user-attachments/assets/65439e9c-0cbb-440c-a630-b989eb6616c6"" />

¿Será que cada partner deberá hacer una declaración responsable y darse de alta en la AEAT?

Gracias de antemano por la ayuda.
 [SEP] Bueno, Odoo puede no cubrirte si no es un Odoo online. Cuando llegue la primera denuncia se sabra... Pon ahí lo que estiméis oportuno. [SEP] No hay que darse de alta en la AEAT, pero si que tendrá que firmar alguien la declaración responsable indicando que el software cumple con la legalidad. Puede ser el mismo cliente el que lo firme. Esto esta confirmado con AEAT, ya que al ser de código abierto puede que tu como implantador no puedas asegurar que cumple. Odoo se ha puesto el pero me parece arriesgado ya que esta en la versión community y cualquiera puede modificar ese código en una instalación on-premise [SEP] Muchas gracias, Anmarmo1!"
Issue,4372,"Lo siento por mis disvistes !!

He visto se puede actualizar todo los posicines fiscales para registrar las nuevas claves de Verifactu por modulo ""account_chart_update"" segun pone en README.rst del ""l10n_es_verifactu_oca"":
- Establecer en las posiciones fiscales la clave de impuestos y la clave de registro VERI*FACTU.
- Para aplicar las claves ejecute el asistente de actualización del módulo accountchart_update.

En concreto:
            Install addons: account_chart_update
                # https://github.com/OCA/account-financial-tools.git

            Settings > Invoicing > Update Chart Template: Update char template
                Next:
                    Check Fiscal positions

                Create/update, then cloes

Creo que esta reuslto mis dudas.

Muchas gracias !!"
Issue,4368,"Hola @flachica me consta que @acysos tenía pensado llevarlo a la V15, también.

Según lo que he hablado con @pedrobaeza , como los cambios de V16 hacia V14 y V15 son bastante similares, sería conveniente que podáis unir esfuerzos y coordinaros.

En caso de que necesitéis revisiones, puedo aportar mi granito de arena.

Gracias. [SEP] @acysos, al enterarse finalmente dice que backportea a 13.0. Aún así, no sé si duplicamos esfuerzos. Bienvenidos tus aportes @HaraldPanten  [SEP] > [@acysos](https://github.com/acysos), al enterarse finalmente dice que backportea a 13.0. Aún así, no sé si duplicamos esfuerzos. Bienvenidos tus aportes [@HaraldPanten](https://github.com/HaraldPanten)

Y si lo lleváis entonces vosotros a V14 y a V15? Nosotros a V13 no lo necesitamos.

Si fuera necesario miramos cómo organizarnos para repartilo.

Ya nos dices @flachica  [SEP] Si. Mi idea es tener una PR en 14.0 antes de que finalice Octubre @HaraldPanten  [SEP] Por favor, portearlo a V13 tambien, no se si los cambios de V13 a V14 son muy profundos... [SEP] @flachica yo puedo ayudar tambien a nivel funcional en revisiones.
 [SEP] > Por favor, portearlo a V13 tambien, no se si los cambios de V13 a V14 son muy profundos...

Si no lo lleva a cabo @acysos de forma voluntaria, también puedes abonar un importe a otros contribuidores para que lo hagan.

Un saludo. [SEP] He renombrado el hilo para ser más amplio, puesto que no solo estamos hablando de la versión 14. [SEP] ¡Hola! A no ser que @acysos indique que ya tiene algo iniciado de la adaptación a Odoo 15, desde Batista10 (@B10Serveis) podríamos encargarnos de ello (probablemente partiendo de la adaptación a la 16). Por supuesto, toda ayuda en revisiones y sugerencias sería muy bienvenida. 🙂  [SEP] Mejor partir de la 14 que de la 16, ya que en 16 se hizo una refactorización previa que habría que volver a extraerla para 15, lo que en la de la 14 ya se ha hecho. [SEP] Gracias @pedrobaeza, tomo nota. 🙂  [SEP] Para facilitar el seguimiento del tíquet: el PR #4377 de @ljimenezsidoo para la migración a 14 ya ha sido mezclado, he creado #4503 para la migración a 15. [SEP] #4503 (Odoo 15) ha sido mezclado también. 🚀  [SEP] Voy a dar esta issue por cerrada, ya que se ha llevado Verifactu a 14.0, 15.0, 16.0 y 17.0.

En 18.0 acabará llegando por necesidad, según procedimiento habitual de contribuciones, mientras que <14.0 debería tener un uso muy residual.

Cualquier cosa podemos reabrir hilo. [SEP] En 18 ya está también... [SEP] sabéis si se va a realizar backport a v13?
se sabe algo de que va a pasar con el tpv de odoo para verifactu?

gracias [SEP] De momento nadie ha expresado su interés en pasarlo a 13. Es demasiado antiguo... Del TPV puedes mirar los diversos pull requests abiertos para ello."
Issue,4366,"también he probado el addon y tengo también error en el cron, he seguido el desarrollo y la versión tester de hace 1 mes funcionaba, ahora que sube las facturas solo con el cron, también me da error,. [SEP] Probad por favor usando #4367 y decís si ya os sale correcto. [SEP] Buenos días, probado y funcionando. Muchas gracias. [SEP] correcto con los cambios indicados, gracias. seguiremos probando y si sale algo mas lo reportare.
gracias [SEP] Fusionando entonces. [SEP] Hola, he instalado el modulo verifactu en la version 16 y me pide como configuracion en las compañias el codigo del desarrollador, como pudiera obtener ese codigo, Gracias"
Issue,4358,"Hola, no veo una aplicación muy directa de eso en la gestión del ERP, pero si teneis algo específico, comentadlo. [SEP] Hola @pedrobaeza le agregue más detalles al Isuues, digame que le parece, gracias [SEP] De acuerdo, entonces entiendo que será un nuevo plan contable ""IGIC (ZEC)"" o similar. [SEP] Si correcto @pedrobaeza es la idea "
Issue,4341,"Hola,
No veo mal que haya un módulo para gestiona las comunicaciones, ya que da mucha más versatilidad a OCA. El problema que veo es que el framework EDI le ha pasado como al contract, ha evolucionado mucho y de tener una orientación sencilla de utilización ha pasado a ser un monstruito jaja.
¿Cabe la posibilidad de separación y adaptación del framework EDI?

Según estuve mirando en su día el punto 1 no lo veo viable. El punto 2, me gustaría no realizarlo ya que realizar módulos bases de comunicaciones es muy útil, a lo mejor ... añadir un apartado a los videos donde se explicase el funcionamiento de framework EDI ¿podría estar bien @etobella ?

Creo que como has comentado enric, el camino natural ha ido a la extracción de ese apartado, no veo del todo bien volver hacía atrás, si no, que se tendría que simplificar. ¿Creación de otro módulo de comunicaciones más sencillito? (pero eso se podría conseguir con el refactor y separación del framework edi ¿correcto?)
 [SEP] ¿No podríamos hacer como con SII, que solo se necesitan unos cuantos campos de control? Realmente el resto de información se ha demostrado no demasiado útil, y más si hay una plataforma como FACe detrás, donde la misma ya registra la actividad. A efectos prácticos, solo necesitamos saber si se ha enviado o no, y error en caso de que no. [SEP] Seria otra opción, si, por eso eran las ideas que se me ocurrían por ahora. De todas formas, si simplificasemos el EDI Framework no lo vería mal yo
 [SEP] El tema es depender de la migración de ese framework en cada versión para tener esto operativo, y más si se da integración por lo de la ley ""Crea y crece"". En ese sentido deberíamos ser más autónomos. Por eso también se quiso quitar de en medio `queue_job` en el SII. [SEP] También depende de otros módulos, aunque el edi-framework acostumbra a ser el más complejo.

Además, la ley crea y crece no irá con facturae, así que si deberá ser con un módulo diferente (y sus respectivos campos y tal) [SEP] Cuantos menos módulos haya en la pila, mejor, y algunas dependencias son lógicas (como `l10n_es_facturae`), pero todo el framework EDI no. [SEP] En eso estoy de acuerdo @pedrobaeza De todas formas, el problema no es el edi-framework, es todo lo que lleva incorporado (queue job, connector....) que tiene una arquitectura demasiado compleja 😢  [SEP] Pues entonces sí que estás de acuerdo, porque el tema es que esa pila es demasiado compleja, y en 18 o cortamos por lo sano, o esa supuesta refactorización del EDI no va a llegar, porque ya hay una parte de la pila fusionada y otros no van a querer cambiarla, y mientras, seguiremos sin tener este módulo disponible. [SEP] A nivel de pilas de módulos obviamente sería mejor integrarlo en el propio y listo, pero veo mejor que exista uno base para que el máximo de módulos se pueda beneficiar de ello, como actualmente está el framework-EDI. Estoy de acuerdo en que la dependencia tecnológica de ese módulo es muy grande y hay puntos de los cuales se quiere ""huir"" (job_queue) como pasó con el SII (también se podría mirar de adaptar el módulo para el queue o triggers de odoo, según configuración o extensiones).
Según lo veo yo si integramos esta conexión directamente en el módulo, estamos ""cerrando"" y duplicando funcionalidades que actualmente están genéricas. Está bien que hayan módulos bases para circuitos de comunicaciones, ya que estamos viendo que cada vez es más común. [SEP] Yo no veo que tenga tanta base compartida, pero si acaso, esa base podría ir en `l10n_es_aeat` como hicimos con SII/VeriFactu. [SEP] Pero entonces si otros módulos se quieren aprovechar de esas funcionalidades si no son del repo l10n-spain, no podrán.
Por otro lado, esta característica podría necesitarse o no ¿es necesario ponerlo en el l10n_es_aeat? Ya que en general no gusta ampliar ese módulo. [SEP] ¿Pero qué funcionalidad se va a reaprovechar? A ver, dejemos de hablar en abstracto. Aquí no hay nada reaprovechable realmente. Lo dicho, al final tenemos unos campos de estado de envío/error, y el código que llama a la API de FACe. Por eso digo que no hay que complicarse. Teniendo librerías Python para esas comunicaciones, y que se inicializan con dos líneas y se envían datos con otras 2, dejemos de montar capas abstractas que si `edi_webservice`, y sustituyendo código por configuraciones raras que continuamente cualquier cambio hacía que ya no saliera un botón o que no se enviara.

Lo dicho, tenemos el antecedente del SII donde no hay complicación. Y lo de `l10n_es_aeat` era siguiendo vuestra línea de razonamiento, pero que efectivamente, aquí no hay código compartido con nada. Lo otro de SII/VeriFactu era porque las estructuras de datos que se envían son iguales en ambos, y sí es más cantidad de código. [SEP] @pedrobaeza Se reaprovechan cosas. Yo en mi caso tengo clientes que envían las facturas de múltiples formas dependendiendo de cliente y el funcionamiento de EDI ayuda un montón.

Personalmente estoy de acuerdo que el stack de edi-framework es demasiado complejo al depender de component y de queue_job y me ofrezco a eliminar esas dependencias para simplificar el stack. PEro de eso a cargarnos el concepto, pues veo muchos problemas. Sobretodo cuando venga la factura electrónica obligatoria en UBL, en el que reinventaremos la rueda según tu idea para generar los ficheros y el envío, ya que el de FACe no nos servirá (desconocemos aún la forma de envío, pero los ficheros seran distintos al 100%). Además que tendremos que notificar los pagos, con lo que tendremos un doble flujo de entrada (envío de facturas de venta, recepción de compras, envío de estado de compras....) Todo esto ya está contemplado en EDI y nos lo simplifica bastante si lo mejoramos un poco.

Sé que personalmente no es fruto de tu devoción el framework de EDI, pero creo que hacerlos completamente separados cada vez no aportan nada. Es mejor buscar una base común más sencilla en mi opinión [SEP] @pedrobaeza con algo así como lo verías? Se quitaria la mayor parte del stack extra dejando solo el edi_oca, que nos permite gestionar la generacioń y envío. Obviamente no pondríamos más dependencias que las explicadas
 [SEP] https://github.com/OCA/edi-framework/pull/192#issuecomment-3166786574 [SEP] El problema es que esto no va a estar en 18. [SEP] Se puede hablar con el equipo EDI y hacer comunicacion en el contributors de la OCA si es necesario y el concepto cuadra para todos [SEP] Bueno, primero habría que conseguir eso, y luego ver cómo se queda finalmente. [SEP] PArece que irá a buen puerto, con lo que podemos plantear el cambio ya en v18. simplificandonos la vida a todos."
Issue,4338,"@AaronHForgeFlow no te has saltado esta sobreescritura en el módulo `l10n_es_dua_sii` de la 16?

https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_dua_sii/models/account_move.py#L47

Lo que se hace en la 17 es integrar y adaptar ese otro módulo, porque el DUA ya está en `l10n_es`. [SEP] @pedrobaeza claro, en la 16.0 estaba por separado 🤦  

De todas formas dejo el issue abierto a ver si alguien da una razón funcional/legal de por qué es así. No he encontrado nada. [SEP] La razón es porque la factura original del proveedor extranjero no hay que enviarla. La AEAT dice que no pasa nada por enviarla (claro, ellos quieren cuanta más información de ti, mejor), pero como no es obligatoria, no se envía. [SEP] @pedrobaeza  Vale! muchas gracias! "
Issue,4302,
Issue,4291,"Esto sucede porque no tiene el codigo postal el cliente definido. Esta definido como un campo obligatorio para el envió del ticketbai cuando no deberia ser asi no? [SEP] Buenas @Joaco1980 
No entiendo muy bien como reproducir el error que comentas.
Yo he realizado dos ventas en el POS sin seleccionar cliente y no me da ningún error. Las ventas ""facturas simplificadas"" se envían correctamente a TBAI. [SEP] > Buenas [@Joaco1980](https://github.com/Joaco1980) No entiendo muy bien como reproducir el error que comentas. Yo he realizado dos ventas en el POS sin seleccionar cliente y no me da ningún error. Las ventas ""facturas simplificadas"" se envían correctamente a TBAI.

Vale para replicarlo, crear un cliente nuevo ""PEPITO FLORES"" y déjale sin CP introducido, mete si quieres provincia, país y todos los datos que consideres pero deja vacío el CP. 

Es ahi donde da el error que comento, ademas si recargas la pagina y vuelves a crear el ticket se crea correctamente pero falla la transmisión y da error cuando haces un ticket después de este error:

ES): El XML del fichero TicketBAI no cumple el esquema.[Linea:2 Columna:1706] Error:cvc-pattern-valid: Value 'aN-aN-NaN' is not facet-valid with respect to pattern '\d{2,2}-\d{2,2}-\d{4,4}' for type 'FechaType'.(EU): TicketBAI fitxategiaren XMLak ez du eskema betetzen.[Linea:2 Columna:1706] Error:cvc-pattern-valid: Value 'aN-aN-NaN' is not facet-valid with respect to pattern '\d{2,2}-\d{2,2}-\d{4,4}' for type 'FechaType'.

Concretamente da un error de validación con la fecha de la factura anterior que la deja asi en el xml:
<FechaExpedicionFacturaAnterior>aN-aN-NaN</FechaExpedicionFacturaAnterior>

Yo estoy subiendo los tickets con error en la subida manualmente en el LROE poniendo esa fecha bien no se si es la manera correcta de hacerlo pero al menos se validan, porque el botón de Cancelar y recrear no sirve en este caso concreto. [SEP] Efectivamente si el cliente no tiene CP salta el error.
`TypeError: Cannot read properties of undefined (reading 'number_prefix')`
 
Seguido de este error, el comportamiento al refrescar etc... pues ya puede ser cualquier cosa. Efectivamente es un BUG a corregir.

ping @rrebollo 
¿Como lo ves para corregir este problema?


NOTA: También recuerdo que quedo pendiente mejorar el módulo para que funcionara con el cambio de  posición fiscal.
 [SEP] @Bilbonet puedo ocuparme del error pero definamos antes la conducta a seguir: ¿Debemos hacer un mejor tratamiento de excepciones y loguear el error concreto: un log indicando que el CP es requerido o el CP no es realmente requerido y podemos continuar con el flujo normal? [SEP] Buenas @rrebollo , muchas gracias por el ofrecimiento.

El tema del TicketBAI funciona en las tres provincias vascas por separado. Lo digo porque aunque la normativa es común podría haber alguna pequeña diferencia. Yo voy a comentar basándome en el TicketBAI de Bizkaia ""BFA"".

Adjunto documento con las especificaciones del envío para el alta de facturas por si necesitas comprobar alguna otra cosa.

Respecto al error que nos ocupa. EL CP del  destinatario NO es un dato obligatorio. Bastaría con evitar que de error cuando se encuentra con este campo vacio.

<img width=""1058"" height=""589"" alt=""Image"" src=""https://github.com/user-attachments/assets/7f5ae03c-0b01-4977-85df-6e828a8bdf3e"" />

▪ Letra roja: Bloque/Campo obligatorio. 
▪ Letra negra: Bloque/Campo opcional. 
▪ Fondo rosa: Bloque/Campo excluyente. 

Quedo a tu disposición para cualquier otra aclaración 😊


[LROE_PJ_240_Alta_V1_0_0.pdf](https://github.com/user-attachments/files/22563391/LROE_PJ_240_Alta_V1_0_0.pdf) [SEP] @Bilbonet perfecto. Lo miro. Sucede que tenemos algunos issues también en una instalación de ticketbai pos en 16.0 y queremos ir descartando causas. Así que puedo aprovechar y corregir este issue también. Al cliente en cuestión le fallan algunos tickets en POS porque la secuencia que genera está repitiendo valores: el valor que sugiere ya está ocupado. Me atrevo a consultarte. ¿Que crees que podríamos revisar? Uno de los temas fundamentales es la imposibilidad de reproducir el bug porque ocurre esporádicamente y no están claras las condiciones que lo desencadenan. [SEP] Genial @rrebollo , para todo lo que necesites no dudes en contactarme.

Respecto a lo que comentas de los duplicados mira esto #3984 
Cualquier cosa me comentas. [SEP] @Bilbonet @Joaco1980 he estado tratando de replicar el error originalmente reportado en este issue en el runboat pero estoy stuck en que el POS no carga el certificado.

<img width=""982"" height=""423"" alt=""Image"" src=""https://github.com/user-attachments/assets/e426a437-16c3-4bea-b38d-cea81e0678ce"" />

Estoy usando los datos de pruebas que se usan en los test automatizados. Alcanzo a ver que los certificados que vienen tanto en l10n_es_ticketbai como l10n_es_ticketbai_api parecen expirados.

<img width=""1679"" height=""336"" alt=""Image"" src=""https://github.com/user-attachments/assets/2c142cbf-be18-42ec-88eb-db6a76b56ee2"" />

¿Me está faltanto alguna configuración? ¿donde puedo obtener un juego de datos apropiado para las pruebas?

Solo de cargar el POS tengo 👇 error en consola del browser

<img width=""560"" height=""189"" alt=""Image"" src=""https://github.com/user-attachments/assets/d15c00b3-7521-4ed2-b69c-7d2420d66252"" /> [SEP] aqui tienes certificados para pruebas

https://www.batuz.eus/fitxategiak/batuz/lroe/batuz_lroe_ziurtagiriak_kit_certificados_v1_0_3.7z





Get Outlook for Android<https://aka.ms/ghei36>
________________________________
From: Rolando Pérez Rebollo ***@***.***>
Sent: Sunday, September 28, 2025 2:13:30 PM
To: OCA/l10n-spain ***@***.***>
Cc: Jesus (Bilbonet) ***@***.***>; Mention ***@***.***>
Subject: Re: [OCA/l10n-spain] [16] l10n_es_ticketbai_pos: Ticketbai no construida aun. (Issue #4291)

[https://avatars.githubusercontent.com/u/38138332?s=20&v=4]rrebollo left a comment (OCA/l10n-spain#4291)<https://github.com/OCA/l10n-spain/issues/4291#issuecomment-3343099649>

@Bilbonet<https://github.com/Bilbonet> @Joaco1980<https://github.com/Joaco1980> he estado tratando de replicar el error originalmente reportado en este issue en el runboar pero estoy stuck en que el pos carga el certificado

image.png (view on web)<https://github.com/user-attachments/assets/e426a437-16c3-4bea-b38d-cea81e0678ce>

Estoy usando los datos de pruebas que se usan en los test automatizados. Alcanzo a ver que los certificados que vienen tanto en l10n_es_ticketbai_pos como l10n_es_ticketbai_api parecen expirados.

image.png (view on web)<https://github.com/user-attachments/assets/2c142cbf-be18-42ec-88eb-db6a76b56ee2>

¿Me está faltanto alguna configuración, donde puedo obtener un juego de datos apropiado para las pruebas?

—
Reply to this email directly, view it on GitHub<https://github.com/OCA/l10n-spain/issues/4291#issuecomment-3343099649>, or unsubscribe<https://github.com/notifications/unsubscribe-auth/AB6MT4GNY2WXFNFMA7LJGJL3U7GGVAVCNFSM6AAAAACBXYIWOOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTGNBTGA4TSNRUHE>.
You are receiving this because you were mentioned.Message ID: ***@***.***>
 [SEP] > El tema del TicketBAI funciona en las tres provincias vascas por separado. Lo digo porque aunque la normativa es común podría haber alguna pequeña diferencia. Yo voy a comentar basándome en el TicketBAI de Bizkaia ""BFA"".

@Bilbonet, si miramos:

https://github.com/OCA/l10n-spain/blob/0ba2de3db3f42dc16af7504e2329b4036582dce9/l10n_es_ticketbai_api/models/ticketbai_invoice.py#L939-L953

☝️ código indica que Gipuzkoa es la excepción. 
(Aclaro que este fragmento **no** es el que se ejecuta en el módulo `l10n_es_ticketbai_pos`, pero lo encontré como un hallazgo interesante durante el análisis del issue).

Pregunto porque tengo listo un fix para el error reportado aquí, pero ahora tengo que refinarlo porque hay diferencias de comportamiento entre las agencias. [SEP] @rrebollo interesante.
Corrijo: Parece que 'Bizkaia/Vizcaya' es la excepción ""que infierno 😥"".

Pues parece que en facturación ya se dio este problema y fue solventado. Imagino que lo mas sencillo sería aplicar el mismo procedimiento en el POS.
Pero lo que tu prefieras. Por mi como si se pone ZIP obligatorio para todas. En este caso tampoco me parece muy importante hilar fino 😊.
 [SEP] > @rrebollo interesante.
> Corrijo: Parece que 'Bizkaia/Vizcaya' es la excepción ""que infierno 😥"".
> 
> Pues parece que en facturación ya se dio este problema y fue solventado. Imagino que lo mas sencillo sería aplicar el mismo procedimiento en el POS.
> Pero lo que tu prefieras. Por mi como si se pone ZIP obligatorio para todas. En este caso tampoco me parece muy importante hilar fino 😊.
> 

Yo creo que solo deberia de ser obligatorio si el destinatario lleva NIF y quiere deducirse por cualquier motivo el IVA, ahí si se obliga a introducir el ""domicilio"" que supongo que incluya el ZIP.

Precisamente las facturas simplificadas es para simplificar la facturación diaria, si exigimos completar todos esos campos que diferencia tenemos con hacer una factura de toda la vida? 

Una tienda que lo utiliza necesita agilidad en la venta, y si quiere asignar un cliente por tema estadístico y de control de ventas no debería tener que pedir tantos datos, es mi opinión.

En cualquier caso toméis la decisión que toméis el tema es que el error no permite arreglarlo introduciendo el ZIP y volver a crear el ticket, o sale sin QR a posteriori y no se crea en el backend, o borras la cache del navegador y vuelves a crearlo y esta vez si se realiza pero da el error de la fecha del ticket anterior en la trasmision, hay que modificarlo manualmente el xml y subirlo al LROE [SEP] > Yo creo que solo deberia de ser obligatorio si el destinatario lleva NIF y quiere deducirse por cualquier motivo el IVA, ahí si se obliga a introducir el ""domicilio"" que supongo que incluya el ZIP.
> 
> Precisamente las facturas simplificadas es para simplificar la facturación diaria, si exigimos completar todos esos campos que diferencia tenemos con hacer una factura de toda la vida?
> 
> Una tienda que lo utiliza necesita agilidad en la venta, y si quiere asignar un cliente por tema estadístico y de control de ventas no debería tener que pedir tantos datos, es mi opinión.

Si claro. El BUG es solo cuando identificas al cliente. Si es una venta anónima no hay error.


 [SEP] @Bilbonet cuando finalmente he podido dilucidar una estrategia para adaptar el código en l10n_es_ticketbai_pos y lograr hacer opcional el CP descubro que bizkaia está definida cómo tbai.tax.agency en el addon l10n_es_ticketbai_batuz. Esto técnicamente implica que para corregir ""bien"" el issue tendríamos que hacer depender el primer addon mencionado del segundo y ya no puedo evaluar que otras repercusiones tendría esto. En este momento me inclino por dejarlo tal y como está. Ya que habría que ocuparse de temas de diseño más serios antes de abordar este. @Joaco1980 lo siento. Si te sirve de algo eso solo está validando que el zip sean 5 dígitos consecutivos so ... [SEP] Ya veo que se ha definido en los módulos de Batuz. Ciertamente esto lo complica 😔.
https://github.com/OCA/l10n-spain/blob/435ca7a53c5ee325f21d50d00306147b29ec55b7/l10n_es_ticketbai_api_batuz/data/tax_agency_data.xml#L5

A estas alturas y viendo que no creo que TBAI de OCA pase de la versión 16.0. Mejor seguir con la mismo estrategia y plantear un nuevo módulo que realice estas correcciones:

-  **l10n_es_ticketbai_pos_batuz**

 [SEP] A mi me parece bien que no toquéis nada pero que al menos ese error no implique no poder avanzar, es decir, si no hay zip en la validación que salte un error de que falta el zip y al menos que te deje volver al cliente, introducir un zip y volver a intentar la transmisión del ticket con el zip.

Ahora el comportamiento es el siguiente: 
- Salta el error de construcción
-  Si luego intentas hacer el ticket le hace pero sin QR de TBAI, puede incluso saltar la secuencia o ni realizarse en el backend. 
- Hay que borrar cache del navegador y volver a realizar la venrta
-  Genera el ticket bien con el QR pero falla el xsig porque el campo de fecha de factura anterior le deja vacío aN-aN-aNNN. 
 
Es como si en todo el proceso perdería la referencia del ticket anterior. Esto implica un error en la transmisión a la hacienda vasca, hay que descargarse el xsig, ponerle la fecha correctamente y subirlo manualmente al LROE.  [SEP] > A estas alturas y viendo que no creo que TBAI de OCA pase de la versión 16.0. Mejor seguir con la mismo estrategia y plantear un nuevo módulo que realice estas correcciones

Vi algo de que ticketbai está disponible en Odoo ¿Enterprise o Community a partir de que versión? Y powered by @ao-landoo y su team creo. [SEP] @Joaco1980 madurando esa última idea

> A mi me parece bien que no toquéis nada pero que al menos ese error no implique no poder avanzar,

Tal vez algo se pueda hacer. Viendolo desde la perspectiva que planteas, el problema fundamental es que ese error ya salta durante la generación del ticket, tal vez si colocamos una validación al momento de escoger el cliente (el detalle es que realmente la validación ignorará el comportamiento para Bizkaia: todos los clientes tienen que tener CP de 5 dígitos) @Bilbonet ¿Que crees?

 [SEP] > > A estas alturas y viendo que no creo que TBAI de OCA pase de la versión 16.0. Mejor seguir con la mismo estrategia y plantear un nuevo módulo que realice estas correcciones
> 
> Vi algo de que ticketbai está disponible en Odoo ¿Enterprise o Community a partir de que versión? Y powered by [@ao-landoo](https://github.com/ao-landoo) y su team creo.

TicketBAI esta diponible en el core de Odoo desde la 16.0. Pero no en el POS.
TicketBAI en el POS se que está en la 18.0 no lo sé seguro si esta en la 17.0    [SEP] > [@Joaco1980](https://github.com/Joaco1980) madurando esa última idea
> 
> > A mi me parece bien que no toquéis nada pero que al menos ese error no implique no poder avanzar,
> 
> Tal vez algo se pueda hacer. Viendolo desde la perspectiva que planteas, el problema fundamental es que ese error ya salta durante la generación del ticket, tal vez si colocamos una validación al momento de escoger el cliente (el detalle es que realmente la validación ignorará el comportamiento para Bizkaia: todos los clientes tienen que tener CP de 5 dígitos) [@Bilbonet](https://github.com/Bilbonet) ¿Que crees?

Pues si, me parece mejor poner una restricción general. 
**Que se obligue a poner CP si identificas al cliente, sea cual sea la hacienda,**
Es peor dejar el error actual. Que según comenta @Joaco1980 hace un estropicio importante cortar la ejecución con el error actual.

 [SEP] @Joaco1980 ¿podremos cerrar este issue entonces?"
Issue,4289,
Issue,4286,"Hola, ¿podéis identificaros adecuadamente en lugar de un nick genérico? Así se sabe con quién se está hablando. [SEP] lo detecte esta mañana y le dije de cambiarlo para que funcionará, se llama Patrick. En ocasiones algunos impuestos usan para grecia GR y otros EL (el nuevo es EL desde hace muchos años)  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Hola, estoy teniendo un problema similar.

Actualmente, el VAT del partner está configurado con el prefijo EL, que es el formato correcto según VIES para Grecia. Sin embargo, al notificar la factura al SII, el envío es rechazado indicando un error en la clave codigoPais, ya que el SII espera el código ISO GR y se está enviando EL.

Si se modifica el VAT del partner y se establece el prefijo GR, el envío al SII vuelve a fallar, en este caso indicando que el ID es incorrecto, ya que el VAT deja de ser válido.

El comportamiento esperado por parte del SII es que se envíe:

codigoPais: GR

ID: ELXXXXXXXXX

Por lo que hemos podido analizar, el envío actual utiliza el mismo prefijo tanto para el código de país como para el identificador, lo que dificulta cumplir simultáneamente con los requisitos de VIES y del SII en este caso concreto. [SEP] Analizando el comportamiento con más detalle, creo que el origen del problema puede estar en la siguiente línea de código:
[
        country_code_map = {""EL"": ""GR""}](https://github.com/OCA/l10n-spain/blob/878690ccf0bdf1cd83b008824fe9bd0992630391/l10n_es_aeat/models/res_partner.py#L60)

En concreto, si esta clave no estuviese definida, el flujo posterior parece que podría ajustarse mejor al comportamiento esperado por el SII en este caso, permitiendo enviar codigoPais = GR mientras se mantiene el ID con el prefijo EL, que es el formato válido según VIES. [SEP] Esto se solucionó en #4753 y #4754"
Issue,4272,"Odoo está incluyendo en el core de 17 un módulo para la gestión de Verifactu, y aquí en OCA, cuando se complete el desarrollo en 16, se migrará a 17. Busca por favor las referencias correspondientes."
Issue,4271,"Hola, Nacho, por no abras incidencias para este tipo de cosas que se recopilan y tratan en el [hilo dedicado a la propia migración](https://github.com/OCA/l10n-spain/issues/3754). En cualquier caso, si tan fundamental es para vuestro proyecto, lo que podéis hacer es:

- Realizar la migración vosotros y contribuirla a OCA.
- Financiar a un contribuidor para que la haga por vosotros.

Si no, no está garantizado ningún plazo de realización. Cuando uno de los contribuidores que suelen migrar lo necesite, lo llevará a cabo y probablemente lo contribuya de vuelta en OCA, pero sin garantías expresas ni obligaciones.

Cierro por lo dicho que no debe haber hilos en incidencias sobre cosas que no lo son."
Issue,4262,"Sería incluir el tipo de operación, pero hay que asegurar que funcionan minorando la misma casilla, o si van de otra forma. [SEP] El modelo 123 no tiene casillas específicas para facturas rectificativas por lo que tiene que ir minorando los importes

![Image](https://github.com/user-attachments/assets/fb452898-e318-455d-9f0d-9ee961779de0) [SEP] Sería entonces si no estoy equivocado, cambiar esta línea y la siguiente a ""both"" en lugar de ""credit"":

https://github.com/OCA/l10n-spain/blob/18.0/l10n_es_aeat_mod123/data/2024/l10n.es.aeat.map.tax.line.csv#L4 [SEP] Pero parece ser que hay que hacer más cosas según https://github.com/OCA/l10n-spain/pull/4220#issuecomment-3024074700 [SEP] He respondido en este PR que hizo @omar7r : https://github.com/OCA/l10n-spain/pull/4220

La cuestión es que la norma solo aplica si debes ingresar más pero no es de menos.


1. Si la factura rectificativa aumenta la retención:

- Debes presentar un modelo 123 complementario del trimestre original.

- Fundamento: artículo 4.3 de la Orden HAP/1608/2014.


2. Si la factura rectificativa reduce la retención:

- No se modifica el modelo 123 ya presentado.

- Si se ingresó de más, debes solicitar una devolución de ingresos indebidos.

- Fundamento: artículo 221.1 de la Ley General Tributaria.

---
Referencias:

Modelo 123 AEAT: https://sede.agenciatributaria.gob.es/Sede/procedimientoini/GC27.shtml

Orden HAP/1608/2014: https://www.boe.es/diario_boe/txt.php?id=BOE-A-2014-8121

Ley General Tributaria: https://www.boe.es/buscar/act.php?id=BOE-A-2003-23186


@moduon @omar7r  [SEP] https://github.com/OCA/l10n-spain/pull/4220#issuecomment-3024303414 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4237,"La rama 12.0 es una rama obsoleta y ya no se mantiene ""oficialmente"". También se junta que el soporte de las herramientas de CI para esa rama está obsoleto (por el propio GitHub), con lo que aquí debes buscar la forma de traer esos cambios, aunque mi recomendación es que migres de versión. [SEP] Gracias Pedro, intentaré actualizarme con openupgrade."
Issue,4223,"@pedrobaeza Podrías echar un vistazo? Gracias! [SEP] He comentado esto en el foro, hay algunos bancos que ni el VAT te ponen. He tenido que hacer algo para poner el partner_id con una importación de extractos por xlsx. Modificando fichero. [SEP] Esto quedó solucionado eligiendo a nivel de diario lo que se quiere hacer, así que cierro."
Issue,4213,"Me temo que la información proporcionada no es suficiente. Revisa la fecha y hora a la que tiene programado el envío, y si tu instancia puede ejecutar acciones planificadas. Por lo demás, debería funcionar correctamente.

Cierro mientras no tengamos más información que pueda llevarnos a deducir que es un problema del módulo."
Issue,4211,"@Bilbonet ¿podrías tal vez indicarme donde encontrar el formato correcto? [SEP] Buenas @rrebollo 
Como se puede ver en el XML que he puesto de ejemplo. Si te fijas en el detalle del IVA.
La parte del recargo de equivalencia la indica mal con el valor ""N"".
Devería ser asi:
`<OperacionEnRecargoDeEquivalenciaORegimenSimplificado>S</OperacionEnRecargoDeEquivalenciaORegimenSimplificado>`

Si realizas una factura Ticketbai con recargo de equivalencia funciona bien. Son las ventas del POS las que sale este valor mal. 
 [SEP] Estimado @Bilbonet
**Problema**: 
- Las implementaciones no gestionan la posición fiscal, ejemplo: v14 https://github.com/OCA/l10n-spain/blob/edfd729da0de8614aad56379c68eb5e8fcd86cac/l10n_es_ticketbai_pos/static/src/js/tbai_models.js#L194-L209

En v16 no mezclado aún:

https://github.com/BinhexTeam/l10n-spain/blob/544ca459119d1d607e8d8ca75fb534f5ff7cac2e/l10n_es_ticketbai_pos/static/src/js/tbai_models.js#L241

- Parece un enfoque técnico simplificado

**Consulta**:
A la luz de estos elementos te parece que sea intencional (por diseño) o es una limitación a corregir? Pregungo por confirmar el enfoque antes de proponer cambios técnicos. [SEP] Buenas @rrebollo

No he analizado a fondo el código que muestras y al mirarlo por encima tengo una duda.
¿Esa parte que muestras del código no se refiere a la posición fiscal de la compañía?
Para el caso que tratamos es la posición fiscal del cliente la que interviene para el desglose de los impuestos. [SEP] > Buenas [@rrebollo](https://github.com/rrebollo)
> 
> No he analizado a fondo el código que muestras y al mirarlo por encima tengo una duda. ¿Esa parte que muestras del código no se refiere a la posición fiscal de la compañía? Para el caso que tratamos es la posición fiscal del cliente la que interviene para el desglose de los impuestos.

Exacto. Solo se tiene en cuenta la company. Creo que desde el punto de vista técnico hay un tratamiento ""ingenuo"" del feature por eso me parece que es una limitación desde el diseño. En el caso del addon ticketbai pos es únicamente desde este código que indico que se le asigna valor al elemento ""OperacionEnRecargoDeEquivalenciaORegimenSimplificado"" del xml. [SEP] Ok entiendo.
Entonces mas que un bug ya estamos hablando de una mejora que habría que implementar.
  [SEP] @Bilbonet entiendo que hay un referente porque desde la app de contabilidad el proceso funciona correctamente así que podría mirarse el código allí (asumo que mayormente python) y trasladar la idea hacia donde corresponda en ticketbai pos (python y js) muy probablemente. Aclarar desde el punto de vista del negocio el panorama para técnicos como yo podría ser la clave: ¿si el cliente tiene una posición fiscal de Recargo de Equivalencia el IVA se comportará igual que en el régimen simplificado? es que no creo que este cambio lo único que afecte sea el valor del tag OperacionEnRecargoDeEquivalenciaORegimenSimplificado al generar el xml. [SEP] No entiendo porque han hecho esta simplificación la verdad.
Puede ser que el desarrollo viene de versiones anteriores del POS donde igual no se podían utilizar diferentes posiciones fiscales de cliente. Y en ese caso pues no correspondía añadir dicha lógica.

Peor por lo que yo conozco desde v14.0 el POS permite diferentes posiciones fiscales así que entiendo que tiene que funcionar igual que en financiero.

De hecho, el POS hace bien el calculo del IVA (parte del core de Odoo). 
Es la parte de TBAI la que no mira el detalle del impuesto si es <OperacionEnRecargoDeEquivalenciaORegimenSimplificado> (desarrollo TBAI).

Respecto a la pregunta que planteas, no se si hay otros caso en los que no este haciendo correctamente el envío TBAI. Pero es muy probable que también ocurra con otras posiciones fiscales como intracavitarias etc...

De momento las facturas simplificadas con recargo de equivalencia la hacienda de Bizkaia las está rechazando:
```
Código:   	B4_2000031
Descripción	(ES): Valor del Tipo impositivo no admitido.
``` [SEP] @Bilbonet gracias por el inside. Creo que como dices probablemente esté relacionado con el hecho de que orgininalmente el POS no permitía usar múltiples posiciones fiscales. Tengo esto en mis issues pendientes. Mirando lo hecho para contabilidad tal vez se pueda trasladar el comportamiento a pos o encontrar alguna solución para incorporar el feature. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4207,"Está fusionado en el repositorio:

https://github.com/OCA/l10n-spain/tree/15.0/l10n_es_aeat_mod592"
Issue,4206,"@pedrobaeza Si puedes revisar esto y decirme si es por culpa de configuración o si esta obsoleto lo del `_tipo` [SEP] No te puedo decir ahora mismo, porque ahora mismo no tenemos ninguno en activo con este transportista. Hasta hace poco, la antigua URL de ASM funcionaba. Tal vez la han cambiado. [SEP] @pedrobaeza Solo hay que cambiar la url a una mas actual, ya que he tenido que llamar a los de gls y me han dado la url que se tiene que utilizar y voy a hacer los fix de las version 14.0, 16.0 y 17.0, ya que en la version 18 hay un pr de una compañera mia que lo añadira ella.

La nueva url:

![Image](https://github.com/user-attachments/assets/eac7191e-5a32-45b9-ac94-870680a1460a)

El pr de la migración:
https://github.com/OCA/l10n-spain/pull/4090 [SEP] Cierro al estar ya los PRs."
Issue,4198,"Hola, no existe ningún módulo con ese nombre. Dirige por favor tus consultas al foro de AEOdoo, al no tratarse de problemas de los módulos en si, si no de uso."
Issue,4197,"Los módulos de prorrata no están aún migrados a dicha versión, por lo que es normal que los de una versión anterior no funcionen adecuadamente en la siguiente."
Issue,4196,"Exel oficial de equivalencias

https://www.ine.es/daco/daco42/clasificaciones/cnae25/Correspondencia_CNAE25_CNAE09.xlsx"
Issue,4185,"Da igual, porque esas casillas no se rellenan con nada, y están ahí solo ""de adorno"". Haría falta migrar el módulo de criterio de caja, que las alimenta, y además creo recordar que se hace manualmente sin seguir esa configuración.

Cierro por no ser un problema real."
Issue,4178,"Si es así, creo que también se debería modificar la casilla 84 y pasar ese impuestos a la casilla 94. [SEP] Y aunque no se si este comentario vendría aquí o se debería abrir un nuevo issue en caso de aprobar el cambio que propone @pedroortega-punt en el mod. 303, creo que en el mod. 390 se debería cambiar el impuesto de la casilla 110 a la 104. [SEP] @TesseraTech4 He realizado la consulta telefónica al departamento de IVA y me han informado que los bienes a la casilla 60 y la prestación de servicios a la casilla 120, por lo que habría que cambiar el mapeo del impuesto de bienes a la casilla 60. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4173,"Es mucho más sencillo hacer el check de ""No incluir en el 347"" del contacto como dependiente de la compañía. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4169,¿En la posición fiscal del régimen extracomunitario habéis puesto que el tipo de identificación SII sea de exportación? [SEP] Buenos días @pedrobaeza he probado en el mismo runboat y ahora estamos haciendo pruebas en el cliente. Tiene pinta que es eso. Muchísimas gracias. 
Issue,4165,"Este commit y otros similares en diversos módulos ya tenían en cuenta que estuvieran archivados:

https://github.com/OCA/l10n-spain/commit/e4457af95b1c027a71eb74b1a6e066e6c828b9e8

Tendrás que concretar algo más para saber si falta algo por aplicar. [SEP] Era para versión 14 que no estaba hecho el backport. Acabo de hacerlo en https://github.com/OCA/l10n-spain/pull/4170

@pedrobaeza gracias por el apunte."
Issue,4155,"Me temo que la información proporcionada no es suficiente para poder ayudar. [SEP] Buenas tardes,
He detectado que el error se produce porque al pulsar en la acción de servidor Enviar al SII en las facturas, en la función de default_get, no actualiza el campo account_move_ids, con las IDS seleccionadas, por lo que al intentar enviar al SII, aparece sin facturas a enviar.
l10n_es_aeat_sii_oca/wizards/account_move_send_sii.py. 
```
        res.update(
            {
                ""sending_number"": len(account_moves),
                ""not_send_without_errors_number"": len(not_send_without_errors),
                ""with_errors_number"": len(with_errors),
                ""modified_number"": len(modified),
            }
        )
        return res
```

Saludos
 [SEP] Fuera de que ahí pueda haber un error, ¿por qué se están usando ese asistente, si con una configuración normal se encola para enviar en cuanto se confirma la factura? [SEP] En mi caso tengo habilitado el que no se envíe las facturas automáticamente, si no que se haga manualmente con el botón de Enviar al SII [SEP] Como tal, considero un error hacerlo de esa forma, porque es muy fácil ""olvidarse"" de alguna factura a enviar y hacerlo en plazo, pero bueno, cada uno que elija la forma que quiera. Entiendo de todas formas que no tienes nada que ver con Eva y la tuya ha sido una averiguación parelela, ¿verdad? [SEP] @Evaguadaltech es posible que alguna de las facturas esté dando error en el envío y por eso parezca que no haga nada. 
Intenta ejecutar la acción planificada manualmente y mira si te sale algún mensaje de error. 

Hola @pedrobaeza iba a abrir un issue, pero me cuelgo de este hilo, en caso de ser necesario lo abro formalmente. 
¿Sabes si es normal que no se puedan enviar al SII facturas de cliente de países extracomunitarios  sin NIF establecido? En versión 15 sí se podía y no veo que en v17 haya que hacer una configuración adicional. ¿Es obligatorio? Gracias 
 [SEP] @mof-landoo en principio sobre eso no ha habido ningún cambio, así que alguna diferencia debería haber entre lo hecho en la 15 y en la 17. Analiza eso, y si no, especifica todos los pasos con datos para reproducir el error en una issue diferente. [SEP] Muy buenas, nosotros estamos teniendo el mismo problema. Tenemos la versión 17 de Odoo y enviamos las facturas de forma manual pulsando el botón (también lo hemos probado de forma automática). Desde el lado de Odoo parece que se ha enviado la factura de forma correcta, cambia a estado Enviado, obtiene el SII CSV, incluso muestra el Retorno SII, pero luego consultamos en la agenciatributaria y la factura no ha llegado.
También he probado a ejecutar la acción planificada de forma manual pero tampoco funciona.
En nuestro log de odoo (odoo-server.log), cuando pulsamos Enviar al SII solo se muestra lo siguiente:
odoo.addons.base.models.ir_cron: Starting job: 'Send Invoices to SII'
odoo.addons.base.models.ir_cron: Job done: 'Send Invoices to SII' (0.794s)

No aparece ningún error.  
¿Se os ocurre por qué puede ser para que lo revise? [SEP] @AlbertoCanto si os devuelve CSV, sí que se está enviando. A ver si tenéis puesto el portal de pruebas en lugar del real... [SEP] El modo pruebas no estaba activado, además, lo curioso, es que el CSV que devuelve no coincide con el real, ya que el que aparece en el campo de Odoo SII CSV es un valor alfanumérico y el que aparece en la factura dentro del portal de la agenciatributaria es numérico solamente. [SEP] Serán números diferentes, porque el CSV siempre ha tenido formato alfanumérico. [SEP] Cierro como ya se fusionó el PR que corregía el asistente de envío."
Issue,4140,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4138,"Me pasa exactamente lo mismo, si alguien puede dar una solucion me salva, gracias.  [SEP] El módulo debe actualizarse a la última versión (en código y en base de datos), y utilizar la última configuración de exportación disponible. Cierro al estar ya cubierto en el módulo."
Issue,4115,"Hola, Eva, ese tipo de preguntas puedes hacerla en https://www.aeodoo.org/forum, que es un lugar más adecuado para ello."
Issue,4110,"@HaraldPanten @pedrobaeza @etobella @JordiBForgeFlow  [SEP] Bueno, yo lo veo más sencillo en esos casos: tienes instalados los dos módulos, pero activas SII o Verifactu y ya está. Es que otro tipo de compatibilidad no es posible, porque hay campos muy específicos de cada tipo. Por ejemplo, el QR o el encadenamiento de Verifactu, no tienen sentido en la capa superior de abstracción, al igual que el CSV del SII. [SEP] > Bueno, yo lo veo más sencillo en esos casos: tienes instalados los dos módulos, pero activas SII o Verifactu y ya está. Es que otro tipo de compatibilidad no es posible, porque hay campos muy específicos de cada tipo. Por ejemplo, el QR o el encadenamiento de Verifactu, no tienen sentido en la capa superior de abstracción, al igual que el CSV del SII.

Sería la idea, pero hay campos que son compartidos y eso es posible que cree ""inconsistencias"". Por otro lado, podría pasar que una compañía utilice un sistema y otra compañia (sistema multicompañía) utilice el otro.... no se si sería ideal realizar una mayor separación. Abro este punto, ya que como se acercan las jornadas podría ser un punto a realizar (en caso de tener que realizarse algo). [SEP] Hasta donde sé, la activación es por compañía, por lo que no es problema. Si ves incompatibilidad de campos, sería listarlos y empezar a resolverlos (que básicamente sería poner nombres distintos), pero no creo que haya tantos. [SEP] > Hasta donde sé, la activación es por compañía, por lo que no es problema. Si ves incompatibilidad de campos, sería listarlos y empezar a resolverlos (que básicamente sería poner nombres distintos), pero no creo que haya tantos.

Por nuestra parte sin problemas, entonces nos lo apuntaremos para el codesprint 😄 . [SEP] Hola @ValentinVinagre a priori son compatibles, y se configuran por compañía, si pasa de un sistema a otro habría que marcar/desmarcar los checks de la compañía pero no necesariamente desinstalar los módulos con lo que no habría inconsistencias de datos, eso ya se planteo en el anterior codesprint. Digo a priori por que puede que haya algun método que se llame igual y habría que revisarlo.  [SEP] > Hola [@ValentinVinagre](https://github.com/ValentinVinagre) a priori son compatibles, y se configuran por compañía, si pasa de un sistema a otro habría que marcar/desmarcar los checks de la compañía pero no necesariamente desinstalar los módulos con lo que no habría inconsistencias de datos, eso ya se planteo en el anterior codesprint. Digo a priori por que puede que haya algun método que se llame igual y habría que revisarlo.

No estoy del todo de acuerdo, según la migración de 16-17 del SII ya vimos cosas compartidas, etc. [SEP] Igual no me he expresado correctamente, Quería decir que la idea era hacerlo así, puede que haya algo compartido 😄 [SEP] Valentín, ¿tienes un listado de esos campos conflictivos que comentas? [SEP] > Valentín, ¿tienes un listado de esos campos conflictivos que comentas?

Actualmente no tengo una lista, la idea es poner el tema encima de la mesa y plantear la situación. No busco realizar una acción correctiva actualmente, nuestra idea si nos ponemos es en los spanish oca days. [SEP] Vale, pues en los Spanish OCA days alguien puede dedicarse a detectar esos posibles conflictos y atajarlos antes de que fusionemos para que no haya luego que renombrar campos y demás. [SEP] Perdón por mi ignorancia, pero se sabe cuándo y por donde estará listo el módulo de VeriFactu ? [SEP] > Perdón por mi ignorancia, pero se sabe cuándo y por donde estará listo el módulo de VeriFactu ?

Se está realizando desde el siguiente PR, mejor pregúntalo por ahí:
https://github.com/OCA/l10n-spain/pull/3579 [SEP] Respuesta de AEAT:

`Buenos días:

Primero, debe recordarse que un SIF adaptado al RD 1007/2023 (tanto actuando en la modalidad VERI*FACTU como en la NO VERI*FACTU) SOLO puede usarse cumpliendo con todos los requisitos de dicho RD 1007/2023 que le aplican a él (para lo que, entre otras cosas, es necesario tener instalado un certificado electrónico cualificado válido). Cuando un productor o fabricante –mientras se den las circunstancias que permitan esto– ofrece al cliente un sistema de facturación para que pueda ser usado de forma adaptada al RRSIF o sin adaptar a dicha normativa, o bien para que cumpla con diferentes normativas, tales como TicketBAI, RD 1007/2023 y la normativa que regula el Suministro Inmediato de Información “SII”, realmente está ofreciendo “un paquete o familia” de varios productos SIF diferentes (aunque puede que compartan gran parte de su programación), a fin de que el cliente pueda elegir específicamente uno para instalar y usar, bajo la responsabilidad del usuario.
En cualquier caso, este ofrecimiento debe implementarse de tal forma que el usuario no pueda cambiar dinámicamente de un “producto” a otro con cada factura ni con cada sesión o arranque del producto, sino que el usuario deberá elegir previamente qué tipo de SIF quiere utilizar y lo instalará –o actualizará– para que cumpla con esas características, que ya permanecerán así en adelante (a menos que se desinstale).
En todo caso, será el usuario último del SIF, quien será responsable de seleccionar la modalidad de su software que corresponda con la normativa que se le aplica.

Si el caso es que el usuario ha decidido, por ejemplo, darse de alta voluntaria en el SII, a partir de ese momento, a todos los efectos relativos a su facturación propia, no quedan afectados por el R. D. 1007/2023 y el programa que utilicen deberán cumplir genéricamente con las obligaciones que se señalan en el artículo 29.2.j) de la Ley 58/2003, de 17 de diciembre, General Tributaria (LGT).

Respecto a  la conservación de los registros de facturación (RFs) si se trata de un SIF que actúe en la modalidad VERI*FACTU, no es obligatoria la conservación de los registros de facturación (RFs), dado que estos habrán sido remitidos en el momento de la expedición de las facturas, a la sede electrónica. En los demás casos, rigen las normas de conservación documental habituales en materia fiscal, es decir, con carácter general, la prescripción fiscal (cuatro años posteriores a la fecha de devengo), pero, en determinados supuestos, plazos más largos. 

Si fuese a la inversa, igualmente, deben cumplir con la normativa que corresponda. Lo que queremos dejar claro con esto, es que se trata de normativas diferentes con obligaciones diferenciadas. El SII consiste en la llevanza de los libros registro de IVA (facturas emitidas, facturas recibidas, bienes de inversión…) a través de la sede electrónica de la Agencia Tributaria, lo que implica obligaciones de comunicación electrónica a la Agencia Tributaria de una amplia información relacionada con el IVA de las facturas emitidas y recibidas en un determinado plazo de tiempo. Por su parte, el reglamento que establece los requisitos de los sistemas informáticos de facturación obliga a que los SIF registren, con determinadas medidas de seguridad y control, cierta información solo de las facturas expedidas, pudiendo remitirse opcionalmente a la Agencia Tributaria.
El ámbito subjetivo de ambos proyectos es excluyente, es decir, quienes cumplan con el SII no han de cumplir con el reglamento que establece los requisitos de los sistemas informáticos de facturación y viceversa.
Respecto a la consulta del encadenamiento, el SIF utilizado sería una nueva instalación por lo que debería comenzar un nuevo encadenamiento.

Atentamente,
Atención al Usuario
Departamento de Informática Tributaria
Email: verifactu@correo.aeat.es
`

Con saber que ha sido enviado para no volver a enviarlo valdría y ya está en el módulo l10n_es_aeat

Saludos,
Ignacio [SEP] > Con saber que ha sido enviado para no volver a enviarlo valdría y ya está en el módulo l10n_es_aeat

Genial, gracias @acysos . "
Issue,4103,"https://github.com/OCA/l10n-spain/issues/4024
Perdon no vi que ya estaba reportado este bug. [SEP] Revisa que utilizas el formato de exportación último y que tienes todo el código actualizado y tu BD actualizados los módulos. [SEP] ok gracias sin problemas , hare antes una copia de esta maquina en el proxmox."
Issue,4102,"Esto se ha discutido anteriormente por issues o en los PRs de `l10n_es_pos`. Haz una búsqueda para echar un vistazo. Básicamente, es utilizar `pos_default_partner` o desarrollar una extensión `l10n_es_vat_book_pos`. [SEP] Gracias Pedro. No tenía constancia. 

De acuerdo, optaremos entonces por la extensión del vatbook para que no requiera el partner en los asientos de caja.  [SEP] Aqui esta:
- [l10n_es_vat_book_pos] https://github.com/OCA/l10n-spain/pull/4104 "
Issue,4100,"ping @AaronHForgeFlow @JordiBForgeFlow @etobella @ValentinVinagre @acysos @rubencr7 @fuentes73  [SEP] A ver, esto es complicado. La verdad es que lo primero seria pensar si necesitamos seguir usando los certificados como ficheros y que ventaja nos da eso. Si alguien accede al servidor, al final lo tiene todo, con lo que tenerlo en como fichero no nos da más seguridad a no ser que tengamos la BBDD desacoplada del servidor de Odoo. Por lo tanto, yo creo que podemos usar el sistema de Odoo directamente ya que no hay una ventaja directa.

De todas formas, estaría bien ver otras opiniones, por que tal vez se me escapa algo de por que se hizo así en su día. [SEP] Haciendo una revisión en diagonal, veo luces y sombras:
Luces:

- Nos ha pasado que ciertos clientes tienen ""intranquilidad"" en traspasar certificados electrónicos y contraseñas... así que sería una opción para que el propio usuario lo pueda gestionar y no necesite al implantador(hasta cierto punto).
- Si Odoo proporciona un sistema parecido o compatible, lo ideal es utilizarlo, menos que mantener.

Sombras:

- ¿Que dirección tomará Odoo con esto?
- ¿La exportación propia de Odoo puede dar información del certificado? ¿está protegido?
- Elimina la opción de poder tener el certificado externamente ¿sería posible realizar la ampliación? Si se hace... ¿vale la pena?

En conclusión no me parece mal ir por el camino de Odoo, pero haría una ampliación para poder optar también a la utilización del certificado como hasta ahora.
¿Como lo veis? [SEP] Odoo usa los certificados para el mismo propósito que se usa en la localización, por ejemplo en su módulo de facturae lo usa, así que sí creo que es un ""feature"" que está solapado con el módulo del l10n_es_aeat.
Sin embargo el módulo certificate es bastante nuevo y creo que le van a hacer cambios puesto que a mi modo de ver presenta algunas vulnerabilidades:

* La contraseña para desencriptar el fichero .pfx o p12 se guarda directamente en la tabla certificate_certificate:

![Image](https://github.com/user-attachments/assets/39589d2b-330c-440c-882e-367830b4aef6)

* El contenido del fichero .pem extraído se guarda directamente en la tabla del ir_attachment:

![Image](https://github.com/user-attachments/assets/e7a1e311-94f7-42d6-a0db-0e6cdfde14f6)

Creo que aunque son funcionalidades que se solapan esperaría a que Odoo las hiciera más estable. Podríamos hacer el esfuerzo de mejorar la seguridad ahora para que luego Odoo lo arregle en la siguiente versión.

Yo en el PR de migración ya he quitado el commit que hacía la migración al nuevo modelo. [SEP] > Odoo usa los certificados para el mismo propósito que se usa en la localización, por ejemplo en su módulo de facturae lo usa, así que sí creo que es un ""feature"" que está solapado con el módulo del l10n_es_aeat. Sin embargo el módulo certificate es bastante nuevo y creo que le van a hacer cambios puesto que a mi modo de ver presenta algunas vulnerabilidades:
> 
> * La contraseña para desencriptar el fichero .pfx o p12 se guarda directamente en la tabla certificate_certificate:
> 
> ![Image](https://github.com/user-attachments/assets/39589d2b-330c-440c-882e-367830b4aef6)
> 
> * El contenido del fichero .pem extraído se guarda directamente en la tabla del ir_attachment:
> 
> ![Image](https://github.com/user-attachments/assets/e7a1e311-94f7-42d6-a0db-0e6cdfde14f6)
> 
> Creo que aunque son funcionalidades que se solapan esperaría a que Odoo las hiciera más estable. Podríamos hacer el esfuerzo de mejorar la seguridad ahora para que luego Odoo lo arregle en la siguiente versión.
> 
> Yo en el PR de migración ya he quitado el commit que hacía la migración al nuevo modelo.

¿y si se valora para v19 a ver que cambios realizan? yo por el momento mantendría el de OCA como está. [SEP] Para mí lo ideal seria:
1) Guardar el contenido fichero .p12 en una variable de entorno en el servidor
2) Guardar el password asociado en un lugar seguro, que puede ser uno de los siguientes:
    a) Variable de entorno, también en el servidor
    b) En un servicio externo como Google KMS, AWS Secrets Manager, Hashicorp Vault... que limitan quién puede acceder a estas claves (por ejemplo, aplicando restricción por IP)

Por lo que entiendo ahora la arquitectura del modulo l10n_es_aeat guarda la clave privada en la base de datos, de modo que esa clave acaba estando en todos los backups de la base de datos y acaban replicandose en entornos de staging con facilidad.




 [SEP] Creo que estas dos ventajas que señalaba @ValentinVinagre son importantes:

> * Nos ha pasado que ciertos clientes tienen ""intranquilidad"" en traspasar certificados electrónicos y contraseñas... así que sería una opción para que el propio usuario lo pueda gestionar y no necesite al implantador(hasta cierto punto).
> * Si Odoo proporciona un sistema parecido o compatible, lo ideal es utilizarlo, menos que mantener.

Sobre el primer punto, pensad que para que un usuario mande la contraseña del certificado a su implantador, tiene que usar un canal adicional, que perfectamente puede ser un vector de ataque adicional.

Pero sin contar con ese, básicamente existen 3 vectores de ataque. Comparemos:


  | Sistema antiguo de OCA | Sistema nuevo de Odoo
-- | -- | --
**Acceso elevado a Odoo** | Vulnerable. | Vulnerable.
**Acceso elevado a Postgres** | Seguro, ya que no hay datos. | Seguro, salvo que también consigas acceso al filestore.
**Acceso elevado al filestore** | Vulnerable. | Seguro, salvo que también consigas acceso a Posgres.

Así pues, antes estábamos poniendo toda la seguridad en el filestore. Ahora, una parte se almacena en Postgres y otra en el filestore. **A mi modo de ver, estamos incrementando la seguridad** puesto que un atacante necesitará vulnerar 2 accesos diferentes para desbloquear el certificado.

Por supuesto, un acceso elevado a Odoo es vulnerable en todos los sentidos y siempre lo será, por diseño, porque:
- Odoo necesita desbloquear la clave. Por tanto, de un modo u otro, necesita tener la contraseña.
- Un usuario con privilegios puede escribir una acción de servidor y hacer lo que quiera.

Más contexto a considerar:
- El almacenamiento en texto plano de contraseñas en Odoo ya se hace en otros sitios, como los servidores de correo entrante/saliente.
- OCA puede crear módulos que mejoren la seguridad de `certificate` mediante almacenar la contraseña en otro backend, ya sea el filestore, vault, bitwarden, etc. Esa mejora sería transparente a lo que haga `l10n_es` o similares, ya que actuaría a otro nivel.

Por lo tanto, para mí **lo mejor que podemos hacer es adoptar `certificate`**.

@moduon MT-9954 [SEP] Los que trabajaron en la migración de la localización los Spanish OCA Days no estaban convencidos del cambio, así que por el momento se ha dejado como estaba. Se puede evaluar en la siguiente versión, o en medio de ésta con scripts de migración, aunque implicaría un cambio de dependencias."
Issue,4094,"No es necesario abrir issue si se va a abrir PR, ya que es duplicar la información. Se continúa en #4095 "
Issue,4092,"Can you provide more information about the error? like the line/file/module or even the full traceback? [SEP] Esto tiene pinta de un Odoo.sh con algo incorrecto con la librería openupgradelib. En cualquier caso, no es un problema de este repo. [SEP] Tengo este mismo issue en la V17 Odoo.sh, solo veo en el log OpenUpgrade: 'migrate' decorator: failed to inspect the frame above: 'pkg', no tengo más detalles del origen. openupgradelib lo tengo actualizado. Alguna idea de como solventar este issue? [SEP] Creo que Odoo ha hecho algo en su Odoo.sh que provoca ese problema, pero claro, ya queda fuera de nuestro alcance. Pon un ticket de soporte a ellos a ver qué dicen. Sois varios con el mismo problema en cuanto usáis la librería en ese hosting. A ver si saben deciros algo. He revisado los últimos commits de la librería, y no hay ninguna razón para que provoquen este error. [SEP] > Creo que Odoo ha hecho algo en su Odoo.sh que provoca ese problema, pero claro, ya queda fuera de nuestro alcance. Pon un ticket de soporte a ellos a ver qué dicen. Sois varios con el mismo problema en cuanto usáis la librería en ese hosting. A ver si saben deciros algo. He revisado los últimos commits de la librería, y no hay ninguna razón para que provoquen este error.

Hi @pedrobaeza, i've opened the PR https://github.com/OCA/openupgradelib/pull/410  after investigating the probelm; that seem originated by 
 - 16.0 https://github.com/odoo/odoo/pull/202014
 - 17.0 https://github.com/odoo/odoo/pull/202583

both PRs move the migration logic away from its original position in a dedicated method, that has not the pkg in `locals` scope, because the caller pass to that method directly the name of module [SEP] Disculpad que parece que finalmente sí es de la librería. Gracias a @patrickt-oforce 

Viendo la fecha del parche, no me cuadraba porque yo hice una migración sin problemas hace unos días, pero ya sé la razón: OCB no se está sincronizando desde hace una semana. [SEP] @pedrobaeza So, do you recommend reopening the issue? 

@patrickt-oforce you are crack!! [SEP] No, because it's already fixed."
Issue,4085,"No, esto es así a propósito, porque casi muchos no necesitan esa separación (solo los B2C), así que obligar a ello no es de recibo, y más con un módulo tan intrusivo como `partner_firstname`. Hay que leer los README: https://github.com/OCA/l10n-spain/tree/17.0/l10n_es_facturae#installation"
Issue,4077,
Issue,4060,"Bueno, realmente es correcto que se muestre así, porque Hacienda hasta donde sé es lo que pide en sus inspecciones, ya que es lo que se puede deducir. Mostrar otro dato que haga que las verificaciones cruzadas con el 303 no cuadren es lo que provocaría confusión y preguntas. El enlace proporcionado no veo que esté relacionado, porque no es de prorrata y además habla del SII. [SEP] Entiendo que está mencionado lo del SII, porque SII y Libro de IVA deberían coincidir. De todas formas, a nosotros no nos ha aparecido la casuística. Justamente tenemos los clientes que utilizan prorrata, también están dados de alta en el SII, en nuestro caso; por lo que el libro de IVA, a nivel práctico, no lo utilizan. [SEP] Según el diseño de registro del Libro de IVA que se puede encontrar [aquí](https://sede.agenciatributaria.gob.es/Sede/iva/libros-registro.html) y descargar desde este enlace [Diseños de registro normalizados para los Libros Registro del IVA de personas jurídicas no incluidas en SII en los formatos XLS y CSV (actualizado 18-12-2024)](https://sede.agenciatributaria.gob.es/static_files/AEAT/LSIJ.xlsx):

> - En ""Cuota Deducible"" se consignará el importe de la Cuota del IVA Soportado que sea deducible para cada tipo de IVA. Cuando toda la cuota soportada sea deducible, en la columna ""Cuota Deducible"" se consignará el mismo contenido que figure en la columna ""Cuota IVA Soportado"". 

Es decir, que según el ejemplo de @rafaelbn con una prorrata del 80% configurada en la compañía entonces el valor mostrado en ""Cuota IVA Siportado"" debería ser diferente al valor mostrado en ""Cuota deducible"", concretamente un 80% en este caso. Sólo deberían coincidir cuando toda la cuota soportada sea deducible.

Actualmente con los dos módulos instalados `l10n_es_vat_book` y `l10n_es_vat_prorate` el valor mostrado es idéntico en ""Cuota IVA Soportado"" y ""Cuota deducible"" dando a entender que toda la cuota soportada es deducible independientemente del valor que te hayas deducido. También se está viendo afectado ""Total de factura"" pues el valor reflejado es la Base Imponible + Cuota Deducible, pareciendo que el IVA está mál aplicado.

Ejemplo práctico de una factura de una compañia con la Prorrata del IVA al 80% para este período y con dos líneas de factura, una línea con un importe de 100 € y un impuesto del 21% y otra línea de 200€ con el mismo impuesto.

![Image](https://github.com/user-attachments/assets/097d527b-11ad-48d2-b0a6-792d316bccbc)

- El total de la factura son 363€.
- La cuota de IVA Soportado es 63€, el 21% de 100€ más el 21% de 200€.
- La cuota deducible es 50,40€, el 80% de la cuota de IVA soportado.


Sin enmbargo el libro de IVA está haciendo un cálculo incorrecto, con este ejemplo sale:

![Image](https://github.com/user-attachments/assets/bc39ab8f-904d-4010-a7e2-197267f3dc69)

A todas luces se ve que el cálculo es incorrecto.

¿Cuál creeís que es la solución correcta @pedrobaeza @HaraldPanten @etobella? ¿Crear un módulo glue, por ejemplo, `l10n_es_vat_book_prorate` o solventarlo directamente en `l10n_es_vat_book`?
 [SEP] Gracias por los detalles extra, Emilio. Ahora queda claro que tenemos dos columnas para la cuota y que la prorrata haría diferente cada una. @etobella utilizó un ""truco"" para no necesitar un módulo extra para el SII que completé yo en https://github.com/OCA/l10n-spain/pull/2598

Tal vez se podría aplicar algo similar. Si no, un glue module. [SEP] Con este PR https://github.com/OCA/l10n-spain/pull/4093 debería solventarse. [SEP] Solucionado en https://github.com/OCA/l10n-spain/pull/4093"
Issue,4051,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,4042,"Buenas @JMTato, esos impuestos corresponden a los de impuesto minorista, pese a que se llamen Impuesto 3% en realidad no se aplica el 3%. Te adjunto un documento con más información: https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://revistas.cef.udima.es/index.php/RCyT/article/download/18473/18201/27775&ved=2ahUKEwijmKzC1MKJAxXEVqQEHXihBlkQFnoECDYQAQ&usg=AOvVaw1b3TMfGz9pYSg7Dfdeo_3U  [SEP] Muchísimas gracias!! Entendido y disculpa."
Issue,4039,"Rolando, no es necesario abrir un issue cuando vais a abrir el PR. Simplemente abre el PR directamente con el texto del issue. Cierro y se sigue por #4040 "
Issue,4024,"Revisa los pull request en 15.0 y 16.0, que ya está corregido, y en camino la 17.0. Para versiones anteriores, podéis hacer cherry-pick."
Issue,4020,"Bueno, con las de ATC creamos un nuevo menú de segundo nivel ""Declaraciones ATC"": https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_atc/views/atc_menuitem.xml#L4, pero podemos reformularlo a tener un único menú superior y poner tres niveles:

- Declaraciones

  -  AEAT

     - Modelo 303

  -  ATC

     - Modelo 415

 [SEP] @pedrobaeza me parece también bien, la idea es no llenar de menús el principal que puede ser al final muy  poco visual.

Pero también hay que tener en cuenta que el por ejemplo el 347 se llama igual en varios sitios, pero hay alguna diferencia por ejemplo en Guipuzcoa se exporta diferente. No sería AEAT, aunque realmente el cálculo es el mismo, especificamente, pero si tiene una diferencia. Tal vez un así, aunque aquí no lo tengo tan claro, porque veo que muchos van a ser generales:

- Declaraciones

  - Generales
     - Modelo 347
  - AEAT
     - Modelo 303
  -  ATC
     - Modelo 415


Saludos,
Ignacio

 [SEP] Uf, eso no me termina de convencer, porque en Canarias creo que no existe 347, por lo que tenerlo en el apartado ""Generales"" se puede entender que también les afecta, siguiendo esa misma lógica. [SEP] Ok, pues lo dejamos como AEAT los comunes, aunque tengan formato diferente de exportación, como es el caso de Guipuzcoa.

- Declaraciones

  -  AEAT

     - Modelo 303
     - Modelo 347

  -  ATC

     - Modelo 415

  -  Bizkaia/Vizcaya

     - Modelo 140

.... [SEP] > Ok, pues lo dejamos como AEAT los comunes, aunque tengan formato diferente de exportación, como es el caso de Guipuzcoa.
> 
> * Declaraciones
>   
>   * AEAT
>     
>     * Modelo 303
>     * Modelo 347
>   * ATC
>     
>     * Modelo 415
>   * Bizkaia/Vizcaya
>     
>     * Modelo 140
> 
> ....

Me parece una buena idea 👍🏻 [SEP] OK, pues podemos hacer el cambio de 17 en adelante, ¿o queréis ir más atrás? [SEP] Yo haría 16.0, 17.0 y 18.0 (cuando se migre).

Saludos,
Ignacio [SEP] OK, pues adelante quien se anime a hacerlo. [SEP] Lo veo bien también, así sobrecargamos menos el menú. Lo único que no estoy seguro si deberíamos sacar el menu item fuera de l10n_es_aeat, en el caso de la ATC no nos afecta porque heredamos directamente de l10n_es_aeat pero el motivo principal es heredar de las plantillas de mapeo y los test helpers. Toda esa funcionalidad podría ir en un módulo común a parte. [SEP] Yo creo que debe quedarse en `l10n_es_aeat` por el momento, ya que es una base adecuada para las declaraciones (sean de la Administración que sean) y no creo que surja el que algún modelo no dependa de este módulo y ""vaya por libre"" sin heredar el modelo base de declaración. [SEP] Asigno yo a un programador y que mande el PR [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Ya realizado."
Issue,4017,"Utiliza el impuesto no sujeto para ello. [SEP] Gracias @pedrobaeza . Había probado esa posibilidad.
Pero si uso ese impuesto que está en el mapeo del Libro de IVA y la casuística para una organización sin ánimo de lucro, como me indican, es que pueda aparecer en el mod347, pero que no aparezca en el libro de IVA.
 [SEP] De momento no está contemplado eso, pero siempre puedes eliminar a mano el impuesto no sujeto del mapeo del libro de IVA. [SEP] Pero entonces los movimientos que literalmente sean no sujetos y que tuvieran que aparecer en el Libro de IVA, no aparecerán. Al quitarlo del mapeo. [SEP] Si como asociación dices que tienes líneas sin impuestos, no creo que tengas IVA no sujeto. [SEP] Me dicen que la organización se comporta como un híbrido. Hay movimientos que si tienen su impuesto, pudiendo incluir no sujeto y a su vez movimientos que declaran por el mod347 que eran los que no entraban en el cálculo por ir el campo impuesto vacío. [SEP] Tendréis que hacer entonces vosotros los modificación para tener todos los casos cubiertos. [SEP] Eso me temo. Había que intentarlo. 
Gracias."
Issue,4016,"This is not something of this repository, but Odoo itself. Please look in odoo/odoo about that, which we already discussed with them, and it was rejected with a reasoning, not remembering if in a dedicated issue or the pull request introducing the change."
Issue,4008,Se está analizando en #3996
Issue,3999,"Hola, esto es algo que debe arreglarse a nivel de Odoo, no aquí. Sé que han hecho algunos fixes y creo que no volverá a ocurrir, pero no tengo la certeza, y cuando pasa, hay que arreglarlo manualmente. 

Cierro al no ser algo de este repositorio."
Issue,3995,La versión de Factuae utilizada especificará eso en su formato. Cambia a otra versión que sea la de 3 decimales (si es que existe). Esto va normalizado. [SEP] Cierro por lo comentado.
Issue,3984,"Acabo de ver que este bug ya estaba registrado aquí #3448 
Pero parece que no se ha aportado ninguna solución por el momento.

Alguna novedad @xabispacebiker @omar7r  
 [SEP] Buenas 
Encuentro nuevos errores en el POS con la numeración de facturas simplificadas. Estos errores se producen cuando hay desconexión del POS. 
Pongo una imagen de ejemplo donde se observa que el mecanismo para asignar el numero de factura simplificada produce otros errores.
En la imagen el numero de pedido ha producido un desajuste en la correlación de la numeración.
Pero en la asignación del numero de factura simplificada ha producido duplicaciones.

![Image](https://github.com/user-attachments/assets/6de1eaaf-dae0-4c4f-861d-4f385c3175cd)

Esto junto con el módulo Ticketbai provoca facturas rechazadas que no se registran en hacienda.

Otro asunto relacionado #3480  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3971,"A tener en cuenta: https://github.com/OCA/l10n-spain/pull/2371#issuecomment-1169837041 [SEP] Issues o PRs relacionados:

- https://github.com/OCA/l10n-spain/pull/2371
- https://github.com/OCA/l10n-spain/pull/3571 [SEP] Haciende Bizkaia “DFB” tiene una aplicación llamada [BILA](https://www.bizkaia.eus/es/bila) como herramienta para cumplir con los modelos fiscales.
Esta aplicación permite importa ciertos modelos desde ficheros tal como se ha comentado en otros issues y PRs aquí comentados.

Yo por mi parte no tengo ningún desarrollo ni conozco ninguno a este respecto.

Puestos a debatir este tema, en mi opinión se podría empezar con los modelos más habituales  de IVA (303 y 390) y su casuística.

En Bizkaia, hacienda pide declarar el IVA deducible separando compras de gastos y bienes de inversión.

![Image](https://github.com/user-attachments/assets/f7967544-c65a-4aeb-b9f0-618ae2e22c96)

Esto actualmente se realiza separando en diarios los diferentes grupos. Aunque luego es un poco costoso obtener de Odoo la información separada en estos grupos y por tipos impositivos. El informe de OCA **""Tabla de impuestos""** no permite filtrar por Diario. Te tienes que ir ha los apuntes contables y allí realizar filtros, agrupaciones y calculadora en mano para sacar lo datos.

Buscar una forma más optima de agilizar este proceso e incluso añadir los modelos 303 y 390 para la BFA podría ser un comienzo.

Muchas gracias 🙂
 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3970,"@giarve , es correcto el BUG. Te lo ratifico. El caso es que cada uno esta usando el mismo impuesto para cosas diferentes...

Si quieres lee por curiosidad https://github.com/OCA/l10n-spain/issues/2945

Nadie lo resuelve y mis intentos han sido baldíos 😢  [SEP] Hola @giarve ,

Te comento para que le expliques a los asesores, pues lamentablemente hay un impuesto para gobernar todas las exenciones y claro... no vale. Entonces tiene que cambiar los XML-ID del ""impuesto comodín"" para corregirlo.

Existen varias exenciones del IVA y lamentablemente no tenemos (en Odoo 16 y anteriores) varios impuestos diferentes, sólo hay uno y otros más incorrecto y confuso que otra cosa.

Lo primero que tienes que determinar es ¿cuál es el artículo de La Ley del IVA que necesitan?

Y la respuesta que te van a decir es el Artículo 20 de la ley del IVA.

## Operaciones EXENTAS de IVA (sujetas pero exentas)

| Tipo de Exención                                           | Artículo LIVA      | Casilla Modelo 303                      |
|------------------------------------------------------------|--------------------|------------------------------------------|
| Exenciones interiores (sanidad, educación, etc.)           | Art. 20            | Casilla 83 (*solo en 4T o mes 12*)       |
| Exportaciones de bienes                                    | Art. 21            | Casilla 60 / 94                          |
| Operaciones asimiladas a exportaciones                     | Art. 22            | Casilla 60 / 94                          |
| Servicios relacionados con exportaciones                   | Art. 23            | Casilla 60 / 94                          |
| Zonas francas, depósitos aduaneros, etc.                   | Art. 24            | Casilla 60 / 94                          |
| Entregas intracomunitarias de bienes                       | Art. 25            | Casilla 59 / 93                          |
| Agencias de viajes – operaciones exentas                   | Art. 143           | Casilla 60 / 94                          |

---

## Operaciones NO SUJETAS al IVA (por localización u otros motivos)

| Tipo de No Sujeción                                         | Fundamento Legal   | Casilla Modelo 303 |
|-------------------------------------------------------------|---------------------|---------------------|
| Operaciones No sujetas por reglas de localización           | Arts. 69-70 LIVA    | Casilla 120         |
| Otras operaciones no sujetas por reglas de localización     | Arts. 68-72 LIVA    | Casilla 121         |
 [SEP] Lo ideal aquí no sería tener un impuesto distinto por cada artículo del IVA entonces? Cuál sería el problema? Compatibilidad con versiones anteriores?

El impuesto comodín este va a cubrir muchos casos, pero no siempre y no queda claro cuando **sin mirar las casillas de mapeo de impuestos**. 
Otra alternativa sería tener más impuestos comodines, por ejemplo, agrupar todos los que van a la Casilla 60 / 94. O se le pone un nombre largo.

Lo más fácil para el usuario: que el impuesto sea autodescriptivo, es decir, 1 impuesto por cada artículo del IVA.
Lo más fácil para mantener, entiendo: impuesto comodín para las mismas casillas (problema: quizás en un futuro hay que desglosar si cambia la casilla y daría pie a errores? no se las veces que ha podido pasar esto o si ha pasado)

De todas formas no le veo mucha diferencia pero no soy yo el que ha estado manteniendo los impuestos así que voy a dejar que gente con más experiencia digan algo por este hilo. [SEP] En 17 ya hay un desglose de cada IVA exento según artículo, e hice un remapeo. Revisad https://github.com/OCA/l10n-spain/pull/4084/files#diff-8da58f33dfe1f2b3032205072ca8757fc48b8ca81d21fde4951d35fd5bc176eeR42

Parece que en la casilla 60 siguen faltando otros tipos de exento según la tabla de Rafa, eso sí. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3961,"Hola, Nosotros llevamos ya unos meses trabajando con el módulo de TicketBAI  contra la hacienda de Bizkaia sin problemas, y el QR se genera en el momento de firmar la factura para enviarla al LROE. SIn embargo desde la actualización a Odoo18 falla y sabemos que está dando muchos problemas. Odoo por ahora no está dando respuestas. [SEP] A mi con la versión Odoo17, tenia problemas para generar el codigo QR, aunque si que subían bien las facturas (esto puedes chequear en la web de Hacienda de Gipuzkoa [https://egoitza.gipuzkoa.eus/WAS/CORP/WATTramiteakWEB/inicio.do])   y gracias a la comunidad de OCA aeodoo. El link de la consulta es el siguiente:
[https://www.aeodoo.org/en/forum/localizacion-espanola-3/tbai-error-al-generar-el-codigo-qr-1960])
Lo solucioné instalando:
pip install reportlab
sudo apt-get install libcairo2 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3942,
Issue,3941,"Hola, efectivamente no está cubierto. He anotado la falta para que conste en https://github.com/OCA/l10n-spain/commit/5c46443507ba3da27ae3e1158894df1a651312e8, pero a no ser que contribuyáis vosotros con esa mejora, no está previsto incluirlo, así que cierro."
Issue,3900,
Issue,3896,"¿Qué opción es ésa de ""por lotes""? Yo lo subo desde el botón ""Importar"" y no he tenido problemas:

![Image](https://github.com/user-attachments/assets/bd9b5510-505a-4e62-9e3b-98357de3c301) [SEP] Sucede lo mismo para versión 16.0.

La presentación de pagos por lotes es un servicio que permite enviar declaraciones correspondientes al mismo modelo, ejercicio y perodo de forma conjunta y automática: https://sede.agenciatributaria.gob.es/Sede/ayuda/manuales-videos-folletos/videos/presentacion-declaraciones-lotes.html

Lo curioso es que si subes los mismos archivos por separado AEAT se lo traga, pero por lotes da el error:

>CTROLEOF - No se deben presentar declaraciones con carácter de fin de línea o de carro

No hay ninguna especificación técnica, ni nada en el diseño de registro del modelo 111 que indique que se tiene que generar de manera diferente el archivo de exportación.

De todas formas por el error que da, tiene pinta que el error está aquí https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_aeat_mod111/data/aeat_export_mod111_data.xml#L720 [SEP] Emilio, prueba a quitar eso a ver si funciona. Se que por ejemplo en Navarra es al revés: que algunos modelos, sin LF+CR, no funcionan. [SEP] > Sucede lo mismo para versión 16.0.
> 
> La presentación de pagos por lotes es un servicio que permite enviar declaraciones correspondientes al mismo modelo, ejercicio y perodo de forma conjunta y automática: https://sede.agenciatributaria.gob.es/Sede/ayuda/manuales-videos-folletos/videos/presentacion-declaraciones-lotes.html
> 
> Lo curioso es que si subes los mismos archivos por separado AEAT se lo traga, pero por lotes da el error:
> 
> > CTROLEOF - No se deben presentar declaraciones con carácter de fin de línea o de carro
> 
> No hay ninguna especificación técnica, ni nada en el diseño de registro del modelo 111 que indique que se tiene que generar de manera diferente el archivo de exportación.
> 
> De todas formas por el error que da, tiene pinta que el error está aquí https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_aeat_mod111/data/aeat_export_mod111_data.xml#L720


------
Hola buenos días. 
Comentaros que cuando vas a validad el 303 al importar el archivo también da error. Os lo pongo por si sirve de ayuda. 
Vosotros sabéis más ahora mismo de las especificaciones. 

![Image](https://github.com/user-attachments/assets/5cfebef9-c107-4d94-a133-982907dc2a61)

y este son los errores del archivo que se ha subido

![Image](https://github.com/user-attachments/assets/68ca0238-28a8-4916-bdc3-caafa309eeb2)

el archivo es la exportacion que realiza Odoo en el modelo 303 vuestro [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3886,"Hola, esa captura que enseñas no corresponde al módulo de OCA. Debe ser de los informes enterprise, y por tanto, tendrías que reportarlo a Odoo S. A., no aquí, o empezar a utilizar el 349 de OCA. [SEP] Hola. Simplemente comentar que hemos cambiado de los módulos de enterprise a los de la OCA, gracias a tu respuesta.

Este error y otro comentado sobre la inclusión de operadores intracomunitarios en el modelo, que no lo eran, funcionan perfectamente aquí.

Saludos."
Issue,3881,
Issue,3876,"Hola, comente sobre este problema directamente en el pr que hizo el cambio: https://github.com/OCA/l10n-spain/pull/3936#issuecomment-2624046335

un saludo. [SEP] Liberada versión en #3936 "
Issue,3872,"@pedrobaeza  [SEP] Duplicado de #3636 

Por favor no es necesario que me hagas ping. Recibo igual las notificaciones."
Issue,3868,"Hola de nuevo,
he vuelto a probar en una instalación limpia de v14 y sucede lo mismo, el botón de Validar se pone en verde una vez que añades el pago pero al clicar simplemente no hace nada.
He probado en Odoo18 que soporta nativamente TicketBai y el pos adaptado para ticketbai funciona según lo esperado, al clicar el botóin Validar sin especificar cliente alguno se genera la factura simplificada con el tbai y qrcode.
A ver si alguien nos puede aclarar qué estamos haciendo mal.
Gracias! [SEP] Una vez probado también con v12 se obtiene el mismo comportamiento.

Con las herramientas de desarrollador activadas en el navegador se obtiene un error del tipo
TypeError: Cannot read properties of undefined (reading 'importKey') --> en v12
o del tipo
TypeError: na.subtle --> en v14

Buscando información por diferentes posts parece que las librerias utilizadas (Crypto, requests_pkcs12,.) requieren un entorno de acceso seguro, es decir, hay que acceder por https.

Una vez configurado un reverse proxy con https, los errores una desaparecido y el botón de Validar ya funciona correctamente generando una factura simplificada cuando no se selecciona cliente con el tbai y qrcode.

Quizás a alguien más le pase y este post le sea de utilidad.

Gracias!"
Issue,3864,"Sí, confirmo que no es correcto como está ahora mismo. [SEP] @Christian-RB Necesitas ayuda con la parte de los scripts de migración?

Al final habrá dos currazos:
1- Simplificar el código
2- Aplicar scripts para arreglar los datos de la gente que lo tienen mal por culpa de esto. [SEP] Buenas @etobella Ahora mismo estoy con el punto 1 casi terminando. 
Sería de gran ayuda si alguien crea los scripts para el remapeo de los xml_ids.
Si necesitan alguna referencia estoy reutilizando los mismos que en 16.0. [SEP] cuando esté todo lo reviso y os doy una ayuda con eso [SEP] Cambios necesarios realizados"
Issue,3862,"Hola, la clave del 349 se calcula en base a los impuestos, no a la posición fiscal:

https://github.com/OCA/l10n-spain/blob/0e62d8ab8ceb93c4acf441b2b83fdf60a90cebfb/l10n_es_aeat_mod349/models/account_move.py#L47-L59

por lo que el comportamiento que describes no es lo que ocurre. Revisa que cada factura tiene los impuestos adecuados.

Cierro al no ser correcta la aseveración y no existir ese error. [SEP] Hola. Entonces, al incluir o no según el impuesto, ¿tiene alguna lógica que incluya el ""21% G"" en el 349?  En el caso de otros clientes que no son particulares en estados miembros, pero no figuran en el registro de operadores intracomunitarios, se debe incluir el IVA en la factura y ellos tienen que deducirlo/reclamarlo porque están exentos. Sin embargo, no pueden figurar en el 349 porque no están en el registro de operadores. 

No veo ningún IVA 21% específico para Ventas intracomunitarias que pudiera ser excluido del 349, junto con el cliente. 

¿Qué estoy haciendo mal? [SEP] Es que cualquier impuesto que no sean los intracomunitarios se excluyen por defecto del 349, sin hacer nada. Aquí están los únicos impuestos que se incluyen (los códigos son los XML-IDs):

https://github.com/OCA/l10n-spain/blob/0e62d8ab8ceb93c4acf441b2b83fdf60a90cebfb/l10n_es_aeat_mod349/data/aeat.349.map.line.csv"
Issue,3861,"Hasta donde sé, el asiento de regularización no tiene que ver con lo que compensas o no. Es el resultado de tu ejercicio. Luego, se tendrá que hacer un asiento extra que mueva parte de los saldos entre la 470 y la 4751 según esa operación. Hacerlo todo en un mismo asiento, no sé si sería lo correcto. La información podría estar según las casillas, desde luego.

@AlbertCabedo es correcto hacerlo todo de un golpe? [SEP] Hola @pedrobaeza 

No sé a que te refieres con lo del asiento de regularización exactamente

El problema que presenta aquí @EmilioPascual es que cuando te sale un trimestre a pagar IVA pero tenemos una cantidad a compensar que utilizamos para pagar menos a Hacienda, esa cantidad, contablemente, tiene que quitarla de la cuenta 470xxx porque si no es así, esa cuenta quedará descuadrada

El modelo 303 lo hace bien trasladando esa cantidad a la casilla 110 pero no genera bien el asiento porque no la descuenta de la cuenta 470xxx

Si veis en el video, cuando solo compensamos lo resta de esa cuenta pero cuando compensamos una parte y pagamos otra, lleva el total a la cuenta 475xxx, cuando debe llevar cada parte a su cuenta correspondiente

Resumen contable del vídeo

![Captura desde 2024-12-19 12-38-27](https://github.com/user-attachments/assets/044bd1a1-5ce7-46e3-b0b6-3efd37561efb)

@rafaelbn @loida-vm @pedrobaeza @AlbertCabedo 

 [SEP] El asiento de regularización es el asiento que genera la declaración, y como digo, ese asiento es el movimiento de la 472/477 a la cuenta que toque (4751 o 4700). El que además se compense es lo que digo que no tengo claro que tenga que ir en el mismo asiento o deba ser uno separado. [SEP] @pedrobaeza mi duda sobre el asiento de regularización del IVA era porque no se van a poder utilizar las cuentas **4750** y **4700** en el mismo asiento, de hecho, eso es lo que contablemente refleja la situación real de lo que estamos declarando en el 303

Si nosotros en la declaración del 303 ponemos en la casilla 78 alguna cantidad porque decidimos compensar y esta no queda reflejada en el asiento, entonces el asiento es incorrecto porque me está poniendo lo mismo que si no declarase nada en esa casilla

Lo que está ocurriendo ahora mismo es que hace el mismo asiento, rellenes o no la casilla 78 y no debería ser así

Dejo un vídeo en el que se ve que hace lo mismo en los dos casos:

https://www.loom.com/share/2ec2f8d5962042269c8d183ed1903b73?sid=2c19b53c-14ec-4217-a85b-0aba9133bb5d

@rafaelbn @EmilioPascual @loida-vm 

@AlbertCabedo  [SEP] A ver si @AlbertCabedo o @acysos confirman al respecto. [SEP] He realizado el siguiente PR https://github.com/OCA/l10n-spain/pull/3874 para resolver esta casuistica [SEP] Cierro estando #3874 ya fusionado."
Issue,3858,"Hola @EnekoAira 

Nos ha pasado lo mismo con esto de los impuestos de alimentos y los errores del SII...
El problema de habilitar la ""Fecha de operación"", es que la misma determina la deducibilidad de las cuotas de IVA. Y si esa fecha difiere respecto a la ""Fecha contable"" de la factura, habrá una incongruencia respecto a los periodos en los que se liquidan esas facturas dentro de los modelos legales de Odoo:

- 303
- 349
- LIVA
- otros...

Es decir, también implica hacer un desarrollo extra en todos modelos legales para que priorice incluir en las declaraciones las facturas conforme a ""fecha operación"" (siempre que esté establecida), por encima de ""fecha contable"".

Saludos,
 [SEP] Tratándose de operaciones entre empresas la mayoría de veces, en los que les da igual el IVA, ya que son meros intermediarios, la solución más eficaz es cambiar los impuestos a los que toque en la fecha de factura, sin más complicación. [SEP] @SoniaViciana Gracias por la respuesta.

No he tenido en cuenta todos esos modelos, supongo que deberíamos consultar la forma de afrontarlo a la propia AEAT. 
Tengo mi opinión pero no está respaldada. 

No obstante, si así fuere, habría que cambiarlos también. Que la pereza no nos lleve a no hacer bien las cosas :-)
 [SEP] @EnekoAira no es pereza, si no practicidad. Además, ¿tienes pensado tú hacer esas mejoras? [SEP] > Tratándose de operaciones entre empresas la mayoría de veces, en los que les da igual el IVA, ya que son meros intermediarios, la solución más eficaz es cambiar los impuestos a los que toque en la fecha de factura, sin más complicación.

No soy quién para contestar a esto. Yo no lo haría, otros ERPs no lo hacen [SEP] Eso de siempre aludir a que ""otros ERPs"" tal, bueno, pues vete con el otro ERP...

Una cosa está clara: un sistema en el que la fecha contable del asiento de la 472 o 477 no coincide con la fecha efectiva de impuestos es un NO muy grande por muchas razones que ahora mismo no voy a desglosar, ya que de todas formas es algo que no se va a hacer en Odoo nunca, primero porque el propio Odoo no lo permite ni lo va a permitir (ya quitó hace muchos años, a partir de la v9, eso de forzar periodo y fecha del asiento, que permitía hacer más o menos estas cosas), y segundo porque la localización se complicaría de forma inimaginable para un caso tan marginal.

Cierro esta issue como algo que no se realizará. [SEP] @SoniaViciana, en realidad creo que la fecha por la que se deben generar los modelos es la fecha de devengo, no la fecha de operación.

Es imposible que sea la fecha de operación la marque el período de devengo, dado que si así fuese sería imposible cumplir lo que indican en las preguntas frecuentes de la AEAT sobre como se debe de cubrir el tipo de operación en el caso de rectificativas, por ejemplo. (https://sede.agenciatributaria.gob.es/Sede/impuestos-tasas/iva/iva-libros-registro-iva-traves-aeat/preguntas-frecuentes/2-registro-cuestiones-comunes.html?faqId=910f6c3d02bc9510VgnVCM100000dc381e0aRCRD)

En las últimas versiones del SII están validando precisamente que el impuesto reportado esté vigente a ""fecha de operación"" de la factura informada; con lo cual queda claro que para la AEAT la fecha que debe tomarse a la hora de decidir el tributo a aplicar es la fecha de operación (no la fecha de factura, ni la fecha contable, ni la fecha de devengo, ni cualquiera otra fecha que queramos aplicar).

Vuelvo sobre el ejemplo de las rectificativas. Si en un período P (IVA al 4%) tengo que rectificar una factura del período P-1 (con un IVA 2%), no puedo simplemente cambiar el IVA de la nueva factura rectificativa al 4%, porque entonces mis bases y cuotas no son correctas, ya que he pagado por 2 y rectifico por 4, causando un perjuicio a la hacienda pública; lo cual no les gusta nada y nos pone en el foco de una posible inspección.


PS: Es mi primer aporte a la comunidad de Odoo y me he quedado muy ingratamente sorprendido por la reacción tajante , desmesurada y agresiva. @SoniaViciana si quieres que continuemos esta reflexión conjuntamente puedes escribirme directamente. [SEP] Una tirita se arranca mejor de un golpe que poco a poco.

Lo que comentas de las rectificativas es otra cuestión aparte. A mí hasta ahora no me han rechazado en el SII una rectificativa hecha con fecha de estos meses (desde octubre) con impuesto del 4%, porque precisamente tienen en cuenta estas cuestiones, y poner fecha de operación de antes de octubre lo considero incorrecto, porque el devengo de la rectificación es ahora, no cuando se hizo la operación rectificada. [SEP] Estaré yo confundido, pero insisto en que ""fecha de operación"" y ""período de devengo"" no están relacionados.

Sobre la rectificativa, la AEAT es clara (por raro que parezca :D): https://sede.agenciatributaria.gob.es/Sede/impuestos-tasas/iva/iva-libros-registro-iva-traves-aeat/preguntas-frecuentes/2-registro-cuestiones-comunes.html?faqId=d6ce6c3d02bc9510VgnVCM100000dc381e0aRCRD

PS: Con un poco de agua tibia también salen muy bien las tiritas. [SEP] Gracias por el enlace, Raúl. En el módulo SII, no estamos indicando fecha de operación en ningún caso, sea rectificativa o normal, y Hacienda no lo está rechazando, aunque no conocía que la AEAT indique que deba ser la fecha de operación de la rectificada.

De todas formas:

- El SII no rechaza rectificativas con el 4% en las fechas actuales.
- El SII no obliga a poner fecha de operación. Rellenando ""Fecha expedición"" y ""Periodo de liquidación"" es suficiente.
- No tengo constancia de notificaciones o inspecciones que indiquen lo contrario.

Por el momento, no veo que haya que hacer nada al respecto para las rectificativas, y empezar a enviar esa fecha generaría muchos flecos, como por ejemplo cuando se hace una rectificativa (como un rappel), sin una factura de origen exacta. Se podría barajar enviar la fecha de operación de la rectificativa cuando el origen está claro. Eso a ver qué les parece a otra gente. Reabro para dar lugar a ese debate, aunque esto sea un tema lateral.

De cara a la fecha de operación en general, el objetivo aquí es automatizar lo máximo posible el envío y evitar errores, por lo que tener un campo ""Fecha de operación"" manipulable no está entre las características deseables por el momento, salvo que se encuentre alguna causa insalvable, pero si alguien quiere hacerlo, gracias a la capacidad modular de Odoo, se puede hacer como un módulo de extensión. [SEP] Ah, y otra cosa que veo según la nueva información: la fecha de operación no debe marcar el periodo de liquidación de los impuestos, ya que si no, las rectificativas irían en declaraciones anteriores y no en la que toca. Parece que ese dato es totalmente caprichoso. [SEP] En nuestro caso, en alguna empresa del grupo, que no es la que usa Odoo si hemos tenido problemas de envío al SII por enviar una factura rectificativa con fecha de noviembre, que rectificaba a una de septiembre, y llevaba entre los IVAs una parte de IVA al 5%.

Dado que ese IVA no es válido en octubre, el SII la rechazó, y tuvimos que modificarla indicando que la fecha de operación era septiembre para que la aceptase.

En resumen, la fecha de operación es la que marca los tributos a aplicar, y la fecha de devengo es la que marca el período en el que se debe incluir en los modelos (al menos de IVA, si metemos el IRPF por el medio ya nos salen más lios...).

PD: Soy Rubén ;D [SEP] La propuesta de añadir un nuevo campo de ""fecha de operación"", sin valor por defecto, pero que si está cubierto se informe al SII va precisamente en la línea de que luego, cada empresa según sus necesidades decida como dar valor a este campo:
- Manualmente por los usuarios
- En base a la fecha de los albaranes
- En base a la fecha de pedidos
- ...

Todo eso sería una cuestión a personalizar en los módulos de cada empresa, según sus necesidades y decisiones.
Así mismo, quien no necesite/quiera hacer nada al respecto simplemente con no alimentar ese campo el comportamiento de su sistema seguirá igual que ahora.

Es por ello que, dado que el concepto de ""fecha de operación"" es un concepto que define el SII debe de estar contemplado en este módulo el que se envíe. Y como es, cuando menos, controvertido; de ahí que la propuesta sea crear un campo que cada empresa decida como alimentar (o no) según su caso de uso. [SEP] Perdona, Rubén, como el login aparece rmosquera, se me ha ido el nombre. Es raro, acabo de comprobar ahora mismo justo ese caso, y tengo facturas aceptadas por el SII en octubre con IVA 4 %.

Si la fecha de operación se considera solo a esos efectos, creo que puede añadirse que se envíe - sin intervención del usuario - en las rectificativas cuando se tiene claro el origen.

Lo de poner ese campo de forma general, no, porque eso repercutiría en la gente tocando sin saber, y teniendo tickets de asistencia por esos temas. Lo dicho, eso es fácil ponerlo en un módulo extra, e incluso se podría plantear tener ese módulo extra aquí, pero desde luego de base, es muy peligroso. [SEP] Al 4% claro que lo van a aceptar, porque es un tipo válido en cualquier mes.

El caso es con los IVA que la AEAT si puede validar porque solo han estado activos durante un tiempo, como el 5% o el 2%.

Entiendo, aunque no comparto, el temor de un mal uso de ese campo... Si está oculto, solo lo activará quien necesite usarlo y debemos confiar en que sepa como usarlo.

No podemos limitar el caso a las rectificativas, lo uso como ejemplo porque es el más claro y el más explícito; pero cualquier caso en el que facturemos operaciones de un mes en otro, y en ese salto de mes haya un cambio de IVA pueden provocar este problema.

La solución que planteas para estos casos en https://github.com/OCA/l10n-spain/issues/3858#issuecomment-2551519653, de decirle al departamento de administración, que haga mal las facturas, a sabiendas; no me parece apropiado.
Y además, no resuelve el caso de las compras, en las que el proveedor simplemente podría negarse a hacer esto.
Y seguramente también nos daría problemas con los casos de autónomos en Régimen Especial Agrario, que no liquidan IVA y por tanto, los estaríamos perjudicando si les facturamos con un tipo de IVA más alto. [SEP] Y otra cosa para @SoniaViciana entonces: con eso no habría que tocar nada de los otros módulos. Simplemente, habría IVA 4% en por ejemplo octubre, pero ya está.

Yo de todas formas, estoy dudando bastante que Hacienda permita hacer facturas de cliente del 4% por ejemplo a finales de octubre, por mucho que le digas que la fecha de operación es de septiembre porque la mercancía se envió entonces... [SEP] > No podemos limitar el caso a las rectificativas, lo uso como ejemplo porque es el más claro y el más explícito; pero cualquier caso en el que facturemos operaciones de un mes en otro, y en ese salto de mes haya un cambio de IVA pueden provocar este problema

No lo limito, solo digo que en este caso es automatizable y sin efectos laterales: se envía si se sabe la factura origen. Se sigue como hasta ahora si no se sabe (como el de una factura de rappel).

> La solución que planteas para estos casos en https://github.com/OCA/l10n-spain/issues/3858#issuecomment-2551519653, de decirle al departamento de administración, que haga mal las facturas, a sabiendas; no me parece apropiado.

No es hacerlo mal. Al contrario, es hacerlo bien, porque la tributación siempre se aplica a las facturas. Los albaranes no llevan fiscalidad. Lo otro se admite por dar ""cuartelillo"". Pero fíjate que tendrías el mismo problema (por lo menos en Odoo, pero también en otros ERPs), si hiciste un presupuesto hace un año, con los impuestos anteriores, y lo confirmas, envías y facturas ahora. Tendrás que cambiar igualmente los impuestos a los que tocan ahora. No vale poner fecha de operación de hace un año porque era cuando emitiste el presupuesto.

> Y además, no resuelve el caso de las compras, en las que el proveedor simplemente podría negarse a hacer esto.
> Y seguramente también nos daría problemas con los casos de autónomos en Régimen Especial Agrario, que no liquidan IVA y por tanto, los estaríamos perjudicando si les facturamos con un tipo de IVA más alto.

Como digo, hasta ahora no tengo constancia de ningún rechazo de este tipo. y el régimen agrario no está contemplado en el desarrollo actual. Pero bueno, volvemos a lo mismo: que la fecha de operación se puede implementar en un módulo aparte. Si es lo bueno que tiene la modularidad. [SEP] Efectivamente no deberías facturarlo a finales de octubre; pero no porque no lo admita el SII, que creo que si lo aceptará (sería cuestión de testarlo en el entorno de pruebas).

El problema ahí sería que incumplirías los plazos de la ley: https://sede.agenciatributaria.gob.es/Sede/ayuda/manuales-videos-folletos/manuales-practicos/manual-iva-2021/capitulo-10-obligac-formales-suj-registro/obligaciones-materia-facturacion/plazos-expedicion-envio-facturas.html

Pero hasta el 16 si podrías:
`Antes del día 16 del mes siguiente a aquél en que se haya producido el devengo del impuesto correspondiente a la citada operación` [SEP] El caso del presupuesto y del albarán no son comparables. Hacienda es clara con que la fecha que marca la fiscalidad es la de ""la entrega de la mercancía o de la prestación del servicio""; ni presupuesto, ni pedido, ni factura.

De hecho, es esa fecha ""de entrega de la mercancía o prestación del servicio"", la que te marca el plazo para poder emitir la factura, como indico en el comentario anterior.

Por nuestra parte veo necesario este desarrollo, y no sé si lo plantearemos como un módulo específico, o como un fork (con su PR) a la rama 12.0 de este repo (que es la versión en la que aún trabajamos).
Seguramente optemos por lo que técnicamente nos resulte más sencillo. Si creamos un módulo nuevo no creo que podamos asumir el adaptarlo a las normas de OCA, que es algo en lo que no tenemos experiencia, y somos una empresa usuaria final de Odoo, no una implantadora. [SEP] Nos tocó trabajar con esto hace poco para un caso muy puntual relacionado con las cuotas de alimentos:

![image](https://github.com/user-attachments/assets/a1d411f3-173f-4ed9-a431-79ba37992c76)

Y podemos asegurar que en el PRE-303 esa factura se deduce a 10/2024 y no en 11/2024. No he encontrado mucha info en la AEAT, pero sí en los blocs de otros ERP:

https://soporte.sage.es/plus/2017/09/gestion-de-fechas-de-facturas-expedidas-para-el-sii-en-contaplus-flex/

https://a3responde.wolterskluwer.es/documentos/erp/fecha-contable-y-fecha-de-operacion-en-facturas-de-venta.html [SEP] Pues entonces volvemos al supuesto inicial que teníamos tanto Sonia como yo, que es que sí que marca la fecha de operación lo que es la fecha a efectos fiscales, y eso supone esa triple fecha que es una línea roja.

Pero entonces es inconsistente con ese otro enlace que dice que en las rectificativas la fecha de operación debe ser la de la factura origen.

¿Tal vez la fecha de operación la utiliza Hacienda de forma diferente según el tipo de factura? [SEP] En mi opinión, y aquí entro en el terreno de lo que intuyo pero no puedo asegurar; lo que marca en que modelo debe ir no es ninguna de las fechas, si no el ""período"" que se indique. Y apoyo mis suposiciones en que:
- Los modelos siempre hacen referencia a un período, que puede ser mensual, trimestral o anual. En el caso de las empresas en SII, mensual y anual. Y esos son los campos que efectivamente tiene el registro de ""Periodo"" en el SII.
- En otra empresa del grupo que no usa Odoo estamos reportando las facturas de compra del mes pasado, que registramos antes del 16 del mes en curso, con período de devengo del mes de la factura, para devengarlas lo antes posible. Llevamos haciendo esto sin problema durante años. Las contabilizadas después del 16 van el el modelo correspondiente al periodo en el que se contabilizan.
- Existe también en el SII una opción de indicar que el IVA de una factura se devengará en un período posterior a aquel en el que se reporta (que se debe usar en casos de proveedores en ""criterio de caja"".

El caso que expone @SoniaViciana no concuerda con lo que yo entiendo, ya que si en esa factura indican:
![image](https://github.com/user-attachments/assets/fb32a033-fd84-480b-8ba5-8bdceb4415c0)

Debería ir en el modelo del 11-2024.

Entiendo que puede parecer un argumento peregrino pero... ¿es posible que ese premodelo no sea correcto? En nuestro grupo de empresas no usamos esos premodelos generados por la AEAT, por lo que no puedo juzgarlo.

Sobre la documentación de otros ERPs... pues es la información de los casos más generales, y tiene la validez que le demos en base a la credibilidad de la empresa (y de su celo por mantener actualizada la documentación pública). Y dicho esto, la veo correcta; pero para el caso general y más común, y en el que la información se registra en plazo en el ERP.
 [SEP] Ya, pero sin esa confirmación de qué supone la fecha de operación en ese caso, la verdad es que es arriesgado aventurarse a poner un dato. [SEP] No sé si desde la OCA tenéis algún canal de comunicación con la AEAT para poder plantear esa consulta a nivel técnico, de la correlación entre los datos enviados al SII y los modelos.

En el ERP de la empresa que no usa Odoo los tributos tienen el concepto de ""fecha de devengo"" y ese es el campo que se usa para los modelos y con el que calcula el ""PeriodoLiquidacion"" para el SII. Lo hacemos así desde hace tiempo sin problemas.

Entiendo que sin una respuesta que se pueda considerar de una autoridad no se incorporen cambios en esa línea al módulo de la OCA.

Nosotros trataremos de hacer nuestro aporte con lo que a nosotros nos sirva. [SEP] @acysos puedes lanzar consulta vinculante sobre este tema?

En cuanto a lo de la fecha de devengo separada de la fecha contable, es la línea roja que siempre os he comentado. No puede ser que se saque un sumas y saldos de una 472/477 y dé un resultado, y en cambio en el 303 se declare otro distinto porque las fechas de devengo son algo diferente. [SEP] Legalmente si puede ocurrir esa diferencia, y que los datos sean correctos. Pero en cualquier caso concuerdo que es algo que si se puede evitar es mucho más práctico, y solo lo ponía como ejemplo y argumento de como creo que funciona el sistema por parte de la AEAT. No propongo que se incorpore un cambio de este tipo, que bastante tenemos con el debate sobre la ""fecha de operación"" :D [SEP] ¡Gracias @EnekoAira ! ¡Bonito caso!

Esta es mi propuesta: https://github.com/OCA/account-invoicing/issues/1962

Me hice una chuletilla de un ejemplo de factura de proveedor, que hay hasta 4 años para contabilizar y para la misma factura son 5 fechas diferentes.

![Image](https://github.com/user-attachments/assets/a2c508ce-5437-4fb5-8b12-ea37ffed6c44)

❤ ❤ 

@moduon [SEP] Desde mi punto de visto sería muy conveniente que apareciera un nuevo campo de ""fecha de operación"", sin valor por defecto, pero que si está cubierto se informe al SII puesto que la fecha en la que quiero imputar mi gasto puede ser distinta a la fecha contable, ya que hay hasta el día 16 de cada mes para poder devengarme en el periodo anterior 

El SII recoge esta casuistica y diferencia entre la fecha de registro contable (fecha en la que se registra la factura) y la Fecha de operación (fecha en la que imputo mi gasto), como vemos en la tabla de @rafaelbn 

Tenemos que tener mucho cuidado con la nomenclatura ya que lo que: 

- en la AEAT llaman **Fecha de operación**, en Odoo es la **fecha contable**
- en la AEAT llaman **Fecha de registro contable**, es la fecha en la que registro la factura en el programa y la valido y esa fecha la tiene en cuenta la AEAT para los plazos del SII

Esto solo se da en la facturas de proveedor ya que en las de cliente esas dos fechas tienen que ser iguales

Estoy de acuerdo con todo lo que ha ido exponiendo @rmosquera-aira

A ver si @acysos hace la consulta vinculante para ver si se puede desarrollar porque nosotros lo vemos necesario

https://github.com/moduon [SEP] > en la AEAT llaman Fecha de operación, en Odoo es la fecha contable

Esto no es del todo correcto, porque está el periodo de liquidación también en la información que se pasa a la AEAT, y el problema es que tengamos una desincronización entre la contabilidad de la 472/477 y la fiscalidad. Mientras eso no se aclare (y tengamos claro que la fecha de operación es solo para ""ver los impuestos válidos""), no se debe incorporar ese campo a nivel de usuario. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3856,"Todo esto está ya hecho en 15.0 en adelante. Revisad PRs ya fusionados. Para 14.0, alguien debe hacer los backports."
Issue,3851,"Hola.

Esta cuestión no tiene que ver con los módulos publicados en este repositorio. Publica por favor tu consulta en los foros de AEOdoo para que alguien te pueda orientar, que tiene pinta de configuración. 

Cierro por lo expuesto."
Issue,3842,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3831,"Hola,

Esto no es cosa del módulo, si no de tu despliegue: o bien no tienes el código de Odoo actualizado, que incluye esos cambios, o bien en tu BD no está actualizado dicho módulo.

En cualquier caso, cierro esta issue, al no tratarse de un error en el código fuente en si. Puedes acudir al foro o a listas para solicitar más ayuda."
Issue,3829,"Puedes proponer un PR arreglándolo. [SEP] Seria lo suyo, pero antes habría que comentar el por que esta oculto el boton de cancelar asiento ""button_cancel"" en facturas de proveedor cuando tenemos confirmada la factura, aprovechamos y tratamos ambos asuntos en un mismo PR.


https://github.com/OCA/l10n-spain/blob/e1107ce2adfb333daa948cc441970284800555f3/l10n_es_ticketbai/views/account_move_views.xml#L248-L252
 [SEP] De acuerdo. Eso lo tendrás que ver con los creadores/mantenedores del módulo, ya que al ser algo específico de vuestra parte, los mantenedores habituales de la localización no hemos intervenido. [SEP] Buenas @enriquemartin entiendo que la parte de l10n_es_ticketbai la hizo Aritz Olea en su día y ahora mismo no habría maintainer de ese modulo? [SEP] Buenas @AsierAcedo no hay maintainer oficial activo no, pero nosotros solemos ser bastante activos en cuanto a PRs en los módulos de tbai/batuz [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Hola @AsierAcedo 
Al final no hay PR de esto?  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3826,"El `with` justamente lo que hace es un `close` cuando termina su alcance, así que a priori es lo mismo. [SEP] @pedrobaeza Correcto, disculpa. Haciendo pruebas pensaba que no se bloqueaba por alguna razón, pero también se bloquea (he editado el mensaje de la issue para quitar la alternativa). Estoy probando en el runbot y ocurre lo mismo: si hay un error durante el envío, hay un bloqueo. [SEP] Pero yo no he experimentado nunca ese bloqueo que comentas. Mira si es por algo específico de esa instancia. [SEP] @pedrobaeza El problema reside en lo de siempre. El método de envío sin el queue, que ya sabemos que da muchos problemas/fallos.

Nosotros siempre lo configuramos con el conector en producción, pero hemos detectado este mal funcionamiento en una instancia de pruebas, por ejemplo cuando el SII da errores cuando no hay certificado, etc. Este tipo de errores (no errores en facturas).

Merece la pena invertir recursos en mejorar ese sistema? Más que nada es para dejarlo reportado.

Por otra parte, y ya que estamos... no sé si merecería la pena hacer desaparecer el sistema ""instantáneo"" en el refactoring de V17.

Ya nos dices. [SEP] Sí, en v17 yo quitaría el sistema instantáneo, puesto que la principal razón era porque `queue_job` no es compatible con Odoo.sh, pero ya al no utilizarlo, ya da igual. Además, se puede hacer instantáneo poniéndolo un retardo de 0. [SEP] > Sí, en v17 yo quitaría el sistema instantáneo, puesto que la principal razón era porque `queue_job` no es compatible con Odoo.sh, pero ya al no utilizarlo, ya da igual. Además, se puede hacer instantáneo poniéndolo un retardo de 0.

OK

@manuelregidor Teniendo en cuenta estos cambios y para no irnos muy ""offtopic"", puedes añadir este punto a la lista de faltantes para el refactoring de V17? Me refiero a lo de eliminar el método instantáneo sin queue, que antes ya hemos barajado esa opción. [SEP] @HaraldPanten De acuerdo, lo añado. Es necesario mantener esta issue abierta? Gracias. [SEP] > @HaraldPanten De acuerdo, lo añado. Es necesario mantener esta issue abierta? Gracias.

Creo que no. Por mí podemos cerrarla"
Issue,3823,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3812,"@fcvalgar es correcto. El libro de IVA no se ha actualizado conforme a los nuevos impuestos. [SEP] @HaraldPanten a ver si mi compañero @edlopen nos puede lanzar un PR para añadir esos mapeos.  [SEP] @HaraldPanten @fcvalgar os dejo el PR para que lo probéis. ¡Gracias!

https://github.com/OCA/l10n-spain/pull/3813 [SEP] Esta issue se puede cerrar porque se resolvió en https://github.com/OCA/l10n-spain/pull/3813 [SEP] Falta hacer backport/fw-port. [SEP] Ya está llevado a 15.0 y rehecho en 17.0. Los nuevos IVAs no deducibles estaban mapeados incorrectamente en 16.0 y ya está también arreglado."
Issue,3806,"Hola, la opción de importar módulos solo sirve para módulos que no contengan código (módulos de datos, como los de industria), por lo que no es válida para casi ningún módulo. Debes incluir el módulo en tu addons path de Odoo, y reiniciar la instancia una vez colocado.

Cierro, ya que no es un ningún fallo del módulo, si no de cómo se ha intentado desplegar. [SEP] Gracias por la respuesta Pedro. No tenía ni idea."
Issue,3799,Efectivamente es incorrecto. Arreglado en https://github.com/OCA/l10n-spain/commit/2ec7e5299e66a6d17e385017e14df36edbd19edb
Issue,3790,"El comprobador es una herramienta de depuración con sus limitaciones, y en el 303 tal como está no sirve. Se aceptan mejoras en el mismo, pero no es un error como tal, si no una limitación. [SEP] Entiendo, muchas gracias por la respuesta. Saludos!"
Issue,3787,"Diría que has cambiado las cuentas estándar 472/477. [SEP] Gracias por tu  rapida respuesta amigo Pedro. No he cambiado nada simplemente he instalado todo y estoy haciendo pruebas antes de utilizar este sistema el proximo año. Podrias decirme como habria podido cambiar estas cuentas y como restaurar esto para que funcione correctamente ? muchisimas gracias Pedro
![impuesto](https://github.com/user-attachments/assets/090ad9ee-30bd-4ab1-9671-e5026fe44580)

Este es el tipo de impuesto que  he usado.
 [SEP] tengo diferentes backups en mi proxmox y he cargado la primera imgen que cree cuando estaba el sistema con las addons sin ningun tipo de cambio y he hecho una simulacion y obtengo el mismo resultado , no hay nada en casillas 11 y 37
![addons](https://github.com/user-attachments/assets/d6e8bda1-3c5d-47c4-9901-1409ad321331)
Crees que es algun tipo de bug ? has intentado replicar esto? o crees que en mi maquina hay alguna configurancion cambiada? gracias Pedro [SEP] El impuesto que debes utilizar es ""IVA 21% Adquisición de servicios intracomunitarios"", no ""IVA 0% Adquisición de servicios intracomunitarios"", o mejor aún, establece el ""IVA 21% (servicios)"" en el producto, y la posición fiscal ""Régimen Intracomunitario"" en el proveedor, y te lo hará solo el sistema. [SEP] Muchisimas gracias Pedro por tu ayuda asi como dices si ha funcionado correctamente pido disculpas por abrir este hilo con el tag de bug puesto que no lo es . Gracias de nuevo por tu ayuda amigo.
![ok](https://github.com/user-attachments/assets/2a7a422a-f9ca-4fa9-b057-3bba3e7995f9)
"
Issue,3786,"Alguien le puede intentar echar un ojo a esto? Lo necesitamos para fin de año... no nos importa pagar por el tiempo. Gracias. [SEP] > Alguien le puede intentar echar un ojo a esto? Lo necesitamos para fin de año... no nos importa pagar por el tiempo. Gracias.

@buildamoc lo hemos corregido en este [PR](https://github.com/OCA/l10n-spain/pull/4121) 😄 "
Issue,3754,"Nota para cuando comencemos con la migración de AEAT, SII, etc: revisar el módulo core `certificate` para ver si provee ya de base las herramientas para la gestión de certificados. [SEP] I'm migrating l10n_es_partner [SEP] Trabajando en l10n_es_igic [SEP] working on `l10n_es_toponyms` [SEP] Working on payment_redsys [SEP] Are there plans to migrate the modules not yet migrated in version 17? Specifically, I'm referring to:
-  l10n_es_ticketbai
- l10n_es_ticketbai_api
- l10n_es_ticketbai_api_batuz
- l10n_es_ticketbai_batuz [SEP] @Gasteizko a partir de la v17.0 esta incluido en el core de Odoo

https://github.com/OCA/OCB/tree/17.0/addons/l10n_es_edi_tbai
 [SEP] > [@Gasteizko](https://github.com/Gasteizko) a partir de la v17.0 esta incluido en el core de Odoo
> 
> https://github.com/OCA/OCB/tree/17.0/addons/l10n_es_edi_tbai

Si, pero paso lo mismo con el SII, que esta en el core, pero le faltan cosas y no funciona bien con los IRPF. Ahí ya es decisión más de los que están en el país vasco que quieren hacer. [SEP] Working on l10n_es_account_asset #4217  [SEP] Working on l10n_es_account_banking_sepa_fsdd #4219  [SEP] Working on l10n_es_cnae  #4236  [SEP] Hay planes de migrar el modelo 190? [SEP] Hay plan sobre el modulo de verifactu?
 [SEP] Working on l10n_es_aeat_patner_check #4283 "
Issue,3751,"@sergio-teruel tienes información sobre este punto? [SEP] Hola @ValentinVinagre No recuerdo bien, seguramente será por herencia del pasado.
Tendría que analizar en profundidad [SEP] Gracias por contestar, efectivamente se puede quitar esa dependencia sin problemas, es dinamica y esta relativamente bien protegida aqui https://github.com/OCA/l10n-spain/blob/2ffc60e53c05330b3fada7c4f927b37abe3eab42/payment_redsys/models/payment_provider.py#L103

Nosotros  ya estamos usando el modulo sin la dependencia, y teniendo correctamente configurado web.base.url funciona muy bien [SEP] Perfecto, pues si alguien podéis hacer el pull request, así queda bien establecido. Indicad por favor en el README la cuestión de `web.base.url` o del dominio cuanto se tiene website. [SEP] ¡Qué bien visto!

¿@IJOL os encargáis del PR? Podemos hacerlo nosotros desde Sygel sin problema sino. Avisadnos y nos organizamos.

¡Gracias!

Un saludo, [SEP] @IJOL ¿Puedes hacerme ping en el PR?"
Issue,3730,"Hello ✋🏼 !

Please @etobella @pedrobaeza @HaraldPanten could review this proposal please?

Thank you very much! 😄 ❤️ 

For me is 👍🏼 , really nice video @ArantxaSudon 💘 🤗  [SEP] https://github.com/OCA/l10n-spain/pull/3715 [SEP] Cierro al estar el PR propuesto. [SEP] @etobella gracias por remitirme a este PR pero he vuelto a probarlo y  no hace lo que comento en el vídeo

@pedrobaeza podrías, por favor, volver a abrir este Issue

![Captura desde 2024-09-26 13-14-59](https://github.com/user-attachments/assets/fcae54c2-e87e-4e96-a7ec-36ea2e08aa6e)


Como veréis en esta captura, yo hago las pruebas y grabo el vídeo con el PR https://github.com/OCA/l10n-spain/pull/3715 ya aprobado y lo que comento aquí sigue reproduciéndose

He vuelto a repetirlo, comprobando que el módulo estaba instalado y, es cierto que:

-  si se utiliza **distinto impuesto**, las líneas de la prorrata si se desdoblan
-  pero si utilizo el **mismo impuesto** (que es lo que suele ocurrir), entonces la líneas no se desdoblan y va todo a la misma línea de gasto.

 
 Creo que, si os fijais en el vídeo que os dejé, se ve perfectamente como me lo deja en una solo línea

Muchas gracias

@rafaelbn @EmilioPascual 
MT-1809 @moduon
 [SEP] Esto no es un PR, si no un issue. Los comentarios correspondientes deberían hacerse en el PR de Enric. [SEP] @pedrobaeza Entonces vuelvo a poner todo esto en https://github.com/OCA/l10n-spain/pull/3715 ?

Yo no soy técnico, soy funcional y aporto todo lo que puedo para mejorar y si tú me dices que lo cambie, que eres el que sabe como funciona, no hay ningún problema, lo cambio en un segundo [SEP] A ver, el PR está cerrado y mergeado y yo no podré dedicarle tiempo a resolverlo, si queréis, podéis abrir un PR y, si puedo, ya lo revisaré, es lo máximo que os puedo ofrecer. [SEP] Gracias @etobella  [SEP] OK, si #3715 no es lo que se comenta en esta issue, entonces reabro para seguir reflejándolo hasta que haya un PR que lo haga. Disculpad la confusión. [SEP] Muchas gracias @pedrobaeza  [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3721,"Se soluciono solo
Parece que era cosa de ellos"
Issue,3720,"¿A alguien más le pasa? [SEP] @keiverobles efectivamente así es.
La solución pasa por refactorizar la forma en la que se recogen los datos para conformar el XML. Se tiene que hacer agrupando por tipo impositivo.
En su momento se trató el tema pero de momento nadie a tomado la iniciativa de plantear una solución.

Gracias por el issue porque aquí queda perfectamente explicado el problema 👍 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3718,"Por si alguien tiene las mismas dudas que yo, he resuelto los problemas de la siguiente forma:
- En el fichero /l10n-spain/l10n_es_facturae/views/report_facturae.xml sustituir el código existente por el siguiente ( he dejado la primera y última línea afectada del xml para mayor claridad) :

```
        ................
        <PartyIdentification t-if=""False"" />

        <t t-set=""has_admin_centres"" t-value=""
            administrative_partner.oficina_contable or 
            partner.oficina_contable or 
            administrative_partner.organo_gestor or 
            partner.organo_gestor or 
            administrative_partner.unidad_tramitadora or 
            partner.unidad_tramitadora or 
            administrative_partner.organo_proponente or 
            partner.organo_proponente
        "" />

        <t t-if=""partner.facturae and has_admin_centres"">
            <AdministrativeCentres>
                <t t-call=""l10n_es_facturae.administrative_center"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.oficina_contable or partner.oficina_contable"" />
                    <t t-set=""role_type_code"" t-value=""'01'"" />
                </t>
                <t t-call=""l10n_es_facturae.administrative_center"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.organo_gestor or partner.organo_gestor"" />
                    <t t-set=""role_type_code"" t-value=""'02'"" />
                </t>
                <t t-call=""l10n_es_facturae.administrative_center"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.unidad_tramitadora or partner.unidad_tramitadora"" />
                    <t t-set=""role_type_code"" t-value=""'03'"" />
                </t>
                <t t-call=""l10n_es_facturae.administrative_center"" t-if=""administrative_partner.organo_proponente or partner.organo_proponente"">
                    <t t-set=""centre_code"" t-value=""administrative_partner.organo_proponente or partner.organo_proponente"" />
                    <t t-set=""role_type_code"" t-value=""'04'"" />
                </t>
            </AdministrativeCentres>
        </t>

        <LegalEntity t-if=""buyer_type == 'J'"">
        ....................
```

Además, en el fichero /l10-nspain/l10n_es_facturae/models/account_move.py no obligar a comprobar la unidad tramitadora y oficina contable, comentando estas líneas:

```
	#if not self.partner_id.unidad_tramitadora:
        #    raise ValidationError(_(""Unidad Tramitadora not provided""))
        #if not self.partner_id.oficina_contable:
        #    raise ValidationError(_(""Oficina Contable not provided""))
```

Por último, si se quiere poder firmar con el certificado digital, hay que ir a Facturación/Contabilidad->Configuración->AEAT|Certificados AEAT:
   	- Poner un nombre al certificado
   	- Incluir el archivo .pfx
   	- Poner un nombre a la _carpeta_ donde se ubicarán las claves públicas y privadas que será en la ruta de  Odoo16/sessions/_carpeta_
   	- Incluir la fecha de inicio de uso del certificado y la fecha de finalización
   	- Darle a OBTENER CLAVES. 
   	- Una vez obtenidas, darle a PARA ACTIVAR y verificar que esté activado.
   Ahora si se quiere firmar la factura electrónicia, al generarla, dejar marcado el botón de firmar.


"
Issue,3703,"Odoo SA ya lo tiene desarrollado para Odoo Enterprise hace 3 semanas: https://github.com/odoo/enterprise/pull/69736 [SEP] Empezamos a trabajar en el PR para hacerlo en OCA. @moduon MT-7092 [SEP] Hola a todos, Emilio lo empezó a hacer en el OCA Sprint pero no lo terminó. Ahora lo está retomando @Shide . Si alguno tiene más experiencia y quiere ayudar nos decís. Estamos con esto ahora mismo. [SEP] Estoy yo haciéndolo ahora. En unas horas lo tendré. [SEP] Gracias @pedrobaeza  [SEP] - [x] Hecho PR para Odoo 15 en https://github.com/OCA/l10n-spain/pull/3755
- [x] https://github.com/OCA/l10n-spain/pull/3757 [SEP] REABRO porque tenemos errores. Creo que no están implementsdos todos los cambios. Estoy viendo que se puso en Known issues 

@Shide  [SEP] Las casillas no implementados son casos muy específicos de las nuevas auto-declaraciones rectificativas. Si tenéis un caso y tenéis claro cómo funcionan, adelante con los cambios. [SEP] El error actual es:

![image001](https://github.com/user-attachments/assets/5765bd5c-87aa-4b45-96a9-259dd6216d14)
 [SEP] @rafaelbn ese error es porque no se está utilizando el nuevo formato BOE. Si generaron la declaración antes del parche, tendrán puesta esa configuración antigua. Cambiad la configuración y volved a exportar. [SEP] - [x] PR en https://github.com/OCA/l10n-spain/pull/3770 [SEP] Correcto @pedrobaeza . Adicionalmente se necesita en ciertos casos rellenar estas casillas.

https://github.com/OCA/l10n-spain/pull/3770"
Issue,3700,"Es probable que no estés utilizando los impuestos correspondientes del OSS, o que tengas mal gestionado el mapeo en el módulo del SII. No es una incidencia del módulo como tal. [SEP] Hola entonces tengo que mepear los impuestos del OSS en Contabilidad>Configuracion>SII - Mapeo de impuestos. Como se hace con los nuevos impuestos que se crean.¿es correcto lo que indico?


Gracias.
Un saludo."
Issue,3699,"Hola, esto no tiene que ver con `l10n_es_igic`, si no con el actualizar (`account_chart_update`). En cualquier caso, simplemente quita la actualización de esa posición fiscal en el listado en el que aparece, en lugar de darle a ""Siguiente"", ""Siguiente"". [SEP] Hola Pedro,

Gracias por la información. No obstante, hemos actualizado el módulo account_chart_update a la última versión pero sigue apareciendo el mismo error al actualizar el plan contable:

""La posición fiscal 'EU privado' tiene intrastat establecido en B2B, por lo que la opción 'IVA Requerido' debe estar activada.

(La opción de ""Requiere IVA"" está activada en ""EU privado"")

¿Sabes cuál podría ser el motivo?

No puedo quitar la actualización de esa posición porque entonces no se actualizaría.

Muchas gracias. [SEP] Desactiva esa casilla manualmente, o en el `account_chart_update` (que hay que ejecutarlo), pongas de no actualizar ese dato."
Issue,3698,"Prueba a subirlo en formato p12. [SEP] Gracias, Pedro.
No se como obtener un P15.
He conseguido transformarlo a pem, pero tampoco sirve (Could not deserialize PKCS12 data). [SEP] Perdón, era p12. Prueba a utilizar un navegador como Firefox para importar el certificado, y ver si funciona correctamente. Entonces, desde ahí podrás exportar a formato .p12. Básicamente es similar al .pfx, pero para aumentar las posibilidades de compatibilidad. [SEP] Mismo error.
Al cargar, sigo viendo como nombre de archivo, lo que ""ocupa"":
![image](https://github.com/user-attachments/assets/63cc42c9-94fa-42f3-98eb-f1613e67f66b)
Y si intento obtener claves:
![image](https://github.com/user-attachments/assets/80c5e5f2-f8e8-4888-9ba4-02e564ee3204)
Probado con p12 y Firefox.
 [SEP] Bueno, lo de que se vea el tamaño es normal, porque así funciona el widget. Si la importación en Firefox funciona, entonces el problema podría ser de las librerías crypto instaladas. Lista qué versiones tienes de cada librería y fíjate lo que hay en el requirements.txt del repositorio https://github.com/OCA/l10n-spain/blob/16.0/requirements.txt.

En cualquier caso, me temo que esto no es un fallo del módulo, por lo que no se debe continuar aquí en el issue tracker. Si con estas indicaciones no lo consigues, acude por favor al foro https://www.aeodoo.org/forum para solicitar más ayuda."
Issue,3690,"Hola Matias, nos encontramos con el mismo problema. Pudiste encontrar solución? [SEP] Hola, en mi caso el problema estaba con otro modulo de pagos (Klarna) que capturaba todos los token de pago y no devolvia el estado de la transaccion al modulo de Redsys, corrgiendo esto se solucionó el problema."
Issue,3689,"Hola @fcvalgar , yo creo que es un BUG del módulo, dado que esa pestaña se debería comportar de manera análoga a la pestaña de Contabilidad. Es decir:

Igual que si tengo acceso a la pestaña de Contabilidad veo la pestaña Contabilidad y si no no

Pues

Si tengo acceso como responsable de AEAT veo la pestaña y si no No

Para todos, es un problema de seguridad importante en la parte de protección de datos puesto que si os fijáis si usas el 190 y rellenas datos, como hacemos, ahí salen datos privados de salud como si tienes discapacidad y cosas así... y lo puede ver cualquiera.

¡Gracias! ¡Saludos!

Creo que es un cambio fácil @OCA/local-spain-maintainers que nosotros haremos un PR para que esa pestaña no se muestre si no tienes en el usuario el permiso de AEAT. ¿Os parece OK? Gracias. 😄 ❤️  [SEP] Fix en https://github.com/OCA/l10n-spain/pull/3692.

Si hay campos cuya privacidad es más crítica, decidme cuáles por favor porque hay que añadir una capa extra de seguridad a nivel ORM. [SEP] Se cierra y la discusción continúa en #3692 "
Issue,3688,"La forma adecuada de resolverlo sería crear un módulo `l10n_es_vat_book_pos`, que detecta qué apuntes provienen del PoS, y que no los marque como incorrectos por no tener NIF, y además tenga en cuenta las posibles casuísticas de constar como simplificadas, o también resumirlos como agrupados. [SEP] > además tenga en cuenta las posibles casuísticas de constar como simplificadas,

Que casuísticas se pueden producir?

>  o también resumirlos como agrupados.

esto a simple vista parece mucho mas complicado, no iria por esta ruta si no es obligatorio

 [SEP] En cuanto a lo de no dar errores por no tener nif, según deduzco de anteriores conversaciones una manera de solucionar este asunto sería por la ruta de pos_default_partner, y marcar este partner como no Aeat, esto sigue siendo  válido como solución? [SEP] https://github.com/OCA/l10n-spain/blob/d1aaa8aa24889b16df2de25298385e366b5decba/l10n_es_vat_book/models/l10n_es_vat_book_line.py#L39-L41

He visto esto en la revision del asunto, no es dañino, pero tampoco bonito [SEP] > Que casuísticas se pueden producir?

Creo que básicamente que venga indicado que es simplificada, pero no he entrado en detalles.


> esto a simple vista parece mucho mas complicado, no iria por esta ruta si no es obligatorio

Sí, pero sería lo más útil en cuanto a volumen.

> He visto esto en la revision del asunto, no es dañino, pero tampoco bonito

Sí, estaría bien limpiarlo.

> En cuanto a lo de no dar errores por no tener nif, según deduzco de anteriores conversaciones una manera de solucionar este asunto sería por la ruta de pos_default_partner, y marcar este partner como no Aeat, esto sigue siendo válido como solución?

Esto es un workaround, pero lo suyo es tratarlo adecuadamente. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3682,"Duplicado con el foro: https://www.aeodoo.org/forum/localizacion-espanola-3/sii-con-oss-1462

Cuando esté claro que es un error real del módulo, se puede reabrir esto.

Ana, no hagas cross-posting. Punto 16 de la FAQ de los foros, que aplica aquí también: https://www.aeodoo.org/forum/localizacion-espanola-3/faq [SEP] Buenos días, nuestro problema se solucionó con la desinstalación de uno de los módulos del estándar para OSS. Después de hacerlo, en ajustes teníamos disponible el wizard que nos permite crear los impuestos necesarios.
![OCA](https://github.com/user-attachments/assets/5ced878c-5035-4856-bc91-9e0541d3da67)
La pista surgió con el comentario de Harald Panten en el foro de Aeodoo, al cuestionar el formato de los impuestos disponibles.
Muchas gracias a todos

"
Issue,3680,"He encontrado el problema, se debia a una cuenta obsoleta que se intentaba usar y Odoo en consecuencia devolvía un error 400.
Al cambiar la configuración de la cuenta el pago se procesa con éxito y el carrito se vacía."
Issue,3676,"Alguna ayuda o pista por donde tirar sobre esto?  [SEP] Nadie se ha encontrado con el problema?
 [SEP] Revisa la tabla de mapeo de impuestos del SII, se está enviando un impuesto con una base de -73.1. Es probable que alguno de los impuestos no los tengas mapeados correctamente. [SEP] Te faltará mapear el impuesto ""IVA Soportado exento (operaciones corrientes)"" en el apartado SFRS del SII. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3670,Utiliza por favor los foros (https://www.aeodoo.org/forum) para este tipo de preguntas.
Issue,3669,La traza que aparece en tu reporte no tiene nada que ver con que tenga el `ES` o no lo tenga. El problema es que no tienes configurado el certificado.
Issue,3668,"Puesto que está el PR #3667, no es necesario tener también una issue, así que cierro."
Issue,3660,"Efectivamente, no está afectado, porque nosotros redirigimos a la página de la propia Redsys, así que cierro. Gracias por comentarlo en cualquier caso."
Issue,3650,"Y por que necesitais que sea LGPL?

No deberiais necesitar un glue module [SEP] A ver, por mi parte, no veo la necesidad de cambiar la licencia. Si no se necesita un glue module, se pueden usar ambos módulos. En caso contrario, está el account_asset_management de OCA :wink: 

Sobre portar la funcionalidad a Odoo, pues lo que vosotros queráis (teniendo en cuenta que estamos hablando de contabilidad, supongo que Odoo dirá que a EE... además, no tengo claro como ligará con su sistema de presentación de impuestos o con el propio SII...), pero recordad que los mismos mecanismos no deberian usarse, ya que seria incumplimiento de licencia. [SEP] Hola @etobella ,

Por que es el módulo base de la prorrata de IVA y si no usas los activos de OCA y usas los de Odoo no puedes adaptar los activos de Odoo a la prorrata para que te cree el activo por el valor adecuado si la factura de proveedor tiene prorrata.

Como te digo tenemos estas 2 opciones para darle salida porque para nosotros no es una opción usar los activos de OCA 😄 , que están genial, pero siempre que podemos usamos lo que tiene Odoo y ampliamos lo que no tiene.

Ya me decís para si esta vía no sirve hablar con Odoo para solucionarlo en CORE.

¡Mil gracias!

Abrazos,
Rafa [SEP] Hablalo con core, a mi la licencia me parece correcta tal y como está, además siempre podéis optar por los assets de OCA."
Issue,3647,Cierro ya después de un tiempo publicado.
Issue,3641,"Debes actualizar todo el código, no solo el de OCA/l10n-spain. En este caso, tienes código obsoleto de odoo/odoo. Y claro, actualizar los módulos en la BD correspondiente. [SEP] Glups, gracias, tienes toda la razon era el odoo,  disculpas por el ruido"
Issue,3636,Same issue here [SEP] Resuelto en #3872 
Issue,3627,"@ramiadavid es esto lo que tú te encontraste en la migración a 17.0? [SEP] @pedrobaeza si, creo que si [SEP] @emedina-mts echa un vistazo a estos cambios:

https://github.com/OCA/l10n-spain/pull/3529/commits/62b30b88c233e1f783c4d8cb7e90e9f74be57dbe#diff-dddf5901fd999ae3d0c986925b1d6d86981f36753f3f607c6ec6c6299d44e312R197

y si los llevas a 16 y funciona, estaría bien que hicieras un PR para resolverlo en esta versión. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] @emedina-mts hola, cuando hice la migración a la v17 (creo que era esa) ya lo comenté y lo modifiqué para esa versión, porque habia un problema en los tests y no se estaban ejecutando y por tanto no se detecta a el fallo, yo sugerí que había que revisarlo en versiones anteriores. Porque no tenia claro si los signo tenian que ser todos en negativo o todos en positivo, simplemente modifique el xml para que los tests no dieran error, porque asumí que los tests estaban correctos y en la pagina de hacienda aparentemente de las dos formas las validaba correctamente

Aunque ahora no recuerdo donde lo comenté porque no encuentro los comentarios, pero si buscas el pr de la migración y miras los cambios hechos en el xml, verás que se han hecho cambios justamente para eso [SEP] #4012 incluye el parche para los signos."
Issue,3624,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3622,"Esto no ha cambiado, ya que nunca ha exportado el IBAN completo. Se está revisando si incluirlo si es compatible con todos aquí: https://github.com/OCA/l10n-spain/pull/3332"
Issue,3610,"Fixed with PR #3609  [SEP] Closing the issue as there's a PR. Next time, you only need to put the PR explaining the issue there."
Issue,3607,"No uso todo el tema del pip y los artificios del setup que hace el pre-commit, pero borrando la carpeta del setup y lanzado pre-commit de nuevo, ha salido esto que debe solucionarlo:

https://github.com/OCA/l10n-spain/commit/8f6f52b14c12c98700cd25d4c0b007303991d036"
Issue,3605,"Creo que el flag a nivel de account.move.line es la opción más factible. Pero el actual `with_vat_prorate` se utiliza para otro fin, que es para marcar el apunte generado por el sistema que es la parte de la cuota del impuesto que no se deduce.

Ese flag podría ser un computed writable y llamarse `apply_vat_prorate`, y que se cambie solo según los impuestos puestos o el producto. Desplazaríamos la lógica que se mira ahora mismo de qué impuestos y cuentas aplican la prorrata o no a este nuevo campo, y simplificaríamos el `_compute_all_tax` a solo mirar si tiene dicho campo marcado o no.

@etobella también debe opinar aquí, que él tocó bastante este módulo en 14.0 [SEP] Gracias Pedro,

Perfecto, a ver si Enric puede corroborar la idoneidad del cambio. [SEP] A ver, mi conocimiento de la prorrata es el siguiente:

Existen 3 tipos de empresas

- Empresas normales
- Empresas con prorata general (se aplica la prorrata en todas las facturas de compra)
- Empresas con prorata especial (es el caso que explicas)

Todo lo que comentas afecta a la prorata especial. En la especial, al recibir una factura pueden darse 3 casos (de hecho debería hacerse línea a línea):

1- La factura no aplica prorrata - Actividad 2
2- Aplico la prorrata (o sea, que un porcentaje va a gastos directamente) - no queda claro que actividad es
3- Toda la factura va a gastos - Actividad 1

Por lo tanto, lo que debería hacerse a nivel de apunte es poner un campo de selección (en blanco seria aplica prorata general) Este campo solo deberia aparecer si la compañía tiene el flag de ""Prorata especial"" (así no cambia nada para la general)

WDYT? [SEP] Bueno, realmente puede ser prorrata general, pero hablar de líneas de negocio. @AlbertCabedo es el caso de AEOdoo, ¿no? ¿O eso se considera prorrata especial? [SEP] > A ver, mi conocimiento de la prorrata es el siguiente:
> 
> Existen 3 tipos de empresas
> 
> * Empresas normales
> * Empresas con prorata general (se aplica la prorrata en todas las facturas de compra)
> * Empresas con prorata especial (es el caso que explicas)
> 
> Todo lo que comentas afecta a la prorata especial. En la especial, al recibir una factura pueden darse 3 casos (de hecho debería hacerse línea a línea):
> 
> 1- La factura no aplica prorrata - Actividad 2 2- Aplico la prorrata (o sea, que un porcentaje va a gastos directamente) - no queda claro que actividad es 3- Toda la factura va a gastos - Actividad 1
> 
> Por lo tanto, lo que debería hacerse a nivel de apunte es poner un campo de selección (en blanco seria aplica prorata general) Este campo solo deberia aparecer si la compañía tiene el flag de ""Prorata especial"" (así no cambia nada para la general)
> 
> WDYT?

Correcto, Enric. Entonces la propuesta (sin entrar en detalles técnicos ya que no es este mi foco) podría ser:

1- Check en compañía para establecer si se rige por prorrata especial (solo si tiene prorrata marcado).

2- En caso de que la compañía tenga prorrata especial, en los apuntes contables habrá el check para decidir si se aplica prorrata especial. Si el check de los apuntes no está marcado y la compañía se rige por prorrata especial, los IVA soportados funcionarán SIN prorrata (es decir, un impuesto soportado ""normal"") .

- Ese es nuestro caso, en una misma factura hay impuestos soportados que se comportan SIN prorrata, pero hay apuntes con IVA soportado a los que SÍ se debe aplicar prorrata.

2.1- Si la compañía no tiene marcado prorrata especial (pero sí prorrata) se comportará como hasta ahora con prorrata general.

2.2- Obviamente, si la compañía no tiene prorrata, se comportará normalmente. No se verá sujeta a esta casuística.

3- He aquí otra pregunta... lo haríais en el mismo módulo? O en una extensión del tipo `l10n_es_vat_prorate_special` o similar? Personalmente creo que un nuevo módulo sería lo más adecuado, para simplificar el código del `l10n_es_vat_prorate` estándar.

WDYT?
 [SEP] No puede ser un check en la línea, pk hay 3 casos distintos:

- Aplica prorata
- Todo va a gastos
- todo normal

Te lo pongo con un ejemplo:

Supongamos que tenemos una compañía 2 actividades: Consultoria y Formación y que tiene una prorata del 30%. Y tengo un único centro de trabajo.

Supongamos que recibo la factura de luz. Como no se a que actividad va, tengo que aplicar mi prorata. O sea, del IVA podremos desgravar el 30% y el otro 70% irá directamente a gastos

Ahora recibo una factura de mesas. Si las mesas son para la parte de consultoria, no aplica la prorata y todo lo podremos desgravar.

Si la factura de mesas fuera para usar en las aulas, al ir a la actividad de educación, no puedo desgravarme los gastos. [SEP] > No puede ser un check en la línea, pk hay 3 casos distintos:
> 
> * Aplica prorata
> * Todo va a gastos
> * todo normal
> 
> Te lo pongo con un ejemplo:
> 
> Supongamos que tenemos una compañía 2 actividades: Consultoria y Formación y que tiene una prorata del 30%. Y tengo un único centro de trabajo.
> 
> Supongamos que recibo la factura de luz. Como no se a que actividad va, tengo que aplicar mi prorata. O sea, del IVA podremos desgravar el 30% y el otro 70% irá directamente a gastos
> 
> Ahora recibo una factura de mesas. Si las mesas son para la parte de consultoria, no aplica la prorata y todo lo podremos desgravar.
> 
> Si la factura de mesas fuera para usar en las aulas, al ir a la actividad de educación, no puedo desgravarme los gastos.

Hola Enric, lo que comentas sobre la opción de ""Todo va a gastos"".

Según lo que tengo entendido y nuestro caso:

- Aplica prorrata --> Ese apunte (esa línea de factura) si es para actividad que prorratee, se le desglosará el impuesto en 2 apuntes. Uno como IVA soportado ""normal"", y otro como más valor de la base, para entendernos (un apunte en la cuenta de gastos).
- Todo normal --> Se comporta como un IVA soportado sin prorrateo.
- Todo va a gastos --> Este punto no lo entiendo. ¿Qué quieres decir que va todo a gastos?

En una misma factura, yo tengo los casos 1 y 2. ""Aplica Prorrata"" y ""Todo normal"" respectivamente.

Me falta por entender el caso de una línea de factura en la que ""Todo vaya a gastos"". ¿A qué te refieres?

Gracias. [SEP] Me refiero a que ese IVA no serà desgravable y debe ir todo a gasto (como si tuvieras una prorata del 0%) [SEP] > Me refiero a que ese IVA no serà desgravable y debe ir todo a gasto (como si tuvieras una prorata del 0%)

Pero para eso ya tendríamos el IVA no deducible. Por lo que no veo necesario que haya 3 opciones:

- IVA Soportado habitual.
- IVA Soportado que sí se deba prorratear.
- Todo gasto --> Se puede resolver con los IVA soportados no deducibles, que ya existen.

¿Me equivoco? ¿O estamos mezclando conceptos? [SEP] y que haremos con los casos raros como el IVA de Bienes de inversión? [SEP] Pongamos un ejemplo.

**Contexto:**

- Soy la Compañía 1.
- Llevo a cabo varias actividades. Unas afectadas por prorrata y otras no, por lo que me veo sujeto a la prorrata especial.
- Actividad 1 = Afectada por prorrata.
- Actividad 2 = NO afectada por prorrata.

Caso de uso:

- Me llega la factura mensual de mi proveedor 1, quien me agrupa muchos conceptos en una misma factura.
- En su factura tengo productos con IVA soportado.
- Pongamos que hay 2 conceptos/productos en esa factura.
- El IVA de estos productos, debo interpretarlos según mi actividad, resumidamente:

1. Este producto es para mi sector de actividad NO afectado por la prorrata.
2. Este producto es para mi sector de actividad SÍ afectado por la prorrata.

Resolución. Cómo entraría la factura en el sistema:

- En la línea del producto 1, no marcaría el check de prorrata especial, por lo que no se vería afectado por la prorrata. Sería un IVA soportado habitual.
- En la línea del producto 2, marcaría el check de aplicar prorrata especial, ya que en esta línea sí querría aplicar la prorrata del IVA. Esto me haría 2 apuntes contables: uno que se llevaría la prorrata a la cuenta de impuesto y otro que cogería la misma cuenta que la base (lo que te hage la funcionalidad de la prorrata, para entendernos).

Este sería un caso de factura con IVAs con prorrateo y sin prorrateo en la misma factura. El caso que me comentas tú, entiendo que se diferenciaría de los productos 1 y 2, ¿correcto? [SEP] correcto @pedrobaeza . 
Según mi punto de vista, hablais todos de lo mismo y estáis todos alineados. Respecto a un posible desarrollo entiendo lo siguiente:
1) si el gasto no es deducible, ya tenemos el Impuesto creado para ello, no hay que hacer nada
2) Si el gasto es deducible 100%, ya tenemos el impuesto creado para ello, no hay que hacer nada.
3) Aqui está el tema, si el gasto es ""común"" en ambas actividades, por ejemplo, el asesor, el abogado, o la luz, entonces se aplica prorrata en estos gastos. Se puede crear un impuesto para ellos o bien desarrollar alguna casilla u opción que permita aplicar prorrata a dichos gastos.

Como digo, todos decís lo mismo y estáis en lo cierto, cualquier cosa o aclaración un meet de 5 minutos y lo resolvemos seguro. gracias y buen finde! [SEP] Gracias @AlbertCabedo creo que ya tenemos un punto en común y pueden empezar a desarrollarlo.

@eantones puede que esto te interese  [SEP] > correcto @pedrobaeza . Según mi punto de vista, hablais todos de lo mismo y estáis todos alineados. Respecto a un posible desarrollo entiendo lo siguiente:
> 
> 1. si el gasto no es deducible, ya tenemos el Impuesto creado para ello, no hay que hacer nada
> 2. Si el gasto es deducible 100%, ya tenemos el impuesto creado para ello, no hay que hacer nada.
> 3. Aqui está el tema, si el gasto es ""común"" en ambas actividades, por ejemplo, el asesor, el abogado, o la luz, entonces se aplica prorrata en estos gastos. Se puede crear un impuesto para ellos o bien desarrollar alguna casilla u opción que permita aplicar prorrata a dichos gastos.
> 
> Como digo, todos decís lo mismo y estáis en lo cierto, cualquier cosa o aclaración un meet de 5 minutos y lo resolvemos seguro. gracias y buen finde!

Gracias Albert. Nos has despejado las dudas.

@pedrobaeza @etobella Entonces propongo lo que ya he comentado antes (sin entrar en detalles, sino a nivel conceptual):

1- Check en compañía para establecer si se rige por prorrata especial (solo visible/seleccionable si la compañía tiene prorrata marcado).

2- En caso de que la compañía tenga prorrata especial, en las líneas de factura (y en los apuntes) habrá la posibilidad de marcar un check (`ya pensaremos si default=True o si default=False`). Yo optaría porque pueda ser seleccionable `default=True/False` según la compañía, pero eso ya es más un detalle de UI.

- Este check solo será visible/seleccionable si la compañía tiene marcada la opción de prorrata especial.
- Este check servirá para decidir si el IVA aplicado a esta línea de factura (y en los apuntes) se prorratea o no se prorratea.
- En caso de estar marcado, el IVA se prorratea (SÍ se aplica prorrata).
- En caso de estar desmarcado, el IVA soportado se aplicará normalmente (NO se aplica prorrata).

3- Para terminar... ¿Hacemos módulo aparte? ¿O en el mismo módulo? Yo creo que lo más limpio seria hace un `l10n_es_vat_prorate_special` o similar, puesto que es un caso muy poco común.

WDYT?

 [SEP] Creo que no merece la pena separar en 2 módulos. No se gana tanto en este caso. [SEP] OK. Empezamos a planificar la apertura de nuevo PR. A priori, a falta de estudio en detalle:

- Añadir el check en compañía, para determinar si se está afectado por prorrata especial.
- Añadir los cambios necesarios en facturas y apuntes.
- Añadir los cambios necesarios a nivel de UI.
- Ampliar README.
- Añadir tests.

Todo como IMP del módulo ya existente `l10n_es_vat_prorate` [SEP] Ahora que tenemos hecho esto, vamos a hacer comprobaciones en el módulo l10n_es_aeat_mod303_vat_prorate, para validar que todo dé como tiene que dar. [SEP] Implementado."
Issue,3589,"Por si le arroga luz a alguien: un par de clientes nos lo han reportado pero no pasa desde todas las máquinas. Este comando es equivalente a la llamada que recibe timeout en los tests que mencionas:
```
wget https://egoitza.gipuzkoa.eus/ogasuna/sii/ficheros/v1.1/SuministroFactRecibidas.wsdl -O-
```
En mi PC (por poner un ejemplo) funciona correctamente pero un par de clientes no. No sé si hacienda está baneando determinadas IPs o es un problema de enrutado más general. [SEP] Gracias por la información. Desde mi PC también funciona. A lo mejor como dices han puesto una lista de denegados. Estoy reintentando en estos momentos un CI, y si sigue fallando, voy a excluir la agencia de los tests porque nos está bloqueando todos los PRs, a falta de saber los motivos. [SEP] Nos acaba de llegar esto desde hacienda:

> Buenos días,
>
> Desde la mañana del pasado viernes día 17 estamos teniendo algunos problemas de conectividad. Estamos trabajando para solventarlos en la mayor brevedad posible.
>
> Esta incidencia se tendrá en cuenta, en su caso,  a todos los efectos del cumplimiento de las obligaciones tributarias.
>
> Disculpen las molestias ocasionadas. [SEP] Hacienda Gipuzkoa notifica que los problemas de conectividad ya están resueltos. @pedrobaeza, si lo puedes confirma se podría cerrar este ticket sin problemas. [SEP] Veamos a ver si ya vuelven a funcionar los tests correctamente: https://github.com/OCA/l10n-spain/pull/3602 [SEP] Pues sí, efectivamente ya funciona de nuevo. Lo he dejado restablecido en 16.0, pero para las versiones anteriores creo que lo voy a dejar desactivado como ya tenemos el chivato en caso de que vuelva a fallar, y así no paralizamos tantas ramas en caso de que vuelva a pasar."
Issue,3565,"Hola, eso ocurre si actualizas código y reinicias servicio, pero no actualizas módulo dentro de la instancia para que se reflejen los cambios de estructura de la base de datos. Es algo estándar de todo Odoo.

Cierro, al no tratarse de un error del módulo."
Issue,3560,"Hola, OCA no se hace garante de nada.

Tendrá que ser el propio integrador, o en su defecto, el usuario (el cliente) el que se hace garante del software."
Issue,3552,"Hola, realiza por favor la pregunta en el foro de AEOdoo (https://www.aeodoo.org/forum), ya que este espacio es para bugs/problemas con el código."
Issue,3551,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3539,"Hola Gelo, gracias por el reporte.

¿Solo falla en V16? ¿O te has encontrado lo mismo en V15, por ejemplo?

Saludos. [SEP] Fusionado el FIX --> https://github.com/OCA/l10n-spain/pull/3540"
Issue,3538,"Lo tienes en #3534  [SEP] Perdón, #3359, que tengo follón por lo de la separación de PRs."
Issue,3533,"There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3527,"De hecho, mirando el listado de todas las retenciones que existen para la localización española, existen un montón que a dia de hoy no deberían existir. Este es el listado de las retenciones existentes en 2024 segun l'AEAT:

https://sede.agenciatributaria.gob.es/static_files/Sede/Programas_ayuda/Retenciones/2024/Cuadro_tipos_retenciones_IRPF2024.pdf [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label. [SEP] Relacionado con IRPFs, me he encontrado con un caso donde el régimen del contacto es de canarias pero también hay que aplicarle IRPF X% y por lo tanto no lleva IVA. La solución que me viene inmediatamente a la cabeza es una posición fiscal que mapee a impuestos de canarias (**sin IVA**) y además aplique el IRPF. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3522,"@HaraldPanten @pedrobaeza  [SEP] > account_demo

https://github.com/odoo/odoo/blob/17.0/addons/account/demo/account_demo.py [SEP] @manuelregidor respecto a esa factura ¿que es diferente o porque realiza que fallen los test? Es algo raro que antes no fallara y ahora si ¿podría haber otra causa? [SEP] @ValentinVinagre Porque aplica en las líneas impuestos que se tienen en cuenta en el 303, por lo que no solamente se genera el informe con los datos creados en los tests del módulo del 303 sino también con los de la info de demo. [SEP] Una solución directa es cambiar la fecha de los datos de los tests para que sea del año pasado, y así no hay solape. [SEP] > Una solución directa es cambiar la fecha de los datos de los tests para que sea del año pasado, y así no hay solape.

Si realizamos eso ¿No podría pasar que no podamos testear correctamente nuevos mapeos de impuestos? 
Es decir: si por ej. tenemos mapeos de esta manera:
mapeo1: 1/1/2010 - 31/12/2020
mapeo2: 1/2/2021 - actual

Aquí se podría poner las facturas de test en fecha 1/1/2021 sin problema. Pero, si entrase un mapeo nuevo por ej:
mapeo1: 1/1/2010 - 31/12/2020
mapeo2: 1/2/2021 - 31/12/2023
mapeo3: 1/1/2024 - actual

Si ponemos las fechas de facturas en años pasados... no podremos testear correctamente esos mapeos actuales. Si no es que para los tests hacemos la jugada de ... dejar siempre el último mapeo y forzar unas fechas específicas correspondiente a los tests.

¿como lo ves?
 [SEP] Ya, claro, ese problema estaba presente en anteriores versiones y de hecho por eso puse la fecha actual y tuve que cambiar el resultado de los tests cuando migré, porque había definiciones de mapeos de impuestos más modernos, pero lo decía como solución inmediata.

Otra opción sería por SQL hacer un borrado de impuestos en las facturas existentes para sin mucha complicación, que no interfieran. [SEP] Veo mejor pensar una solución un poco más a largo plazo, total ahora estamos a tiempo, ya que se está realizando toda la migración y no tenemos clientes con una alta urgencia de estas necesidades.
Por lo que hemos comentado veo las siguientes opciones:

1.- En los test's de los modelos siempre testear el último mapeo, borrar los anteriores y indicar siempre una fecha específica para que no interfiera lo de Odoo. (esta es la que veo que menos problemas nos podría dar y que es la ""las estable"").
2.- Realizar un borrado por sql (o similar) de todos los impuestos aplicados en las facturas creadas por Odoo. Esto ... no me acaba de gustar del todo, ya que se podría interferir en los posibles testeos futuros de otros módulos o si Odoo en un futuro cambia esto... ¿podría ser problemático?
3.- Cambiar fechas en las facturas de los tests actuales.
4.- Cambiar los test's para que de alguna manera se identifiquen las facturas que no tendrían que entrar para los test's de los modelos de OCA. Por ej. ¿en el aeat se podría indicar una función de filtrado de todo esto?

Por el momento veo esto ...  No se si veis alguna opción más. 
 [SEP] 2 no es problemático, porque se deshace todo en cuanto termina el test específico. [SEP] > 2 no es problemático, porque se deshace todo en cuanto termina el test específico.

La idea sería ponerlo en el l10n_es_aeat para que lo recojan el resto de módulos de la l10n-spain de oca o en cada módulo que tenga problemas? [SEP] Se puede poner en el test aeat base. Igualmente lo deshará en cada test hijo que lo herede."
Issue,3521,"*** Editado punto 4 y añadido punto 5. [SEP] Hola @SoniaViciana 

Entiendo los problemas que indicas, sobre todo los que tienen que ver con las sesiones que cierran al dia siguiente. Donde los apuntes se van a quedar en una fecha distinta a la del envio del SII de algunas facturas simplificadas.
Lo que no tengo muy claro es la propuesta de solución usando el **l10n_es_aeat_sii_invoice_summary** por que hacer un apunte con el resumen de lo que hay que enviar al SII, ¿supone duplicar la información contable? 
Como dices verifactu ha excluido a las empresas adscritas al SII pero no se hasta cuando van a permitir seguir enviando un asiento resumen a los del SII cuando a los demás les van a exigir enviar todas las facturas...

En cualquier caso, es cierto que hay algunos problemas con esta implementación que habría que revisar, tal vez podríamos esperar a ver la implementación del verifactu en el pos por que habrá que tocar también cosas para enviar cada una de las facturas simplificadas por separado.

Un saludo
 [SEP] Hola @anmarmo1 

En la propuesta de solución, la idea sería no duplicar, si no dotar al asiento agrupado de facturas simplificadas que ya genera el TPV, de la información / lógica faltante para que sea una factura de venta a todos los efectos. Completando a su vez los campos de `l10n_es_aeat_sii_invoice_summary` (primer y último número de factura simplificada).
Sin embargo... esto se tiene que sopesar, porque haría el SII del TPV incompatible con `l10n_es_pos_by_device` (múltiples dispositivos por sesión en el punto de venta). 

Entonces, lo cierto es que hay que pensarse bien qué conviene más, sabiendo los pros y los contras de cada opción (esto es lo que pretendo en este issue). En todo caso, iremos informando. La opción 2 no es algo que tengamos pensado abordar a corto plazo.

Saludos, [SEP] Lo suyo sería que se discutiera esto en los Spanish OCA Days. Sonia, convence a tu jefe para que vayáis para allá... [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3520,"Detalla de los cambios comentados sobre el 123 en https://github.com/OCA/l10n-spain/issues/3227 [SEP] Gracias @ArantxaSudon @rafaelbn . Abrís PR? [SEP] @HaraldPanten , podemos empezar a trabajar en esto el lunes a primera hora. Esta semana no podemos empezar. [SEP] > @HaraldPanten , podemos empezar a trabajar en esto el lunes a primera hora. Esta semana no podemos empezar.

Sin problema, cuando os vaya bien. Nosotros estamos con la migración a V17. Si os encargáis del nuevo formato en V16, por ejemplo, ya lo añadimos en el PR de migración para la nueva.

Gracias! [SEP] @HaraldPanten PR en https://github.com/OCA/l10n-spain/pull/3528 [SEP] @rafaelbn @HaraldPanten  dejo captura del excell utilizado en V16 para incorporar los cambios por si sirve de ayuda

![Captura desde 2024-04-15 12-20-06](https://github.com/OCA/l10n-spain/assets/104626993/81c42c25-6876-494e-b015-bdf8a8528e73)
 [SEP] Realizado en #3528"
Issue,3518,"Buenas tardes @greciosd, por lo que he podido comprobar es correcto que ambas cuentas tengan el mismo código, pero claramente no es correcto que ambas se carguen en el paquete ""sin ánimo de lucro"". En el plan general la cuenta 4707 corresponde a ""Hacienda Pública, deudora por IGIC"" y en el plan ""sin ánimo de lucro"" la cuenta 4707 corresponde a ""Hacienda Pública, deudora por colaboración en la entrega y distribución de subvenciones (art.12 Ley de Subvenciones)"". Voy a proponer un PR para sacar las cuentas 4707 y la cuenta 4757 del common, para poder asignarlas a nivel del hijo. [SEP] El PR en concreto: https://github.com/OCA/l10n-spain/pull/3523"
Issue,3514,"Hola, Loia, creo recordar que se quitó porque la AEAT no quería tener el campo rellenado en ese caso. Entonces el parche sería que no fuera visible para el tipo `I`. Probadlo si es correcta mi hipótesis y nos decís. [SEP] Por ahora el tipo ""I"" no es visible. Pero sí debería serlo. Según la AEAT, esta es la nueva normativa: 
![imagen](https://github.com/OCA/l10n-spain/assets/104626797/3d886030-fa3c-44d2-b78b-5455cfbdadf7)
https://sede.agenciatributaria.gob.es/Sede/todas-gestiones/impuestos-tasas/iva/modelo-303-iva-autoliquidacion_/instrucciones.html

Si la opción es a domiciliar, debe estar indicada la cuenta bancaria. 
Ahora el código está así: https://github.com/OCA/l10n-spain/blob/fc2a79ffe96832030fffed3c3d41b251ba63d12c/l10n_es_aeat_mod303/data/2023/aeat.model.export.config.line.csv#L123 (_línea 123; columna: expression_) 
Solo es visible con el `result_type` X y D

Gracias [SEP] OK, pues adelante con el PR si lo tenéis claro."
Issue,3507,"@etobella si no recuerdo mal, lo incluiste tú para evitar una incompatibilidad. [SEP] No entiendo el problema :thinking: que tiene que ver el manifest de la 15 si estas instalando 16. 

De hecho, usamos la misma versión que define Odoo en sus requirements. https://github.com/odoo/odoo/blob/16.0/requirements.txt#L5

Así que para mi no hay ningún bug.

Debemos recordar que por eso hay cambio de versiones... Las dependencias pueden cambiar entre versiones mayores (lo intentamos evitar en menores...) [SEP] @etobella la indicación a la rama 15 es por indicar las diferencias entre una rama que no da ningún problema (la cual en su manifest no solicita ninguna version de cryptography en concreto) realizando la instalación con una que si las esta dando.

La única diferencia apreciable entre versiones es la obligación de versión de la dependencia que aunque estando la misma versión que requiere odoo y en el sistema la misma, esa indicación de version es la que genera el fallo que salta el error de que no esta instalada (aunque si lo esta)

Como se ha indicado, los pasos han sido los siguientes:

Instalación de odoo 16 CE con sus requirements, su funcionamiento es correcto
Descarga del repositorio l10n_spain e instalación de sus requirements, cuando se va a los modulos mencionados salta el mensaje de que esa versión no esta instalada.

Si eliminamos del manifest la versión, dejando solo indicado la dependencia cryptography funciona correctamente la instalación

Queremos dejar claro que este problema no es a nivel del fichero requirements.txt sino en los archivos __manifest__.py [SEP] El problema esta en tu instalacion. Odoo requiere esa version, por eso esta congelado. [SEP] @iTecan efectivamente si se instala con las versiones indicadas tanto en el requirements.txt de Odoo como en el manifest, todo funciona correctamente, así que cierro. Revisa por favor tu procedimiento de despliegue para ver si estás instalando por otro lado una versión sin congelar de `cryptography`, y tendrás que indicar dicha versión. Me suena que utilizas Doodba, así que sería en el archivo pip.txt indicar `cryptography==3.4.8` en lugar de solo `cryptography`.

Cierro entonces la issue."
Issue,3500,
Issue,3483,"Hola, esto no es ninguna issue del módulo, por lo que éste no es el lugar adecuado para hacer este tipo de solicitudes. Prueba a ponerlo en los foros de AEOdoo: https://www.aeodoo.org/forum. De todas formas, creo que este tipo de cosas son las que debe aportar cada uno como empresa implantadora de Odoo, y no tengo claro que alguien os conteste al respecto. Estamos muchos que ni trabajamos en esa zona, y los demás ya han aportado el software como gesto solidario."
Issue,3482,"Envase no debe ser la traducción para `product.packaging`: https://dle.rae.es/envase. Empaquetado era correcto IMO. [SEP] Precisamente consultamos la RAE a la hora de hacer esa elección. [La traducción para empaquetado](https://dle.rae.es/empaquetado) indica únicamente:

> Acción y efecto de empaquetar.

Normalmente, en los contextos mencionados, el que conlleva una ""acción y efecto"" es más bien el contexto de inventario. Pongamos el caso de un supermercado:
- Los operarios de almacén harán la ""acción y efecto de [des]empaquetar"" al abrir los pallets, que quizás vengan envueltos en plástico, y colocar las cajas en estanterías, o ""acciones"" similares.
- En cambio, las fresas ya las compran ""envasadas"" en cajitas de 500g, no es una ""acción"" que ellos hagan.

En cualquier caso, obviamente son términos casi equivalentes, y el problema de escoger ""empaquetado"" es que deja la incógnita de qué escoger para la otra parte: la de stock. [SEP] En stock (`stock.quant.package`), está puesto ""paquete"". Para `product.packaging`, se habla de ""empaquetado"", por lo que están diferenciados. Creo que ""envase"", aunque su tercedra acepción lo puede permitir, queda poco natural. Ejemplo: tenemos un cliente que vende guantes de protección, y los vende empaquetados de 5 en 5. Hablar de envase de 5 pares de guantes quedaría muy raro. También envase se relaciona muchas veces con líquidos. [SEP] > Envase no debe ser la traducción para `product.packaging`: https://dle.rae.es/envase. Empaquetado era correcto IMO.

Yo aquí discrepo 😅. Me explico:

- En función de la definición que das de la RAE creo que encaja en la segunda acepción. Por ejemplo, caja de 6 unidades en la venta de manzanas que es un producto que se vende por Kg.
![image](https://github.com/OCA/l10n-spain/assets/147538094/8e333f74-d23b-4e1c-ad80-91a96465fad7)

- Respesto a ""Empaquetado"" la RAE dice:
![image](https://github.com/OCA/l10n-spain/assets/147538094/4cf19bdd-7a8f-4743-9660-4447e23acf3b)

- Si miramos empaquetar, creo que también la segunda acepción encaja con lo que @yajo dice en el ejemplo: Nos han llegado al almacén 100 envases de 200g de jamón, empaquetados en 4 cajas.
![image](https://github.com/OCA/l10n-spain/assets/147538094/fbb7158a-a917-478e-abda-b50e8ac7cbe3)

Saludos,
 [SEP] Lo dicho, Gelo, tú nunca hablarías de envase de 5 pares de guantes, ¿a que no? [SEP] > En stock (`stock.quant.package`), está puesto ""paquete"". Para `product.packaging`, se habla de ""empaquetado"", por lo que están diferenciados.

Sobre el papel, son términos diferentes; pero en realidad, paquete y empaquetado no están bien diferenciados. Si lo estuvieran, nunca hubiéramos necesitado preocuparnos de este asunto...

""Paquete"" es el sustantivo y ""empaquetar"" es el verbo, pero ambas se refieren a la misma cosa. De hecho, [la primera definición de empaquetar](https://dle.rae.es/empaquetar) es ""hacer paquetes"".

> Creo que ""envase"", aunque su tercedra acepción lo puede permitir, queda poco natural.

Del mismo modo, cuando hablamos de ""empaquetados"", hay contextos en que no queda natural. Ejemplo: Vendo aceite empaquetado en botellas de 1, 5 y 10 L. Obviamente, en este contexto queda mejor ""envasado"".

También hay contextos en que queda exactamente igual de bien tanto el uno como el otro:
- Vendo jamón empaquetado en blísters de 200g.
- Vendo jamón envasado en blísters de 200g.

Y hay otros en los que queda igual de mal uno que el otro:
- Vendo jamón empaquetado en pata de 7kg.
- Vendo jamón envasado en pata de 7kg.

Por eso decía al principio:

> Obviamente no encajará siempre con cada caso de uso, pero más o menos se puede llegar a entender.
> 
> Creemos que lo más importante es tener un estándar, que la traducción sea homogénea, y que se distinga fácilmente entre modelos y usos, sin confundir.

Creo que el español es un idioma suficientemente rico como para poder usar 2 terminologías totalmente diferentes y así ayudar a nuestros usuarios a entender la diferencia.

En fin, todo esto que estamos comentando no es en contra de lo que dices, @pedrobaeza, sino simplemente estamos expresando públicamente el mismo análisis que ya hicimos internamente y que luego nos llevó a la conclusión de que la usabilidad de Odoo mejoraría llamando ""envase"" a `product.packaging` que llamándolo ""empaquetado"". [SEP] Pero curiosamente los casos en los que queda peor envase afectan a mis clientes, y supongo que envasado quedará mejor en los vuestros. A ver qué opina más gente al respecto. [SEP] Bueno, tampoco es tan así. Quiero decir que no a todos nuestros clientes les encaja perfecto ""envase"". Incluso, para ciertos clientes les encaja bien en unos productos y mal en otros.

La cuestión aquí no es si le va mejor o peor a nuestros clientes. La cuestión es mejorar la usabilidad general de Odoo permitiendo al usuario diferenciar apropiadamente entre 2 funcionalidades independientes, que tienen nombres demasiado parecidos. [SEP] Ya, yo es lo que intento también, con unos términos lo más adecuados posibles, teniendo en cuenta que no siempre va a casar al 100%. En muchos sitios te estás refieriendo como ""envasado"" en lugar de ""envase"", que es el cambio que planteáis, con lo que ahí ya también se desfigura la idoneidad de esa palabra, porque así queda mejor en las frase formuladas. La cuestión es que en Odoo solo tenemos una palabra en la columna, y entre ver ""Envase"" o ver ""Empaquetado"" en dicha columna, yo sigo decantándome por la última, pero lo dicho, a ver qué opina otra gente. [SEP] > Lo dicho, Gelo, tú nunca hablarías de envase de 5 pares de guantes, ¿a que no?

Hola Pedro, no te discuto que en alguna ocasión puede ser confuso, pero también puede ser porque no usamos la palabra adecuada. 

Según chat GPT:
Los términos ""paquete"" y ""envase"" son comúnmente utilizados en el contexto del embalaje de productos, pero tienen significados ligeramente diferentes:

**- Envase:**
  - Un envase se refiere específicamente al contenedor físico utilizado para contener y proteger un producto. Puede ser cualquier tipo de recipiente, como una botella, una lata, una caja, una bolsa, etc.

  - El envase cumple funciones importantes, como proteger el producto de daños físicos, contaminación, pérdida de frescura y deterioro durante el transporte y el almacenamiento.
  - Además de proteger el producto, el envase puede tener un papel en la promoción y la comercialización del producto, ya que a menudo lleva información sobre el producto, instrucciones de uso, etiquetas de advertencia, diseños gráficos para atraer a los consumidores, etc.

**-Paquete:**
  - El término ""paquete"" se utiliza más ampliamente para referirse al conjunto completo de materiales de embalaje que rodean y contienen un producto. Esto incluye no solo el envase primario que contiene directamente el producto, sino también cualquier envoltura secundaria o material de relleno utilizado para proteger y presentar el producto.
  - Un paquete puede incluir varios niveles de embalaje, como el envase primario (la botella, la lata, etc.), el envase secundario (la caja que contiene varias unidades del producto), y el embalaje de transporte (cartones, relleno protector, etc.).
  - El paquete se diseña teniendo en cuenta tanto la protección del producto como la eficiencia en términos de almacenamiento, transporte y manipulación.

En resumen, **mientras que el ""envase"" se refiere específicamente al contenedor físico que contiene el producto, el ""paquete"" se refiere al conjunto completo de materiales de embalaje que rodean y contienen el producto, incluyendo el envase primario, cualquier envoltura secundaria y el embalaje de transporte.**

Así que yo creo que la RAE y Chat GPT van más a favor de la propuesta de @yajo  [SEP] > En muchos sitios te estás refieriendo como ""envasado"" en lugar de ""envase""

Gracias, he actualizado algunas traducciones para que digan ""envase"". Creo que puse ""envasado"" por inercia al ver ""empaquetado"". 😅 

En cualquier caso, no era un gran problema. Precisamente, al usar 2 familias completamente diferentes de palabras, ya no se vuelve tan relevante diferenciar si uno usa el sustantivo o el verbo. [SEP] Ante la falta de opiniones de más empresas, y puesto que Jairo volvió a cambiar todos los términos en Transifex a la siguiente semana, lo dejaremos así por el momento. [SEP] OK Gracias ❤️ 😊 "
Issue,3480,"Este caso parece complejo. 
Entiendo lo que comentas, y siendo así, seria conveniente hacer la mejora en el POS.
Si haces alguna propuesta de mejora y necesitas ayuda para hacer pruebas y review estoy disponible 🙂
 [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3475,"Indicada la incompatibilidad en el ROADMAP: https://github.com/OCA/l10n-spain/commit/fc2f5838f308ce36cd9f597d464e23bda5e8be9d

Cierro y el que quiera solucionar dicho caso, puede poner un PR al respecto."
Issue,3474,"Por favor no abras issues nuevos teniendo una issue (y además fijada) para controlar dicho progreso. Se seguirá progresando en el tema, pero no hay fechas cerradas."
Issue,3459,"Aunque no estás indicando el módulo, por el trozo de error, estás creando la base de datos con código de Odoo core obsoleto. Actualiza dicho código. [SEP] Me refería a l10n_es_facturae. Correcto, al actualizar l10n_es sí es posible instalar l10n_es_facturae. Gracias!"
Issue,3456,#3472 - corrección v14.0 [SEP] Cerrado por mergeo
Issue,3455,"Según veo en la definición de la exportación, tiene para aplicar el signo:

https://github.com/OCA/l10n-spain/blob/16.0/l10n_es_aeat_mod347/data/aeat_export_mod347_partner_data.xml#L178-L180

![image](https://github.com/OCA/l10n-spain/assets/7165771/39400832-dc2d-41f8-817b-72175d0a4f20)

¿Lo tienes así definido en la BD en la que estás exportando? [SEP] @pedrobaeza  si lo tengo así
![image](https://github.com/OCA/l10n-spain/assets/84158523/b732e7fa-f2ba-4eee-9189-eaf59ad923f0)
 [SEP] Pues entonces debería exportar con la N delante... ¿Lo que muestras arriba es ese campo de importe de las operaciones o es algún otro? [SEP] Solo me han pasado esa captura. Tranquilo ya lo reviso yo, era solo confirmar que tiene que salir en negativo en el documento. [SEP] Pero si por la posición (después de la ""B"") tiene que ser ese campo [SEP] @pedrobaeza He estado revisando el tema y creo que el problema está aqui:
https://github.com/OCA/l10n-spain/blob/035a1f9d5525f2e043d5991e8d89a36f8754261f/l10n_es_aeat_mod347/data/aeat_export_mod347_partner_data.xml#L176

La función abs hace que el valor siempre sea positivo, ¿sabes si hay algún motivo para esto o se puede modificar? [SEP] Veo que ese cambio lo hice aquí:

https://github.com/OCA/l10n-spain/commit/2102ab1207fb8ed546c4ac9b468c25b02c14f733

y es que antes había `abs` en el código, pero no veo la razón que me llevo a poner el `abs` en la exportación del BOE. No tiene demasiado sentido visto ahora, y puede que fuera un ""por si acaso"". Creo que no ha impactado hasta ahora porque no es lo habitual que salgan registros con negativo. Arreglado en #3467 (y posteriores fw-port)."
Issue,3452,"Creo que la solución es actualizar la libreria **xmlsig**, nos encontremos un problema similar y actualmente tenemos la version 1.0.1 y dejo de dar ese error. [SEP] La librería xmlsig esta actualizada, como comente antes [SEP] El mismo problema en Odoo 16.  Comparando el fichero firmado con autofirma y el fichero firmado con Odoo veo que autofirma usa el sha-256 mientras que el que me sale de odoo usa sha1. No sé donde se cambia eso en Odoo. [SEP] Tras varias confirmaciones, el módulo no tiene problemas en si. La problemática puede venir de las versiones criptográficas, o del certificado subido (como le ha ocurrido a https://www.aeodoo.org/forum/localizacion-espanola-3/error-gestion-certificado-en-odoo-16-docker-1501).

Entonces cierro esta issue, al no tratarse de algo de código de este repositorio."
Issue,3451,"Caso bastante especial sin duda... Creo que no habría que hacer una factura, si no un asiento, pero efectivamente haría falta un impuesto nuevo con cuota 0 y mapearlo en el 347 si no hay ninguno de los existentes que pueda valer. [SEP] Sí, un caso especial, y con el Kit Digital creo que será un problema para mucha gente, pues hay que informarlo en el 347 cuando supere los 3.000€...

Con meter el impuesto en el apunte de la 4708 también he probado y no funciona bien, no sé si hice algo mal, al poner el impuesto directamente en el apunte contable, a parte que hay que poner igualmente la empresa que otorga la subvención y por tanto y crear el cliente igualmente, con su CIF y su dirección correcta (en el caso del Kit Digital sería ENTIDAD PÚBLICA EMPRESARIAL RED.ES), en el 347 el importe global lo pone correcto, pero en el desglose trimestral lo pone en negativo y considera el apunte como el de una rectificativa. 

Por otro lado en mi caso la factura ayuda mucho para saber cuánto falta por cobrar de la subvención y poner claridad en el asunto, es una factura que hay que cobrar, tienes un sitio donde sabes todas las subvenciones que has recibido, tienes el control en cuentas de clientes, etc...

---

El asiento del Kit precisamente es un poco complejo, lo pongo aquí por si da alguna pista (disclaimer!! esto es según lo que me ha recomendado a mi la gestoría, como dice gpt, mejor consultar con un experto en contabilidad antes de tocar nada :)

Asiento de la factura del proveedor:

|Cuenta | Empresa | Etiqueta | Impuesto (cuota) | Impuestos | Cuenta analítica | Monto moneda | Moneda | Debe | Haber | Fecha vencimiento
|-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
|  |   |   |   |   |   |   |   | 2.416,37 | 2.416,37 |  
|4100156 Agente Digitalizador SL | Agente Digitalizador SL | / |   |   |   | 0,00 |   | 0,00 € | 2.416,37 € | 01/07/2023
|472000 Hacienda Pública. IVA soportado | Agente Digitalizador SL | 21% IVA soportado (servicios corrientes) | 21% IVA soportado (servicios corrientes) |   |   | 0,00 |   | 419,37 € | 0,00 € | 01/07/2023
|206000 Aplicaciones informáticas | Agente Digitalizador SL | Kit digital |   | 21% IVA soportado (servicios corrientes) |   | 0,00 |   | 1.997,00 € | 0,00 € | 01/07/2023

Asiento de factura de la subvención, teóricamente se podría hacer a mano, pero entonces al menos en mi caso, el 347 lo considera una factura rectificativa:

|Cuenta | Empresa | Etiqueta | Impuesto (cuota) | Impuestos | Cuenta analítica | Monto moneda | Moneda | Debe | Haber | Fecha vencimiento
|-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
|  |   |   |   |   |   |   |   | 1.997,00 | 1.997,00 |  
|430041 ENTIDAD PÚBLICA EMPRESARIAL RED.ES | ENTIDAD PÚBLICA EMPRESARIAL RED.ES | / |   |   |   | 0,00 |   | 1.997,00 € | 0,00 € | 05/07/2023
|470804 HP Deudora Subvenciones Kit Digital 2023/.../... | ENTIDAD PÚBLICA EMPRESARIAL RED.ES | Subvencion 2023/.../... 141-KD000... |   | Subvenciones |   | 0,00 |   | 0,00 € | 1.997,00 € | 05/07/2023

Asiento manual para poder cuadrar el pago de las facturas (el iva se paga directamente al agente digitalizador):


|Cuenta | Empresa | Etiqueta | Impuesto (cuota) | Impuestos | Cuenta analítica | Monto moneda | Moneda | Debe | Haber | Fecha vencimiento
|-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
|  |   |   |   |   |   |   |   | 1.997,00 | 1.997,00 |  
|4100156 Agente Digitalizador SL | Agente Digitalizador SL | Traspaso saldo proveedor subvención Kit Digital 2023/.../... para conciliar el pago de facturas |   |   |   | 0,00 |   | 1.997,00 € | 0,00 € | 05/07/2023
|430041 ENTIDAD PÚBLICA EMPRESARIAL RED.ES | ENTIDAD PÚBLICA EMPRESARIAL RED.ES | Traspaso saldo proveedor subvención Kit Digital 2023/.../... para conciliar el pago de facturas |   |   |   | 0,00 |   | 0,00 € | 1.997,00 € | 05/07/2023

 [SEP] Hola, Miquel, lo que pones es de cara a la empresa receptora del KD, ¿verdad? El que vaya a la cuenta 4300 no me cuadra. @AlbertCabedo te has encontrado con este caso? [SEP] @pedrobaeza si, esto es para la empresa receptora del KD.

Por lo que nos ha explicado nuestra gestoría, hay que tener en cuenta que existen dos movimientos:
- La empresa que solicita el KID obtiene una subvención de 2.000€ de la ENTIDAD PÚBLICA EMPRESARIAL RED.ES. Por tanto, a efectos prácticos, RED.ES es un deudor (de ahí la 4300, que en este caso sirve de cuenta puente) que le debe 2.000€ de una subvención a la empresa. Por eso yo hago una factura en el diario de subvenciones y le pongo impuesto S_SUB
- El agente digitalizador, el proveedor de servicios, que hace una factura a la empresa por 2.000€ + IVA, como es un activo digital hay que imputarlo a la 206

El IVA no es subvencionable y hay que pagarlo al proveedor, en cambio los 2.000€ que cuesta el KD los cobra el agente directamente de red.es al presentar la justificación. Por tanto, la factura del cliente RED.ES hay que cuadrarla contra la base de la factura de proveedor del agente y de aquí el asiento de la 4100 contra 4300, para conciliar ambas facturas y marcarlas como pagadas.

Esto pasará en las subvenciones en que el proveedor cobra directamente la subvención concedida a la empresa, sin que la empresa vea el dinero en su cuenta bancaria. [SEP] Yo creo que no debe ir contra la 4300, si no que con una cuenta de subvenciones, y también el que tiene que declarar el KD en el 347 en todo caso es el agente digitalizador, no el cliente final, pero a ver si algún otro fiscalista/contable nos puede decir. [SEP] Hola,

Nosotros tras varias consultas a Hacienda no han explicado que el agente declara normal y el beneficiario declara normal pero a más a más debe de poner las bases de los kits digitales en la casilla 120 contra el Ministerio de Asuntos Económicos y Transformación Digital

> El 4 mar 2024, a las 20:13, Pedro M. Baeza ***@***.***> escribió:
> 
> 
> Yo creo que no debe ir contra la 4300, si no que con una cuenta de subvenciones, y también el que tiene que declarar el KD en el 347 en todo caso es el agente digitalizador, no el cliente final, pero a ver si algún otro fiscalista/contable nos puede decir.
> 
> —
> Reply to this email directly, view it on GitHub <https://github.com/OCA/l10n-spain/issues/3451#issuecomment-1977282116>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/ABPMFVRMIVEZ2PNIH3QIYQTYWTBWVAVCNFSM6AAAAABDY4B52WVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTSNZXGI4DEMJRGY>.
> You are receiving this because you are subscribed to this thread.
> 

 [SEP] Hola, Josep, ¿la casilla 120 de qué? [SEP] Del modelo 347

> El 5 mar 2024, a las 9:21, Pedro M. Baeza ***@***.***> escribió:
> 
> 
> Hola, Josep, ¿la casilla 120 de qué?
> 
> —
> Reply to this email directly, view it on GitHub <https://github.com/OCA/l10n-spain/issues/3451#issuecomment-1978195316>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/ABPMFVXO7RWUSY5T5M6SUETYWV6BZAVCNFSM6AAAAABDY4B52WVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTSNZYGE4TKMZRGY>.
> You are receiving this because you commented.
> 

 [SEP] Pues me temo que no sé de lo que hablas, ya que en el modelo 347, hasta donde sé, no hay casillas numeradas (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos/347.pdf) [SEP] Disculpa, me liado de 120.
Se debe de añadir un registro de la siguiente forma según lo nos explicaron en Hacienda.

El Agente lo declara normal
El Beneficiario declara normal la facturas del agente y añade un registro contra el Ministerio por la base total de las ayudas.

￼

> El 5 mar 2024, a las 9:49, Pedro M. Baeza ***@***.***> escribió:
> 
> 
> Pues me temo que no sé de lo que hablas, ya que en el modelo 347, hasta donde sé, no hay casillas numeradas (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos/347.pdf)
> 
> —
> Reply to this email directly, view it on GitHub <https://github.com/OCA/l10n-spain/issues/3451#issuecomment-1978241013>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/ABPMFVTO5ZWWZM3HRWL44E3YWWBJZAVCNFSM6AAAAABDY4B52WVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTSNZYGI2DCMBRGM>.
> You are receiving this because you commented.
> 

 [SEP] @pedrobaeza respecto a quién debe declarar la subvención en el 347, en todas las subvenciones es el beneficiario de la subvención. En el caso el KD, cuando entras en el portal, ahí pone que el beneficiario es la empresa que recibe los servicios del agente digitalizador.


![image](https://github.com/OCA/l10n-spain/assets/1849488/45efe6c7-ae50-44fd-ad31-464e3c597b69)


Las condiciones que estipula red.es para recibir el KD es que los servicios a contratar deben ser realizados por un agente digitalizador. Pasa lo mismo con los cupones de industria 4.0 u otras subvenciones en las que la empresa beneficiaria está obligada a gastarse el dinero en unos proveedores certificados en las competencias para las que se ha solicitado la subvención.

Por tanto quién debe declarar la subvención en el 347 es la empresa que recibe el dinero, y además debe activarla en sus cuentas y declarar el ingreso en las 740 o 746. El KD es un poco complejo porqué el ingreso que se debe declarar es la parte amortizada. En otras subvenciones es más sencillo, por ejemplo los Next Generation que no son amortizables, deben declararse todo el importe recibido en el año en curso (criterio de caja) como un ingreso, aunque debe activarse el total recibido. Por ejemplo si se reciben 100k para un proyecto de 2 años, el primer año se activan los 100k, pero se declaran 50k de ingreso.


Respecto la 4300, eso mejor un fiscalista, porque aunque el nuestro nos ha dicho que no está mal hecho, no es muy ""elegante"", a lo mejor hay quien tiene una mejor fórmula para hacerlo. Hablando con otras empresas que se dedican mucho a subvenciones, nos han comentado que ellos también tienen un diario de subvenciones, aunque no crean facturas como tales, pero sí imputan ahí los movimientos.

En cualquier caso, coincido en que es necesario un tipo de impuesto S_SUB que recoja los importes de las subvenciones en el 347. [SEP] OK, creo que queda bastante claro y documentado en este hilo. A ver si alguien recoge el testigo y se pone hacerlo. Si no, esto podría ser una tarea para los Spanish OCA days de Tenerife en mayo. [SEP] There hasn't been any activity on this issue in the past 6 months, so it has been marked as stale and it will be closed automatically if no further activity occurs in the next 30 days.
If you want this issue to never become stale, please ask a PSC member to apply the ""no stale"" label."
Issue,3450,"El contacto hay que definirlo correctamente:

![image](https://github.com/OCA/l10n-spain/assets/7165771/bcbf71bb-94ae-4f5b-9e54-8174e7d5f4f8)
 [SEP] Hola, disculpa @pedrobaeza como se decía al abrir el hilo facturae solicitan nombre y APELLIDO aún habiéndolo marcado como ""individual"" (previamente ya habíamos probado esto que comentas). Cuando seleccionas ""Individual"", tal y como se muestra en tu captura, sigue sin aparecer un campo donde añadir el apellido. 
Hemos probado a añadir ambos datos en el mismo campo pero el odoo no es capaz de separarlo. ¿Existe alguna solución?
 [SEP] Instalar `partner_firstname`."
Issue,3449,
Issue,3448,"@xabispacebiker Nos acabamos de encontrar con este error y esa librería de js que genera el fichero en el TPV es una muerte, ¿has dado con la solucion? gracias [SEP] Buenas @omar7r , Finalmente pudimos identificar el problema en el proceso de generación de facturas TicketBAI que ocurría bajo ciertas condiciones, como la pérdida de conexión a internet o una alta carga del sistema. Este problema se debía a una ""race condition"", donde múltiples procesos intentaban generar un número de factura al mismo tiempo. Como resultado, el mismo número de factura podía ser asignado a diferentes facturas, causando errores al enviar los datos a la agencia tributaria.

Para resolver este problema, hemos implementado un mecanismo para evitar la generación concurrente del mismo número de factura. Esto es lo que hicimos:

1. Introducción de un flag: Añadimos un flag (isGeneratingInvoice) para rastrear si un proceso de generación de factura ya está en curso.
2. Control de acceso: Antes de iniciar el proceso de generación de la factura, el sistema verifica este flag. Si ya se está generando una factura, el nuevo proceso esperará hasta que el actual termine.
3. Reinicio del flag: Una vez que la generación de la factura se completa, el flag se reinicia, permitiendo que el siguiente proceso continúe.
4. Control de errores: Mejoramos el control de errores para asegurar que el flag se reinicie incluso si ocurre un error durante el proceso de generación de la factura.

Por el momento parece que el error se ha corregido. [SEP] Muchas gracias por la respuesta ¿no tenéis ese parche público o? habrá que mirar de hacer algo así, probé con el módulo de multidispositivos y de inicio parecía que no podía replicar el problema forzando la caída y recuperación de la conexión como antes y pensé que ya no sucedía, pero nada, sigue sucediendo y no logro encontrar el nuevo patrón para replicarlo... [SEP] @xabispacebiker saludos. ¿Como ha ido finalmente el fix? ¿Alguna posibilidad de compartirlo con la comunidad?"
Pull Request,4799,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out!"
Pull Request,4798,"Parche directo

/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4798-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4798-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4798-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/a91c57db7e96f1872d6b9510035c50dd2bcc5272).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red."
Pull Request,4797,
Pull Request,4796,"Gracias por la corrección @carlosdauden 
Parece que ahora que se envían las rectificativas como tal el test no pasa porque el test no estaba bien planteado.

<img width=""3769"" height=""1714"" alt=""image"" src=""https://github.com/user-attachments/assets/0ee2c39d-04e7-4f82-b508-d28c5b8504bf"" />

¿Puedes corregir el test y aprobamos.?"
Pull Request,4795,"This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4795-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4795-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at cc83ac9a2c90e99484f2f4a34d740a769ba2d5e7. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4794,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/48b6018d3c0a48eba89506a3ee81d431e05b8f74).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/860ac56e39bde542cc39caa5e1f5921754f4a0c8).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4794-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 391a4f5fb86090dd94aed568c95023db035cde68. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4792,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4792-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4792-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 835942345db56aefbb77af1f1c43e6e5d94b3990. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4791,"Hi @EmilioPascual, @Andrii9090, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/5c3cff50b276156a971fa0f627136c4303e833fb).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4791-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 906962409a0b86583388ebf9b3eee7253cf4052e. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4790,"On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/2ece3f2750f19de0803110dfffce85f8c1127db3).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4790-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/577885ceea1282e10c33c1f8b4722f3701e6d4ac).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red."
Pull Request,4789,"What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4789-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4789-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b385ffae3cbdc3d19e5bf1762c9ca0f747d0bce6. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4788,"Listo, lo he añadido a la constrain para que salte también si lo añadieran en la compañía directamente [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/0e09b28007c5334c3d9316551b4ecedacbf7553d).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4788-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 4819579f190a945a6c78cb7d9468832edc996f71. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4787,
Pull Request,4786,"Hi @nicolasramos,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4786-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4786-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 8c3a8703afbdf736eabd820cb4ccbe22f27125c9. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4785,"Hi @nicolasramos,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4785-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4785-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9fe183b73261cc10acb65dd253a0de0abbacf898. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4784,"En este caso, como son pocos cambios, creo que se podrían codificar en la misma configuración de exportación BOE con una fórmula similar a `object.convocation_bdsn if year > 2023 else """"` [SEP] > En este caso, como son pocos cambios, creo que se podrían codificar en la misma configuración de exportación BOE con una fórmula similar a `object.convocation_bdsn if year > 2023 else """"`

Lo intenté así, pero el nuevo campo es númerico y si es antes de 2023 tendría que poner espacios en blanco pero un campo númerico te pondrá 0. Si le fuerzas a que ponga los espacios en blanco saltará un error que un campo numérico no puede poner un string. [SEP] Pero aunque sea numérico, puedes poner que en el formato BOE sea texto, y te convierte el número y ya está. De hecho, no sé si deberías poner `fields.Integer` o `fields.Char` en el campo, porque muchas veces acostumbran a poner un 0 delante, y eso lo quitaría siendo integer. [SEP] > Pero aunque sea numérico, puedes poner que en el formato BOE sea texto, y te convierte el número y ya está. De hecho, no sé si deberías poner `fields.Integer` o `fields.Char` en el campo, porque muchas veces acostumbran a poner un 0 delante, y eso lo quitaría siendo integer.

Tenías razón, pasandolo a `char` se ha reducido bastante. Gracias por el aporte. ¿Puedes volver a echarle un ojo? [SEP] Error en los tests de facturae [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4784-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4784-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at bef87df366d00c757008e85feb707859f084a39d. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4783,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hola @desagia ,

Por favor, tienes que hacer un PR para cada módulo.

Y verifica que pasan todos los test.

¡Muchas gracias!

Saludos"
Pull Request,4782,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out!"
Pull Request,4781,
Pull Request,4780,"@mbaena ya me avisas cuando esté para revisar [SEP] @pedrobaeza listo para revisar
Ya lo estamos utilizando en producción para el modelo 190 (ejercicio 2025), sin incidencias hasta ahora. [SEP] Hola, @mbaena, disculpa si no me he expresado bien. No quería que el formato de 2025 lo convirtieras a XML, si no que no cambiaras el de 2017. El de 2025 por supuesto que puede quedarse en CSV y que ya vaya de la ""forma nueva"" más eficiente. Es no tener que convertir el anterior formato a CSV, ya que el mismo está en XML. [SEP] hola, @pedrobaeza creo que esto era lo que indicabas, mantener XML anterior e incorporar nuevo en CSV. Probado en real.  [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4780-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4780-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at b14f68f26743cc47e70e4413aea587b0556583f8. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4779,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4779-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4779-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6dd2d21f10fdd6871202be5503bb088d29f278b3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4778,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4778-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4778-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ade22074857513c175aea049022f0d5b8365b85e. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4777,
Pull Request,4776,"Hi @EmilioPascual, @Andrii9090, @rafaelbn,
some modules you are maintaining are being modified, check this out!"
Pull Request,4775,"Hi @Andrii9090, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] Buenas tardes @EmilioPascual como nos habían dicho que no tenían pensado incorporarlo ya estábamos realizado la implementación de la Página 12 en https://github.com/OCA/l10n-spain/pull/4776. Estábamos pendientes de que el cliente subiera el fichero a la AEAT para proponerlo y ha pasado sin problema con múltiples actividades"
Pull Request,4774,"@HaraldPanten @pedrobaeza  [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch), awaiting test results. [SEP] It looks like something changed on `18.0` in the meantime.
Let me try again (no action is required from you).
Prepared branch [18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4774-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a67f120b425499f87df1dcdcb4da193417c157c0. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4773,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] > Esos impuestos ya están presentes en otras casillas, como por ejemplo el `p_iva4_sp_ex` en la 190 y 191, así que dudo que vayan ahí. Además, por el nombre, parecen ser de exportación, no de ISP.

La casilla 523 es una casilla de caracter puramente informativo o estadístico. Está englobada en la sección 11. Operaciones específicas el cual tiene el siguiente apunte:

<img width=""629"" height=""98"" alt=""image"" src=""https://github.com/user-attachments/assets/4d09c35f-738f-4922-970f-071af0ec5f77"" />

Según entiendo la casilla 523 es igual que la casilla 27 pero incluyendo sólo los servicios. [SEP] A ver si @AlbertCabedo o @acysos nos puede confirmar, pero lo dicho, el impuesto `p_iva4_sp_ex` no tiene pinta de ir ahí. [SEP] Ahora veo #4771 de nuevo y efectivamente ahí está metido ese impuesto bajo el epígrafe `IVA devengado en otros supuestos de inversión del sujeto pasivo`, con lo que sí es ISP, pero la cuestión es si aquí va también lo mismo, o lo del artículo 84 son otros supuestos. [SEP] La casila 27 y 28 también también vienen bajo el supuesto del articulo 84.
<img width=""962"" height=""130"" alt=""image"" src=""https://github.com/user-attachments/assets/ddc622db-6ac9-427d-9791-f1ed8527d31b"" />
Lo único que aquí especifica también el 4º que tiene que ver con la entrega de gas, electricidad, ... según https://www.boe.es/buscar/pdf/1992/BOE-A-1992-28740-consolidado.pdf
<img width=""907"" height=""219"" alt=""image"" src=""https://github.com/user-attachments/assets/b87bf8ef-f094-4a39-bc94-2918421f8a57"" />
Creo que esto último no influye para el mapeo de los impuestos de la casilla."
Pull Request,4772,"@HaraldPanten could u review? thanks 😸  [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch), awaiting test results. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4772-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5a70778400a2712ca097c6344c0e71b1a7783ea7. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4771,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] ¿Qué caso de impuesto tiene valores en otra cuenta contable? [SEP] Todos los impuestos en la casilla 28 tienen la cuenta 472 y la 477 menos p_iva0_ic_sc. Si lee la 472, estáría cogiendolo del IVA deducible, algo incorrecto. Además si tienes prorrata la cantidad será incorrecta. En cuanto al p_iva0_ic_sc no tiene ninguna cuenta, pero como el porcentaje es 0, no está generando cuota. [SEP] Vale, el título me despistó que pusiera 347. Es el 390... Cámbialo, por favor. [SEP] > Vale, el título me despistó que pusiera 347. Es el 390... Cámbialo, por favor.

Si, perdón, estoy trabajando también en el nuevo modelo de registro del 347 y se me fue la cabeza. Gracias por el apunte. [SEP] Ahora has puesto 349, pero es el 390 :wink:  [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4771-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4771-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9983791d08b480de1482eaf3f04de2f414fcffc6. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4770,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hola,

Las casillas 60 y 61 es solo para las compensaciones, la rectificativas o deducciones por rectificación van a la siempre a las casillas 639 y 62, aunque sean del régimen especial de agricultura, ganadería y pesca. 

https://sede.agenciatributaria.gob.es/static_files/Sede/Procedimiento_ayuda/G412/Instrucciones_modelo_390-2025.pdf

Necesitamos una consulta vinculante con AEAT que indiquen ellos que se puede poner con símbolo negativo en las casillas 60 y 61, ya que estas casillas solo aceptan símbolo positivo.

Saludos [SEP] Hola,
Tiene todo el sentido lo que indica @acysos, gracias por la aclaración. La mejora propuesta del Modelo 390 está basada en cómo se gestionan las compensaciones del REAGP en el Modelo 303, donde todas las compensaciones se agregan en la casilla 42, según el mapeo actual:

https://github.com/OCA/l10n-spain/blob/163c6de6b6329c766d37aaebd590afa051bb4658/l10n_es_aeat_mod303/data/2024-10/l10n.es.aeat.map.tax.line.csv#L38

El problema que habíamos detectado es un descuadre entre los totales del Modelo 390 y lo declarado en los modelos 303, ya que la implementación actual del 390 no estaba teniendo en cuenta las rectificaciones.
"
Pull Request,4769,"This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4769-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4769-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b1c99e6fa3f6599f03f2643884399d5e45c46d9d. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4768,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out!"
Pull Request,4767,"@christian-ramos-tecnativa puedes por favor mirar el error de `l10n_es_pos_sii`. [SEP] Arreglado en https://github.com/OCA/l10n-spain/pull/4769 [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4767-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4767-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 163c6de6b6329c766d37aaebd590afa051bb4658. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4766,"What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4766-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4766-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at d10f01df85b9a9610eb7286cfd41b23dd26ee50b. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4765,"Hi @EmilioPascual, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] Estoy a favor de la comprobación, pero no me gusta nada hacer cosas que modifiquen la factura durante la validación. Ya que estás validando una factura que consideras correcta pero luego puede presentar datos distintos y esto puede confundir al usuario. ¿No podríamos transformarlo en un raise directamente? Indicando en el error que pasando la factura a cancelado y a borrador de nuevo debería generar el vat correctamente [SEP] He cambiado el código, ahora 
 - si la empresa tiene prorrata configurada,
 - si las líneas de factura están sujetas a prorrata,
 - si los impuestos de la factura tienen `with_vat_prorate=True`
 - si no existe ninguna línea de apunte contable correspondiente a la prorrata.
En caso de cumplirse estas condiciones, salta un raise

Además, he establecido el campo `with_vat_prorate` de account.move.line como readonly en el caso de prorrata general, para evitar que el ORM lo establezca a False por defecto durante el cálculo de las líneas de prorrata.

@EmilioPascual puedes revisar de nuevo?"
Pull Request,4764,"Great! [SEP] exacto, al ser `report.${nombre del report}`, Odoo lo coge automáticamente. [SEP] Anda, esas ""black magic""...

Pon porfa un comentario al lado de la línea `_name` para recordar eso. [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/757e772df85ebb73470600c9a38952d2135229f7).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/9ad35743e515b1e909db67100bb21c6ae9d66043).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4764-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at f4fa261ef499c55a9b4de78e119da7c996b0a0a9. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4763,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] ping @Bilbonet @luciaavanzosc @oihane @mariancuadranetkia [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4763-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4763-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ff164db495c98271469173900f3fab8049da0b2f. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4762,"@Shide puedes revisar este fix, ya que según parece, lo introdujiste tú? [SEP] @EmilioPascual @ArantxaSudon porfa, echadle un ojo [SEP] @moduon MT-13491 [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4762-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4762-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 26f707d16e71b36049f4383ecbaf7a1c4d2678f6. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4761,"> ¿No habría que cambiar el `freeze_time` de los tests para poner 2026?
> 
> https://github.com/OCA/l10n-spain/blob/163c6de6b6329c766d37aaebd590afa051bb4658/l10n_es_atc_mod417/tests/test_l10n_es_atc_mod417.py#L572

Esta actualización es por trimestre, no es por cambio de año aún, a diferencia de la actualización en el PR https://github.com/OCA/l10n-spain/pull/4757 donde sí tengo que cambiar la fecha de los test, porque ahí el JAR valida el año. Imagino que en una próxima actualización, donde sí cambie el año, ahí sí se debe cambiar en los test, pero ahora no es necesario. [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4761-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4761-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3aac26c68dfae7b98b9e9d9b1a07ee37f83aa884. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4759,"On my way to merge this fine PR!
Prepared branch [15.0-ocabot-merge-pr-4759-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4759-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 4c3b798da72d7ba3c88466afd69721cab129dc27. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4758,"@eantones, can you please review it?

 [SEP] @deeniiz also the CI is red, please check it out."
Pull Request,4757,"Hi @nicolasramos,
some modules you are maintaining are being modified, check this out!"
Pull Request,4756,"El modelo se calcula para una sola compañía, no para varias, por lo que no entiendo el parche."
Pull Request,4755,"@pedrobaeza Puedes revisar el pr y si esta correcto le puedes dar el aprobado para que se fusione lo antes posible [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4755-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4755-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 1ab4e2fa97731392287419e900d86c27c31fe9e9. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4754,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Habría que comprobar si esto tiene algún efecto lateral fuera del SII. Creo recordar que el 349 también utiliza esto. [SEP] Por lo que he comprobado del 349 se fuerza el `country_code` (que actualmente devuelve EL) y se pasa por la función `_map_aeat_country_code` nuevamente, con este cambio no sería necesario, ya que sería `GR` desde la primera llamada. Además en los tests del 349 tiene partner con país Grecia, por lo que habría saltado el CI en caso de que este cambio le afectara.
https://github.com/OCA/l10n-spain/blob/36eda0438efb096ed8c040418fd10893a0e3fe1c/l10n_es_aeat_mod349/models/mod349.py#L432-L440
https://github.com/OCA/l10n-spain/blob/36eda0438efb096ed8c040418fd10893a0e3fe1c/l10n_es_aeat_mod349/tests/test_l10n_es_aeat_mod349.py#L365-L367 [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4754-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4754-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ce7d74ffb8bbaff47df4c546c264726aeff554e8. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4753,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] Fusiono en base a las reviews existentes.

/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4753-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4753-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 2294e946f91bb5df26b363517db55bd49f28fa0b. Thanks a lot for contributing to OCA. ❤️ [SEP] Llévalo por favor a 18"
Pull Request,4752,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch), awaiting test results. [SEP] It looks like something changed on `18.0` in the meantime.
Let me try again (no action is required from you).
Prepared branch [18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4752-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at fc53612c021bc816bedecdf6d3a6b76db0afb0d2. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4751,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] <img width=""1327"" height=""671"" alt=""image"" src=""https://github.com/user-attachments/assets/4d4551c7-e2e5-4def-b7bc-9d2b023af8e8"" />
 [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] @pedrobaeza se podría mergear este? o faltaría revisar algo? [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4751-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4751-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 1802baf4b9001442537a69d23e0b3532ea257c5d. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4750,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] <img width=""1327"" height=""671"" alt=""image"" src=""https://github.com/user-attachments/assets/33baccee-6dff-4dde-944e-3e839631c190"" />
 [SEP] @luciaavanzosc @oihane pueden dar un poco más de contexto @Bilbonet. [SEP] Lo han empezado a validar en Álava y falla sino se cambia. LGTM [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [14.0-ocabot-merge-pr-4750-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/14.0-ocabot-merge-pr-4750-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at fd23732dee3a31ea7772a96ec338789f5a4b60df. Thanks a lot for contributing to OCA. ❤️ [SEP] @omar7r habrá que revisar si sólo es Araba"
Pull Request,4749,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] LGTM!"
Pull Request,4748,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4748-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4748-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at bac2dc70f1955137d9948f68d27f3d7341fd9f9c. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4747,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4747-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4747-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at df3a1d3bcc22fec63757ca9ec8b7808affc1a48e. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4746,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/1c888ca4dd9e0c7833ad4738054e1a047b3ab303).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4746-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 36eda0438efb096ed8c040418fd10893a0e3fe1c. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4745,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4745-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4745-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @EmilioPascual para la próxima, recuerda añadir la nueva configuración al test para así evitar sorpresas y regresiones. [SEP] Congratulations, your PR was merged at 7e013beb6fdbd6e13da0d148d77b65a6f35185bf. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4744,"/ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [15.0-ocabot-merge-pr-4744-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4744-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at d0c1b0c0a53259c576191e91e5d8fc52b4aa34a3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4742,"@eduezerouali-tecnativa revisa bien el backport, que en el Excel salen mezclados los datos en columnas que no corresponden.

<img width=""2347"" height=""210"" alt=""image"" src=""https://github.com/user-attachments/assets/021bba9f-964b-4acc-9a2d-8731fe549d72"" />
 [SEP] @pedrobaeza 
<img width=""1756"" height=""194"" alt=""Selección_054"" src=""https://github.com/user-attachments/assets/9b9c0c10-e077-4224-bb96-0e9c41e1a173"" />
He hecho una prueba en local y se ejecuta bien, cosa que en runboat no. El commit esta con los ultimos cambios. [SEP] /ocabot merge minor [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4742-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4742-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at c0f1aad097c803f2e808c007629328a97cb1d6b3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4741,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4741-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4741-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 3af0494a8327b8903808c4ca24b9c8587a4f6697. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4740,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor), awaiting test results. [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4740-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 73dec24922ef39c6f9b3d4b40b7dc1e81dcf5319. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4739,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4739-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4739-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3dcd8a1e2c0454ef1641fdf9b1d6260056267108. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4738,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/ecaacf055c3a0b9c71e474fc9db9e653b10e95d4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/e3b9a06d5917ac9c41155c4be84491c429bbae84).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4738-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b85bd887eea3f65f39d58892b1e8f3a52ac8830b. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4737,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR looks fantastic, let's merge it!
Prepared branch [19.0-ocabot-merge-pr-4737-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/19.0-ocabot-merge-pr-4737-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9bf2a1d793c262765735f5c68b3a6549cf3bd39d. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4736,"This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4736-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4736-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at e936d3af1229c954d2450bed3d4fc49755b40915. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4735,
Pull Request,4734,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/a506c1c4022a9aa9fb138bebb7da1abb4a5c277e).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4734-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 889ffbd41b2a65471674d8901223740a8b0f3689. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4733,"What a great day to merge this nice PR. Let's do it!
Prepared branch [15.0-ocabot-merge-pr-4733-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4733-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 51b348ea328d20bb6d903d76c7dad24016d3fd55. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4732,"Hi @pedrobaeza, @victoralmau,
some modules you are maintaining are being modified, check this out! [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4732-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4732-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9f474d3896f86b697a368da4e1bd1699cb7e12b9. Thanks a lot for contributing to OCA. ❤️ [SEP] @christian-ramos-tecnativa ¿Puedes hacer backport a 17.0?"
Pull Request,4731,"This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4731-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4731-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6aedd2a4047a29fb9b247fef4a245df469dacf25. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4730,"What a great day to merge this nice PR. Let's do it!
Prepared branch [15.0-ocabot-merge-pr-4730-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4730-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a296b02aa14c9a5d1039449e3fab1d2f77eb334c. Thanks a lot for contributing to OCA. ❤️ [SEP] ¿Hace falta en 16.0? [SEP] Sí, en el PR 4736 he mirado de corregir los tests KO en este módulo..."
Pull Request,4729,"This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4729-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4729-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at dbe00155799ffd353dad1a29a007c600da4aedb8. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4728,"On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4728-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4728-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 0ba76c2742d8add304d1abad7d939af770a1c3ff. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4727,/ocabot migration l10n_es_aeat_mod390
Pull Request,4726,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4726-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4726-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a24b63c6f5e85cdf3aea31dd4062561a0fe28f8e. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4725,
Pull Request,4724,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4724-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4724-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cd45131687afe7a1176cb11215196ecd0cc2b3a3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4723,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4723-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4723-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4723-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/5825061e9d4cbc740e3cba7736274c3ae51c164e).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4723-by-HaraldPanten-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4723-by-HaraldPanten-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5f8058ce57c2ecae5d263e35ae6477d8d574c437. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4722,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4722-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4722-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 8c4438c6968603fe10bdd6c845f107a4db2da844. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4721,"/ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4721-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4721-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at b6d43e3ed757a88f07121c32edb1244440dd4530. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4720,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4720-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4720-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 2dc85b4542fb019d0004520ffd4a7e310b81e203. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4719,"Ídem que el de 16. Las columnas del Excel no coinciden. [SEP] ping @pedrobaeza  [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4719-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4719-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at b560ee1fb9878cf7b3fd0aa674f5026a66652e23. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4718,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4718-by-etobella-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4718-by-etobella-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 04f115220f183bf968e3937620a3a44b8e0c0374. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4717,/ocabot migration l10n_es_aeat_mod347
Pull Request,4716,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @pedrobaeza 
Same https://github.com/OCA/l10n-spain/pull/4475
 [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4716-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4716-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5c39867f69b29795e62fe6f8e1f248f1332583d5. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4715,"/ocabot merge patch [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4715-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4715-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 182d65d390dedde920534a47770d757ffd385aab. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4714,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4714-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4714-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 00aa4a69f0c05465ffbdb3391c8e37b7aed3bc95. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4713,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4713-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4713-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 0024eb109f9b42c8d63b837b7ab030b9d9fe2bcc. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4712,
Pull Request,4711,"Los errores vienen de la migración a 18, cuando se paso del archivo `xml` a `csv`, los espacios en blancos no los reconoce sin las comillas, esto hace que en vez de añadir un espacio en blanco como indica el diseño de registro, se añada `False` dando error al subir el archivo a AEAT. [SEP] Cierro en favor de https://github.com/OCA/l10n-spain/pull/4718 que recoge los cambios para 2025"
Pull Request,4710,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @christian-ramos-tecnativa Changes done! [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4710-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4710-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 524dec78351172e3c4c06235f16ff5568a26aabc. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4709,"@eduezerouali-tecnativa ¿Puedes hacer backport a 17? [SEP] > @eduezerouali-tecnativa ¿Puedes hacer backport a 17?

Si está previsto hacer backport a 16 y 17 [SEP] > Un detalle más: el periodo de deducción sí que se puede escribir, y se obtiene de la fecha contable de la factura, aunque habría que añadir un dato extra a nivel de libro de IVA: si la liquidación es trimestral o mensual.

Entonces habría que añadir `vat_settlement_period` a nivel de `l10n.es.vat.book`. Y el cálculo sería, en el caso de liquidación mensual, añadir los 30 días naturales, y en el caso de liquidación trimestral, comprobar a qué trimestre corresponde y poner la fecha del último día del trimestre. [SEP] Sí, se añade ese campo, y sería poner dentro de qué toca: el año en el ejercicio, y si es mensual, pues el mes en periodo (01, 02...), y si es trimestral, pues 1T, 2T, 3T, 4T. [SEP] Hay ejemplos en `l10n_es_aeat*` que lo calcula de manera elegante. [SEP] Lo reviso y lo añado. [SEP] ping @pedrobaeza  [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor), awaiting test results. [SEP] muchas gracias!!! pues testeado y ok a merge [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/1a0929b73bfa232b7e250fc7c924766591847a1b).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4709-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 3ddc7f91efa7e578fe6249cfb497d3d24a1ec08d. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4708,
Pull Request,4707,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Ya están todos los puntos comentados, en cuanto al PR que realizaste para `l10n_es_pos_sii` me ha parecido que los campos en este están bastante preparados con los `invisible` y `readonly` donde toca. Déjame saber si echas alguno en falta [SEP] A que te refieres con 

> las nuevas etiquetas acortadas.

@pedrobaeza? [SEP] Mira en el otro PR cómo en la vista se ponen string acortadas sin el término SII."
Pull Request,4706,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Gracias por el PR! 👍

Siguiendo el feedback de @pedrobaeza, aquí va una propuesta de refactorización que acumula los paths y los valida una sola vez:

```python
@api.model
def get_certificates(self, company=None):
    if not company:
        company = self.env.user.company_id

    aeat_certificates = self.search([
        (""company_id"", ""="", company.id),
        (""public_key"", ""!="", False),
        (""private_key"", ""!="", False),
        ""|"",
        (""date_start"", ""="", False),
        (""date_start"", ""<="", fields.Date.today()),
        ""|"",
        (""date_end"", ""="", False),
        (""date_end"", "">="", fields.Date.today()),
        (""state"", ""="", ""active""),
    ])

    if aeat_certificates:
        # Acumular archivos faltantes
        missing_files = []
        for aeat_certificate in aeat_certificates:
            public_crt = aeat_certificate.public_key
            private_key = aeat_certificate.private_key
            if not os.path.isfile(public_crt):
                missing_files.append(_(""Public certificate: %s"") % public_crt)
            if not os.path.isfile(private_key):
                missing_files.append(_(""Private key: %s"") % private_key)

        # Validar una sola vez
        if missing_files:
            raise exceptions.UserError(
                _(""Error! The following certificate files were not found:\n%s"")
                % ""\n"".join(missing_files)
            )

        return (
            aeat_certificates[0].public_key,
            aeat_certificates[0].private_key,
        )
    else:
        # Fallback a parámetros de configuración
        ICP = self.env[""ir.config_parameter""].sudo()
        public_crt = ICP.get_param(""l10n_es_aeat.public_key"", False)
        private_key = ICP.get_param(""l10n_es_aeat.private_key"", False)

        if not public_crt or not private_key:
            raise exceptions.UserError(_(""Error! There aren't certificates.""))

        # Paths por defecto (instalaciones nuevas)
        default_paths = (
            ""/opt/certificates/publicCert.crt"",
            ""/opt/certificates/privateKey.pem"",
        )

        missing_files = []
        if public_crt not in default_paths and not os.path.isfile(public_crt):
            missing_files.append(_(""Public certificate: %s"") % public_crt)
        if private_key not in default_paths and not os.path.isfile(private_key):
            missing_files.append(_(""Private key: %s"") % private_key)

        if missing_files:
            raise exceptions.UserError(
                _(""Error! The following certificate files were not found:\n%s\n\n""
                  ""Please configure a valid certificate through ""
                  ""Settings > AEAT > Certificates"")
                % ""\n"".join(missing_files)
            )

        return public_crt, private_key
```

**Ventajas de este enfoque:**
- ✅ El usuario ve **todos** los archivos faltantes de una vez (mejor UX)
- ✅ Evita múltiples `raise` dispersos
- ✅ Código más mantenible y DRY
"
Pull Request,4705,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4705-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4705-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a4ff6c54d1f80c3284fdc94228710a5f196db037. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4704,"Hi @pedrobaeza, @victoralmau,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/ad0fd5a3581e1b26937dfb0fcbd93a06d1074b36).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/9d2f4cb0b643e83136f6c430d0ba02b2412863f6).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] Hice rebase para reiniciar los tests. @pedrobaeza puedes intentar fusionar de nuevo?  [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/ad803b8cfc4f88662195aab5518215738ecf37fe).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4704-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5e90b6f39949e32d5089f2ce5436767f6ea5ebb4. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4703,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out! [SEP] @hildickethan 
can you merge this pr?
It's the same than #4210 , #4209 and #4208  [SEP] ideally wouldnt merge with failed tests but it looks unrelated so should be ok

/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [15.0-ocabot-merge-pr-4703-by-hildickethan-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4703-by-hildickethan-bump-patch), awaiting test results. [SEP] El bot no lo va a fusionar si está en rojo. Dará error. [SEP] tenia esperanzas de que era algo puntual de conexión, pero si falla entiendo que habría que hacer backport de estos cambios que refactorizan los tests y asumo que arreglan el problema https://github.com/OCA/l10n-spain/pull/4548 [SEP] @hildickethan your merge command was aborted due to failed check(s), which you can inspect on [this commit of 15.0-ocabot-merge-pr-4703-by-hildickethan-bump-patch](https://github.com/OCA/l10n-spain/commits/c1ea7ce283918d6a61edb96fa5150e5eb5f103df).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] @mariancuadranetkia fallan los tests por algo del módulo de verifactu
<img width=""1253"" height=""168"" alt=""imagen"" src=""https://github.com/user-attachments/assets/0fe71869-043a-4786-8c59-70aa5ffab96d"" />
no pasa en las otras versiones por lo tanto seguramente será algo que habrá que hacer backport [SEP] @hildickethan he estado revisando, pero de momento no he tenido mucho éxito. He probado incluso comparando con versiones más nuevas, pero aún no he dado con 'la tecla'. 
Hasta el jueves no podré volver a mirarlo, pero lo volveré a revisar por si tuviera más suerte.

Gracias a ambos! [SEP] Generado PR #4730 [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [15.0-ocabot-merge-pr-4703-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4703-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6cd80df98bb766d4c7d92b0938ee899c43afe8b4. Thanks a lot for contributing to OCA. ❤️ [SEP] @mariancuadranetkia no hacía falta rebase en este caso, porque el bot ya lo hace, y como has hecho push después de lanzar el comando, ahora esto consta como closed en lugar de merged. En cualquier caso, está fusionado. [SEP] @pedrobaeza pensé que sería necesario y por eso lo hice, pero a la siguiente vez me aseguraré antes revisando o incluso preguntando si tal. Muchas gracias!"
Pull Request,4702,Waiting to merge this pull request: https://github.com/OCA/l10n-spain/pull/4526
Pull Request,4701,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out!"
Pull Request,4700,"Fusiono directamente para proceder a realizar las traducciones:

/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4700-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4700-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 1ff183d041f2ed09e937e5b71819a83635f529da. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4699,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4699-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4699-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 7a7a552b66a7c5d1bb428b7094049f3b2e432450. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4698,"Hi @Christian-RB,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4698-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4698-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6bfe0a426fc873ec61a9d984076344c81c3a6bfe. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4697,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4697-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4697-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 0f58f3c77ef2541921b91e11eb241b8cb6e8e50d. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4696,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4696-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4696-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 268afce573c36a58d9393e905fd4b6d65c15dbdb. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4695,"Hi @Christian-RB,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4695-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4695-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at c8d89ad439e6793fa8618dd76710b08e80b6b962. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4694,"Hi @Christian-RB,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4694-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4694-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 5f07ac229231c2d309f7071dad13e1dd21392792. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4693,"/ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4693-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4693-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ac3d26175131d56d9e2436a571016dbb6a102227. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4692,"@HaraldPanten @etobella y los demás usuarios del SII, qué os parece esta mejora? [SEP] Gracias Pedro,

Te decimos algo en breve, para revisarlo con un poco más de detalle 👍"
Pull Request,4691,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] Me comentan que han podido presentar 4T con el formato antiguo. ¿Puede ser que la actualización solo sea para 2026? [SEP] En Diciembre sacan 2 diseños de registro uno para el último período de 2025 y otro para 2026
<img width=""424"" height=""83"" alt=""image"" src=""https://github.com/user-attachments/assets/6d19f1b7-efcc-4182-aeb4-554217807fa9"" />
<img width=""689"" height=""171"" alt=""image"" src=""https://github.com/user-attachments/assets/09edcfeb-8f34-4ddc-8970-6b0c7da8d933"" />

Dentro especifica que el de 2026 (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos_26/DR303e26.xlsx) es a partir de 2026
<img width=""1029"" height=""42"" alt=""image"" src=""https://github.com/user-attachments/assets/b42f8546-b295-4b54-a481-63f9ff0b8b72"" />

Mientras que el del 2025 (https://sede.agenciatributaria.gob.es/static_files/Sede/Disenyo_registro/DR_300_399/archivos_25/DR303e25.xlsx) específica para el 2025 
<img width=""560"" height=""57"" alt=""image"" src=""https://github.com/user-attachments/assets/ccc91e3a-7555-4db9-87e0-0bcafbd6c3c4"" />

Nosotros hemos presentado los 303 con el formato nuevo del 2025 y en principio no está dando errores. He estado mirando si eran compatibles porque a lo mejor alguna variables si no llevan nada, rellena con ceros que es uno de los cambios, pero me parece insalvable el cambio en las longitudes de la página 2
<img width=""1059"" height=""553"" alt=""image"" src=""https://github.com/user-attachments/assets/59a5560c-15d7-4430-b7a6-b6258c95b8fa"" />

Puede que formato anterior del 2025 no haya quedado obsoleto. Es lo que tiene AEAT que no es muy claro.

Desde luego que este no es para 2026
 [SEP] Acabo de probar a exportar con los dos formatos y subirlos al pre-portal de AEAT con una declaración bastante completita, se ha tragado los 2 sin errores. [SEP] Acabo de ver por que ha sido, la página 2 y 5 están omitidas y en la página 1 que es donde están los cambios de este PR si el año es mayor a 2024 siempre se pone ""00000"".

Parece entonces que no hace falta crear una configuración para 2025 y se puede hacer con la que hay actualmente 2024-10. Cierro PR.

Todavía quedaría pendiente hacer las adaptaciones para el 2026"
Pull Request,4690,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4690-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4690-by-pedrobaeza-bump-minor), awaiting test results. [SEP] > Técnicamente tiene buena pinta. Ya es probarlo en casos reales a ver si sale algún problema, pero eso se puede hacer en PRs posteriores.

Hemos probado todo lo que hemos podido en el pre-portal de AEAT y ya hemos subido bastantes a producción sin error.
 [SEP] Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Congratulations, your PR was merged at e58fd456002db3847e57ba475c9bc0728b8ce6b6. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4689,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out! [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4689-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4689-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 31e1f31340496abc952a071f94949a79d4b8873e. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4688,/ocabot migration l10n_es_aeat_sii_match
Pull Request,4687,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/9f2e1a82959ab3a44abdf467b4258b229caf1dc8).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4687-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 516c0d00c7141e38648441f27faf8b5b9ebd3da3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4686,"Hi @hildickethan,
some modules you are maintaining are being modified, check this out! [SEP] > Entiendo que ocurriría lo mismo si usas la función de `gls_asm_send_pickup` sin que sea de tipo pickup pero como ese proceso es manual y el botón no sale si no es del tipo correcto, ese caso no debería ser un problema

Sí, estoy de acuerdo, crees que deberíamos poner el `UserError` en lugar del `continue`, para ser coherentes? [SEP] > Sí, estoy de acuerdo, crees que deberíamos poner el `UserError` en lugar del `continue`, para ser coherentes?

Si tienes tiempo estaría bien, por coherencia más que otra cosa y vendría bien si algun dia se ejecuta por código en lugar del botón [SEP] > > Sí, estoy de acuerdo, crees que deberíamos poner el `UserError` en lugar del `continue`, para ser coherentes?
> 
> Si tienes tiempo estaría bien, por coherencia más que otra cosa y vendría bien si algun dia se ejecuta por código en lugar del botón

Okay! Ahora he añadido esta parte [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4686-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4686-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6309db228e2244365fec56824471fd8fc4102758. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4685,"/ocabot migration delivery_gls_asm

A revisar CI."
Pull Request,4684,"@Jaimermaccione Fixed, could you please check again?
Thanks [SEP] @HaraldPanten this PR has passed functional and technical review. Could you please review and merge it?
Thanks [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4684-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4684-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at dfb5e3fb2a006eb6a7cd9f36e530ba77a21fcb45. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4683,"Hi @carlos-lopez-tecnativa,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4683-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4683-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Ciertamente, para mi tampoco tiene sentido... [SEP] Congratulations, your PR was merged at 446cd1a464862e154424ae21a9acea9d145ee062. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4682,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] @luciaavanzosc estoy trabajando en algunos issues en un cliente y veo que hemos enfrentado problemas comunes. En este caso en particular me pregunto desde el punto de vista del diseño ¿es valido que l10n_es_unique_id no tenga ningún valor? @Bilbonet 
"
Pull Request,4680,"/ocabot migration l10n_es_aeat_mod303 [SEP] @sbiosca-s73 ¿puedes añadir el siguiente fix?

*  #4748 [SEP] @dalonsod hecho!"
Pull Request,4679,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] @Bilbonet ¿podrías echarle un ojo a esto? ¿reproducirlo en runboat tal vez? [SEP] El segundo commit de este PR tiene como objetivo corregir este error:

```
tbai_datas
Traceback (most recent call last):
File ""/opt/odoo-server/odoo/http.py"", line 1823, in _serve_db
return service_model.retrying(self._serve_ir_http, self.env)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/service/model.py"", line 152, in retrying
result = func()
^^^^^^
File ""/opt/odoo-server/odoo/http.py"", line 1851, in _serve_ir_http
response = self.dispatcher.dispatch(rule.endpoint, args)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/http.py"", line 2055, in dispatch
result = self.request.registry['ir.http']._dispatch(endpoint)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/addons/base/models/ir_http.py"", line 154, in _dispatch
result = endpoint(**request.params)
^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/http.py"", line 763, in route_wrapper
result = endpoint(self, *args, **params_ok)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/addons/web/controllers/dataset.py"", line 43, in call_kw
return self._call_kw(model, method, args, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/addons/web/controllers/dataset.py"", line 34, in _call_kw
return call_kw(Model, method, args, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/api.py"", line 480, in call_kw
result = _call_kw_model(method, model, args, kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/odoo/api.py"", line 451, in _call_kw_model
result = method(recs, *args, **kwargs)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/addons/point_of_sale/models/pos_order.py"", line 939, in create_from_ui
order_ids.append(self._process_order(order, draft, False))
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/extra_addons/oca/l10n-spain/l10n_es_ticketbai_pos/models/pos_order.py"", line 201, in _process_order
vals = order.tbai_prepare_invoice_values(pos_order)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File ""/opt/odoo-server/extra_addons/oca/l10n-spain/l10n_es_ticketbai_pos/models/pos_order.py"", line 107, in tbai_prepare_invoice_values
datas = base64.b64encode(order_data[""tbai_datas""].encode(""utf-8""))
~~~~~~~~~~^^^^^^^^^^^^^^
KeyError: 'tbai_datas'
```

**Posible causa principal:**  
Probablemente se debía a una condición de carrera en el código JavaScript y/o a una interrupción en la cadena de Promesas y/o a excepciones ocultas durante el proceso de generación de facturas simplificadas.  

Este problema fue particularmente difícil de abordar debido a su naturaleza intermitente, ya que ocurre de forma aleatoria y parece estar relacionado con latencias de red u otros factores de sincronización. [SEP] Buenas @rrebollo 

A que te refieres con activar ""Régimen simplificado"" en el POS?
En la configuración de la compañía si veo el check en el apartado TicketBai, pero en el POS no lo veo.

 [SEP] > A que te refieres con activar ""Régimen simplificado"" en el POS? En la configuración de la compañía si veo el check en el apartado TicketBai, pero en el POS no lo veo.

A esto:

<img width=""1354"" height=""819"" alt=""image"" src=""https://github.com/user-attachments/assets/b72b5282-49fa-4ca9-acf8-a6321768f7b5"" />

 [SEP] Sobre la discrepancia entre el valor de `to_invoice` como option y el que figura en el json de pos order, entiendo que puede tratarse de una variación en el código que no se manejó previamente. Todas las pruebas de la función `create_from_ui` de `pos.order` —que simulan la llamada desde el servicio RPC de JavaScript— pasan el mismo valor tanto en el option como en el JSON de pos order; normalmente asignan el mismo parámetro.

Adicionalmente, al realizar pruebas en un entorno Runbot ([runbot.com](https://runbot.com/)) con una versión vanilla de Odoo 16 CE, observé que, aunque en la interfaz del POS se seleccione la opción “Facturar”, el valor de `to_invoice` en options permanece en `false`.

Dada esta situación, el enfoque adoptado en este PR para resolver el problema resulta legítimo y adecuado. [SEP] Estoy trabajando en un set de pruebas js [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch), awaiting test results. [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4679-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at c2bca315ce4639d63faa0c2b788fcf8215cf93ab. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4676,/ocabot migration l10n_es_aeat_mod115
Pull Request,4675,/ocabot migration l10n_es_aeat_mod111
Pull Request,4674,"@HaraldPanten could u review please? [SEP] Probado en local y funciona correctamente. Se resuelve el error y no hay discrepancias con los resultados (tampoco con prorrata, etc.).

También probado en runboat y se resuelve el error con los grupos de impuestos.

@pedrobaeza Al margen de ajustes que queremos hacer y añadir tests, te cuadra el enfoque planteado? Sin este parche (o uno equivalente) actualmente no es posible generar el libro de IVA en instancias que utilicen DUA y tengan facturas del transitario con el grupo de impuestos aplicado.

Gracias. [SEP] En general, utilizar un enfoque con `try` + `except` no suele ser la mejor de las soluciones, ya que ese error puede ser causado por varias razones (aunque se limite la excepción a capturar), y luego, el código del `except` no asegura tampoco que vaya a salir bien. ¿No se puede detectar de otra forma la estructura? ¿Puedes resumir por aquí cómo sale de una y otra forma para ver si tenemos una mejor forma? [SEP] > En general, utilizar un enfoque con `try` + `except` no suele ser la mejor de las soluciones, ya que ese error puede ser causado por varias razones (aunque se limite la excepción a capturar), y luego, el código del `except` no asegura tampoco que vaya a salir bien. ¿No se puede detectar de otra forma la estructura? ¿Puedes resumir por aquí cómo sale de una y otra forma para ver si tenemos una mejor forma?

Cambiado con detección de longitud. Si ""res"" con la devolución de la llamada ""_process_aeat_tax_base_info"" tiene más de longitud 1 es que se está haciendo un grupo de impuestos.  [SEP] > Uhm, sigue sin convencerme demasiado... ¿No habría que mirar `si tax es de tipo grupo`, y si es el caso, entonces buscar `res[tax.child_ids]` (en seudocódigo)?

Pongo un ejemplo:
Impuesto: DUA --> account.tax(157,) 
Impuestos hijos: account.tax(9, 154)
res después de la llamada a ""_process_aeat_tax_base_info"" -> {account.tax(9,): {'tax': account.tax(9,), 'base': 5691.03, 'amount': 0, 'deductible_amount': 0}, account.tax(154,): {'tax': account.tax(154,), 'base': 5691.03, 'amount': 0, 'deductible_amount': 0}} 

1) Se puede comprobar si el ""account.tax(157,) / Tax"" de esa iteración es grupo de impuesto y entonces que haga esa ""excepción"" (sin problema).

2) Búsqueda  res[tax.child_ids], se podría realizar, pero solamente con que cojamos la base de uno de ellos ya es suficiente, el resto se pueden ignorar.

¿Te va bien con ese enfoque?  [SEP] Vale, entonces podría ser `if is_group(tax): list(res.values())[0][""base""]` [SEP] @pedrobaeza @HaraldPanten sabéis si hay algún problema con los runboats?
`Error: Docker login for 'ghcr.io' failed with exit code 1`

Ya he subido el cambio el cambio según lo que se habló ayer 😸 a ver que os parece. [SEP] > @pedrobaeza @HaraldPanten sabéis si hay algún problema con los runboats? `Error: Docker login for 'ghcr.io' failed with exit code 1`
> 
> Ya he subido el cambio el cambio según lo que se habló ayer 😸 a ver que os parece.

A nivel funcional, el runboat no me ha dado problemas. A priori funciona con normalidad.

Pedro, ya nos das feedback sobre el planteamiento técnico. A nivel funcional querré hacer algunas pruebas más; eso sí.

Gracias. [SEP] Vale @pedrobaeza  te comento...

Lo que hemos hecho ha sido compatibilizar el grupo de impuestos para sacar el libro de IVA. El desglose en dos líneas no es correcto, como bien dices. A mi entender, debería comportarse como en las versiones antiguas. Una línea con la base y la cuota según la revalorización. Al final es coger la base y la cutoa donde se aplica el impuesto de importaciones.

De todas formas, eso no lo hemos cambiado. Nosotros lo que hemos hecho ha sido compatibilizar el libro de IVA, tal y como estaba, con los grupos de impuestos. Habría que hacer un FIX para que apareciera la base y la cuota en una sola línea, como había funcionado hasta la V16. Adjunto captura.

<img width=""1502"" height=""272"" alt=""Captura de pantalla 2025-12-22 a las 14 38 57"" src=""https://github.com/user-attachments/assets/e193d61d-9f17-4cbd-9148-6a1061c3a0a6"" />

Hacemos FIX en este mismo PR en commit por separado? [SEP] Podéis ponerlo en este PR. [SEP] ¿Alguna novedad? [SEP] > ¿Alguna novedad?

Mi idea es continuarlo el viernes/lunes a más tardar, que entre fiestas y cierres.... 😅 . [SEP] @pedrobaeza @HaraldPanten indicado en la cabecera del PR y puesto en estado draft como comentamos ayer :) . [SEP] Este PR no debe ser fusionado. Es un parche circunstancial que dejamos abierto (en Draft) por si el resto de usuarios se encuentran con el mismo problema. Esto permite extraerlo, pero no es una solución definitiva. Hasta el refactoring del módulo puede utilizarse como parche temporal."
Pull Request,4673,"Hola, veo que estáis haciendo esto en varios sitios, pero no tengo claro que mejore velocidad en general, ya que si no se hace prefetch, luego tendrá que obtener los datos ""por trozos"", y realmente Odoo ya lleva una gestión para hacer un prefetch inteligente. [SEP] @pedrobaeza con las pruebas realizadas hemos comprobado que con el prefetch, el consumo de la ram era exponencial al calcular el libro de iva de una empresa con muchas facturas, después de añadir dicho cambio el proceso acabo sin problema. [SEP] Ya, ¿pero y tiempos? ¿Esa instancia tiene modificaciones severas sobre `account.move` y `account.move.line`? Algo intermedio es hacer prefetch solo de los campos necesarios para el proceso. [SEP] > Algo intermedio es hacer prefetch solo de los campos necesarios para el proceso.

Esta es la solución ideal, el problema será que el prefetch estará calculando computes complejos que luego no se usan aquí [SEP] Bueno, en el ORM se difieren la obtención de los campos calculados hasta que se usen por primera vez, por lo que eso no debería ser."
Pull Request,4672,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4672-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4672-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 393a220daebf4090131f7b4464a393111a51eded. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4671,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @pedrobaeza ya que fusionas para 16 y 17, que no se te pase 18. Gracias. 😊 [SEP] > Aplica los comentarios de la 16 aquí.

Es verdad, se me olvidarón. Ya está, gracias por recordarlo. [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/f6fef01498a0bc8fe52c7b4db26bb3635b48fe62).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4671-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 334c6d4c58baafa36e72af2bf861a36338e321df. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4670,"@bjkumal @eantones please review it
 [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4670-by-etobella-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4670-by-etobella-bump-nobump), awaiting test results. [SEP] /ocabot migration l10n_es_facturae_sale_stock [SEP] Congratulations, your PR was merged at 9734cce395dbe79ab0b8ce4dc42955c1ee0320a3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4669,"Los tests fallan por el módulo `l10n_es_atc_mod420`. Error de fechas https://github.com/OCA/l10n-spain/actions/runs/20652855269/job/59300462804#step:8:1311, me parece que los tests no son correctos si al cambiar de año dan error. [SEP] > Añade por favor en los tests dicho impuesto para verificar las casillas - que cambiarán -, y así detectar si en el futuro cambian los XML-IDs, que salte el error.

Hecho. Gracias. [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4669-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4669-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at a1afcd8d78181a09b94868b0e103a46936d468f7. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4668,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4668-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4668-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at fdf41b11a53eec1565f7f2694a68aeb8df938e6a. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4667,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4667-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4667-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 465965a147f26dc23bc164f14ac11e0e45b5679e. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4665,
Pull Request,4664,"On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4664-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4664-by-pedrobaeza-bump-patch), awaiting test results. [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] Congratulations, your PR was merged at 174522360a73a6f8b1007ea5e2703401626f0456. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4663,"@pedrobaeza @almumu [SEP] > En este módulo no se puede depender de `stock`. Mira si existe otra forma de arreglarlo sin requerir esa dependencia. Por otro lado, mira de que no se cambie README/index.html

Vale! Ahora lo intento [SEP] > En este módulo no se puede depender de `stock`. Mira si existe otra forma de arreglarlo sin requerir esa dependencia. Por otro lado, mira de que no se cambie README/index.html

En teoría, debería ser suficiente añadiendo el t-if=""address"" de la vista original de Odoo

        <div t-if=""address"" t-attf-class=""address row mb-4"" title=""This block is not always present depending on the printed document."">

https://github.com/odoo/odoo/blob/376c36336b4a2bd01c9cb9b2594abee0713bcf51/addons/web/views/report_templates.xml#L280

Con esto ya no aparece el bloque ""Address block"" [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4663-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4663-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 046cdd85ee6296f5e4002c7e9e3261923f6b1f45. Thanks a lot for contributing to OCA. ❤️ [SEP] @RicardCForgeFlow Creo que esto no se llevó a la V17. Podríais llevarlo/revisarlo?

@pedrobaeza @AaronHForgeFlow @LoisRForgeFlow 

Gracias por la aportación. [SEP] > @RicardCForgeFlow Creo que esto no se llevó a la V17. Podríais llevarlo/revisarlo?
> 
> @pedrobaeza @AaronHForgeFlow @LoisRForgeFlow
> 
> Gracias por la aportación.

Hola @HaraldPanten ahora he hecho el cambio para la v17: https://github.com/OCA/l10n-spain/pull/4687

Para la v16 no es necesario, ya que no existe el bloque ""Address block"" [SEP] > #4687

Perfecto! Muchas gracias por la aportación."
Pull Request,4662,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] > Si se tiene desactivado el SII, no debe haber facturas con `aeat_state` distinto de `not_sent`, así que es algo específico de esa instancia donde tenéis el problema, pero este cambio no tiene demasiado sentido para mí ahora mismo.
> 
> ¿Cuál es el caso de uso?

Hola @pedrobaeza 
El problema es que para las facturas que se crearon **antes** de activar el módulo `l10n_es_aeat_sii_oca`, el campo `aeat_state` aparece vacío en lugar de `not_sent` y no deja eliminarlas.

¿Es correcto este comportamiento?

Igual lo mejor es modificar el campo `aeat_state` de las facturas que se crearon **antes** de activar el módulo `l10n_es_aeat_sii_oca` con una acción de servidor en nuestro caso. [SEP] Entendido el problema. Entonces cambia el filtered a que sea `rec.aeat_state not in [""not_sent"", False]`. [SEP] > Entendido el problema. Entonces cambia el filtered a que sea `rec.aeat_state not in [""not_sent"", False]`.

@pedrobaeza buena idea. Acabo de subir los cambios. [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4662-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4662-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cb464963d188c069c266c54ba6a85309e54870c2. Thanks a lot for contributing to OCA. ❤️ [SEP] > /ocabot merge patch
> 
> ¿Puedes llevarlo a versiones superiores?

Si."
Pull Request,4661,
Pull Request,4660,"¿Puedes por favor llevarlo a la 17 también? [SEP] @pedrobaeza , lo vamos a llevar a todas las versiones ;-)

> Cuando esté fusionado hago cherry-pick a la 17 [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4660-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4660-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 84ac9d1e30b8c561bc549c324195743a278d1f29. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4659,"@pedrobaeza 
cuando se mergee este ya se podría eliminar el commit https://github.com/OCA/l10n-spain/pull/4378/commits/625d706d74df3dda6147a8f9982beb95bf803964  del PR  https://github.com/OCA/l10n-spain/pull/4378 de l10n_es_verifactu_pos_oca
"
Pull Request,4658,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] https://github.com/odoo/odoo/blob/2dc9529af127ed4b2d451059b6ab9c83778c7814/odoo/addons/base/models/res_partner.py#L395 [SEP] Comprueba CI. @carlosdauden como tú estuviste cacharreando con esto, tal vez puedes dar pistas [SEP] > Comprueba CI. @carlosdauden como tú estuviste cacharreando con esto, tal vez puedes dar pistas

Te lo cuento, si he revisado y seguro que el error del orden también está en 17.0. El tema es que en 16.0 el order era por display_name y a partir de 17.0 el order es por complete_name. Esa es la diferencia fundamental.

https://github.com/odoo/odoo/blob/bb60d831a7cdb0606c1baae9a8985b2fdb7dc15b/odoo/addons/base/models/res_partner.py#L179

Por que no ordena bien? por que lo que vemos en pantalla es el display_name con el comercial calculado pero realmente el complete_name no se estaba calculando con el comercial (de ahí el error de los test que espera que siga sin calcularse).

Es correcto que el complete_name siga sin calcularse? No, por que entonces el orden en las vistas no será el correcto visualmente.

El test que hay ahora mismo como digo espera que se calcule el display_name con el comercial pero que el complete_name no se calcule. Por lo tanto hay que modificar el test.

Al añadir el contexto al compute que se alimenta del método _get_complete_name SI añade el comercial y el orden se corresponde con lo visual (display_name) pero claro, el test ya no es correcto. [SEP] Vale, pero recuerdo que @carlosdauden tocó eso. A ver si nos puede dar pistas o nos descarta que tenga que ver. [SEP] /ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4658-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4658-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at 3dcc7dd0d35d4e65db46332557db0354dd17f104. Thanks a lot for contributing to OCA. ❤️ [SEP] Only 19 fw-port pending."
Pull Request,4656,"/ocabot migration l10n_es_pos_sii [SEP] Listo para revisión [SEP] Parece que el CI está caído por la imagen de postgres, en un rato lo vuelvo a lanzar [SEP] /ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4656-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4656-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at 68807f45a87a317e10d271b0e1b783ed470f4b65. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4655,"/ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/ffdf47d200bee8f9170bfad477705a941b926829).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4655-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 10d2830d6dd464a33cc3fbf445d51eca1261b2e0. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4654,"Hi @etobella,
some modules you are maintaining are being modified, check this out! [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/0b22bbebc4767e904b260f873457127389013124).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4654-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 6dec1c2e1db952c6ee513c099d1dea5a213bca08. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4653,
Pull Request,4651,/ocabot migration l10n_es_account_banking_sepa_fsdd
Pull Request,4648,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] Es un caso demasiado específico como bien decís... pero no debería crearse un método específico para ello, si no ver por qué fallan los mecanismos de limpieza estándar y mejorarlos."
Pull Request,4647,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Este desarrollo es incorrecto. Cierra el PR y revisa la tarea por favor"
Pull Request,4646,
Pull Request,4645,
Pull Request,4644,/ocabot migration l10n_es_account_statement_import_n43
Pull Request,4640,"Hola @almumu cuando tengas un rato libre, ¿podrías por favor echarle un vistazo rápido a este borrador de PR? Me gustaría especialmente tu opinión sobre la parte de la subsanación, para ver si consideras que este enfoque es el más adecuado. Cualquier aporte / sugerencia será bienvenida."
Pull Request,4638,
Pull Request,4636,"/ocabot merge minor [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/aefd36e6c26d272f85a3f3ed5a76f9b7a32c2e8f).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge minor [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4636-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at a7fb941179328d37cc002e247425a82a64433ade. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4635,
Pull Request,4634,"@pedrobaeza @almumu [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/07e89917d3bd8a6e9744a50ba89795b0d76a24f5).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4634-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3abdabbfc1243bde64b8cd0abce8abceaf4d25cc. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4633,
Pull Request,4630,Pendiente de #4499 
Pull Request,4629,/ocabot migration l10n_es_aeat_partner_check
Pull Request,4627,"Subido con la aproximación inicial @pedrobaeza   [SEP] Pero si lo metemos en el `res.config.settings`, ¿El usuario va a necesitar permiso de `Ajustes` no? 
Si planteamos esta opción creo que mi primera aproximación con el `wizard` es más apropiada aunque quedara un poco raro el manejo del One2many, el cuál, podríamos sustituirlo con un botón que llame al modelo de `res.company.vat.prorrate` en lugar de manejarlo en el propio wizard [SEP] Con permiso de administrador de facturación no se tiene acceso a esa configuración? Si es así, entonces no nos valdría. Míralo y lo que tú veas. [SEP] @christian-ramos-tecnativa cómo quedó esto? El runboat no funciona ahora mismo. [SEP] @pedrobaeza Lo había devuelto a la primera aproximación utilizando un wizard, he hecho rebase a ver si el runboat colabora. No he encontrado otra forma que quedara mas ""limpia"" a nivel de código. La experiencia de usuario considero que si está correctamente cubierta. Si puedes pruébalo de nuevo con mas ""cariño"" y me dices que te parece 😄  [SEP] Tras volverlo a analizar, lo del m2m lo sigo sin ver. Es mejor hacer una ""copia"" de las líneas en el wizard, y luego volcarlo a lo definitivo. Se podría hacer fácilmente con una herencia con cambio de nombre, y que añada el campo inverse del wizard, y el `company_id` lo rellenas tú en el `default_get` y por contexto para las nuevas líneas, y luego sería volcarlo haciendo un read y sacando el valor del campo m2o del inverse. [SEP] Listo, he preferido hacerlo al momento de pulsar el botón `Actualizar` ya que el `inverse` estaría modificando los datos reales con cada modificación y considero que hacer eso es un wizard es muy poco intuitivo. Ya que, por lo general, el usuario cree que los cambios se aplican al cerrar el wizard. [SEP] Listo! 👍🏻  [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4627-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4627-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 7b5aa79adfa7b2b84bf80559b20fa24a6b772ac5. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4625,"@adasatorres ping me when all tests are green [SEP] No hay un modelo específico para Canarias equivalente al 347? Cuál es la finalidad de esto? [SEP] Buenas tardes, @pedrobaeza.
Efectivamente, en Canarias existe un modelo equivalente (el 415). Supongo que debe haber algún caso específico que el 415 no cubre, ya que he visto que este addon existe en la versión 16.0 conviviendo con el del 415, y además hay un PR abierto para la 18.0 sobre el mismo tema.

Quizá @christian-ramos-tecnativa, que fue quien subió el addon en la 16.0, pueda aportar más información sobre si realmente es necesario, teniendo en cuenta que ya existe el addon del modelo 415. [SEP] La verdad que cuando heredé el desarrollo de este módulo no le dí muchas vueltas, pero ahora por más que lo piense no se me ocurre un ejemplo en el que tengas que presentar un 347 con igic. 
Tienen algún caso real que utilice esta funcionalidad? [SEP] @pedrobaeza @christian-ramos-tecnativa, Cierro el PR, ya que después de investigar, he comprobado que para operaciones sujetas a IGIC en Canarias, la obligación informativa anual se cumple mediante el Modelo 415. Ademas no  he encontrado ningún excepción."
Pull Request,4624,/ocabot migration l10n_es_aeat
Pull Request,4622,
Pull Request,4619,"/ocabot migration delivery_mrw [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/90f45c3b812daf9b117af505b4e1fd49ef0453eb).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge nobump [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/69630f6756bdb07ea9d4cc2960f5fbabd0597e73).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge nobump [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4619-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at bbfe643b70dbea7c0678cdd530eedf0bc97e355f. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4617,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] ¿@pedrobaeza, @LauraCForgeFlow podéis revisar los cambios por favor? [SEP] ¿@pedrobaeza puedes volver a revisarlo, por favor? Muchas gracias 😊 [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch), awaiting test results. [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/76176889882a5f83b88a26517873418b2feb92e4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Al fusionar ha dado error en el módulo del verifactu [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/6ec673c46be6640c49c60fd937eac8750b92387a).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] Uhm, ese error es extraño, pero habría que solucionarlo para limpiar la rama. [SEP] ¿@pedrobaeza puedes volver a lanzar el merge? Ya quedó resuelto el error del verifactu que saltó al fusionar. Gracias [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4617-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 7a6618f9e7915b2d71bb92ac59a5818e31718d27. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4616,"Hasta donde sé, el resultado es automático y calculado. ¿En qué casos se necesitaría cambiar ese resultado? [SEP] > Hasta donde sé, el resultado es automático y calculado. ¿En qué casos se necesitaría cambiar ese resultado?

Creo que no, el campo no es compute y no se hace nada en el `calculate` [SEP] Ya, pues entonces creo que es lo que habría que hacer en lugar de cambiar el readonly, ¿no os parece? [SEP] @EmilioPascual @ArantxaSudon @pedrobaeza He modificado el PR para hacer la mejora del cómputo del campo tipo declaración. [SEP] @pedrobaeza ¿Podrías revisarlo? ¡Gracias! [SEP] This PR has the `approved` label and has been created more than 5 days ago. It should therefore be ready to merge by a maintainer (or a PSC member if the concerned addon has no declared maintainer). 🤖 [SEP] Hola, @pedrobaeza, ¿podrías revisar la respuesta de Emilio? ¡Gracias! [SEP] Efectivamente, como dice @pedrobaeza ""Negativa"" se refiere a 0

<img width=""674"" height=""192"" alt=""image"" src=""https://github.com/user-attachments/assets/41a107e0-bd8e-4af2-80be-16c95b1cff19"" />

Además, he añadido una restricción al confirmar de que la casilla 30 no sea negativa.

<img width=""658"" height=""106"" alt=""image"" src=""https://github.com/user-attachments/assets/a10a934f-9d06-40dd-83d4-7d6d97e69c6d"" />

Además, ¿podéis cambiar el nombre del PR para que indique la rama 16.0? Este PR está apuntando a 16.0 [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/f85535a28e80a027258ed70673ba4e5dd9119b9c).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4616-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 752dc7f82ff323af1eac411cf3e3a57877999201. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4614,
Pull Request,4612,"En lugar de esto, simplemente pon en la clave `excludes` el otro módulo y deja que Odoo ya haga esta comprobación. [SEP] > En lugar de esto, simplemente pon en la clave `excludes` el otro módulo y deja que Odoo ya haga esta comprobación.

Okay! Es verdad, mucho mas simple :sweat_smile:  [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/29ca7de9657b53bb0b4a5c9e892a07b9a9ff3c57).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] @pedrobaeza He parado el workflow ya que ha habido un push después de tu comando de merge y no sé cómo puede afectar. ¿Puedes revisar que se pueda fusionar y relanzar el comando si lo ves bien?

Gracias de antemano. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4612-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 016933d9ba88fb920cd08f30bbb82231054eb150. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4611,
Pull Request,4610,"Hi @ao-landoo,
some modules you are maintaining are being modified, check this out! [SEP] @Bilbonet uno de nuestros clientes estaba experimentando random issues como [este](https://github.com/OCA/l10n-spain/pull/3909#issuecomment-2666406741). He realizado este patch en aras de corregirlo. En mis pruebas locales funciona correctamente. Tal vez puedas ayudarme con un review funcional. [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [16.0-ocabot-merge-pr-4610-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4610-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9587712879dbcb63e709f541cb515964709fea74. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4609,
Pull Request,4608,"Este PR está pendiente de solucionar https://github.com/OCA/l10n-spain/pull/4499#issuecomment-3571519427 [SEP] Buenas @syci. 

Desde el desconocimiento (no conozco el régimen tributario canario), ¿porque has asignado el impuesto ""Exento por Comercio Minorista"" a la clave S1 (Operación Sujeto No exenta)?

Por otro lado, el ""IGIC Exento Repercutido"" ¿porque su causa de exención es E6?

El ""IGIC 0% (Exportaciones)"" lo veo bien en E2 por tratarse de una exportación.

Como bien dices está pendiente del PR del módulo original."
Pull Request,4607,
Pull Request,4606,"No termino de ver la relación de esto con el SII. [SEP] > No termino de ver la relación de esto con el SII.

buenos días @pedrobaeza , la relación es que después de ese cambio en https://github.com/OCA/l10n-spain/commit/fa02f05b86cf2b16c42491bcb49143d6d6be5bb8#diff-d74b92c5e46eac6d96f3fd4c432611a9c7c51c3f691dddba3342721ff660fe3fR16-R17

en el módulo **l10n_es_vat_book_oss** se establece a 0 el importe de todos los impuestos OSS
https://github.com/OCA/l10n-spain/blob/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_vat_book_oss/models/account_move.py#L16

<img width=""892"" height=""234"" alt=""image"" src=""https://github.com/user-attachments/assets/9c819e14-afa0-403f-a209-21b2e5e71d6f"" />


 y en el módulo **l10n_es_aeat_sii_oss** se buscan esos mismos impuestos oss para restarlos del importe total en el sii
[l10n_es_vat_book](https://github.com/OCA/l10n-spain/blame/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_aeat_sii_oss/models/account_move.py#L14)
<img width=""709"" height=""307"" alt=""image"" src=""https://github.com/user-attachments/assets/36ad32bb-c6f9-4b0f-9d63-7e5eba6ddba5"" />



por lo que ya no se están restando los impuestos oss del importe total porque ""amount"" siempre es 0 porque el módulo l10n_es_vat_book_oss lo establece a 0 en la función _process_aeat_tax_fee_info que es la que se utiliza dentro de _get_aeat_tax_info (la misma que se utiliza en el sii, y también en verifactu para obtener el desglose de impuestos)
https://github.com/OCA/l10n-spain/blob/3df1c7be67052c5ec7fe8b599f4860ae951750c8/l10n_es_aeat/models/account_move.py#L38
<img width=""1017"" height=""548"" alt=""image"" src=""https://github.com/user-attachments/assets/31c945d0-08a0-43f9-a5c9-2fa7790cb35e"" />


<img width=""1203"" height=""497"" alt=""image"" src=""https://github.com/user-attachments/assets/b7d5572b-5683-4c6e-ace3-656f4fddf369"" />


 [SEP] Ya, ahí está el tema, que la idea es que libro de IVA debería ser igual a SII/VERI*FACTU, y por eso busco que haya una fuente de verdad. Creo que lo que podemos hacer si no es tener como con la cuota: el importe y luego lo deducible, pues aquí la base y la base ""aplicable a impuestos"", y entonces quitar de uno u otro, y así seguir conteniendo todo en el mismo diccionario y llamada, pero utilizar una u otra según interese. [SEP] @pedrobaeza el problema es que ahora todas las facturas con OSS salen con incidencias en el SII. Exactamente que se debería hacer para poder cerrarlo? [SEP] ¿Qué te parece la sugerencia de tener esos cuatro valores devueltos, y leer en cada módulo (SII/vat book) lo que interese? Si no lo ves factible, vamos a solucionarlo de la manera que sea."
Pull Request,4602,"This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4602-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4602-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 8af041d43cd184373e75b8546b94222896a614e0. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4601,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] No es un error real según lo comentado en https://github.com/OCA/l10n-spain/issues/4596#issuecomment-3569886665, así que cierro."
Pull Request,4600,Pendiente de #4622 
Pull Request,4599,
Pull Request,4598,"This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4598-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4598-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 431acdf74780f8abe623486749c76d4f9b599f79. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4595,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4595-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4595-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4595-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/e9beaf90a5587fb40d173948f599d69e1543e8b6).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] @ramzeta por favor no quites los parámetros anteriores. El error en el CI que hay ahora mismo se debe a que FACe lleva más de 24 horas caído. A ver si lo solucionan, y si no, veremos de desactivar temporalmente los tests, aunque precisamente el módulo tampoco funciona debido a eso. [SEP] Vale subo una mejora que detecte ! Gracias [SEP] Sí, y por favor haz squash de los commits y revisa el CI de pre-commit."
Pull Request,4594,
Pull Request,4593,"/ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4593-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4593-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 3553e282cd4cad0d5a5f452ee61c695e4f3b5b48. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4592,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/c677e71f371d07f2d21bd06b816d8f9f8a241fc4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch), awaiting test results. [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4592-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cd13b882929971aa0f9f784ce50fb3954dc25fec. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4590,ping @juancarlosonate-tecnativa he añadido el cuando se cambie el partner recalcule los impuestos en `sale.order`. En el caso de `purchase.order` y `account.move` ya se hace.
Pull Request,4588,"/ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4588-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4588-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at c887d9e624468fa97da94034359635e607eefa83. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4587,"/ocabot merge nobump [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4587-by-pedrobaeza-bump-nobump](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4587-by-pedrobaeza-bump-nobump), awaiting test results. [SEP] Congratulations, your PR was merged at 468bd2f477811f83440f988ec0f7e72f3d007066. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4585,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] @carlos-lopez-tecnativa Done!! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4585-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4585-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 531a2525a14caf27de84040f1da629515a303f0f. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4584,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [16.0-ocabot-merge-pr-4584-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4584-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 491f186a858791d88dee5294e74389b2d58d4766. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4583,"He probado el módulo pero primero me da error que no esta instalado ""pos_hr"", creo que hay que incluir esa dependecia, el QR sale en la impresión pero cuando va a la URL no aparece el número de factura, aparece como ""false"", y logicamente da ""factura no encontrada"" [SEP] Este módulo no debe depender de `pos_hr`. [SEP] > He probado el módulo pero primero me da error que no esta instalado ""pos_hr"", creo que hay que incluir esa dependecia, el QR sale en la impresión pero cuando va a la URL no aparece el número de factura, aparece como ""false"", y logicamente da ""factura no encontrada""

A falta de revisar el error que comentas, comentar que el módulo no tiene dependencia directa con pos_hr.
Sus dependecias son: l10n_es_pos_oca y l10n_es_verifactu_oca [SEP] Sí, parece lógico mirar el flag de simplificado. [SEP] @cesarportas 
Functional review: tras añadir este módulo y hacer una venta en POS me salta el siguiente error cuando voy a validar el método de pago. Me da tanto con tarjeta como en efectivo así que el método de pago no influye en el error. 

Tengo VERIFACTU configurado correctamente y este error sólo me da dentro del POS ya que dentro de las facturas, puedo validar y confirmar una factura sin problema ninguno.


<img width=""1920"" height=""1171"" alt=""image"" src=""https://github.com/user-attachments/assets/2f30fee1-aac9-4a63-85f9-7db293dea221"" />
"
Pull Request,4582,"Tiene sentido mantener esto en lugar de ir al de Odoo core? [SEP] @pedrobaeza gracias por avisarme, no me había dado cuenta que en v19. 0 estaba en el core, lo cancelo. "
Pull Request,4581,"@pedrobaeza Aprovechando que estoy haciendo esto, veo que ahora lo que nos piden es enviar el .pem del certificado, no copiarlo manualmente. Teniendo en cuenta que no tiene passwords, podríamos intentar que fuera una funcionalidad parecida al show key que hay a dia de hoy, aunque en las pruebas que he hecho me implicaba hacer un campo calculado que cada vez que entrabas sacaba la parte pública. El problema es que no puedo descargar el fichero con ese onchange. Si cambiamos esa funcionalidad por un wizard te parece bien? En el wizard aparecería la clave pública escrita por si la queremos copiar y tendríamos la opción de descargar el fichero pem.

Opción con el onchange se vería así:

<img width=""584"" height=""133"" alt=""image"" src=""https://github.com/user-attachments/assets/782aa2f1-09a6-4b0b-891c-55c68ee233b2"" />

Con el botón seria más sencillo creo yo. [SEP] Con el onchange no se ve mal tampoco, ¿no? [SEP] el tema es que con el onchange no va, se debe hacer un campo compute que no depende del valor del campo no almacenado (el show public certificate), por lo tanto, el campo se recalcula cada vez que entramos en el registro, no cuando lo pedimos. Esto se hace así por que en el momento de hacer la descarga, el fichero vuelve a calcularse, y al ser el show un no stored, lo vuelve a poner a False y, por lo tanto, no hay elemento. [SEP] Bueno, si ves problemas técnicas, no creo que sea mucho problema tener un botón + popup"
Pull Request,4580,"@ajfebres Recuerda que es un commit por módulo, quita el del pre-commit [SEP] @syci Estoy conservando el histórico de la versión de la cual estoy migrando, según:

https://github.com/OCA/maintainer-tools/wiki/Migration-to-version-15.0 [SEP] > @syci Estoy conservando el histórico de la versión de la cual estoy migrando, según:
> 
> https://github.com/OCA/maintainer-tools/wiki/Migration-to-version-15.0

Sí, pero este no corresponde tenerlo en el histórico. 
<img width=""1136"" height=""84"" alt=""image"" src=""https://github.com/user-attachments/assets/926bac47-53f6-40b9-bad2-aae9c238bb46"" />
 [SEP] Pendiente de #4499 "
Pull Request,4579,"`
    if(!result.verifactu_qr){
                    result.verifactu_qr = this._get_verifactu_qr_code_data();
                }
                return result;
`

A la hora de reimprimir no sale el qr 

En el models js me aparece correctamente con esto en el export_for_printing() al volver a reimprimir el ticket

Así ya lo ven en la 14"
Pull Request,4577,"/ocabot merge major [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4577-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4577-by-pedrobaeza-bump-major), awaiting test results. [SEP] Congratulations, your PR was merged at d72dfe8658ba37e3422aa225265070a7736ee9f0. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4576,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/b4a39e1696e2d3ceeb5fd39ed8a3abdaa58b9559).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4576-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9f6c6d16ceddfdd49fa0889ffb62dc54d672cc91. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4575,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4575-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4575-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 704c5b184812e910a538ead8fa921c8f1fc4d974. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4574,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4574-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4574-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at cb531729904d61860afb53c8d466e5e6aa3ffeaf. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4573,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/b23a2176266c21fdf0e7224fc010ff8dfcafaac4).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge patch [SEP] What a great day to merge this nice PR. Let's do it!
Prepared branch [17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4573-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 95dbcd78d0cf3fdeb224f2b762414b8348dc3d2f. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4572,"/ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [16.0-ocabot-merge-pr-4572-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4572-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 4f2881fc04f98bcd6614a6fb25aacf7ca91331f0. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4571,"/ocabot merge patch [SEP] On my way to merge this fine PR!
Prepared branch [15.0-ocabot-merge-pr-4571-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/15.0-ocabot-merge-pr-4571-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 06757f5a5eda1a37ffed89504a1b1ef98296d766. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4570,"@enriquemartin FYI [SEP] /ocabot merge patch [SEP] This PR looks fantastic, let's merge it!
Prepared branch [14.0-ocabot-merge-pr-4570-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/14.0-ocabot-merge-pr-4570-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 9b36a6849d6e56d1b30eb0bb8b2816fa8ede7cf6. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4569,"Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [16.0-ocabot-merge-pr-4569-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/16.0-ocabot-merge-pr-4569-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at ce22d44d4ac2ee627d4ae544e9de09fe57c40163. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4568,"Hi @pedrobaeza,
some modules you are maintaining are being modified, check this out! [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [18.0-ocabot-merge-pr-4568-by-pedrobaeza-bump-minor](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4568-by-pedrobaeza-bump-minor), awaiting test results. [SEP] Congratulations, your PR was merged at 8d5e2967d0a7c40ea93f74b23a5c9adfaa9150a3. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4566,"Hi @EmilioPascual, @rafaelbn,
some modules you are maintaining are being modified, check this out! [SEP] @etobella recuerdas la función de eso? [SEP] @Andrii9090 actualiza el commit, el módulo se llama `l10n_es_vat_prorate`, no l10n_vat_prorate [SEP] Parece que ese cambio viene de este PR cancelado de migración https://github.com/OCA/l10n-spain/pull/4251/files#diff-e382c2f33435675e086d7fac9d04032b592ec563e685ec3b2fb75bea7e3f1c05

Cuando @Andrii9090 retomo la migración a 18.0 lo hizo a partir de ese PR. ¿@BetoRaja, @Anxo82, @HaraldPanten os acordáis porque añadiais la parte que se quita en este PR?

A falta de un argumento válido yo lo qutaría, no entiendo el motivo de hacerlo y además está causando problemas. [SEP] Cierto, en este commit lo añaden https://github.com/OCA/l10n-spain/pull/4251/commits/8dcd1b62b652042b5713afeecb8530847af32985#diff-e382c2f33435675e086d7fac9d04032b592ec563e685ec3b2fb75bea7e3f1c05 [SEP] This PR looks fantastic, let's merge it!
Prepared branch [18.0-ocabot-merge-pr-4566-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/18.0-ocabot-merge-pr-4566-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 79f14ccd015c49ee823420931e288d2d29260bb6. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4565,"/ocabot merge major [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major), awaiting test results. [SEP] @pedrobaeza your merge command was aborted due to failed check(s), which you can inspect on [this commit of 17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/c348bdd33d95ed0aab919dcda216d64ee915abb8).

After fixing the problem, you can re-issue a merge command. Please refrain from merging manually as it will most probably make the target branch red. [SEP] /ocabot merge major [SEP] This PR looks fantastic, let's merge it!
Prepared branch [17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4565-by-pedrobaeza-bump-major), awaiting test results. [SEP] Congratulations, your PR was merged at dc4ac92efef35495876d8f4a7382fb9be6541476. Thanks a lot for contributing to OCA. ❤️"
Pull Request,4564,"/ocabot merge patch [SEP] Hey, thanks for contributing! Proceeding to merge this for you.
Prepared branch [17.0-ocabot-merge-pr-4564-by-pedrobaeza-bump-patch](https://github.com/OCA/l10n-spain/commits/17.0-ocabot-merge-pr-4564-by-pedrobaeza-bump-patch), awaiting test results. [SEP] Congratulations, your PR was merged at 596197dd3787a58b1c1a66de548ef88b37a72df7. Thanks a lot for contributing to OCA. ❤️"
